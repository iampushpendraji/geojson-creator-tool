(self.webpackChunkgeojson_creator_tool=self.webpackChunkgeojson_creator_tool||[]).push([[643],{8527:function(tr){tr.exports=function(){"use strict";var ce=function(L,U){var ct={drag:[],click:[],mousemove:[],mousedown:[],mouseup:[],mouseout:[],keydown:[],keyup:[],touchstart:[],touchmove:[],touchend:[],tap:[]},oe={on:function(Bt,Te,ur){if(void 0===ct[Bt])throw new Error("Invalid event type: "+Bt);ct[Bt].push({selector:Te,fn:ur})},render:function(Bt){U.store.featureChanged(Bt)}},Se=function(Bt,Te){for(var ur=ct[Bt],ar=ur.length;ar--;){var kr=ur[ar];if(kr.selector(Te)){kr.fn.call(oe,Te)||U.store.render(),U.ui.updateMapClasses();break}}};return L.start.call(oe),{render:L.render,stop:function(){L.stop&&L.stop()},trash:function(){L.trash&&(L.trash(),U.store.render())},combineFeatures:function(){L.combineFeatures&&L.combineFeatures()},uncombineFeatures:function(){L.uncombineFeatures&&L.uncombineFeatures()},drag:function(Bt){Se("drag",Bt)},click:function(Bt){Se("click",Bt)},mousemove:function(Bt){Se("mousemove",Bt)},mousedown:function(Bt){Se("mousedown",Bt)},mouseup:function(Bt){Se("mouseup",Bt)},mouseout:function(Bt){Se("mouseout",Bt)},keydown:function(Bt){Se("keydown",Bt)},keyup:function(Bt){Se("keyup",Bt)},touchstart:function(Bt){Se("touchstart",Bt)},touchmove:function(Bt){Se("touchmove",Bt)},touchend:function(Bt){Se("touchend",Bt)},tap:function(Bt){Se("tap",Bt)}}};function gt(L){var U=0;if(L&&L.length>0){U+=Math.abs(Pt(L[0]));for(var ct=1;ct<L.length;ct++)U-=Math.abs(Pt(L[ct]))}return U}function Pt(L){var U,ct,oe,Se,Bt,Te,ur=0,ar=L.length;if(ar>2){for(Te=0;Te<ar;Te++)Te===ar-2?(oe=ar-2,Se=ar-1,Bt=0):Te===ar-1?(oe=ar-1,Se=0,Bt=1):(oe=Te,Se=Te+1,Bt=Te+2),U=L[oe],ct=L[Se],ur+=(s(L[Bt][0])-s(U[0]))*Math.sin(s(ct[1]));ur=6378137*ur*6378137/2}return ur}function s(L){return L*Math.PI/180}var lt_geometry=function L(U){var ct,oe=0;switch(U.type){case"Polygon":return gt(U.coordinates);case"MultiPolygon":for(ct=0;ct<U.coordinates.length;ct++)oe+=gt(U.coordinates[ct]);return oe;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0;case"GeometryCollection":for(ct=0;ct<U.geometries.length;ct++)oe+=L(U.geometries[ct]);return oe}},it="mapbox-gl-draw-hot",K="mapbox-gl-draw-cold",tt="add",X="move",J="pointer",et="none",at={POLYGON:"polygon",LINE:"line_string",POINT:"point"},Z="Feature",Wt="Polygon",St="LineString",kt="Point",dt="FeatureCollection",At={DRAW_LINE_STRING:"draw_line_string",DRAW_POLYGON:"draw_polygon",DRAW_POINT:"draw_point",SIMPLE_SELECT:"simple_select",DIRECT_SELECT:"direct_select",STATIC:"static"},$t="draw.create",Ot="draw.update",Er="feature",He="midpoint",ei="vertex",_n="true",zn="false",se=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate"],Ze={Point:0,LineString:1,Polygon:2};function Kt(L,U){var ct=Ze[L.geometry.type]-Ze[U.geometry.type];return 0===ct&&L.geometry.type===Wt?L.area-U.area:ct}function ut(L){if(this._items={},this._nums={},this._length=L?L.length:0,L)for(var U=0,ct=L.length;U<ct;U++)this.add(L[U]),void 0!==L[U]&&("string"==typeof L[U]?this._items[L[U]]=U:this._nums[L[U]]=U)}ut.prototype.add=function(L){return this.has(L)||(this._length++,"string"==typeof L?this._items[L]=this._length:this._nums[L]=this._length),this},ut.prototype.delete=function(L){return!1===this.has(L)||(this._length--,delete this._items[L],delete this._nums[L]),this},ut.prototype.has=function(L){return!("string"!=typeof L&&"number"!=typeof L||void 0===this._items[L]&&void 0===this._nums[L])},ut.prototype.values=function(){var L=this,U=[];return Object.keys(this._items).forEach(function(ct){U.push({k:ct,v:L._items[ct]})}),Object.keys(this._nums).forEach(function(ct){U.push({k:JSON.parse(ct),v:L._nums[ct]})}),U.sort(function(ct,oe){return ct.v-oe.v}).map(function(ct){return ct.k})},ut.prototype.clear=function(){return this._length=0,this._items={},this._nums={},this};var rt=[Er,He,ei],ot={click:function(L,U,ct){return Nt(L,U,ct,ct.options.clickBuffer)},touch:function(L,U,ct){return Nt(L,U,ct,ct.options.touchBuffer)}};function Nt(L,U,ct,oe){if(null===ct.map)return[];var kr,Ae,Se=L?(void 0===(Ae=oe)&&(Ae=0),[[(kr=L).point.x-Ae,kr.point.y-Ae],[kr.point.x+Ae,kr.point.y+Ae]]):U,Bt={};ct.options.styles&&(Bt.layers=ct.options.styles.map(function(kr){return kr.id}));var Te=ct.map.queryRenderedFeatures(Se,Bt).filter(function(kr){return-1!==rt.indexOf(kr.properties.meta)}),ur=new ut,ar=[];return Te.forEach(function(kr){var Ae=kr.properties.id;ur.has(Ae)||(ur.add(Ae),ar.push(kr))}),function(kr){return kr.map(function(Ae){return Ae.geometry.type===Wt&&(Ae.area=lt_geometry({type:Z,property:{},geometry:Ae.geometry})),Ae}).sort(Kt).map(function(Ae){return delete Ae.area,Ae})}(ar)}function le(L,U){var ct=ot.click(L,null,U),oe={mouse:et};return ct[0]&&(oe.mouse=ct[0].properties.active===_n?X:J,oe.feature=ct[0].properties.meta),-1!==U.events.currentModeName().indexOf("draw")&&(oe.mouse=tt),U.ui.queueMapClasses(oe),U.ui.updateMapClasses(),ct[0]}function Oe(L,U){var ct=L.x-U.x,oe=L.y-U.y;return Math.sqrt(ct*ct+oe*oe)}function Qe(L,U,ct){void 0===ct&&(ct={});var oe=null!=ct.fineTolerance?ct.fineTolerance:4,Se=null!=ct.grossTolerance?ct.grossTolerance:12,Bt=null!=ct.interval?ct.interval:500;L.point=L.point||U.point,L.time=L.time||U.time;var Te=Oe(L.point,U.point);return Te<oe||Te<Se&&U.time-L.time<Bt}function ir(L,U,ct){void 0===ct&&(ct={});var oe=null!=ct.tolerance?ct.tolerance:25,Se=null!=ct.interval?ct.interval:250;return L.point=L.point||U.point,L.time=L.time||U.time,Oe(L.point,U.point)<oe&&U.time-L.time<Se}function Ge(L,U){return L(U={exports:{}},U.exports),U.exports}var fn=Ge(function(L){var U=L.exports=function(ct,oe){if(oe||(oe=16),void 0===ct&&(ct=128),ct<=0)return"0";for(var Se=Math.log(Math.pow(2,ct))/Math.log(oe),Bt=2;Se===1/0;Bt*=2)Se=Math.log(Math.pow(2,ct/Bt))/Math.log(oe)*Bt;var Te=Se-Math.floor(Se),ur="";for(Bt=0;Bt<Math.floor(Se);Bt++)ur=Math.floor(Math.random()*oe).toString(oe)+ur;if(Te){var ar=Math.pow(oe,Te);ur=Math.floor(Math.random()*ar).toString(oe)+ur}var kr=parseInt(ur,oe);return kr!==1/0&&kr>=Math.pow(2,ct)?U(ct,oe):ur};U.rack=function(ct,oe,Se){var Bt=function(ur){var ar=0;do{if(ar++>10){if(!Se)throw new Error("too many ID collisions, use more bits");ct+=Se}var kr=U(ct,oe)}while(Object.hasOwnProperty.call(Te,kr));return Te[kr]=ur,kr},Te=Bt.hats={};return Bt.get=function(ur){return Bt.hats[ur]},Bt.set=function(ur,ar){return Bt.hats[ur]=ar,Bt},Bt.bits=ct||128,Bt.base=oe||16,Bt}}),en=function(L,U){this.ctx=L,this.properties=U.properties||{},this.coordinates=U.geometry.coordinates,this.id=U.id||fn(),this.type=U.geometry.type};en.prototype.changed=function(){this.ctx.store.featureChanged(this.id)},en.prototype.incomingCoords=function(L){this.setCoordinates(L)},en.prototype.setCoordinates=function(L){this.coordinates=L,this.changed()},en.prototype.getCoordinates=function(){return JSON.parse(JSON.stringify(this.coordinates))},en.prototype.setProperty=function(L,U){this.properties[L]=U},en.prototype.toGeoJSON=function(){return JSON.parse(JSON.stringify({id:this.id,type:Z,properties:this.properties,geometry:{coordinates:this.getCoordinates(),type:this.type}}))},en.prototype.internal=function(L){var U={id:this.id,meta:Er,"meta:type":this.type,active:zn,mode:L};if(this.ctx.options.userProperties)for(var ct in this.properties)U["user_"+ct]=this.properties[ct];return{type:Z,properties:U,geometry:{coordinates:this.getCoordinates(),type:this.type}}};var hr=function(L,U){en.call(this,L,U)};(hr.prototype=Object.create(en.prototype)).isValid=function(){return"number"==typeof this.coordinates[0]&&"number"==typeof this.coordinates[1]},hr.prototype.updateCoordinate=function(L,U,ct){this.coordinates=3===arguments.length?[U,ct]:[L,U],this.changed()},hr.prototype.getCoordinate=function(){return this.getCoordinates()};var gn=function(L,U){en.call(this,L,U)};(gn.prototype=Object.create(en.prototype)).isValid=function(){return this.coordinates.length>1},gn.prototype.addCoordinate=function(L,U,ct){this.changed();var oe=parseInt(L,10);this.coordinates.splice(oe,0,[U,ct])},gn.prototype.getCoordinate=function(L){var U=parseInt(L,10);return JSON.parse(JSON.stringify(this.coordinates[U]))},gn.prototype.removeCoordinate=function(L){this.changed(),this.coordinates.splice(parseInt(L,10),1)},gn.prototype.updateCoordinate=function(L,U,ct){var oe=parseInt(L,10);this.coordinates[oe]=[U,ct],this.changed()};var Yn=function(L,U){en.call(this,L,U),this.coordinates=this.coordinates.map(function(ct){return ct.slice(0,-1)})};(Yn.prototype=Object.create(en.prototype)).isValid=function(){return 0!==this.coordinates.length&&this.coordinates.every(function(L){return L.length>2})},Yn.prototype.incomingCoords=function(L){this.coordinates=L.map(function(U){return U.slice(0,-1)}),this.changed()},Yn.prototype.setCoordinates=function(L){this.coordinates=L,this.changed()},Yn.prototype.addCoordinate=function(L,U,ct){this.changed();var oe=L.split(".").map(function(Se){return parseInt(Se,10)});this.coordinates[oe[0]].splice(oe[1],0,[U,ct])},Yn.prototype.removeCoordinate=function(L){this.changed();var U=L.split(".").map(function(oe){return parseInt(oe,10)}),ct=this.coordinates[U[0]];ct&&(ct.splice(U[1],1),ct.length<3&&this.coordinates.splice(U[0],1))},Yn.prototype.getCoordinate=function(L){var U=L.split(".").map(function(oe){return parseInt(oe,10)});return JSON.parse(JSON.stringify(this.coordinates[U[0]][U[1]]))},Yn.prototype.getCoordinates=function(){return this.coordinates.map(function(L){return L.concat([L[0]])})},Yn.prototype.updateCoordinate=function(L,U,ct){this.changed();var oe=L.split("."),Se=parseInt(oe[0],10),Bt=parseInt(oe[1],10);void 0===this.coordinates[Se]&&(this.coordinates[Se]=[]),this.coordinates[Se][Bt]=[U,ct]};var Jn={MultiPoint:hr,MultiLineString:gn,MultiPolygon:Yn},Sn=function(L,U,ct,oe,Se){var Bt=ct.split("."),Te=parseInt(Bt[0],10),ur=Bt[1]?Bt.slice(1).join("."):null;return L[Te][U](ur,oe,Se)},ri=function(L,U){if(en.call(this,L,U),delete this.coordinates,this.model=Jn[U.geometry.type],void 0===this.model)throw new TypeError(U.geometry.type+" is not a valid type");this.features=this._coordinatesToFeatures(U.geometry.coordinates)};function Br(L){this.map=L.map,this.drawConfig=JSON.parse(JSON.stringify(L.options||{})),this._ctx=L}(ri.prototype=Object.create(en.prototype))._coordinatesToFeatures=function(L){var U=this,ct=this.model.bind(this);return L.map(function(oe){return new ct(U.ctx,{id:fn(),type:Z,properties:{},geometry:{coordinates:oe,type:U.type.replace("Multi","")}})})},ri.prototype.isValid=function(){return this.features.every(function(L){return L.isValid()})},ri.prototype.setCoordinates=function(L){this.features=this._coordinatesToFeatures(L),this.changed()},ri.prototype.getCoordinate=function(L){return Sn(this.features,"getCoordinate",L)},ri.prototype.getCoordinates=function(){return JSON.parse(JSON.stringify(this.features.map(function(L){return L.type===Wt?L.getCoordinates():L.coordinates})))},ri.prototype.updateCoordinate=function(L,U,ct){Sn(this.features,"updateCoordinate",L,U,ct),this.changed()},ri.prototype.addCoordinate=function(L,U,ct){Sn(this.features,"addCoordinate",L,U,ct),this.changed()},ri.prototype.removeCoordinate=function(L){Sn(this.features,"removeCoordinate",L),this.changed()},ri.prototype.getFeatures=function(){return this.features},Br.prototype.setSelected=function(L){return this._ctx.store.setSelected(L)},Br.prototype.setSelectedCoordinates=function(L){var U=this;this._ctx.store.setSelectedCoordinates(L),L.reduce(function(ct,oe){return void 0===ct[oe.feature_id]&&(ct[oe.feature_id]=!0,U._ctx.store.get(oe.feature_id).changed()),ct},{})},Br.prototype.getSelected=function(){return this._ctx.store.getSelected()},Br.prototype.getSelectedIds=function(){return this._ctx.store.getSelectedIds()},Br.prototype.isSelected=function(L){return this._ctx.store.isSelected(L)},Br.prototype.getFeature=function(L){return this._ctx.store.get(L)},Br.prototype.select=function(L){return this._ctx.store.select(L)},Br.prototype.deselect=function(L){return this._ctx.store.deselect(L)},Br.prototype.deleteFeature=function(L,U){return void 0===U&&(U={}),this._ctx.store.delete(L,U)},Br.prototype.addFeature=function(L){return this._ctx.store.add(L)},Br.prototype.clearSelectedFeatures=function(){return this._ctx.store.clearSelected()},Br.prototype.clearSelectedCoordinates=function(){return this._ctx.store.clearSelectedCoordinates()},Br.prototype.setActionableState=function(L){return void 0===L&&(L={}),this._ctx.events.actionable({trash:L.trash||!1,combineFeatures:L.combineFeatures||!1,uncombineFeatures:L.uncombineFeatures||!1})},Br.prototype.changeMode=function(L,U,ct){return void 0===U&&(U={}),void 0===ct&&(ct={}),this._ctx.events.changeMode(L,U,ct)},Br.prototype.updateUIClasses=function(L){return this._ctx.ui.queueMapClasses(L)},Br.prototype.activateUIButton=function(L){return this._ctx.ui.setActiveButton(L)},Br.prototype.featuresAt=function(L,U,ct){if(void 0===ct&&(ct="click"),"click"!==ct&&"touch"!==ct)throw new Error("invalid buffer type");return ot[ct](L,U,this._ctx)},Br.prototype.newFeature=function(L){var U=L.geometry.type;return U===kt?new hr(this._ctx,L):U===St?new gn(this._ctx,L):U===Wt?new Yn(this._ctx,L):new ri(this._ctx,L)},Br.prototype.isInstanceOf=function(L,U){if(L===kt)return U instanceof hr;if(L===St)return U instanceof gn;if(L===Wt)return U instanceof Yn;if("MultiFeature"===L)return U instanceof ri;throw new Error("Unknown feature class: "+L)},Br.prototype.doRender=function(L){return this._ctx.store.featureChanged(L)},Br.prototype.onSetup=function(){},Br.prototype.onDrag=function(){},Br.prototype.onClick=function(){},Br.prototype.onMouseMove=function(){},Br.prototype.onMouseDown=function(){},Br.prototype.onMouseUp=function(){},Br.prototype.onMouseOut=function(){},Br.prototype.onKeyUp=function(){},Br.prototype.onKeyDown=function(){},Br.prototype.onTouchStart=function(){},Br.prototype.onTouchMove=function(){},Br.prototype.onTouchEnd=function(){},Br.prototype.onTap=function(){},Br.prototype.onStop=function(){},Br.prototype.onTrash=function(){},Br.prototype.onCombineFeature=function(){},Br.prototype.onUncombineFeature=function(){},Br.prototype.toDisplayFeatures=function(){throw new Error("You must overwrite toDisplayFeatures")};var Xo={drag:"onDrag",click:"onClick",mousemove:"onMouseMove",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseout:"onMouseOut",keyup:"onKeyUp",keydown:"onKeyDown",touchstart:"onTouchStart",touchmove:"onTouchMove",touchend:"onTouchEnd",tap:"onTap"},zo=Object.keys(Xo);function Gn(L){return[].concat(L).filter(function(U){return void 0!==U})}function xa(){var L=this;if(!L.ctx.map||void 0===L.ctx.map.getSource(it))return ar();var U=L.ctx.events.currentModeName();L.ctx.ui.queueMapClasses({mode:U});var ct=[],oe=[];L.isDirty?oe=L.getAllIds():(ct=L.getChangedIds().filter(function(kr){return void 0!==L.get(kr)}),oe=L.sources.hot.filter(function(kr){return kr.properties.id&&-1===ct.indexOf(kr.properties.id)&&void 0!==L.get(kr.properties.id)}).map(function(kr){return kr.properties.id})),L.sources.hot=[];var Se=L.sources.cold.length;L.sources.cold=L.isDirty?[]:L.sources.cold.filter(function(kr){return-1===ct.indexOf(kr.properties.id||kr.properties.parent)});var Bt=Se!==L.sources.cold.length||oe.length>0;function Te(kr,Ae){var or=L.get(kr).internal(U);L.ctx.events.currentModeRender(or,function(lr){L.sources[Ae].push(lr)})}if(ct.forEach(function(kr){return Te(kr,"hot")}),oe.forEach(function(kr){return Te(kr,"cold")}),Bt&&L.ctx.map.getSource(K).setData({type:dt,features:L.sources.cold}),L.ctx.map.getSource(it).setData({type:dt,features:L.sources.hot}),L._emitSelectionChange&&(L.ctx.map.fire("draw.selectionchange",{features:L.getSelected().map(function(kr){return kr.toGeoJSON()}),points:L.getSelectedCoordinates().map(function(kr){return{type:Z,properties:{},geometry:{type:kt,coordinates:kr.coordinates}}})}),L._emitSelectionChange=!1),L._deletedFeaturesToEmit.length){var ur=L._deletedFeaturesToEmit.map(function(kr){return kr.toGeoJSON()});L._deletedFeaturesToEmit=[],L.ctx.map.fire("draw.delete",{features:ur})}function ar(){L.isDirty=!1,L.clearChangedIds()}ar(),L.ctx.map.fire("draw.render",{})}function xn(L){var U,ct=this;this._features={},this._featureIds=new ut,this._selectedFeatureIds=new ut,this._selectedCoordinates=[],this._changedFeatureIds=new ut,this._deletedFeaturesToEmit=[],this._emitSelectionChange=!1,this._mapInitialConfig={},this.ctx=L,this.sources={hot:[],cold:[]},this.render=function(){U||(U=requestAnimationFrame(function(){U=null,xa.call(ct)}))},this.isDirty=!1}function cr(L,U){var ct=L._selectedCoordinates.filter(function(oe){return L._selectedFeatureIds.has(oe.feature_id)});L._selectedCoordinates.length===ct.length||U.silent||(L._emitSelectionChange=!0),L._selectedCoordinates=ct}xn.prototype.createRenderBatch=function(){var L=this,U=this.render,ct=0;return this.render=function(){ct++},function(){L.render=U,ct>0&&L.render()}},xn.prototype.setDirty=function(){return this.isDirty=!0,this},xn.prototype.featureChanged=function(L){return this._changedFeatureIds.add(L),this},xn.prototype.getChangedIds=function(){return this._changedFeatureIds.values()},xn.prototype.clearChangedIds=function(){return this._changedFeatureIds.clear(),this},xn.prototype.getAllIds=function(){return this._featureIds.values()},xn.prototype.add=function(L){return this.featureChanged(L.id),this._features[L.id]=L,this._featureIds.add(L.id),this},xn.prototype.delete=function(L,U){var ct=this;return void 0===U&&(U={}),Gn(L).forEach(function(oe){ct._featureIds.has(oe)&&(ct._featureIds.delete(oe),ct._selectedFeatureIds.delete(oe),U.silent||-1===ct._deletedFeaturesToEmit.indexOf(ct._features[oe])&&ct._deletedFeaturesToEmit.push(ct._features[oe]),delete ct._features[oe],ct.isDirty=!0)}),cr(this,U),this},xn.prototype.get=function(L){return this._features[L]},xn.prototype.getAll=function(){var L=this;return Object.keys(this._features).map(function(U){return L._features[U]})},xn.prototype.select=function(L,U){var ct=this;return void 0===U&&(U={}),Gn(L).forEach(function(oe){ct._selectedFeatureIds.has(oe)||(ct._selectedFeatureIds.add(oe),ct._changedFeatureIds.add(oe),U.silent||(ct._emitSelectionChange=!0))}),this},xn.prototype.deselect=function(L,U){var ct=this;return void 0===U&&(U={}),Gn(L).forEach(function(oe){ct._selectedFeatureIds.has(oe)&&(ct._selectedFeatureIds.delete(oe),ct._changedFeatureIds.add(oe),U.silent||(ct._emitSelectionChange=!0))}),cr(this,U),this},xn.prototype.clearSelected=function(L){return void 0===L&&(L={}),this.deselect(this._selectedFeatureIds.values(),{silent:L.silent}),this},xn.prototype.setSelected=function(L,U){var ct=this;return void 0===U&&(U={}),L=Gn(L),this.deselect(this._selectedFeatureIds.values().filter(function(oe){return-1===L.indexOf(oe)}),{silent:U.silent}),this.select(L.filter(function(oe){return!ct._selectedFeatureIds.has(oe)}),{silent:U.silent}),this},xn.prototype.setSelectedCoordinates=function(L){return this._selectedCoordinates=L,this._emitSelectionChange=!0,this},xn.prototype.clearSelectedCoordinates=function(){return this._selectedCoordinates=[],this._emitSelectionChange=!0,this},xn.prototype.getSelectedIds=function(){return this._selectedFeatureIds.values()},xn.prototype.getSelected=function(){var L=this;return this._selectedFeatureIds.values().map(function(U){return L.get(U)})},xn.prototype.getSelectedCoordinates=function(){var L=this;return this._selectedCoordinates.map(function(U){return{coordinates:L.get(U.feature_id).getCoordinate(U.coord_path)}})},xn.prototype.isSelected=function(L){return this._selectedFeatureIds.has(L)},xn.prototype.setFeatureProperty=function(L,U,ct){this.get(L).setProperty(U,ct),this.featureChanged(L)},xn.prototype.storeMapConfig=function(){var L=this;se.forEach(function(U){L.ctx.map[U]&&(L._mapInitialConfig[U]=L.ctx.map[U].isEnabled())})},xn.prototype.restoreMapConfig=function(){var L=this;Object.keys(this._mapInitialConfig).forEach(function(U){L._mapInitialConfig[U]?L.ctx.map[U].enable():L.ctx.map[U].disable()})},xn.prototype.getInitialConfigValue=function(L){return void 0===this._mapInitialConfig[L]||this._mapInitialConfig[L]};var oi=function(){for(var L=arguments,U={},ct=0;ct<arguments.length;ct++){var oe=L[ct];for(var Se in oe)Y.call(oe,Se)&&(U[Se]=oe[Se])}return U},Y=Object.prototype.hasOwnProperty,W=["mode","feature","mouse"];function ft(L){var U=null,ct=null,oe={onRemove:function(){return L.map.off("load",oe.connect),clearInterval(ct),oe.removeLayers(),L.store.restoreMapConfig(),L.ui.removeButtons(),L.events.removeEventListeners(),L.ui.clearMapClasses(),L.map=null,L.container=null,L.store=null,U&&U.parentNode&&U.parentNode.removeChild(U),U=null,this},connect:function(){L.map.off("load",oe.connect),clearInterval(ct),oe.addLayers(),L.store.storeMapConfig(),L.events.addEventListeners()},onAdd:function(Se){var Bt=Se.fire;return Se.fire=function(Te,ur){var ar=arguments;return 1===Bt.length&&1!==arguments.length&&(ar=[oi({},{type:Te},ur)]),Bt.apply(Se,ar)},L.map=Se,L.events=function(Te){var ur=Object.keys(Te.options.modes).reduce(function($e,Vr){return $e[Vr]=function Yo(L){var U=Object.keys(L);return function(ct,oe){void 0===oe&&(oe={});var Se={},Bt=U.reduce(function(Te,ur){return Te[ur]=L[ur],Te},new Br(ct));return{start:function(){var Te=this;Se=Bt.onSetup(oe),zo.forEach(function(ur){var ar,kr=Xo[ur],Ae=function(){return!1};L[kr]&&(Ae=function(){return!0}),Te.on(ur,Ae,(ar=kr,function(or){return Bt[ar](Se,or)}))})},stop:function(){Bt.onStop(Se)},trash:function(){Bt.onTrash(Se)},combineFeatures:function(){Bt.onCombineFeatures(Se)},uncombineFeatures:function(){Bt.onUncombineFeatures(Se)},render:function(Te,ur){Bt.toDisplayFeatures(Se,Te,ur)}}}}(Te.options.modes[Vr]),$e},{}),ar={},kr={},Ae={},or=null,lr=null;Ae.drag=function($e,Vr){Vr({point:$e.point,time:(new Date).getTime()})?(Te.ui.queueMapClasses({mouse:"drag"}),lr.drag($e)):$e.originalEvent.stopPropagation()},Ae.mousedrag=function($e){Ae.drag($e,function(Vr){return!Qe(ar,Vr)})},Ae.touchdrag=function($e){Ae.drag($e,function(Vr){return!ir(kr,Vr)})},Ae.mousemove=function($e){if(1===(void 0!==$e.originalEvent.buttons?$e.originalEvent.buttons:$e.originalEvent.which))return Ae.mousedrag($e);var Vr=le($e,Te);$e.featureTarget=Vr,lr.mousemove($e)},Ae.mousedown=function($e){ar={time:(new Date).getTime(),point:$e.point};var Vr=le($e,Te);$e.featureTarget=Vr,lr.mousedown($e)},Ae.mouseup=function($e){var Vr=le($e,Te);$e.featureTarget=Vr,Qe(ar,{point:$e.point,time:(new Date).getTime()})?lr.click($e):lr.mouseup($e)},Ae.mouseout=function($e){lr.mouseout($e)},Ae.touchstart=function($e){if($e.originalEvent.preventDefault(),Te.options.touchEnabled){kr={time:(new Date).getTime(),point:$e.point};var Vr=ot.touch($e,null,Te)[0];$e.featureTarget=Vr,lr.touchstart($e)}},Ae.touchmove=function($e){if($e.originalEvent.preventDefault(),Te.options.touchEnabled)return lr.touchmove($e),Ae.touchdrag($e)},Ae.touchend=function($e){if($e.originalEvent.preventDefault(),Te.options.touchEnabled){var Vr=ot.touch($e,null,Te)[0];$e.featureTarget=Vr,ir(kr,{time:(new Date).getTime(),point:$e.point})?lr.tap($e):lr.touchend($e)}};var Rr=function($e){return!(8===$e||46===$e||$e>=48&&$e<=57)};function Cn($e,Vr,Kn){void 0===Kn&&(Kn={}),lr.stop();var rn=ur[$e];if(void 0===rn)throw new Error($e+" is not valid");or=$e;var ci=rn(Te,Vr);lr=ce(ci,Te),Kn.silent||Te.map.fire("draw.modechange",{mode:$e}),Te.store.setDirty(),Te.store.render()}Ae.keydown=function($e){"mapboxgl-canvas"===($e.srcElement||$e.target).classList[0]&&(8!==$e.keyCode&&46!==$e.keyCode||!Te.options.controls.trash?Rr($e.keyCode)?lr.keydown($e):49===$e.keyCode&&Te.options.controls.point?Cn(At.DRAW_POINT):50===$e.keyCode&&Te.options.controls.line_string?Cn(At.DRAW_LINE_STRING):51===$e.keyCode&&Te.options.controls.polygon&&Cn(At.DRAW_POLYGON):($e.preventDefault(),lr.trash()))},Ae.keyup=function($e){Rr($e.keyCode)&&lr.keyup($e)},Ae.zoomend=function(){Te.store.changeZoom()},Ae.data=function($e){if("style"===$e.dataType){var Vr=Te.setup,Kn=Te.map,ci=Te.store;Te.options.styles.some(function(Cr){return Kn.getLayer(Cr.id)})||(Vr.addLayers(),ci.setDirty(),ci.render())}};var Jo={trash:!1,combineFeatures:!1,uncombineFeatures:!1};return{start:function(){lr=ce(ur[or=Te.options.defaultMode](Te),Te)},changeMode:Cn,actionable:function($e){var Vr=!1;Object.keys($e).forEach(function(Kn){if(void 0===Jo[Kn])throw new Error("Invalid action type");Jo[Kn]!==$e[Kn]&&(Vr=!0),Jo[Kn]=$e[Kn]}),Vr&&Te.map.fire("draw.actionable",{actions:Jo})},currentModeName:function(){return or},currentModeRender:function($e,Vr){return lr.render($e,Vr)},fire:function($e,Vr){Ae[$e]&&Ae[$e](Vr)},addEventListeners:function(){Te.map.on("mousemove",Ae.mousemove),Te.map.on("mousedown",Ae.mousedown),Te.map.on("mouseup",Ae.mouseup),Te.map.on("data",Ae.data),Te.map.on("touchmove",Ae.touchmove),Te.map.on("touchstart",Ae.touchstart),Te.map.on("touchend",Ae.touchend),Te.container.addEventListener("mouseout",Ae.mouseout),Te.options.keybindings&&(Te.container.addEventListener("keydown",Ae.keydown),Te.container.addEventListener("keyup",Ae.keyup))},removeEventListeners:function(){Te.map.off("mousemove",Ae.mousemove),Te.map.off("mousedown",Ae.mousedown),Te.map.off("mouseup",Ae.mouseup),Te.map.off("data",Ae.data),Te.map.off("touchmove",Ae.touchmove),Te.map.off("touchstart",Ae.touchstart),Te.map.off("touchend",Ae.touchend),Te.container.removeEventListener("mouseout",Ae.mouseout),Te.options.keybindings&&(Te.container.removeEventListener("keydown",Ae.keydown),Te.container.removeEventListener("keyup",Ae.keyup))},trash:function($e){lr.trash($e)},combineFeatures:function(){lr.combineFeatures()},uncombineFeatures:function(){lr.uncombineFeatures()},getMode:function(){return or}}}(L),L.ui=function(Te){var ur={},ar=null,kr={mode:null,feature:null,mouse:null},Ae={mode:null,feature:null,mouse:null};function or($e){Ae=oi(Ae,$e)}function lr(){var $e,Vr;if(Te.container){var Kn=[],rn=[];W.forEach(function(ci){Ae[ci]!==kr[ci]&&(Kn.push(ci+"-"+kr[ci]),null!==Ae[ci]&&rn.push(ci+"-"+Ae[ci]))}),Kn.length>0&&($e=Te.container.classList).remove.apply($e,Kn),rn.length>0&&(Vr=Te.container.classList).add.apply(Vr,rn),kr=oi(kr,Ae)}}function Rr($e,Vr){void 0===Vr&&(Vr={});var Kn=document.createElement("button");return Kn.className="mapbox-gl-draw_ctrl-draw-btn "+Vr.className,Kn.setAttribute("title",Vr.title),Vr.container.appendChild(Kn),Kn.addEventListener("click",function(rn){if(rn.preventDefault(),rn.stopPropagation(),rn.target===ar)return Cn(),void Vr.onDeactivate();Jo($e),Vr.onActivate()},!0),Kn}function Cn(){ar&&(ar.classList.remove("active"),ar=null)}function Jo($e){Cn();var Vr=ur[$e];Vr&&Vr&&"trash"!==$e&&(Vr.classList.add("active"),ar=Vr)}return{setActiveButton:Jo,queueMapClasses:or,updateMapClasses:lr,clearMapClasses:function(){or({mode:null,feature:null,mouse:null}),lr()},addButtons:function(){var $e=Te.options.controls,Vr=document.createElement("div");return Vr.className="mapboxgl-ctrl-group mapboxgl-ctrl",$e&&($e[at.LINE]&&(ur[at.LINE]=Rr(at.LINE,{container:Vr,className:"mapbox-gl-draw_line",title:"LineString tool "+(Te.options.keybindings?"(l)":""),onActivate:function(){return Te.events.changeMode(At.DRAW_LINE_STRING)},onDeactivate:function(){return Te.events.trash()}})),$e[at.POLYGON]&&(ur[at.POLYGON]=Rr(at.POLYGON,{container:Vr,className:"mapbox-gl-draw_polygon",title:"Polygon tool "+(Te.options.keybindings?"(p)":""),onActivate:function(){return Te.events.changeMode(At.DRAW_POLYGON)},onDeactivate:function(){return Te.events.trash()}})),$e[at.POINT]&&(ur[at.POINT]=Rr(at.POINT,{container:Vr,className:"mapbox-gl-draw_point",title:"Marker tool "+(Te.options.keybindings?"(m)":""),onActivate:function(){return Te.events.changeMode(At.DRAW_POINT)},onDeactivate:function(){return Te.events.trash()}})),$e.trash&&(ur.trash=Rr("trash",{container:Vr,className:"mapbox-gl-draw_trash",title:"Delete",onActivate:function(){Te.events.trash()}})),$e.combine_features&&(ur.combine_features=Rr("combineFeatures",{container:Vr,className:"mapbox-gl-draw_combine",title:"Combine",onActivate:function(){Te.events.combineFeatures()}})),$e.uncombine_features&&(ur.uncombine_features=Rr("uncombineFeatures",{container:Vr,className:"mapbox-gl-draw_uncombine",title:"Uncombine",onActivate:function(){Te.events.uncombineFeatures()}}))),Vr},removeButtons:function(){Object.keys(ur).forEach(function($e){var Vr=ur[$e];Vr.parentNode&&Vr.parentNode.removeChild(Vr),delete ur[$e]})}}}(L),L.container=Se.getContainer(),L.store=new xn(L),U=L.ui.addButtons(),L.options.boxSelect&&(Se.boxZoom.disable(),Se.dragPan.disable(),Se.dragPan.enable()),Se.loaded()?oe.connect():(Se.on("load",oe.connect),ct=setInterval(function(){Se.loaded()&&oe.connect()},16)),L.events.start(),U},addLayers:function(){L.map.addSource(K,{data:{type:dt,features:[]},type:"geojson"}),L.map.addSource(it,{data:{type:dt,features:[]},type:"geojson"}),L.options.styles.forEach(function(Se){L.map.addLayer(Se)}),L.store.setDirty(!0),L.store.render()},removeLayers:function(){L.options.styles.forEach(function(Se){L.map.getLayer(Se.id)&&L.map.removeLayer(Se.id)}),L.map.getSource(K)&&L.map.removeSource(K),L.map.getSource(it)&&L.map.removeSource(it)}};return L.setup=oe,oe}function bt(L){return function(U){var ct=U.featureTarget;return!!ct&&!!ct.properties&&ct.properties.meta===L}}function zt(L){return!!L.featureTarget&&!!L.featureTarget.properties&&L.featureTarget.properties.active===_n&&L.featureTarget.properties.meta===Er}function ae(L){return!!L.featureTarget&&!!L.featureTarget.properties&&L.featureTarget.properties.active===zn&&L.featureTarget.properties.meta===Er}function me(L){return void 0===L.featureTarget}function ue(L){var U=L.featureTarget;return!!U&&!!U.properties&&U.properties.meta===ei}function Dt(L){return!!L.originalEvent&&!0===L.originalEvent.shiftKey}function Ht(L){return 27===L.keyCode}function nr(L){return 13===L.keyCode}var xr=Me;function Me(L,U){this.x=L,this.y=U}function qe(L,U){var ct=U.getBoundingClientRect();return new xr(L.clientX-ct.left-(U.clientLeft||0),L.clientY-ct.top-(U.clientTop||0))}function pr(L,U,ct,oe){return{type:Z,properties:{meta:ei,parent:L,coord_path:ct,active:oe?_n:zn},geometry:{type:kt,coordinates:U}}}function wr(L,U,ct){void 0===U&&(U={}),void 0===ct&&(ct=null);var oe,Se=L.geometry,Bt=Se.type,Te=Se.coordinates,ur=L.properties&&L.properties.id,ar=[];function kr(or,lr){var Rr="",Cn=null;or.forEach(function(Jo,$e){var Vr=null!=lr?lr+"."+$e:String($e),Kn=pr(ur,Jo,Vr,Ae(Vr));if(U.midpoints&&Cn){var rn=function(Cr,us,ls){var qr=us.geometry.coordinates,Bi=ls.geometry.coordinates;if(qr[1]>85||qr[1]<-85||Bi[1]>85||Bi[1]<-85)return null;var xo={lng:(qr[0]+Bi[0])/2,lat:(qr[1]+Bi[1])/2};return{type:Z,properties:{meta:He,parent:Cr,lng:xo.lng,lat:xo.lat,coord_path:ls.properties.coord_path},geometry:{type:kt,coordinates:[xo.lng,xo.lat]}}}(ur,Cn,Kn);rn&&ar.push(rn)}Cn=Kn;var ci=JSON.stringify(Jo);Rr!==ci&&ar.push(Kn),0===$e&&(Rr=ci)})}function Ae(or){return!!U.selectedPaths&&-1!==U.selectedPaths.indexOf(or)}return Bt===kt?ar.push(pr(ur,Te,ct,Ae(ct))):Bt===Wt?Te.forEach(function(or,lr){kr(or,null!==ct?ct+"."+lr:String(lr))}):Bt===St?kr(Te,ct):0===Bt.indexOf("Multi")&&(oe=Bt.replace("Multi",""),Te.forEach(function(or,lr){ar=ar.concat(wr({type:Z,properties:L.properties,geometry:{type:oe,coordinates:or}},U,lr))})),ar}Me.prototype={clone:function(){return new Me(this.x,this.y)},add:function(L){return this.clone()._add(L)},sub:function(L){return this.clone()._sub(L)},multByPoint:function(L){return this.clone()._multByPoint(L)},divByPoint:function(L){return this.clone()._divByPoint(L)},mult:function(L){return this.clone()._mult(L)},div:function(L){return this.clone()._div(L)},rotate:function(L){return this.clone()._rotate(L)},rotateAround:function(L,U){return this.clone()._rotateAround(L,U)},matMult:function(L){return this.clone()._matMult(L)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(L){return this.x===L.x&&this.y===L.y},dist:function(L){return Math.sqrt(this.distSqr(L))},distSqr:function(L){var U=L.x-this.x,ct=L.y-this.y;return U*U+ct*ct},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(L){return Math.atan2(this.y-L.y,this.x-L.x)},angleWith:function(L){return this.angleWithSep(L.x,L.y)},angleWithSep:function(L,U){return Math.atan2(this.x*U-this.y*L,this.x*L+this.y*U)},_matMult:function(L){var ct=L[2]*this.x+L[3]*this.y;return this.x=L[0]*this.x+L[1]*this.y,this.y=ct,this},_add:function(L){return this.x+=L.x,this.y+=L.y,this},_sub:function(L){return this.x-=L.x,this.y-=L.y,this},_mult:function(L){return this.x*=L,this.y*=L,this},_div:function(L){return this.x/=L,this.y/=L,this},_multByPoint:function(L){return this.x*=L.x,this.y*=L.y,this},_divByPoint:function(L){return this.x/=L.x,this.y/=L.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var L=this.y;return this.y=this.x,this.x=-L,this},_rotate:function(L){var U=Math.cos(L),ct=Math.sin(L),Se=ct*this.x+U*this.y;return this.x=U*this.x-ct*this.y,this.y=Se,this},_rotateAround:function(L,U){var ct=Math.cos(L),oe=Math.sin(L),Bt=U.y+oe*(this.x-U.x)+ct*(this.y-U.y);return this.x=U.x+ct*(this.x-U.x)-oe*(this.y-U.y),this.y=Bt,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},Me.convert=function(L){return L instanceof Me?L:Array.isArray(L)?new Me(L[0],L[1]):L};var Ar=function(L){setTimeout(function(){L.map&&L.map.doubleClickZoom&&L._ctx&&L._ctx.store&&L._ctx.store.getInitialConfigValue&&L._ctx.store.getInitialConfigValue("doubleClickZoom")&&L.map.doubleClickZoom.enable()},0)},Xe=function(L){setTimeout(function(){L.map&&L.map.doubleClickZoom&&L.map.doubleClickZoom.disable()},0)},vr=function(L){if(!L||!L.type)return null;var U=Ke[L.type];return U?"geometry"===U?{type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:L}]}:"feature"===U?{type:"FeatureCollection",features:[L]}:"featurecollection"===U?L:void 0:null},Ke={Point:"geometry",MultiPoint:"geometry",LineString:"geometry",MultiLineString:"geometry",Polygon:"geometry",MultiPolygon:"geometry",GeometryCollection:"geometry",Feature:"feature",FeatureCollection:"featurecollection"};function bn(L){switch(L&&L.type||null){case"FeatureCollection":return L.features=L.features.reduce(function(U,ct){return U.concat(bn(ct))},[]),L;case"Feature":return L.geometry?bn(L.geometry).map(function(U){var ct={type:"Feature",properties:JSON.parse(JSON.stringify(L.properties)),geometry:U};return void 0!==L.id&&(ct.id=L.id),ct}):[L];case"MultiPoint":return L.coordinates.map(function(U){return{type:"Point",coordinates:U}});case"MultiPolygon":return L.coordinates.map(function(U){return{type:"Polygon",coordinates:U}});case"MultiLineString":return L.coordinates.map(function(U){return{type:"LineString",coordinates:U}});case"GeometryCollection":return L.geometries.map(bn).reduce(function(U,ct){return U.concat(ct)},[]);case"Point":case"Polygon":case"LineString":return[L]}}var Lr=Ge(function(L){var U=L.exports=function(Ae){return new ct(Ae)};function ct(Ae){this.value=Ae}function oe(Ae,or,lr){var Rr=[],Cn=[],Jo=!0;return function $e(Vr){var Kn=lr?Se(Vr):Vr,rn={},ci=!0,Cr={node:Kn,node_:Vr,path:[].concat(Rr),parent:Cn[Cn.length-1],parents:Cn,key:Rr.slice(-1)[0],isRoot:0===Rr.length,level:Rr.length,circular:null,update:function(qr,Bi){Cr.isRoot||(Cr.parent.node[Cr.key]=qr),Cr.node=qr,Bi&&(ci=!1)},delete:function(qr){delete Cr.parent.node[Cr.key],qr&&(ci=!1)},remove:function(qr){ur(Cr.parent.node)?Cr.parent.node.splice(Cr.key,1):delete Cr.parent.node[Cr.key],qr&&(ci=!1)},keys:null,before:function(qr){rn.before=qr},after:function(qr){rn.after=qr},pre:function(qr){rn.pre=qr},post:function(qr){rn.post=qr},stop:function(){Jo=!1},block:function(){ci=!1}};if(!Jo)return Cr;function us(){if("object"==typeof Cr.node&&null!==Cr.node){Cr.keys&&Cr.node_===Cr.node||(Cr.keys=Bt(Cr.node)),Cr.isLeaf=0==Cr.keys.length;for(var qr=0;qr<Cn.length;qr++)if(Cn[qr].node_===Vr){Cr.circular=Cn[qr];break}}else Cr.isLeaf=!0,Cr.keys=null;Cr.notLeaf=!Cr.isLeaf,Cr.notRoot=!Cr.isRoot}us();var ls=or.call(Cr,Cr.node);return void 0!==ls&&Cr.update&&Cr.update(ls),rn.before&&rn.before.call(Cr,Cr.node),ci&&("object"!=typeof Cr.node||null===Cr.node||Cr.circular||(Cn.push(Cr),us(),ar(Cr.keys,function(qr,Bi){Rr.push(qr),rn.pre&&rn.pre.call(Cr,Cr.node[qr],qr);var xo=$e(Cr.node[qr]);lr&&kr.call(Cr.node,qr)&&(Cr.node[qr]=xo.node),xo.isLast=Bi==Cr.keys.length-1,xo.isFirst=0==Bi,rn.post&&rn.post.call(Cr,xo),Rr.pop()}),Cn.pop()),rn.after&&rn.after.call(Cr,Cr.node)),Cr}(Ae).node}function Se(Ae){if("object"==typeof Ae&&null!==Ae){var or;if(ur(Ae))or=[];else if("[object Date]"===Te(Ae))or=new Date(Ae.getTime?Ae.getTime():Ae);else if("[object RegExp]"===Te(Ae))or=new RegExp(Ae);else if("[object Error]"===Te(Ae))or={message:Ae.message};else if(function(Cn){return"[object Boolean]"===Te(Cn)}(Ae))or=new Boolean(Ae);else if(function(Cn){return"[object Number]"===Te(Cn)}(Ae))or=new Number(Ae);else if(function(Cn){return"[object String]"===Te(Cn)}(Ae))or=new String(Ae);else if(Object.create&&Object.getPrototypeOf)or=Object.create(Object.getPrototypeOf(Ae));else if(Ae.constructor===Object)or={};else{var Rr=function(){};Rr.prototype=Ae.constructor&&Ae.constructor.prototype||Ae.__proto__||{},or=new Rr}return ar(Bt(Ae),function(Cn){or[Cn]=Ae[Cn]}),or}return Ae}ct.prototype.get=function(Ae){for(var or=this.value,lr=0;lr<Ae.length;lr++){var Rr=Ae[lr];if(!or||!kr.call(or,Rr)){or=void 0;break}or=or[Rr]}return or},ct.prototype.has=function(Ae){for(var or=this.value,lr=0;lr<Ae.length;lr++){var Rr=Ae[lr];if(!or||!kr.call(or,Rr))return!1;or=or[Rr]}return!0},ct.prototype.set=function(Ae,or){for(var lr=this.value,Rr=0;Rr<Ae.length-1;Rr++){var Cn=Ae[Rr];kr.call(lr,Cn)||(lr[Cn]={}),lr=lr[Cn]}return lr[Ae[Rr]]=or,or},ct.prototype.map=function(Ae){return oe(this.value,Ae,!0)},ct.prototype.forEach=function(Ae){return this.value=oe(this.value,Ae,!1),this.value},ct.prototype.reduce=function(Ae,or){var lr=1===arguments.length,Rr=lr?this.value:or;return this.forEach(function(Cn){this.isRoot&&lr||(Rr=Ae.call(this,Rr,Cn))}),Rr},ct.prototype.paths=function(){var Ae=[];return this.forEach(function(or){Ae.push(this.path)}),Ae},ct.prototype.nodes=function(){var Ae=[];return this.forEach(function(or){Ae.push(this.node)}),Ae},ct.prototype.clone=function(){var Ae=[],or=[];return function lr(Rr){for(var Cn=0;Cn<Ae.length;Cn++)if(Ae[Cn]===Rr)return or[Cn];if("object"==typeof Rr&&null!==Rr){var Jo=Se(Rr);return Ae.push(Rr),or.push(Jo),ar(Bt(Rr),function($e){Jo[$e]=lr(Rr[$e])}),Ae.pop(),or.pop(),Jo}return Rr}(this.value)};var Bt=Object.keys||function(Ae){var or=[];for(var lr in Ae)or.push(lr);return or};function Te(Ae){return Object.prototype.toString.call(Ae)}var ur=Array.isArray||function(Ae){return"[object Array]"===Object.prototype.toString.call(Ae)},ar=function(Ae,or){if(Ae.forEach)return Ae.forEach(or);for(var lr=0;lr<Ae.length;lr++)or(Ae[lr],lr,Ae)};ar(Bt(ct.prototype),function(Ae){U[Ae]=function(or){var lr=[].slice.call(arguments,1),Rr=new ct(or);return Rr[Ae].apply(Rr,lr)}});var kr=Object.hasOwnProperty||function(Ae,or){return or in Ae}}),Mn=Nr;function Nr(L){if(!(this instanceof Nr))return new Nr(L);this._bbox=L||[1/0,1/0,-1/0,-1/0],this._valid=!!L}Nr.prototype.include=function(L){return this._valid=!0,this._bbox[0]=Math.min(this._bbox[0],L[0]),this._bbox[1]=Math.min(this._bbox[1],L[1]),this._bbox[2]=Math.max(this._bbox[2],L[0]),this._bbox[3]=Math.max(this._bbox[3],L[1]),this},Nr.prototype.equals=function(L){var U;return U=L instanceof Nr?L.bbox():L,this._bbox[0]==U[0]&&this._bbox[1]==U[1]&&this._bbox[2]==U[2]&&this._bbox[3]==U[3]},Nr.prototype.center=function(L){return this._valid?[(this._bbox[0]+this._bbox[2])/2,(this._bbox[1]+this._bbox[3])/2]:null},Nr.prototype.union=function(L){var U;return this._valid=!0,U=L instanceof Nr?L.bbox():L,this._bbox[0]=Math.min(this._bbox[0],U[0]),this._bbox[1]=Math.min(this._bbox[1],U[1]),this._bbox[2]=Math.max(this._bbox[2],U[2]),this._bbox[3]=Math.max(this._bbox[3],U[3]),this},Nr.prototype.bbox=function(){return this._valid?this._bbox:null},Nr.prototype.contains=function(L){if(!L)return this._fastContains();if(!this._valid)return null;var U=L[0],ct=L[1];return this._bbox[0]<=U&&this._bbox[1]<=ct&&this._bbox[2]>=U&&this._bbox[3]>=ct},Nr.prototype.intersect=function(L){return this._valid?(U=L instanceof Nr?L.bbox():L,!(this._bbox[0]>U[2]||this._bbox[2]<U[0]||this._bbox[3]<U[1]||this._bbox[1]>U[3])):null;var U},Nr.prototype._fastContains=function(){return this._valid?new Function("ll","return "+this._bbox[0]+"<= ll[0] &&"+this._bbox[1]+"<= ll[1] &&"+this._bbox[2]+">= ll[0] &&"+this._bbox[3]+">= ll[1]"):new Function("return null;")},Nr.prototype.polygon=function(){return this._valid?{type:"Polygon",coordinates:[[[this._bbox[0],this._bbox[1]],[this._bbox[2],this._bbox[1]],[this._bbox[2],this._bbox[3]],[this._bbox[0],this._bbox[3]],[this._bbox[0],this._bbox[1]]]]}:null};var Oi={features:["FeatureCollection"],coordinates:["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon"],geometry:["Feature"],geometries:["GeometryCollection"]},ai=Object.keys(Oi),kn=function(L){return Tn(L).bbox()};function Tn(L){for(var U=Mn(),ct=function(L){if(!L)return[];var U=bn(vr(L)),ct=[];return U.features.forEach(function(oe){oe.geometry&&(ct=ct.concat(function Se(Bt){return Array.isArray(Bt)&&Bt.length&&"number"==typeof Bt[0]?[Bt]:Bt.reduce(function(Te,ur){return Array.isArray(ur)&&Array.isArray(ur[0])?Te.concat(Se(ur)):(Te.push(ur),Te)},[])}(oe.geometry.coordinates)))}),ct}(L),oe=0;oe<ct.length;oe++)U.include(ct[oe]);return U}function co(L,U){var ct=-90,oe=90,Se=-90,Bt=90,Te=270,ur=-270;L.forEach(function(kr){var Ae=kn(kr),or=Ae[1],lr=Ae[3],Rr=Ae[0],Cn=Ae[2];or>ct&&(ct=or),lr<oe&&(oe=lr),lr>Se&&(Se=lr),or<Bt&&(Bt=or),Rr<Te&&(Te=Rr),Cn>ur&&(ur=Cn)});var ar=U;return ct+ar.lat>85&&(ar.lat=85-ct),Se+ar.lat>90&&(ar.lat=90-Se),oe+ar.lat<-85&&(ar.lat=-85-oe),Bt+ar.lat<-90&&(ar.lat=-90-Bt),Te+ar.lng<=-270&&(ar.lng+=360*Math.ceil(Math.abs(ar.lng)/360)),ur+ar.lng>=270&&(ar.lng-=360*Math.ceil(Math.abs(ar.lng)/360)),ar}function ni(L,U){var ct=co(L.map(function(oe){return oe.toGeoJSON()}),U);L.forEach(function(oe){var Se,Bt=oe.getCoordinates(),Te=function(ar){var kr={lng:ar[0]+ct.lng,lat:ar[1]+ct.lat};return[kr.lng,kr.lat]},ur=function(ar){return ar.map(function(kr){return Te(kr)})};oe.type===kt?Se=Te(Bt):oe.type===St||"MultiPoint"===oe.type?Se=Bt.map(Te):oe.type===Wt||"MultiLineString"===oe.type?Se=Bt.map(ur):"MultiPolygon"===oe.type&&(Se=Bt.map(function(ar){return ar.map(function(kr){return ur(kr)})})),oe.incomingCoords(Se)})}kn.polygon=function(L){return Tn(L).polygon()},kn.bboxify=function(L){return Lr(L).map(function(U){U&&ai.some(function(ct){return!!U[ct]&&-1!==Oi[ct].indexOf(U.type)})&&(U.bbox=Tn(U).bbox(),this.update(U))})};var Xr={onSetup:function(L){var U=this,ct={dragMoveLocation:null,boxSelectStartLocation:null,boxSelectElement:void 0,boxSelecting:!1,canBoxSelect:!1,dragMoving:!1,canDragMove:!1,initiallySelectedFeatureIds:L.featureIds||[]};return this.setSelected(ct.initiallySelectedFeatureIds.filter(function(oe){return void 0!==U.getFeature(oe)})),this.fireActionable(),this.setActionableState({combineFeatures:!0,uncombineFeatures:!0,trash:!0}),ct},fireUpdate:function(){this.map.fire(Ot,{action:"move",features:this.getSelected().map(function(L){return L.toGeoJSON()})})},fireActionable:function(){var L=this,U=this.getSelected(),ct=U.filter(function(ur){return L.isInstanceOf("MultiFeature",ur)}),oe=!1;if(U.length>1){oe=!0;var Se=U[0].type.replace("Multi","");U.forEach(function(ur){ur.type.replace("Multi","")!==Se&&(oe=!1)})}this.setActionableState({combineFeatures:oe,uncombineFeatures:ct.length>0,trash:U.length>0})},getUniqueIds:function(L){return L.length?L.map(function(U){return U.properties.id}).filter(function(U){return void 0!==U}).reduce(function(U,ct){return U.add(ct),U},new ut).values():[]},stopExtendedInteractions:function(L){L.boxSelectElement&&(L.boxSelectElement.parentNode&&L.boxSelectElement.parentNode.removeChild(L.boxSelectElement),L.boxSelectElement=null),this.map.dragPan.enable(),L.boxSelecting=!1,L.canBoxSelect=!1,L.dragMoving=!1,L.canDragMove=!1},onStop:function(){Ar(this)},onMouseMove:function(L){return this.stopExtendedInteractions(L),!0},onMouseOut:function(L){return!L.dragMoving||this.fireUpdate()}};Xr.onTap=Xr.onClick=function(L,U){return me(U)?this.clickAnywhere(L,U):bt(ei)(U)?this.clickOnVertex(L,U):(ct=U).featureTarget&&ct.featureTarget.properties&&ct.featureTarget.properties.meta===Er?this.clickOnFeature(L,U):void 0;var ct},Xr.clickAnywhere=function(L){var U=this,ct=this.getSelectedIds();ct.length&&(this.clearSelectedFeatures(),ct.forEach(function(oe){return U.doRender(oe)})),Ar(this),this.stopExtendedInteractions(L)},Xr.clickOnVertex=function(L,U){this.changeMode(At.DIRECT_SELECT,{featureId:U.featureTarget.properties.parent,coordPath:U.featureTarget.properties.coord_path,startPos:U.lngLat}),this.updateUIClasses({mouse:X})},Xr.startOnActiveFeature=function(L,U){this.stopExtendedInteractions(L),this.map.dragPan.disable(),this.doRender(U.featureTarget.properties.id),L.canDragMove=!0,L.dragMoveLocation=U.lngLat},Xr.clickOnFeature=function(L,U){var ct=this;Xe(this),this.stopExtendedInteractions(L);var oe=Dt(U),Se=this.getSelectedIds(),Bt=U.featureTarget.properties.id,Te=this.isSelected(Bt);if(!oe&&Te&&this.getFeature(Bt).type!==kt)return this.changeMode(At.DIRECT_SELECT,{featureId:Bt});Te&&oe?(this.deselect(Bt),this.updateUIClasses({mouse:J}),1===Se.length&&Ar(this)):!Te&&oe?(this.select(Bt),this.updateUIClasses({mouse:X})):Te||oe||(Se.forEach(function(ur){return ct.doRender(ur)}),this.setSelected(Bt),this.updateUIClasses({mouse:X})),this.doRender(Bt)},Xr.onMouseDown=function(L,U){return zt(U)?this.startOnActiveFeature(L,U):this.drawConfig.boxSelect&&(ct=U).originalEvent&&ct.originalEvent.shiftKey&&0===ct.originalEvent.button?this.startBoxSelect(L,U):void 0;var ct},Xr.startBoxSelect=function(L,U){this.stopExtendedInteractions(L),this.map.dragPan.disable(),L.boxSelectStartLocation=qe(U.originalEvent,this.map.getContainer()),L.canBoxSelect=!0},Xr.onTouchStart=function(L,U){if(zt(U))return this.startOnActiveFeature(L,U)},Xr.onDrag=function(L,U){return L.canDragMove?this.dragMove(L,U):this.drawConfig.boxSelect&&L.canBoxSelect?this.whileBoxSelect(L,U):void 0},Xr.whileBoxSelect=function(L,U){L.boxSelecting=!0,this.updateUIClasses({mouse:tt}),L.boxSelectElement||(L.boxSelectElement=document.createElement("div"),L.boxSelectElement.classList.add("mapbox-gl-draw_boxselect"),this.map.getContainer().appendChild(L.boxSelectElement));var ct=qe(U.originalEvent,this.map.getContainer()),oe=Math.min(L.boxSelectStartLocation.x,ct.x),Se=Math.max(L.boxSelectStartLocation.x,ct.x),Bt=Math.min(L.boxSelectStartLocation.y,ct.y),Te=Math.max(L.boxSelectStartLocation.y,ct.y),ur="translate("+oe+"px, "+Bt+"px)";L.boxSelectElement.style.transform=ur,L.boxSelectElement.style.WebkitTransform=ur,L.boxSelectElement.style.width=Se-oe+"px",L.boxSelectElement.style.height=Te-Bt+"px"},Xr.dragMove=function(L,U){L.dragMoving=!0,U.originalEvent.stopPropagation();var ct={lng:U.lngLat.lng-L.dragMoveLocation.lng,lat:U.lngLat.lat-L.dragMoveLocation.lat};ni(this.getSelected(),ct),L.dragMoveLocation=U.lngLat},Xr.onMouseUp=function(L,U){var ct=this;if(L.dragMoving)this.fireUpdate();else if(L.boxSelecting){var oe=[L.boxSelectStartLocation,qe(U.originalEvent,this.map.getContainer())],Se=this.featuresAt(null,oe,"click"),Bt=this.getUniqueIds(Se).filter(function(Te){return!ct.isSelected(Te)});Bt.length&&(this.select(Bt),Bt.forEach(function(Te){return ct.doRender(Te)}),this.updateUIClasses({mouse:X}))}this.stopExtendedInteractions(L)},Xr.toDisplayFeatures=function(L,U,ct){U.properties.active=this.isSelected(U.properties.id)?_n:zn,ct(U),this.fireActionable(),U.properties.active===_n&&U.geometry.type!==kt&&wr(U).forEach(ct)},Xr.onTrash=function(){this.deleteFeature(this.getSelectedIds()),this.fireActionable()},Xr.onCombineFeatures=function(){var L=this.getSelected();if(!(0===L.length||L.length<2)){for(var U=[],ct=[],oe=L[0].type.replace("Multi",""),Se=0;Se<L.length;Se++){var Bt=L[Se];if(Bt.type.replace("Multi","")!==oe)return;Bt.type.includes("Multi")?Bt.getCoordinates().forEach(function(ur){U.push(ur)}):U.push(Bt.getCoordinates()),ct.push(Bt.toGeoJSON())}if(ct.length>1){var Te=this.newFeature({type:Z,properties:ct[0].properties,geometry:{type:"Multi"+oe,coordinates:U}});this.addFeature(Te),this.deleteFeature(this.getSelectedIds(),{silent:!0}),this.setSelected([Te.id]),this.map.fire("draw.combine",{createdFeatures:[Te.toGeoJSON()],deletedFeatures:ct})}this.fireActionable()}},Xr.onUncombineFeatures=function(){var L=this,U=this.getSelected();if(0!==U.length){for(var ct=[],oe=[],Se=function(Te){var ur=U[Te];L.isInstanceOf("MultiFeature",ur)&&(ur.getFeatures().forEach(function(ar){L.addFeature(ar),ar.properties=ur.properties,ct.push(ar.toGeoJSON()),L.select([ar.id])}),L.deleteFeature(ur.id,{silent:!0}),oe.push(ur.toGeoJSON()))},Bt=0;Bt<U.length;Bt++)Se(Bt);ct.length>1&&this.map.fire("draw.uncombine",{createdFeatures:ct,deletedFeatures:oe}),this.fireActionable()}};var ca=bt(ei),Hn=bt(He),Fa={fireUpdate:function(){this.map.fire(Ot,{action:"change_coordinates",features:this.getSelected().map(function(L){return L.toGeoJSON()})})},fireActionable:function(L){this.setActionableState({combineFeatures:!1,uncombineFeatures:!1,trash:L.selectedCoordPaths.length>0})},startDragging:function(L,U){this.map.dragPan.disable(),L.canDragMove=!0,L.dragMoveLocation=U.lngLat},stopDragging:function(L){this.map.dragPan.enable(),L.dragMoving=!1,L.canDragMove=!1,L.dragMoveLocation=null},onVertex:function(L,U){this.startDragging(L,U);var ct=U.featureTarget.properties,oe=L.selectedCoordPaths.indexOf(ct.coord_path);Dt(U)||-1!==oe?Dt(U)&&-1===oe&&L.selectedCoordPaths.push(ct.coord_path):L.selectedCoordPaths=[ct.coord_path];var Se=this.pathsToCoordinates(L.featureId,L.selectedCoordPaths);this.setSelectedCoordinates(Se)},onMidpoint:function(L,U){this.startDragging(L,U);var ct=U.featureTarget.properties;L.feature.addCoordinate(ct.coord_path,ct.lng,ct.lat),this.fireUpdate(),L.selectedCoordPaths=[ct.coord_path]},pathsToCoordinates:function(L,U){return U.map(function(ct){return{feature_id:L,coord_path:ct}})},onFeature:function(L,U){0===L.selectedCoordPaths.length?this.startDragging(L,U):this.stopDragging(L)},dragFeature:function(L,U,ct){ni(this.getSelected(),ct),L.dragMoveLocation=U.lngLat},dragVertex:function(L,U,ct){for(var oe=L.selectedCoordPaths.map(function(ur){return L.feature.getCoordinate(ur)}),Se=co(oe.map(function(ur){return{type:Z,properties:{},geometry:{type:kt,coordinates:ur}}}),ct),Bt=0;Bt<oe.length;Bt++){var Te=oe[Bt];L.feature.updateCoordinate(L.selectedCoordPaths[Bt],Te[0]+Se.lng,Te[1]+Se.lat)}},clickNoTarget:function(){this.changeMode(At.SIMPLE_SELECT)},clickInactive:function(){this.changeMode(At.SIMPLE_SELECT)},clickActiveFeature:function(L){L.selectedCoordPaths=[],this.clearSelectedCoordinates(),L.feature.changed()},onSetup:function(L){var U=L.featureId,ct=this.getFeature(U);if(!ct)throw new Error("You must provide a featureId to enter direct_select mode");if(ct.type===kt)throw new TypeError("direct_select mode doesn't handle point features");var oe={featureId:U,feature:ct,dragMoveLocation:L.startPos||null,dragMoving:!1,canDragMove:!1,selectedCoordPaths:L.coordPath?[L.coordPath]:[]};return this.setSelectedCoordinates(this.pathsToCoordinates(U,oe.selectedCoordPaths)),this.setSelected(U),Xe(this),this.setActionableState({trash:!0}),oe},onStop:function(){Ar(this),this.clearSelectedCoordinates()},toDisplayFeatures:function(L,U,ct){L.featureId===U.properties.id?(U.properties.active=_n,ct(U),wr(U,{map:this.map,midpoints:!0,selectedPaths:L.selectedCoordPaths}).forEach(ct)):(U.properties.active=zn,ct(U)),this.fireActionable(L)},onTrash:function(L){L.selectedCoordPaths.sort(function(U,ct){return ct.localeCompare(U,"en",{numeric:!0})}).forEach(function(U){return L.feature.removeCoordinate(U)}),this.fireUpdate(),L.selectedCoordPaths=[],this.clearSelectedCoordinates(),this.fireActionable(L),!1===L.feature.isValid()&&(this.deleteFeature([L.featureId]),this.changeMode(At.SIMPLE_SELECT,{}))},onMouseMove:function(L,U){var ct=zt(U),oe=ca(U),Se=0===L.selectedCoordPaths.length;return this.updateUIClasses(ct&&Se||oe&&!Se?{mouse:X}:{mouse:et}),this.stopDragging(L),!0},onMouseOut:function(L){return L.dragMoving&&this.fireUpdate(),!0}};Fa.onTouchStart=Fa.onMouseDown=function(L,U){return ca(U)?this.onVertex(L,U):zt(U)?this.onFeature(L,U):Hn(U)?this.onMidpoint(L,U):void 0},Fa.onDrag=function(L,U){if(!0===L.canDragMove){L.dragMoving=!0,U.originalEvent.stopPropagation();var ct={lng:U.lngLat.lng-L.dragMoveLocation.lng,lat:U.lngLat.lat-L.dragMoveLocation.lat};L.selectedCoordPaths.length>0?this.dragVertex(L,U,ct):this.dragFeature(L,U,ct),L.dragMoveLocation=U.lngLat}},Fa.onClick=function(L,U){return me(U)?this.clickNoTarget(L,U):zt(U)?this.clickActiveFeature(L,U):ae(U)?this.clickInactive(L,U):void this.stopDragging(L)},Fa.onTap=function(L,U){return me(U)?this.clickNoTarget(L,U):zt(U)?this.clickActiveFeature(L,U):ae(U)?this.clickInactive(L,U):void 0},Fa.onTouchEnd=Fa.onMouseUp=function(L){L.dragMoving&&this.fireUpdate(),this.stopDragging(L)};var za={};function No(L,U){return!!L.lngLat&&L.lngLat.lng===U[0]&&L.lngLat.lat===U[1]}za.onSetup=function(){var L=this.newFeature({type:Z,properties:{},geometry:{type:kt,coordinates:[]}});return this.addFeature(L),this.clearSelectedFeatures(),this.updateUIClasses({mouse:tt}),this.activateUIButton(at.POINT),this.setActionableState({trash:!0}),{point:L}},za.stopDrawingAndRemove=function(L){this.deleteFeature([L.point.id],{silent:!0}),this.changeMode(At.SIMPLE_SELECT)},za.onTap=za.onClick=function(L,U){this.updateUIClasses({mouse:X}),L.point.updateCoordinate("",U.lngLat.lng,U.lngLat.lat),this.map.fire($t,{features:[L.point.toGeoJSON()]}),this.changeMode(At.SIMPLE_SELECT,{featureIds:[L.point.id]})},za.onStop=function(L){this.activateUIButton(),L.point.getCoordinate().length||this.deleteFeature([L.point.id],{silent:!0})},za.toDisplayFeatures=function(L,U,ct){var oe=U.properties.id===L.point.id;if(U.properties.active=oe?_n:zn,!oe)return ct(U)},za.onTrash=za.stopDrawingAndRemove,za.onKeyUp=function(L,U){if(Ht(U)||nr(U))return this.stopDrawingAndRemove(L,U)};var Wn={onSetup:function(){var L=this.newFeature({type:Z,properties:{},geometry:{type:Wt,coordinates:[[]]}});return this.addFeature(L),this.clearSelectedFeatures(),Xe(this),this.updateUIClasses({mouse:tt}),this.activateUIButton(at.POLYGON),this.setActionableState({trash:!0}),{polygon:L,currentVertexPosition:0}},clickAnywhere:function(L,U){if(L.currentVertexPosition>0&&No(U,L.polygon.coordinates[0][L.currentVertexPosition-1]))return this.changeMode(At.SIMPLE_SELECT,{featureIds:[L.polygon.id]});this.updateUIClasses({mouse:tt}),L.polygon.updateCoordinate("0."+L.currentVertexPosition,U.lngLat.lng,U.lngLat.lat),L.currentVertexPosition++,L.polygon.updateCoordinate("0."+L.currentVertexPosition,U.lngLat.lng,U.lngLat.lat)},clickOnVertex:function(L){return this.changeMode(At.SIMPLE_SELECT,{featureIds:[L.polygon.id]})},onMouseMove:function(L,U){L.polygon.updateCoordinate("0."+L.currentVertexPosition,U.lngLat.lng,U.lngLat.lat),ue(U)&&this.updateUIClasses({mouse:J})}};Wn.onTap=Wn.onClick=function(L,U){return ue(U)?this.clickOnVertex(L,U):this.clickAnywhere(L,U)},Wn.onKeyUp=function(L,U){Ht(U)?(this.deleteFeature([L.polygon.id],{silent:!0}),this.changeMode(At.SIMPLE_SELECT)):nr(U)&&this.changeMode(At.SIMPLE_SELECT,{featureIds:[L.polygon.id]})},Wn.onStop=function(L){this.updateUIClasses({mouse:et}),Ar(this),this.activateUIButton(),void 0!==this.getFeature(L.polygon.id)&&(L.polygon.removeCoordinate("0."+L.currentVertexPosition),L.polygon.isValid()?this.map.fire($t,{features:[L.polygon.toGeoJSON()]}):(this.deleteFeature([L.polygon.id],{silent:!0}),this.changeMode(At.SIMPLE_SELECT,{},{silent:!0})))},Wn.toDisplayFeatures=function(L,U,ct){var oe=U.properties.id===L.polygon.id;if(U.properties.active=oe?_n:zn,!oe)return ct(U);if(0!==U.geometry.coordinates.length){var Se=U.geometry.coordinates[0].length;if(!(Se<3)){if(U.properties.meta=Er,ct(pr(L.polygon.id,U.geometry.coordinates[0][0],"0.0",!1)),Se>3){var Bt=U.geometry.coordinates[0].length-3;ct(pr(L.polygon.id,U.geometry.coordinates[0][Bt],"0."+Bt,!1))}if(Se<=4&&(ct({type:Z,properties:U.properties,geometry:{coordinates:[[U.geometry.coordinates[0][0][0],U.geometry.coordinates[0][0][1]],[U.geometry.coordinates[0][1][0],U.geometry.coordinates[0][1][1]]],type:St}}),3===Se))return;return ct(U)}}},Wn.onTrash=function(L){this.deleteFeature([L.polygon.id],{silent:!0}),this.changeMode(At.SIMPLE_SELECT)};var Ws={onSetup:function(L){var U,ct,oe=(L=L||{}).featureId,Se="forward";if(oe){if(!(U=this.getFeature(oe)))throw new Error("Could not find a feature with the provided featureId");var Bt=L.from;if(Bt&&"Feature"===Bt.type&&Bt.geometry&&"Point"===Bt.geometry.type&&(Bt=Bt.geometry),Bt&&"Point"===Bt.type&&Bt.coordinates&&2===Bt.coordinates.length&&(Bt=Bt.coordinates),!Bt||!Array.isArray(Bt))throw new Error("Please use the `from` property to indicate which point to continue the line from");var Te=U.coordinates.length-1;if(U.coordinates[Te][0]===Bt[0]&&U.coordinates[Te][1]===Bt[1])U.addCoordinate.apply(U,[ct=Te+1].concat(U.coordinates[Te]));else{if(U.coordinates[0][0]!==Bt[0]||U.coordinates[0][1]!==Bt[1])throw new Error("`from` should match the point at either the start or the end of the provided LineString");Se="backwards",U.addCoordinate.apply(U,[ct=0].concat(U.coordinates[0]))}}else U=this.newFeature({type:Z,properties:{},geometry:{type:St,coordinates:[]}}),ct=0,this.addFeature(U);return this.clearSelectedFeatures(),Xe(this),this.updateUIClasses({mouse:tt}),this.activateUIButton(at.LINE),this.setActionableState({trash:!0}),{line:U,currentVertexPosition:ct,direction:Se}},clickAnywhere:function(L,U){if(L.currentVertexPosition>0&&No(U,L.line.coordinates[L.currentVertexPosition-1])||"backwards"===L.direction&&No(U,L.line.coordinates[L.currentVertexPosition+1]))return this.changeMode(At.SIMPLE_SELECT,{featureIds:[L.line.id]});this.updateUIClasses({mouse:tt}),L.line.updateCoordinate(L.currentVertexPosition,U.lngLat.lng,U.lngLat.lat),"forward"===L.direction?(L.currentVertexPosition++,L.line.updateCoordinate(L.currentVertexPosition,U.lngLat.lng,U.lngLat.lat)):L.line.addCoordinate(0,U.lngLat.lng,U.lngLat.lat)},clickOnVertex:function(L){return this.changeMode(At.SIMPLE_SELECT,{featureIds:[L.line.id]})},onMouseMove:function(L,U){L.line.updateCoordinate(L.currentVertexPosition,U.lngLat.lng,U.lngLat.lat),ue(U)&&this.updateUIClasses({mouse:J})}};Ws.onTap=Ws.onClick=function(L,U){if(ue(U))return this.clickOnVertex(L,U);this.clickAnywhere(L,U)},Ws.onKeyUp=function(L,U){nr(U)?this.changeMode(At.SIMPLE_SELECT,{featureIds:[L.line.id]}):Ht(U)&&(this.deleteFeature([L.line.id],{silent:!0}),this.changeMode(At.SIMPLE_SELECT))},Ws.onStop=function(L){Ar(this),this.activateUIButton(),void 0!==this.getFeature(L.line.id)&&(L.line.removeCoordinate(""+L.currentVertexPosition),L.line.isValid()?this.map.fire($t,{features:[L.line.toGeoJSON()]}):(this.deleteFeature([L.line.id],{silent:!0}),this.changeMode(At.SIMPLE_SELECT,{},{silent:!0})))},Ws.onTrash=function(L){this.deleteFeature([L.line.id],{silent:!0}),this.changeMode(At.SIMPLE_SELECT)},Ws.toDisplayFeatures=function(L,U,ct){var oe=U.properties.id===L.line.id;if(U.properties.active=oe?_n:zn,!oe)return ct(U);U.geometry.coordinates.length<2||(U.properties.meta=Er,ct(pr(L.line.id,U.geometry.coordinates["forward"===L.direction?U.geometry.coordinates.length-2:1],""+("forward"===L.direction?U.geometry.coordinates.length-2:1),!1)),ct(U))};var Aa={simple_select:Xr,direct_select:Fa,draw_point:za,draw_polygon:Wn,draw_line_string:Ws},aa={defaultMode:At.SIMPLE_SELECT,keybindings:!0,touchEnabled:!0,clickBuffer:2,touchBuffer:25,boxSelect:!0,displayControlsDefault:!0,styles:[{id:"gl-draw-polygon-fill-inactive",type:"fill",filter:["all",["==","active","false"],["==","$type","Polygon"],["!=","mode","static"]],paint:{"fill-color":"#3bb2d0","fill-outline-color":"#3bb2d0","fill-opacity":.1}},{id:"gl-draw-polygon-fill-active",type:"fill",filter:["all",["==","active","true"],["==","$type","Polygon"]],paint:{"fill-color":"#fbb03b","fill-outline-color":"#fbb03b","fill-opacity":.1}},{id:"gl-draw-polygon-midpoint",type:"circle",filter:["all",["==","$type","Point"],["==","meta","midpoint"]],paint:{"circle-radius":3,"circle-color":"#fbb03b"}},{id:"gl-draw-polygon-stroke-inactive",type:"line",filter:["all",["==","active","false"],["==","$type","Polygon"],["!=","mode","static"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#3bb2d0","line-width":2}},{id:"gl-draw-polygon-stroke-active",type:"line",filter:["all",["==","active","true"],["==","$type","Polygon"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#fbb03b","line-dasharray":[.2,2],"line-width":2}},{id:"gl-draw-line-inactive",type:"line",filter:["all",["==","active","false"],["==","$type","LineString"],["!=","mode","static"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#3bb2d0","line-width":2}},{id:"gl-draw-line-active",type:"line",filter:["all",["==","$type","LineString"],["==","active","true"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#fbb03b","line-dasharray":[.2,2],"line-width":2}},{id:"gl-draw-polygon-and-line-vertex-stroke-inactive",type:"circle",filter:["all",["==","meta","vertex"],["==","$type","Point"],["!=","mode","static"]],paint:{"circle-radius":5,"circle-color":"#fff"}},{id:"gl-draw-polygon-and-line-vertex-inactive",type:"circle",filter:["all",["==","meta","vertex"],["==","$type","Point"],["!=","mode","static"]],paint:{"circle-radius":3,"circle-color":"#fbb03b"}},{id:"gl-draw-point-point-stroke-inactive",type:"circle",filter:["all",["==","active","false"],["==","$type","Point"],["==","meta","feature"],["!=","mode","static"]],paint:{"circle-radius":5,"circle-opacity":1,"circle-color":"#fff"}},{id:"gl-draw-point-inactive",type:"circle",filter:["all",["==","active","false"],["==","$type","Point"],["==","meta","feature"],["!=","mode","static"]],paint:{"circle-radius":3,"circle-color":"#3bb2d0"}},{id:"gl-draw-point-stroke-active",type:"circle",filter:["all",["==","$type","Point"],["==","active","true"],["!=","meta","midpoint"]],paint:{"circle-radius":7,"circle-color":"#fff"}},{id:"gl-draw-point-active",type:"circle",filter:["all",["==","$type","Point"],["!=","meta","midpoint"],["==","active","true"]],paint:{"circle-radius":5,"circle-color":"#fbb03b"}},{id:"gl-draw-polygon-fill-static",type:"fill",filter:["all",["==","mode","static"],["==","$type","Polygon"]],paint:{"fill-color":"#404040","fill-outline-color":"#404040","fill-opacity":.1}},{id:"gl-draw-polygon-stroke-static",type:"line",filter:["all",["==","mode","static"],["==","$type","Polygon"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#404040","line-width":2}},{id:"gl-draw-line-static",type:"line",filter:["all",["==","mode","static"],["==","$type","LineString"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#404040","line-width":2}},{id:"gl-draw-point-static",type:"circle",filter:["all",["==","mode","static"],["==","$type","Point"]],paint:{"circle-radius":5,"circle-color":"#404040"}}],modes:Aa,controls:{},userProperties:!1},ss={point:!0,line_string:!0,polygon:!0,trash:!0,combine_features:!0,uncombine_features:!0},Bn={point:!1,line_string:!1,polygon:!1,trash:!1,combine_features:!1,uncombine_features:!1};function go(L,U){return L.map(function(ct){return ct.source?ct:oi(ct,{id:ct.id+"."+U,source:"hot"===U?it:K})})}var Bo=Ge(function(L,U){var ct="[object Arguments]",oe="[object Map]",Se="[object Object]",Bt="[object Set]",Te=/^\[object .+?Constructor\]$/,ur=/^(?:0|[1-9]\d*)$/,ar={};ar["[object Float32Array]"]=ar["[object Float64Array]"]=ar["[object Int8Array]"]=ar["[object Int16Array]"]=ar["[object Int32Array]"]=ar["[object Uint8Array]"]=ar["[object Uint8ClampedArray]"]=ar["[object Uint16Array]"]=ar["[object Uint32Array]"]=!0,ar[ct]=ar["[object Array]"]=ar["[object ArrayBuffer]"]=ar["[object Boolean]"]=ar["[object DataView]"]=ar["[object Date]"]=ar["[object Error]"]=ar["[object Function]"]=ar[oe]=ar["[object Number]"]=ar[Se]=ar["[object RegExp]"]=ar[Bt]=ar["[object String]"]=ar["[object WeakMap]"]=!1;var kr="object"==typeof global&&global&&global.Object===Object&&global,Ae="object"==typeof self&&self&&self.Object===Object&&self,or=kr||Ae||Function("return this")(),lr=U&&!U.nodeType&&U,Rr=lr&&L&&!L.nodeType&&L,Cn=Rr&&Rr.exports===lr,Jo=Cn&&kr.process,$e=function(){try{return Jo&&Jo.binding&&Jo.binding("util")}catch{}}(),Vr=$e&&$e.isTypedArray;function Kn(be,Ye){for(var dr=-1,dn=null==be?0:be.length;++dr<dn;)if(Ye(be[dr],dr,be))return!0;return!1}function rn(be){var Ye=-1,dr=Array(be.size);return be.forEach(function(dn,xi){dr[++Ye]=[xi,dn]}),dr}function ci(be){var Ye=-1,dr=Array(be.size);return be.forEach(function(dn){dr[++Ye]=dn}),dr}var Cr,us,ls,qr=Array.prototype,xo=Object.prototype,Uo=or["__core-js_shared__"],ho=Function.prototype.toString,sa=xo.hasOwnProperty,Ks=(Cr=/[^.]+$/.exec(Uo&&Uo.keys&&Uo.keys.IE_PROTO||""))?"Symbol(src)_1."+Cr:"",Ho=xo.toString,Ui=RegExp("^"+ho.call(sa).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),cs=Cn?or.Buffer:void 0,bo=or.Symbol,qo=or.Uint8Array,Fu=xo.propertyIsEnumerable,Sl=qr.splice,zs=bo?bo.toStringTag:void 0,Ol=Object.getOwnPropertySymbols,el=cs?cs.isBuffer:void 0,ha=(us=Object.keys,ls=Object,function(be){return us(ls(be))}),hu=Ua(or,"DataView"),gi=Ua(or,"Map"),pu=Ua(or,"Promise"),Da=Ua(or,"Set"),Bs=Ua(or,"WeakMap"),ki=Ua(Object,"create"),Hr=Qn(hu),bu=Qn(gi),fu=Qn(pu),pa=Qn(Da),Ba=Qn(Bs),wu=bo?bo.prototype:void 0,qi=wu?wu.valueOf:void 0;function Us(be){var Ye=-1,dr=null==be?0:be.length;for(this.clear();++Ye<dr;){var dn=be[Ye];this.set(dn[0],dn[1])}}function Ms(be){var Ye=-1,dr=null==be?0:be.length;for(this.clear();++Ye<dr;){var dn=be[Ye];this.set(dn[0],dn[1])}}function $n(be){var Ye=-1,dr=null==be?0:be.length;for(this.clear();++Ye<dr;){var dn=be[Ye];this.set(dn[0],dn[1])}}function Ts(be){var Ye=-1,dr=null==be?0:be.length;for(this.__data__=new $n;++Ye<dr;)this.add(be[Ye])}function Ni(be){var Ye=this.__data__=new Ms(be);this.size=Ye.size}function fa(be,Ye){for(var dr=be.length;dr--;)if(qa(be[dr][0],Ye))return dr;return-1}function qs(be){return null==be?void 0===be?"[object Undefined]":"[object Null]":zs&&zs in Object(be)?function(Ye){var dr=sa.call(Ye,zs),dn=Ye[zs];try{Ye[zs]=void 0;var xi=!0}catch{}var Ln=Ho.call(Ye);return xi&&(dr?Ye[zs]=dn:delete Ye[zs]),Ln}(be):Ho.call(be)}function Un(be){return Ko(be)&&qs(be)==ct}function $s(be,Ye,dr,dn,xi){return be===Ye||(null==be||null==Ye||!Ko(be)&&!Ko(Ye)?be!=be&&Ye!=Ye:function(Ln,mo,Gi,Ga,mi,$o){var As=zu(Ln),Qa=zu(mo),ys=As?"[object Array]":Wo(Ln),Qs=Qa?"[object Array]":Wo(mo),Vs=(ys=ys==ct?Se:ys)==Se,vs=(Qs=Qs==ct?Se:Qs)==Se,Go=ys==Qs;if(Go&&Cl(Ln)){if(!Cl(mo))return!1;As=!0,Vs=!1}if(Go&&!Vs)return $o||($o=new Ni),As||ms(Ln)?da(Ln,mo,Gi,Ga,mi,$o):function(Eo,bi,si,ba,Po,po,En){switch(si){case"[object DataView]":if(Eo.byteLength!=bi.byteLength||Eo.byteOffset!=bi.byteOffset)return!1;Eo=Eo.buffer,bi=bi.buffer;case"[object ArrayBuffer]":return!(Eo.byteLength!=bi.byteLength||!po(new qo(Eo),new qo(bi)));case"[object Boolean]":case"[object Date]":case"[object Number]":return qa(+Eo,+bi);case"[object Error]":return Eo.name==bi.name&&Eo.message==bi.message;case"[object RegExp]":case"[object String]":return Eo==bi+"";case oe:var jn=rn;case Bt:if(jn||(jn=ci),Eo.size!=bi.size&&!(1&ba))return!1;var Za=En.get(Eo);if(Za)return Za==bi;ba|=2,En.set(Eo,bi);var Ro=da(jn(Eo),jn(bi),ba,Po,po,En);return En.delete(Eo),Ro;case"[object Symbol]":if(qi)return qi.call(Eo)==qi.call(bi)}return!1}(Ln,mo,ys,Gi,Ga,mi,$o);if(!(1&Gi)){var Zs=Vs&&sa.call(Ln,"__wrapped__"),ua=vs&&sa.call(mo,"__wrapped__");if(Zs||ua){var js=Zs?Ln.value():Ln,du=ua?mo.value():mo;return $o||($o=new Ni),mi(js,du,Gi,Ga,$o)}}return!!Go&&($o||($o=new Ni),function(Eo,bi,si,ba,Po,po){var En=1&si,jn=Ka(Eo),Va=jn.length;if(Va!=Ka(bi).length&&!En)return!1;for(var Ro=Va;Ro--;){var fo=jn[Ro];if(!(En?fo in bi:sa.call(bi,fo)))return!1}var ts=po.get(Eo);if(ts&&po.get(bi))return ts==bi;var hs=!0;po.set(Eo,bi),po.set(bi,Eo);for(var Bu=En;++Ro<Va;){var tu=Eo[fo=jn[Ro]],_s=bi[fo];if(ba)var ao=En?ba(_s,tu,fo,bi,Eo,po):ba(tu,_s,fo,Eo,bi,po);if(!(void 0===ao?tu===_s||Po(tu,_s,si,ba,po):ao)){hs=!1;break}Bu||(Bu="constructor"==fo)}if(hs&&!Bu){var es=Eo.constructor,ea=bi.constructor;es==ea||!("constructor"in Eo)||!("constructor"in bi)||"function"==typeof es&&es instanceof es&&"function"==typeof ea&&ea instanceof ea||(hs=!1)}return po.delete(Eo),po.delete(bi),hs}(Ln,mo,Gi,Ga,mi,$o))}(be,Ye,dr,dn,$s,xi))}function da(be,Ye,dr,dn,xi,Ln){var mo=1&dr,Gi=be.length,Ga=Ye.length;if(Gi!=Ga&&!(mo&&Ga>Gi))return!1;var mi=Ln.get(be);if(mi&&Ln.get(Ye))return mi==Ye;var $o=-1,As=!0,Qa=2&dr?new Ts:void 0;for(Ln.set(be,Ye),Ln.set(Ye,be);++$o<Gi;){var ys=be[$o],Qs=Ye[$o];if(dn)var Vs=mo?dn(Qs,ys,$o,Ye,be,Ln):dn(ys,Qs,$o,be,Ye,Ln);if(void 0!==Vs){if(Vs)continue;As=!1;break}if(Qa){if(!Kn(Ye,function(vs,Go){if(!Qa.has(Go)&&(ys===vs||xi(ys,vs,dr,dn,Ln)))return Qa.push(Go)})){As=!1;break}}else if(ys!==Qs&&!xi(ys,Qs,dr,dn,Ln)){As=!1;break}}return Ln.delete(be),Ln.delete(Ye),As}function Ka(be){return dn=hi,xi=function Gs(be){return null!=(Ye=be)&&$a(Ye.length)&&!Su(Ye)?function sl(be,Ye){var dr=zu(be),dn=!dr&&Oa(be),xi=!dr&&!dn&&Cl(be),Ln=!dr&&!dn&&!xi&&ms(be),mo=dr||dn||xi||Ln,Gi=mo?function($o,As){for(var Qa=-1,ys=Array($o);++Qa<$o;)ys[Qa]=As(Qa);return ys}(be.length,String):[],Ga=Gi.length;for(var mi in be)!Ye&&!sa.call(be,mi)||mo&&("length"==mi||xi&&("offset"==mi||"parent"==mi)||Ln&&("buffer"==mi||"byteLength"==mi||"byteOffset"==mi)||Eu(mi,Ga))||Gi.push(mi);return Gi}(be):function Wu(be){if(dr=(Ye=be)&&Ye.constructor,Ye!==("function"==typeof dr&&dr.prototype||xo))return ha(be);var Ye,dr,xi=[];for(var Ln in Object(be))sa.call(be,Ln)&&"constructor"!=Ln&&xi.push(Ln);return xi}(be);var Ye}(Ye=be),zu(Ye)?xi:function(Ln,mo){for(var Gi=-1,Ga=mo.length,mi=Ln.length;++Gi<Ga;)Ln[mi+Gi]=mo[Gi];return Ln}(xi,dn(Ye));var Ye,dn,xi}function rl(be,Ye){var dr,dn,xi=be.__data__;return("string"==(dn=typeof(dr=Ye))||"number"==dn||"symbol"==dn||"boolean"==dn?"__proto__"!==dr:null===dr)?xi["string"==typeof Ye?"string":"hash"]:xi.map}function Ua(be,Ye){var dr=be?.[Ye];return function wo(be){return!(!Au(be)||(Ye=be,Ks&&Ks in Ye))&&(Su(be)?Ui:Te).test(Qn(be));var Ye}(dr)?dr:void 0}Us.prototype.clear=function(){this.__data__=ki?ki(null):{},this.size=0},Us.prototype.delete=function(be){var Ye=this.has(be)&&delete this.__data__[be];return this.size-=Ye?1:0,Ye},Us.prototype.get=function(be){var Ye=this.__data__;if(ki){var dr=Ye[be];return"__lodash_hash_undefined__"===dr?void 0:dr}return sa.call(Ye,be)?Ye[be]:void 0},Us.prototype.has=function(be){var Ye=this.__data__;return ki?void 0!==Ye[be]:sa.call(Ye,be)},Us.prototype.set=function(be,Ye){var dr=this.__data__;return this.size+=this.has(be)?0:1,dr[be]=ki&&void 0===Ye?"__lodash_hash_undefined__":Ye,this},Ms.prototype.clear=function(){this.__data__=[],this.size=0},Ms.prototype.delete=function(be){var Ye=this.__data__,dr=fa(Ye,be);return!(dr<0||(dr==Ye.length-1?Ye.pop():Sl.call(Ye,dr,1),--this.size,0))},Ms.prototype.get=function(be){var Ye=this.__data__,dr=fa(Ye,be);return dr<0?void 0:Ye[dr][1]},Ms.prototype.has=function(be){return fa(this.__data__,be)>-1},Ms.prototype.set=function(be,Ye){var dr=this.__data__,dn=fa(dr,be);return dn<0?(++this.size,dr.push([be,Ye])):dr[dn][1]=Ye,this},$n.prototype.clear=function(){this.size=0,this.__data__={hash:new Us,map:new(gi||Ms),string:new Us}},$n.prototype.delete=function(be){var Ye=rl(this,be).delete(be);return this.size-=Ye?1:0,Ye},$n.prototype.get=function(be){return rl(this,be).get(be)},$n.prototype.has=function(be){return rl(this,be).has(be)},$n.prototype.set=function(be,Ye){var dr=rl(this,be),dn=dr.size;return dr.set(be,Ye),this.size+=dr.size==dn?0:1,this},Ts.prototype.add=Ts.prototype.push=function(be){return this.__data__.set(be,"__lodash_hash_undefined__"),this},Ts.prototype.has=function(be){return this.__data__.has(be)},Ni.prototype.clear=function(){this.__data__=new Ms,this.size=0},Ni.prototype.delete=function(be){var Ye=this.__data__,dr=Ye.delete(be);return this.size=Ye.size,dr},Ni.prototype.get=function(be){return this.__data__.get(be)},Ni.prototype.has=function(be){return this.__data__.has(be)},Ni.prototype.set=function(be,Ye){var dr=this.__data__;if(dr instanceof Ms){var dn=dr.__data__;if(!gi||dn.length<199)return dn.push([be,Ye]),this.size=++dr.size,this;dr=this.__data__=new $n(dn)}return dr.set(be,Ye),this.size=dr.size,this};var hi=Ol?function(be){return null==be?[]:(be=Object(be),function(Ye,dr){for(var dn=-1,xi=null==Ye?0:Ye.length,Ln=0,mo=[];++dn<xi;){var Gi=Ye[dn];dr(Gi)&&(mo[Ln++]=Gi)}return mo}(Ol(be),function(Ye){return Fu.call(be,Ye)}))}:function(){return[]},Wo=qs;function Eu(be,Ye){return!!(Ye=Ye??9007199254740991)&&("number"==typeof be||ur.test(be))&&be>-1&&be%1==0&&be<Ye}function Qn(be){if(null!=be){try{return ho.call(be)}catch{}try{return be+""}catch{}}return""}function qa(be,Ye){return be===Ye||be!=be&&Ye!=Ye}(hu&&"[object DataView]"!=Wo(new hu(new ArrayBuffer(1)))||gi&&Wo(new gi)!=oe||pu&&"[object Promise]"!=Wo(pu.resolve())||Da&&Wo(new Da)!=Bt||Bs&&"[object WeakMap]"!=Wo(new Bs))&&(Wo=function(be){var Ye=qs(be),dr=Ye==Se?be.constructor:void 0,dn=dr?Qn(dr):"";if(dn)switch(dn){case Hr:return"[object DataView]";case bu:return oe;case fu:return"[object Promise]";case pa:return Bt;case Ba:return"[object WeakMap]"}return Ye});var Oa=Un(function(){return arguments}())?Un:function(be){return Ko(be)&&sa.call(be,"callee")&&!Fu.call(be,"callee")},zu=Array.isArray,Cl=el||function(){return!1};function Su(be){if(!Au(be))return!1;var Ye=qs(be);return"[object Function]"==Ye||"[object GeneratorFunction]"==Ye||"[object AsyncFunction]"==Ye||"[object Proxy]"==Ye}function $a(be){return"number"==typeof be&&be>-1&&be%1==0&&be<=9007199254740991}function Au(be){var Ye=typeof be;return null!=be&&("object"==Ye||"function"==Ye)}function Ko(be){return null!=be&&"object"==typeof be}var be,ms=Vr?(be=Vr,function(Ye){return be(Ye)}):function(be){return Ko(be)&&$a(be.length)&&!!ar[qs(be)]};L.exports=function(be,Ye){return $s(be,Ye)}}),La={Polygon:Yn,LineString:gn,Point:hr,MultiPolygon:ri,MultiLineString:ri,MultiPoint:ri};var Tu=function(L,U){var ct={options:L=function(Se){void 0===Se&&(Se={});var Bt=oi(Se);return Se.controls||(Bt.controls={}),Bt.controls=oi(!1===Se.displayControlsDefault?Bn:ss,Se.controls),(Bt=oi(aa,Bt)).styles=go(Bt.styles,"cold").concat(go(Bt.styles,"hot")),Bt}(L)};U=function wn(L,U){return U.modes=At,U.getFeatureIdsAt=function(ct){return ot.click({point:ct},null,L).map(function(oe){return oe.properties.id})},U.getSelectedIds=function(){return L.store.getSelectedIds()},U.getSelected=function(){return{type:dt,features:L.store.getSelectedIds().map(function(ct){return L.store.get(ct)}).map(function(ct){return ct.toGeoJSON()})}},U.getSelectedPoints=function(){return{type:dt,features:L.store.getSelectedCoordinates().map(function(ct){return{type:Z,properties:{},geometry:{type:kt,coordinates:ct.coordinates}}})}},U.set=function(ct){if(void 0===ct.type||ct.type!==dt||!Array.isArray(ct.features))throw new Error("Invalid FeatureCollection");var oe=L.store.createRenderBatch(),Se=L.store.getAllIds().slice(),Bt=U.add(ct),Te=new ut(Bt);return(Se=Se.filter(function(ur){return!Te.has(ur)})).length&&U.delete(Se),oe(),Bt},U.add=function(ct){var oe=JSON.parse(JSON.stringify(vr(ct))).features.map(function(Se){if(Se.id=Se.id||fn(),null===Se.geometry)throw new Error("Invalid geometry: null");if(void 0===L.store.get(Se.id)||L.store.get(Se.id).type!==Se.geometry.type){var Bt=La[Se.geometry.type];if(void 0===Bt)throw new Error("Invalid geometry type: "+Se.geometry.type+".");var Te=new Bt(L,Se);L.store.add(Te)}else{var ur=L.store.get(Se.id);ur.properties=Se.properties,Bo(ur.getCoordinates(),Se.geometry.coordinates)||ur.incomingCoords(Se.geometry.coordinates)}return Se.id});return L.store.render(),oe},U.get=function(ct){var oe=L.store.get(ct);if(oe)return oe.toGeoJSON()},U.getAll=function(){return{type:dt,features:L.store.getAll().map(function(ct){return ct.toGeoJSON()})}},U.delete=function(ct){return L.store.delete(ct,{silent:!0}),U.getMode()!==At.DIRECT_SELECT||L.store.getSelectedIds().length?L.store.render():L.events.changeMode(At.SIMPLE_SELECT,void 0,{silent:!0}),U},U.deleteAll=function(){return L.store.delete(L.store.getAllIds(),{silent:!0}),U.getMode()===At.DIRECT_SELECT?L.events.changeMode(At.SIMPLE_SELECT,void 0,{silent:!0}):L.store.render(),U},U.changeMode=function(ct,oe){return void 0===oe&&(oe={}),ct===At.SIMPLE_SELECT&&U.getMode()===At.SIMPLE_SELECT?(Se=oe.featureIds||[],Bt=L.store.getSelectedIds(),Se.length===Bt.length&&JSON.stringify(Se.map(function(Te){return Te}).sort())===JSON.stringify(Bt.map(function(Te){return Te}).sort())||(L.store.setSelected(oe.featureIds,{silent:!0}),L.store.render()),U):(ct===At.DIRECT_SELECT&&U.getMode()===At.DIRECT_SELECT&&oe.featureId===L.store.getSelectedIds()[0]||L.events.changeMode(ct,oe,{silent:!0}),U);var Se,Bt},U.getMode=function(){return L.events.getMode()},U.trash=function(){return L.events.trash({silent:!0}),U},U.combineFeatures=function(){return L.events.combineFeatures({silent:!0}),U},U.uncombineFeatures=function(){return L.events.uncombineFeatures({silent:!0}),U},U.setFeatureProperty=function(ct,oe,Se){return L.store.setFeatureProperty(ct,oe,Se),U},U}(ct,U),ct.api=U;var oe=ft(ct);return U.onAdd=oe.onAdd,U.onRemove=oe.onRemove,U.types=at,U.options=L,U};function El(L){Tu(L,this)}return El.modes=Aa,El}()},3054:(tr,ce,It)=>{"use strict";It.r(ce),It.d(ce,{HomeModule:()=>ev});var gt=It(6895),Pt=It(8996),s=It(4650),lt=It(4006),ht=It(5938);let Lt=(()=>{class r{constructor(a,p){this.dialogRef=a,this.data=p,p&&(this.messageData=p.messageData)}ngOnInit(){}closeDialog(a){this.dialogRef.close(a)}}return r.\u0275fac=function(a){return new(a||r)(s.Y36(ht.so),s.Y36(ht.WI))},r.\u0275cmp=s.Xpm({type:r,selectors:[["app-confirm-box"]],decls:8,vars:1,consts:[[1,"p-flex","mt-3"],[1,"btn","btn-sm","btn-secondary","me-2",3,"click"],[1,"btn","btn-sm","btn-info","ms-2",3,"click"]],template:function(a,p){1&a&&(s.TgZ(0,"div")(1,"span"),s._uU(2),s.qZA(),s.TgZ(3,"div",0)(4,"button",1),s.NdJ("click",function(){return p.closeDialog(!1)}),s._uU(5,"No"),s.qZA(),s.TgZ(6,"button",2),s.NdJ("click",function(){return p.closeDialog(!0)}),s._uU(7,"Yes"),s.qZA()()()),2&a&&(s.xp6(2),s.Oqu(p.messageData))}}),r})();const Ft=function(){return{background:"red"}},Qt=function(){return{"":""}};function qt(r,o){if(1&r){const a=s.EpF();s.TgZ(0,"span")(1,"img",1),s.NdJ("click",function(){const v=s.CHM(a).$implicit,b=s.oxw();return s.KtG(b.sendMarkerName(v))}),s.qZA()()}if(2&r){const a=o.$implicit,p=s.oxw();s.xp6(1),s.Q6J("ngStyle",a==p.activeMarker?s.DdM(2,Ft):s.DdM(3,Qt))("src","../../../assets/marker-icons/all_maki_icons/svgs/"+a+".svg",s.LSH)}}let _e=(()=>{class r{constructor(a,p){this.dialogRef=a,this.data=p,this.markerList=["aerialway","landmark","airfield","landuse","airport","laundry","alcohol-shop","library","american-football","lighthouse-JP","amusement-park","lighthouse","aquarium","lodging","arrow","logging","art-gallery","marker-stroked","attraction","marker","bakery","mobile-phone","bank-JP","monument-JP","bank","monument","bar","mountain","barrier","museum","baseball","music","basketball","natural","bbq","observation-tower","beach","optician","beer","paint","bicycle-share","park-alt1","bicycle","park","blood-bank","parking-garage","bowling-alley","parking","bridge","pharmacy","building-alt1","picnic-site","building","pitch","bus","place-of-worship","cafe","playground","campsite","police-JP","car-rental","police","car-repair","post-JP","car","post","casino","prison","castle-JP","racetrack-boat","castle","racetrack-cycling","caution","racetrack-horse","cemetery-JP","racetrack","cemetery","rail-light","charging-station","rail-metro","cinema","rail","circle-stroked","ranger-station","circle","recycling","city","religious-buddhist","clothing-store","religious-christian","college-JP","religious-jewish","college","religious-muslim","commercial","religious-shinto","communications-tower","residential-community","confectionery","restaurant-bbq","construction","restaurant-noodle","convenience","restaurant-pizza","cricket","restaurant-seafood","cross","restaurant-sushi","dam","restaurant","danger","road-accident","defibrillator","roadblock","dentist","rocket","diamond","school-JP","doctor","school","dog-park","scooter","drinking-water","shelter","elevator","shoe","embassy","shop","emergency-phone","skateboard","entrance-alt1","skiing","entrance","slaughterhouse","farm","slipway","fast-food","snowmobile","fence","soccer","ferry-JP","square-stroked","ferry","square","fire-station-JP","stadium","fire-station","star-stroked","fitness-centre","star","florist","suitcase","fuel","swimming","furniture","table-tennis","gaming","teahouse","garden-centre","telephone","garden","tennis","gift","theatre","globe","toilet","golf","town-hall","grocery","town","hairdresser","triangle-stroked","harbor","triangle","hardware","veterinary","heart","viewpoint","heliport","village","highway-rest-area","volcano","home","volleyball","horse-riding","warehouse","hospital-JP","waste-basket","hospital","watch","hot-spring","\twater","ice-cream","waterfall","industry","watermill","information","wetland","jewelry-store","wheelchair","karaoke","windmill","landmark-JP","zoo"]}ngOnInit(){this.data&&(this.activeMarker=this.data.markerName)}sendMarkerName(a){this.dialogRef.close(a)}}return r.\u0275fac=function(a){return new(a||r)(s.Y36(ht.so),s.Y36(ht.WI))},r.\u0275cmp=s.Xpm({type:r,selectors:[["app-icon-list-dialog"]],decls:1,vars:1,consts:[[4,"ngFor","ngForOf"],["role","button","alt","",1,"p-2",3,"ngStyle","src","click"]],template:function(a,p){1&a&&s.YNc(0,qt,2,4,"span",0),2&a&&s.Q6J("ngForOf",p.markerList)},dependencies:[gt.sg,gt.PC],styles:["img[_ngcontent-%COMP%]:hover{background-color:#0ff}"]}),r})(),mt=(()=>{class r{constructor(){this.showIdentityFeatureStatus=new s.vpe,this.getIdentityFeatureData=new s.vpe}sendShowIdentityFeatureStatus(a){this.showIdentityFeatureStatus.emit(a)}sendIdentityFeatureData(a){this.getIdentityFeatureData.emit(a)}}return r.\u0275fac=function(a){return new(a||r)},r.\u0275prov=s.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"}),r})();var xt=It(4987);let Jt=(()=>{class r{constructor(){this.getDataTableStatus=new s.vpe,this.getSourceData=new s.vpe,this.getStyleDetails=new s.vpe,this.popData=a=>{this.popUp.setLngLat([a.lngLat.lng,a.lngLat.lat]).setHTML(`<span style='${this.popUpStyle}'>${this.popUpMessage}</span>`).addTo(this.map)}}sendShowDataTableStatus(a){this.getDataTableStatus.emit(a)}sendSourceData(a){this.getSourceData.emit(a)}sendStyleDetails(a){this.getStyleDetails.emit(a)}initializeMapPopUp(){this.popUp=new xt.Popup({closeButton:!1,closeOnClick:!1})}useMapPopUp(a,p,y=""){this.map=a,this.popUpStyle=y,this.popUpMessage=p,a.on("mousemove",this.popData),a.on("mouseout",()=>{this.popUp.remove()})}removeMapPopUp(){this.map.off("mousemove",this.popData),this.popUp.remove()}}return r.\u0275fac=function(a){return new(a||r)},r.\u0275prov=s.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"}),r})();var ye=It(2851);let j=(()=>{class r{constructor(a,p,y,v){this.dataShareService=a,this.styleService=p,this.dialogRef=y,this.data=v,v&&(this.textId=v.textField.id,this.textColor=v.textField.styledetails.styledata.color,this.textName=v.textField.styledetails.styledata.textname,this.textHeight=v.textField.styledetails.styledata.height,this.textWidth=v.textField.styledetails.styledata.width,this.textFontSize=v.textField.styledetails.styledata.textfontsize,this.textLat=v.textField.geometry.coordinates[1],this.textLng=v.textField.geometry.coordinates[0],this.geo_json_main=v.geo_json_main,this.map=v.map)}submitBtn(){this.textFontSize>=5&&this.dialogRef.close({textColor:this.textColor,textLat:this.textLat,textLng:this.textLng,textHeight:this.textHeight,textWidth:this.textWidth,textName:this.textName,textFontSize:this.textFontSize,id:this.textId})}deleteText(){let a=JSON.parse(JSON.stringify({...this.geo_json_main})),p=this.geo_json_main.features.findIndex(y=>y.id==this.textId);a.features.splice(p,1),this.dataShareService.sendSourceData(a),this.styleService.setDataOnMap(this.map,a,!0,!1),this.closeBtn()}closeBtn(){this.dialogRef.close()}ngOnInit(){}}return r.\u0275fac=function(a){return new(a||r)(s.Y36(Jt),s.Y36(tt),s.Y36(ht.so),s.Y36(ht.WI))},r.\u0275cmp=s.Xpm({type:r,selectors:[["app-text-edit"]],decls:32,vars:7,consts:[[1,"mb-1"],["for","textname"],["type","text","name","","id","textname",3,"ngModel","ngModelChange"],["for","color"],["id","color",3,"colorPicker","colorPickerChange"],["for","textFontSize"],["type","number","name","","id","textFontSize","min","5",3,"ngModel","ngModelChange"],["for","lat"],["type","text","name","","id","lat",3,"ngModel","ngModelChange"],["for","lng"],["type","text","name","","id","lng",3,"ngModel","ngModelChange"],[1,"mt-3","text-center"],[1,"btn","btn-sm","btn-secondary",3,"click"],[1,"btn","btn-sm","btn-success","ms-1",3,"click"],[1,"btn","btn-sm","btn-danger","ms-1",3,"click"]],template:function(a,p){1&a&&(s.TgZ(0,"div",0)(1,"label",1),s._uU(2,"Name"),s.qZA(),s._uU(3," : "),s.TgZ(4,"input",2),s.NdJ("ngModelChange",function(v){return p.textName=v}),s.qZA()(),s.TgZ(5,"div",0)(6,"label",3),s._uU(7,"Color"),s.qZA(),s._uU(8," : "),s.TgZ(9,"input",4),s.NdJ("colorPickerChange",function(v){return p.textColor=v}),s.qZA()(),s.TgZ(10,"div",0)(11,"label",5),s._uU(12,"Size"),s.qZA(),s._uU(13," : "),s.TgZ(14,"input",6),s.NdJ("ngModelChange",function(v){return p.textFontSize=v}),s.qZA()(),s.TgZ(15,"div",0)(16,"label",7),s._uU(17,"Lat"),s.qZA(),s._uU(18," : "),s.TgZ(19,"input",8),s.NdJ("ngModelChange",function(v){return p.textLat=v}),s.qZA()(),s.TgZ(20,"div",0)(21,"label",9),s._uU(22,"Lng"),s.qZA(),s._uU(23," : "),s.TgZ(24,"input",10),s.NdJ("ngModelChange",function(v){return p.textLng=v}),s.qZA()(),s.TgZ(25,"div",11)(26,"button",12),s.NdJ("click",function(){return p.closeBtn()}),s._uU(27,"Close"),s.qZA(),s.TgZ(28,"button",13),s.NdJ("click",function(){return p.submitBtn()}),s._uU(29,"Submit"),s.qZA(),s.TgZ(30,"button",14),s.NdJ("click",function(){return p.deleteText()}),s._uU(31,"Delete"),s.qZA()()),2&a&&(s.xp6(4),s.Q6J("ngModel",p.textName),s.xp6(5),s.Udp("background",p.textColor),s.Q6J("colorPicker",p.textColor),s.xp6(5),s.Q6J("ngModel",p.textFontSize),s.xp6(5),s.Q6J("ngModel",p.textLat),s.xp6(5),s.Q6J("ngModel",p.textLng))},dependencies:[lt.Fj,lt.wV,lt.JJ,lt.qQ,lt.On,ye.Kk],styles:["label[_ngcontent-%COMP%]{width:50px;text-align:left;display:inline-block}input[type=number][_ngcontent-%COMP%]:out-of-range{outline-color:red}"]}),r})();var it=It(7009);let K=(()=>{class r{constructor(a){this._snackBar=a}openSnackbar(a,p){this._snackBar.open(a,"X",{duration:3e3,horizontalPosition:"end",verticalPosition:"top",panelClass:p})}}return r.\u0275fac=function(a){return new(a||r)(s.LFG(it.ux))},r.\u0275prov=s.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"}),r})(),tt=(()=>{class r{constructor(a,p,y,v){this.snackBarService=a,this.matDialog=p,this.dataShareService=y,this.identityFeatureService=v,this.canDeleteMarker=!1,this.newMarkerGeoJSON={type:"FeatureCollection",features:[]},this.fillColorArray=[],this.fillOpacityArray=[],this.fillBorderColorArray=[],this.lineColorArray=[],this.lineWidthArray=[],this.circleRadiusArray=[],this.circleColorArray=[],this.fillBorderWidthArray=[],this.dataState=[],this.currentStateIndex=0,this.isUndoChecked=!1,this.dataShareService.getSourceData.subscribe(b=>{this.geo_json_main=b})}setColorArrayData(a){this.fillColorArray=[],this.fillOpacityArray=[],this.fillBorderColorArray=[],this.fillBorderWidthArray=[],this.lineColorArray=[],this.lineWidthArray=[],this.circleColorArray=[],this.circleRadiusArray=[],this.map=a,this.geo_json_main&&(this.geo_json_main.features.forEach(p=>{void 0!==p.styledetails.styledata.circlecolor&&(this.circleColorArray.push(p.id),this.circleColorArray.push(p.styledetails.styledata.circlecolor)),void 0!==p.styledetails.styledata.circleradius&&(this.circleRadiusArray.push(p.id),this.circleRadiusArray.push(Number(p.styledetails.styledata.circleradius))),void 0!==p.styledetails.styledata.linecolor&&(this.lineColorArray.push(p.id),this.lineColorArray.push(p.styledetails.styledata.linecolor)),void 0!==p.styledetails.styledata.linewidth&&(this.lineWidthArray.push(p.id),this.lineWidthArray.push(Number(p.styledetails.styledata.linewidth))),void 0!==p.styledetails.styledata.fillcolor&&(this.fillColorArray.push(p.id),this.fillColorArray.push(p.styledetails.styledata.fillcolor)),void 0!==p.styledetails.styledata.fillbordercolor&&(this.fillBorderColorArray.push(p.id),this.fillBorderColorArray.push(p.styledetails.styledata.fillbordercolor)),void 0!==p.styledetails.styledata.fillopacity&&(this.fillOpacityArray.push(p.id),this.fillOpacityArray.push(Number(p.styledetails.styledata.fillopacity))),void 0!==p.styledetails.styledata.fillborderwidth&&(this.fillBorderWidthArray.push(p.id),this.fillBorderWidthArray.push(Number(p.styledetails.styledata.fillborderwidth))),null==p.styledetails.styledata.circlecolor&&(this.circleColorArray.push(p.id),this.circleColorArray.push("orange")),null==p.styledetails.styledata.circleradius&&(this.circleRadiusArray.push(p.id),this.circleRadiusArray.push(5)),null==p.styledetails.styledata.linecolor&&(this.lineColorArray.push(p.id),this.lineColorArray.push("orange")),null==p.styledetails.styledata.linewidth&&(this.lineWidthArray.push(p.id),this.lineWidthArray.push(5)),null==p.styledetails.styledata.fillopacity&&(this.fillOpacityArray.push(p.id),this.fillOpacityArray.push(5)),null==p.styledetails.styledata.fillbordercolor&&(this.fillBorderColorArray.push(p.id),this.fillBorderColorArray.push("#3b1513")),null==p.styledetails.styledata.fillcolor&&(this.fillColorArray.push(p.id),this.fillColorArray.push("orange")),null==p.styledetails.styledata.fillborderwidth&&(this.fillBorderWidthArray.push(p.id),this.fillBorderWidthArray.push(2))}),this.setLastElementInEachStyle())}setLastElementInEachStyle(){this.circleColorArray.push("#B42222"),this.circleRadiusArray.push(6),this.lineColorArray.push("#BF93E4"),this.lineWidthArray.push(5),this.fillColorArray.push("#10CAF0"),this.fillBorderColorArray.push("#3b1513"),this.fillBorderWidthArray.push(2),this.fillOpacityArray.push(.4),this.setPaintFinally()}setPaintFinally(){this.map.setPaintProperty("YourMapSourceIdPolygon","fill-color",this.paintArrayCreator("fill-color")),this.map.setPaintProperty("YourMapSourceIdPolygon","fill-opacity",this.paintArrayCreator("fill-opacity")),this.map.setPaintProperty("YourMapSourceIdPolygonLineString","line-color",this.paintArrayCreator("polygon-border-color")),this.map.setPaintProperty("YourMapSourceIdPolygonLineString","line-width",this.paintArrayCreator("polygon-border-width")),this.map.setPaintProperty("YourMapSourceIdPoint","circle-color",this.paintArrayCreator("circle-color")),this.map.setPaintProperty("YourMapSourceIdPoint","circle-radius",this.paintArrayCreator("circle-radius")),this.map.setPaintProperty("YourMapSourceIdLineString","line-color",this.paintArrayCreator("line-color")),this.map.setPaintProperty("YourMapSourceIdLineString","line-width",this.paintArrayCreator("line-width"))}paintArrayCreator(a){let p=["match",["get","featureid"]];return"fill-color"==a&&p.push(...this.fillColorArray),"fill-opacity"==a&&p.push(...this.fillOpacityArray),"polygon-border-color"==a&&p.push(...this.fillBorderColorArray),"polygon-border-width"==a&&p.push(...this.fillBorderWidthArray),"circle-color"==a&&p.push(...this.circleColorArray),"circle-radius"==a&&p.push(...this.circleRadiusArray),"line-color"==a&&p.push(...this.lineColorArray),"line-width"==a&&p.push(...this.lineWidthArray),p}setDataOnMap(a,p,y=!0,v=!0){v&&this.setDataSourceFn(JSON.parse(JSON.stringify({...p}))),y&&this.deleteAllMarkers(),this.newMarkerGeoJSON={type:"FeatureCollection",features:[]},this.map=a;let b={...p};-1==b.features.findIndex(P=>"marker"==P.geometry.type)?(this.map.getSource("YourMapSource").setData(b),b.features.length>0&&this.setColorArrayData(this.map)):this.seprateMarkerLayer(b)}seprateMarkerLayer(a){let p=JSON.parse(JSON.stringify(a)),y=[];if(a.features.forEach((v,b)=>{"marker"==v.geometry.type&&(y.push(b),this.newMarkerGeoJSON.features.push(v))}),y){let v=0;y.forEach(b=>{p.features.splice(b-v,1),v++})}this.map.getSource("YourMapSource").setData(p),a.features.length>0&&this.setColorArrayData(this.map),this.addMarkerLayerOnMap()}addMarkerLayerOnMap(){for(const a of this.newMarkerGeoJSON.features)if(a.styledetails.styledata.markername){let p=`../../assets/marker-icons/all_maki_icons/svgs/${a.styledetails.styledata.markername}.svg`;const y=document.createElement("div"),v=a.styledetails.styledata.height,b=a.styledetails.styledata.width;y.className="marker",y.id=a.styledetails.id,y.style.backgroundImage=`url(${p})`,y.style.width=`${v}px`,y.style.height=`${b}px`,y.style.backgroundSize="100%",y.style.backgroundPosition="center",y.style.backgroundRepeat="no-repeat",y.style.cursor="pointer",y.addEventListener("click",()=>{this.sendIdentityFeatureStatus(a)}),y.addEventListener("contextmenu",()=>{this.sendIdentityFeatureStatus(a)}),new xt.Marker(y).setLngLat(a.geometry.coordinates).addTo(this.map)}else if(a.styledetails.styledata.textname){let p=!0;const y=document.createElement("div"),v=a.styledetails.styledata.width,b=a.styledetails.styledata.height;y.className="marker",y.id=a.styledetails.id,y.innerHTML=`${a.styledetails.styledata.textname}`,y.style.width=`${v}px`,y.style.height=`${b}px`,y.style.backgroundSize="100%",y.style.backgroundPosition="center",y.style.backgroundRepeat="no-repeat",y.style.cursor="pointer",y.style.color=a.styledetails.styledata.color,y.style.fontSize=`${a.styledetails.styledata.textfontsize}px`,new xt.Marker(y,{draggable:!0}).setLngLat(a.geometry.coordinates).addTo(this.map).on("dragend",P=>{if(p){let C={...this.geo_json_main};const O=P.target.getLngLat();let k=C.features.findIndex(R=>y.id==R.id);C.features[k].geometry.coordinates=[O.lng,O.lat],this.setDataOnMap(this.map,C),this.dataShareService.sendSourceData(C)}}),y.addEventListener("contextmenu",()=>{p=this.openTextFieldPopUp(a,p)}),y.addEventListener("click",()=>{this.canDeleteMarker?this.deleteFeature(a):p=this.openTextFieldPopUp(a,p)})}}openTextFieldPopUp(a,p){this.matDialog.open(j,{data:{textField:a,geo_json_main:this.geo_json_main,map:this.map},disableClose:!0}).afterClosed().subscribe(v=>{let b={...this.geo_json_main};if(v){let I=b.features.findIndex(P=>v.id==P.id);b.features[I].geometry.coordinates=[v.textLng,v.textLat],b.features[I].styledetails.styledata.color=v.textColor,b.features[I].styledetails.styledata.height=v.textHeight,b.features[I].styledetails.styledata.width=v.textWidth,b.features[I].styledetails.styledata.textname=v.textName,b.features[I].styledetails.styledata.textfontsize=v.textFontSize}return this.setDataOnMap(this.map,b),this.dataShareService.sendSourceData(b),!1})}setTextFieldData(a){}deleteAllMarkers(){this.newMarkerGeoJSON.features.length>0&&(this.newMarkerGeoJSON.features.forEach(a=>{document.getElementById(`${a.styledetails.id}`).remove()}),this.newMarkerGeoJSON={type:"FeatureCollection",features:[]})}sendIdentityFeatureStatus(a){this.canDeleteMarker?this.deleteFeature(a):this.showIdentityFeature(this.identityFeatureData(a.properties))}deleteFeature(a){let p={...this.geo_json_main},y=p.features.findIndex(v=>v.id==a.properties.featureid);p.features.splice(y,1),this.setDataOnMap(this.map,p),this.dataShareService.sendSourceData(p)}identityFeatureData(a){let p=Object.keys(a),y=[];return p.forEach(v=>{let b={name:"",value:""};b.name=v,b.value=a[v],y.push(b)}),y}showIdentityFeature(a){setTimeout(()=>{this.identityFeatureService.sendShowIdentityFeatureStatus(!1),setTimeout(()=>{this.identityFeatureService.sendShowIdentityFeatureStatus(!0),this.identityFeatureService.sendIdentityFeatureData(a)},200)},0)}setDataSourceFn(a){this.isUndoChecked&&(this.dataState.length=this.currentStateIndex);let p=JSON.parse(JSON.stringify({...a}));this.dataState.push(p),this.currentStateIndex++,this.isUndoChecked=!1}handleUndo(){if(this.dataState.length>0)if(this.currentStateIndex--,this.currentStateIndex<=0)this.snackBarService.openSnackbar("You can't undo from this state'","snackbar-err"),this.currentStateIndex++;else{let a=this.dataState[this.currentStateIndex-1];this.setDataOnMap(this.map,JSON.parse(JSON.stringify({...a})),!0,!1),this.dataShareService.sendSourceData(JSON.parse(JSON.stringify({...a}))),this.setColorArrayData(this.map),this.isUndoChecked=!0}else this.snackBarService.openSnackbar("Please draw some feature first","snackbar-err")}handleRedo(){if(this.dataState.length>0)if(this.currentStateIndex++,this.currentStateIndex>this.dataState.length)this.snackBarService.openSnackbar("You can't redo from this state","snackbar-err"),this.currentStateIndex--;else{let a=this.dataState[this.currentStateIndex-1];this.setDataOnMap(this.map,JSON.parse(JSON.stringify({...a})),!0,!1),this.dataShareService.sendSourceData(JSON.parse(JSON.stringify({...a}))),this.setColorArrayData(this.map),this.isUndoChecked=!0}else this.snackBarService.openSnackbar("Please use undo first","snackbar-err")}}return r.\u0275fac=function(a){return new(a||r)(s.LFG(K),s.LFG(ht.uw),s.LFG(Jt),s.LFG(mt))},r.\u0275prov=s.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"}),r})();var X=It(7392),nt=It(455);function J(r,o){if(1&r){const a=s.EpF();s.TgZ(0,"div")(1,"div")(2,"img",19),s.NdJ("click",function(){s.CHM(a);const y=s.oxw(3);return s.KtG(y.showMarkerList())}),s.qZA()(),s.TgZ(3,"div",20)(4,"label",21),s._uU(5,"Height"),s.qZA(),s._uU(6," : "),s.TgZ(7,"input",22),s.NdJ("ngModelChange",function(y){s.CHM(a);const v=s.oxw(3);return s.KtG(v.markerHeight=y)}),s.qZA()(),s.TgZ(8,"div",23)(9,"label",24),s._uU(10,"Width"),s.qZA(),s._uU(11," : "),s.TgZ(12,"input",25),s.NdJ("ngModelChange",function(y){s.CHM(a);const v=s.oxw(3);return s.KtG(v.markerWidth=y)}),s.qZA()()()}if(2&r){const a=s.oxw(3);s.xp6(2),s.Q6J("src","../../../assets/marker-icons/all_maki_icons/svgs/"+a.markerName+".svg",s.LSH),s.xp6(5),s.Q6J("ngModel",a.markerHeight),s.xp6(5),s.Q6J("ngModel",a.markerWidth)}}function et(r,o){if(1&r){const a=s.EpF();s.TgZ(0,"div")(1,"div",26)(2,"label",27),s._uU(3,"Background Color"),s.qZA(),s._uU(4," : "),s.TgZ(5,"input",28),s.NdJ("colorPickerChange",function(y){s.CHM(a);const v=s.oxw(3);return s.KtG(v.fillColor=y)}),s.qZA()(),s.TgZ(6,"div",26)(7,"label",29),s._uU(8,"Border Color"),s.qZA(),s._uU(9," : "),s.TgZ(10,"input",30),s.NdJ("colorPickerChange",function(y){s.CHM(a);const v=s.oxw(3);return s.KtG(v.fillBorderColor=y)}),s.qZA()(),s.TgZ(11,"div",26)(12,"label",31),s._uU(13,"Border Width"),s.qZA(),s._uU(14," : "),s.TgZ(15,"input",32),s.NdJ("ngModelChange",function(y){s.CHM(a);const v=s.oxw(3);return s.KtG(v.fillBorderWidth=y)}),s.qZA()(),s.TgZ(16,"div",26)(17,"label",31),s._uU(18,"Fill Opacity"),s.qZA(),s._uU(19," : "),s.TgZ(20,"input",32),s.NdJ("ngModelChange",function(y){s.CHM(a);const v=s.oxw(3);return s.KtG(v.fillOpacity=y)}),s.qZA()()()}if(2&r){const a=s.oxw(3);s.xp6(5),s.Udp("background",a.fillColor),s.Q6J("colorPicker",a.fillColor),s.xp6(5),s.Udp("background",a.fillBorderColor),s.Q6J("colorPicker",a.fillBorderColor),s.xp6(5),s.Q6J("ngModel",a.fillBorderWidth),s.xp6(5),s.Q6J("ngModel",a.fillOpacity)}}function at(r,o){if(1&r){const a=s.EpF();s.TgZ(0,"div")(1,"div",26)(2,"label",29),s._uU(3,"Line Color"),s.qZA(),s._uU(4," : "),s.TgZ(5,"input",30),s.NdJ("colorPickerChange",function(y){s.CHM(a);const v=s.oxw(3);return s.KtG(v.lineColor=y)}),s.qZA()(),s.TgZ(6,"div",26)(7,"label",31),s._uU(8,"Line Width"),s.qZA(),s._uU(9," : "),s.TgZ(10,"input",33),s.NdJ("ngModelChange",function(y){s.CHM(a);const v=s.oxw(3);return s.KtG(v.lineWidth=y)}),s.qZA()()()}if(2&r){const a=s.oxw(3);s.xp6(5),s.Udp("background",a.lineColor),s.Q6J("colorPicker",a.lineColor),s.xp6(5),s.Q6J("ngModel",a.lineWidth)}}function Z(r,o){if(1&r){const a=s.EpF();s.TgZ(0,"div")(1,"div",26)(2,"label",29),s._uU(3,"Circle Color"),s.qZA(),s._uU(4," : "),s.TgZ(5,"input",30),s.NdJ("colorPickerChange",function(y){s.CHM(a);const v=s.oxw(3);return s.KtG(v.circleColor=y)}),s.qZA()(),s.TgZ(6,"div",26)(7,"label",31),s._uU(8,"Circle Radius"),s.qZA(),s._uU(9," : "),s.TgZ(10,"input",34),s.NdJ("ngModelChange",function(y){s.CHM(a);const v=s.oxw(3);return s.KtG(v.circleRadius=y)}),s.qZA()()()}if(2&r){const a=s.oxw(3);s.xp6(5),s.Udp("background",a.circleColor),s.Q6J("colorPicker",a.circleColor),s.xp6(5),s.Q6J("ngModel",a.circleRadius)}}function Wt(r,o){if(1&r&&(s.TgZ(0,"div")(1,"div",18),s.YNc(2,J,13,3,"div",7),s.YNc(3,et,21,8,"div",7),s.YNc(4,at,11,4,"div",7),s.YNc(5,Z,11,4,"div",7),s.qZA()()),2&r){const a=s.oxw(2);s.xp6(2),s.Q6J("ngIf","marker"==(null==a.geo_json_main||null==a.geo_json_main.features[a.CurrentFeatureindex]||null==a.geo_json_main.features[a.CurrentFeatureindex].geometry?null:a.geo_json_main.features[a.CurrentFeatureindex].geometry.type)),s.xp6(1),s.Q6J("ngIf","Polygon"==(null==a.geo_json_main||null==a.geo_json_main.features[a.CurrentFeatureindex]||null==a.geo_json_main.features[a.CurrentFeatureindex].geometry?null:a.geo_json_main.features[a.CurrentFeatureindex].geometry.type)),s.xp6(1),s.Q6J("ngIf","LineString"==(null==a.geo_json_main||null==a.geo_json_main.features[a.CurrentFeatureindex]||null==a.geo_json_main.features[a.CurrentFeatureindex].geometry?null:a.geo_json_main.features[a.CurrentFeatureindex].geometry.type)),s.xp6(1),s.Q6J("ngIf","Point"==(null==a.geo_json_main||null==a.geo_json_main.features[a.CurrentFeatureindex]||null==a.geo_json_main.features[a.CurrentFeatureindex].geometry?null:a.geo_json_main.features[a.CurrentFeatureindex].geometry.type))}}function St(r,o){if(1&r&&(s.TgZ(0,"div"),s.YNc(1,Wt,6,4,"div",7),s.qZA()),2&r){const a=s.oxw();s.xp6(1),s.Q6J("ngIf",a.geo_json_main)}}function kt(r,o){if(1&r&&(s.TgZ(0,"table",37)(1,"tr")(2,"td",38),s._uU(3,"Sq. Meters"),s.qZA(),s.TgZ(4,"td",38),s._uU(5),s.qZA()(),s.TgZ(6,"tr")(7,"td",38),s._uU(8,"Sq. Kilometers"),s.qZA(),s.TgZ(9,"td",38),s._uU(10),s.qZA()(),s.TgZ(11,"tr")(12,"td",38),s._uU(13,"Sq. Feet"),s.qZA(),s.TgZ(14,"td",38),s._uU(15),s.qZA()(),s.TgZ(16,"tr")(17,"td",38),s._uU(18,"Acres"),s.qZA(),s.TgZ(19,"td",38),s._uU(20),s.qZA()(),s.TgZ(21,"tr")(22,"td",38),s._uU(23,"Sq. Miles"),s.qZA(),s.TgZ(24,"td",38),s._uU(25),s.qZA()()()),2&r){const a=s.oxw(2);s.xp6(5),s.Oqu(a.polygonMeasurement),s.xp6(5),s.Oqu(a.polygonMeasurement/1e6),s.xp6(5),s.Oqu(10.76*a.polygonMeasurement),s.xp6(5),s.Oqu(.0002471054*a.polygonMeasurement),s.xp6(5),s.Oqu(39e-8*a.polygonMeasurement)}}function dt(r,o){if(1&r&&(s.TgZ(0,"table",37)(1,"tr")(2,"td",38),s._uU(3,"Meters"),s.qZA(),s.TgZ(4,"td",38),s._uU(5),s.qZA()(),s.TgZ(6,"tr")(7,"td",38),s._uU(8,"Kilometers"),s.qZA(),s.TgZ(9,"td",38),s._uU(10),s.qZA()(),s.TgZ(11,"tr")(12,"td",38),s._uU(13,"Feet"),s.qZA(),s.TgZ(14,"td",38),s._uU(15),s.qZA()(),s.TgZ(16,"tr")(17,"td",38),s._uU(18,"Yards"),s.qZA(),s.TgZ(19,"td",38),s._uU(20),s.qZA()(),s.TgZ(21,"tr")(22,"td",38),s._uU(23,"Miles"),s.qZA(),s.TgZ(24,"td",38),s._uU(25),s.qZA()()()),2&r){const a=s.oxw(2);s.xp6(5),s.Oqu(1e3*a.lineMeasurement),s.xp6(5),s.Oqu(a.lineMeasurement),s.xp6(5),s.Oqu(3280.84*a.lineMeasurement),s.xp6(5),s.Oqu(1093.61*a.lineMeasurement),s.xp6(5),s.Oqu(.621371*a.lineMeasurement)}}function je(r,o){if(1&r&&(s.TgZ(0,"table",37)(1,"tr")(2,"td",39),s._uU(3,"Latitude"),s.qZA(),s.TgZ(4,"td",39),s._uU(5),s.qZA()(),s.TgZ(6,"tr")(7,"td",39),s._uU(8,"Longitude"),s.qZA(),s.TgZ(9,"td",39),s._uU(10),s.qZA()()()),2&r){const a=s.oxw(2);s.xp6(5),s.Oqu(a.geo_json_main.features[a.CurrentFeatureindex].geometry.coordinates[0]),s.xp6(5),s.Oqu(a.geo_json_main.features[a.CurrentFeatureindex].geometry.coordinates[1])}}function Ce(r,o){if(1&r&&(s.TgZ(0,"div",35),s.YNc(1,kt,26,5,"table",36),s.YNc(2,dt,26,5,"table",36),s.YNc(3,je,11,2,"table",36),s.qZA()),2&r){const a=s.oxw();s.xp6(1),s.Q6J("ngIf","Polygon"==(null==a.geo_json_main||null==a.geo_json_main.features[a.CurrentFeatureindex]||null==a.geo_json_main.features[a.CurrentFeatureindex].geometry?null:a.geo_json_main.features[a.CurrentFeatureindex].geometry.type)),s.xp6(1),s.Q6J("ngIf","LineString"==(null==a.geo_json_main||null==a.geo_json_main.features[a.CurrentFeatureindex]||null==a.geo_json_main.features[a.CurrentFeatureindex].geometry?null:a.geo_json_main.features[a.CurrentFeatureindex].geometry.type)),s.xp6(1),s.Q6J("ngIf","Point"==(null==a.geo_json_main||null==a.geo_json_main.features[a.CurrentFeatureindex]||null==a.geo_json_main.features[a.CurrentFeatureindex].geometry?null:a.geo_json_main.features[a.CurrentFeatureindex].geometry.type)||"marker"==(null==a.geo_json_main||null==a.geo_json_main.features[a.CurrentFeatureindex]||null==a.geo_json_main.features[a.CurrentFeatureindex].geometry?null:a.geo_json_main.features[a.CurrentFeatureindex].geometry.type))}}function Mt(r,o){if(1&r){const a=s.EpF();s.TgZ(0,"div"),s._UZ(1,"input",42)(2,"input",43),s.TgZ(3,"button",44),s.NdJ("click",function(){s.CHM(a);const y=s.oxw().index,v=s.oxw();return s.KtG(v.removeAttribute(y))}),s._uU(4,"-"),s.qZA()()}if(2&r){const a=s.oxw().index;s.xp6(1),s.Q6J("readonly",0==a),s.xp6(1),s.Q6J("readonly",0==a),s.xp6(1),s.Q6J("disabled",0==a)}}function pe(r,o){if(1&r&&(s.TgZ(0,"div",40)(1,"div",41),s.YNc(2,Mt,5,3,"div",7),s.qZA()()),2&r){const a=o.index;s.xp6(1),s.Q6J("formGroupName",a),s.xp6(1),s.Q6J("ngIf",0!==a)}}function At(r,o){1&r&&(s.TgZ(0,"div",45),s._uU(1," * Click on marker icon in identity feature to change it "),s.qZA())}let $t=(()=>{class r{constructor(a,p,y,v,b,I){this.identityFeatureService=a,this.dataShareService=p,this._fb=y,this.matDialog=v,this.styleService=b,this.snackbarService=I}ngOnInit(){this.identityFeatureService.showIdentityFeatureStatus.subscribe(a=>{a||this.closeIdentity(),this.showIdentityFeature=a}),this.identityFeatureService.getIdentityFeatureData.subscribe(a=>{this.featureFormData=a,this.setFeatureFormData(),this.findFeatureIndex(),this.setStyleDetails()}),this.dataShareService.getSourceData.subscribe(a=>{this.geo_json_main=a}),this.initializeFormArray()}setStyleDetails(){"marker"==this.geo_json_main.features[this.CurrentFeatureindex].geometry.type&&(this.markerName=this.geo_json_main.features[this.CurrentFeatureindex].styledetails.styledata.markername,this.markerHeight=this.geo_json_main.features[this.CurrentFeatureindex].styledetails.styledata.height,this.markerWidth=this.geo_json_main.features[this.CurrentFeatureindex].styledetails.styledata.width),"Polygon"==this.geo_json_main.features[this.CurrentFeatureindex].geometry.type&&(this.fillColor=this.geo_json_main.features[this.CurrentFeatureindex].styledetails.styledata.fillcolor,this.fillBorderColor=this.geo_json_main.features[this.CurrentFeatureindex].styledetails.styledata.fillbordercolor,this.fillBorderWidth=this.geo_json_main.features[this.CurrentFeatureindex].styledetails.styledata.fillborderwidth,this.fillOpacity=this.geo_json_main.features[this.CurrentFeatureindex].styledetails.styledata.fillopacity,this.polygonMeasurement=this.geo_json_main.features[this.CurrentFeatureindex].measurement.squaremeters),"LineString"==this.geo_json_main.features[this.CurrentFeatureindex].geometry.type&&(this.lineColor=this.geo_json_main.features[this.CurrentFeatureindex].styledetails.styledata.linecolor,this.lineWidth=this.geo_json_main.features[this.CurrentFeatureindex].styledetails.styledata.linewidth,this.lineMeasurement=this.geo_json_main.features[this.CurrentFeatureindex].measurement.kilometers),"Point"==this.geo_json_main.features[this.CurrentFeatureindex].geometry.type&&(this.circleColor=this.geo_json_main.features[this.CurrentFeatureindex].styledetails.styledata.circlecolor,this.circleRadius=this.geo_json_main.features[this.CurrentFeatureindex].styledetails.styledata.circleradius)}saveStyleDetailsInJson(){"marker"==this.geo_json_main.features[this.CurrentFeatureindex].geometry.type&&this.setMarkerStyleDetails(),"Polygon"==this.geo_json_main.features[this.CurrentFeatureindex].geometry.type&&this.setPolygonStyleDetails(),"LineString"==this.geo_json_main.features[this.CurrentFeatureindex].geometry.type&&this.setLineStringStyleDetails(),"Point"==this.geo_json_main.features[this.CurrentFeatureindex].geometry.type&&this.setPointStyleDetails()}setMarkerStyleDetails(){this.geo_json_main.features[this.CurrentFeatureindex].styledetails.styledata.markername=this.markerName,this.geo_json_main.features[this.CurrentFeatureindex].styledetails.styledata.height=this.markerHeight,this.geo_json_main.features[this.CurrentFeatureindex].styledetails.styledata.width=this.markerWidth,this.dataShareService.sendSourceData(this.geo_json_main)}setPolygonStyleDetails(){this.geo_json_main.features[this.CurrentFeatureindex].styledetails.styledata.fillcolor=this.fillColor,this.geo_json_main.features[this.CurrentFeatureindex].styledetails.styledata.fillbordercolor=this.fillBorderColor,this.geo_json_main.features[this.CurrentFeatureindex].styledetails.styledata.fillborderwidth=this.fillBorderWidth,this.geo_json_main.features[this.CurrentFeatureindex].styledetails.styledata.fillopacity=this.fillOpacity,this.dataShareService.sendSourceData(this.geo_json_main)}setLineStringStyleDetails(){this.geo_json_main.features[this.CurrentFeatureindex].styledetails.styledata.linecolor=this.lineColor,this.geo_json_main.features[this.CurrentFeatureindex].styledetails.styledata.linewidth=this.lineWidth}setPointStyleDetails(){this.geo_json_main.features[this.CurrentFeatureindex].styledetails.styledata.circlecolor=this.circleColor,this.geo_json_main.features[this.CurrentFeatureindex].styledetails.styledata.circleradius=this.circleRadius}findFeatureIndex(){this.CurrentFeatureindex=this.geo_json_main.features.findIndex(a=>this.featureFormData[0].value==a.id)}initializeFormArray(){this.featureForm=this._fb.group({identityFormData:this._fb.array([this.putFormData()])})}putFormData(){return this._fb.group({name:["",lt.kI.required],value:["",lt.kI.required]})}get identityFormData(){return this.featureForm.get("identityFormData")}addNewAttribute(){this.identityFormData.push(this.putFormData())}removeAttribute(a){this.identityFormData.removeAt(a)}setFeatureFormData(){let a=this.featureFormData.length;for(let y=1;y<a;y++)this.addNewAttribute();let p=this.featureFormData.findIndex(y=>"featureid"==y.name);if(0!==p){let y=this.featureFormData.splice(p,1)[0];this.featureFormData.splice(0,0,y)}this.identityFormData.patchValue(this.featureFormData)}submitData(){"Polygon"==this.geo_json_main.features[this.CurrentFeatureindex].geometry.type&&this.fillOpacity>=0&&this.fillBorderWidth>=0&&this.finallySubmitData(),"marker"==this.geo_json_main.features[this.CurrentFeatureindex].geometry.type&&this.markerHeight>=10&&this.markerWidth>=10&&this.finallySubmitData(),"LineString"==this.geo_json_main.features[this.CurrentFeatureindex].geometry.type&&this.lineWidth>=1&&this.finallySubmitData(),"Point"==this.geo_json_main.features[this.CurrentFeatureindex].geometry.type&&this.circleRadius>=1&&this.finallySubmitData()}finallySubmitData(){"VALID"==this.featureForm.status?(this.setDataIn_geo_json_main(this.featureForm.get("identityFormData").value),this.closeIdentity(),this.saveStyleDetailsInJson(),this.styleService.setDataOnMap(this.map,this.geo_json_main)):this.snackbarService.openSnackbar("Please fill all the fields or remove empty fields","snackbar-err")}setDataIn_geo_json_main(a){let p=this.setFormDataForProperties(a);this.setNew_geo_json_main_data(p),this.dataShareService.sendSourceData(this.geo_json_main)}setNew_geo_json_main_data(a){let p=this.geo_json_main.features.findIndex(y=>y.id==a.featureid);this.geo_json_main.features[p].properties=a}setFormDataForProperties(a){let p={};return a.forEach(y=>{p[y.name]=y.value}),p}deleteFeature(){this.matDialog.open(Lt,{width:"250px",data:{messageData:"Are You Sure You Want To Delete This Feature"},enterAnimationDuration:"200ms",exitAnimationDuration:"200ms"}).afterClosed().subscribe(p=>{p&&(this.deleteFeatureFromGeojson(this.featureFormData[0].value),this.closeIdentity())})}deleteFeatureFromGeojson(a){let p=this.geo_json_main.features;p.splice(this.CurrentFeatureindex,1),this.geo_json_main.features=p,this.styleService.setDataOnMap(this.map,this.geo_json_main),this.dataShareService.sendSourceData(this.geo_json_main)}showMarkerList(){this.matDialog.open(_e,{width:"500px",data:{markerName:this.markerName}}).afterClosed().subscribe(p=>{p&&(this.markerName=p)})}getShowMeasurementStatus(a){this.showMeasurement=a.checked}showIdentity(a){this.featureFormData=a,this.setFeatureFormData(),this.findFeatureIndex(),this.setStyleDetails()}closeIdentity(){this.showIdentityFeature=!1,this.featureForm.reset(),this.identityFormData.controls=[this.putFormData()]}}return r.\u0275fac=function(a){return new(a||r)(s.Y36(mt),s.Y36(Jt),s.Y36(lt.qu),s.Y36(ht.uw),s.Y36(tt),s.Y36(K))},r.\u0275cmp=s.Xpm({type:r,selectors:[["app-identity-feature-side-nav"]],inputs:{map:"map"},decls:32,vars:6,consts:[[1,"identity-feature",3,"ngClass"],[1,"p-flex","shadow-sm"],[1,"cancle-icon",3,"click"],[1,"p-flex","my-2","toggle-div"],[1,"me-2"],[1,"d-block",3,"change"],[1,"ms-2"],[4,"ngIf"],["class","p-flex",4,"ngIf"],[1,"mt-2",3,"formGroup","ngSubmit"],["formArrayName","identityFormData",4,"ngFor","ngForOf"],[1,"p-flex","mb-3"],["type","button",1,"btn","btn-sm","d-flex","btn-primary","mt-2","mb-2",3,"click"],[1,"ms-1"],["type","submit",1,"btn","btn-sm","btn-success","ms-2"],["type","button",1,"d-flex","align-items-center","btn","btn-sm","btn-danger","ms-2",3,"click"],[1,"p-0","m-0","d-flex","align-items-center"],["class","alert alert-danger","style","line-height: 15px;",4,"ngIf"],[1,"mt-2"],["height","35px","width","35px","role","button","alt","",1,"ms-2","fs-1",3,"src","click"],[1,"d-flex","justify-content-center","mt-2"],["for","marker-height"],["id","marker-height","type","number","min","10",3,"ngModel","ngModelChange"],[1,"d-flex","justify-content-center","my-2"],["for","marker-width"],["id","marker-width","type","number","min","10",3,"ngModel","ngModelChange"],[1,"d-flex","justify-content-center","mb-2"],["for","fill-color"],["id","fill-color",3,"colorPicker","colorPickerChange"],["for","fill-outline-color"],["id","fill-outline-color",3,"colorPicker","colorPickerChange"],["for","fill-opacity"],["id","fill-opacity","type","number","min","0",3,"ngModel","ngModelChange"],["id","fill-opacity","type","number","min","1",3,"ngModel","ngModelChange"],["id","fill-opacity","type","number","min","2",3,"ngModel","ngModelChange"],[1,"p-flex"],["class","table w-75",4,"ngIf"],[1,"table","w-75"],["scope","col",1,"border","border-1","border-dark","p-2"],[1,"border","border-1","border-dark","p-2"],["formArrayName","identityFormData"],[1,"text-center",3,"formGroupName"],["type","text","formControlName","name",3,"readonly"],["type","text","formControlName","value",3,"readonly"],["type","button",1,"btn","btn-sm","btn-danger",3,"disabled","click"],[1,"alert","alert-danger",2,"line-height","15px"]],template:function(a,p){1&a&&(s.TgZ(0,"div",0)(1,"header",1)(2,"span"),s._uU(3,"Identity Feature"),s.qZA(),s.TgZ(4,"mat-icon",2),s.NdJ("click",function(){return p.closeIdentity()}),s._uU(5,"cancel"),s.qZA()(),s.TgZ(6,"main")(7,"div",3)(8,"span",4),s._uU(9,"Style"),s.qZA(),s.TgZ(10,"mat-slide-toggle",5),s.NdJ("change",function(v){return p.getShowMeasurementStatus(v)}),s.qZA(),s.TgZ(11,"span",6),s._uU(12,"Info"),s.qZA()(),s.YNc(13,St,2,1,"div",7),s.YNc(14,Ce,4,3,"div",8),s.TgZ(15,"form",9),s.NdJ("ngSubmit",function(){return p.submitData()}),s.YNc(16,pe,3,2,"div",10),s.TgZ(17,"div",11)(18,"button",12),s.NdJ("click",function(){return p.addNewAttribute()}),s.TgZ(19,"span"),s._uU(20,"+"),s.qZA(),s.TgZ(21,"span",13),s._uU(22,"Add Attribute"),s.qZA()(),s.TgZ(23,"button",14),s._uU(24,"Submit"),s.qZA(),s.TgZ(25,"button",15),s.NdJ("click",function(){return p.deleteFeature()}),s.TgZ(26,"span",16)(27,"mat-icon"),s._uU(28,"delete_forever"),s.qZA(),s.TgZ(29,"span"),s._uU(30,"Delete"),s.qZA()()()()(),s.YNc(31,At,2,0,"div",17),s.qZA()()),2&a&&(s.Q6J("ngClass",p.showIdentityFeature?"identity-feature-show":"identity-feature-hide"),s.xp6(13),s.Q6J("ngIf",!p.showMeasurement),s.xp6(1),s.Q6J("ngIf",p.showMeasurement),s.xp6(1),s.Q6J("formGroup",p.featureForm),s.xp6(1),s.Q6J("ngForOf",p.identityFormData.controls),s.xp6(15),s.Q6J("ngIf","marker"==(null==p.geo_json_main||null==p.geo_json_main.features[p.CurrentFeatureindex]||null==p.geo_json_main.features[p.CurrentFeatureindex].geometry?null:p.geo_json_main.features[p.CurrentFeatureindex].geometry.type)))},dependencies:[gt.mk,gt.sg,gt.O5,X.Hw,nt.Rr,lt._Y,lt.Fj,lt.wV,lt.JJ,lt.JL,lt.qQ,lt.sg,lt.u,lt.x0,lt.CE,lt.On,ye.Kk],styles:[".toggle-div[_ngcontent-%COMP%]  .mat-slide-toggle.mat-checked:not(.mat-disabled) .mat-slide-toggle-thumb{background-color:#00f}.toggle-div[_ngcontent-%COMP%]  .mat-slide-toggle.mat-checked:not(.mat-disabled) .mat-slide-toggle-bar{background-color:#87ceeb}.identity-feature[_ngcontent-%COMP%]{position:absolute;z-index:3;left:0;top:0;bottom:0;margin:auto 0;width:400px;height:50%;background-color:#f0f8ff;border:1px solid gray;border-left:none;transition:transform .5s}.identity-feature-hide[_ngcontent-%COMP%]{transform:translate(-100%)}.identity-feature-show[_ngcontent-%COMP%]{transform:translate(0)}header[_ngcontent-%COMP%]{height:8%;background-color:#0fcaf0;position:relative;font-size:15px;font-weight:bolder}.cancle-icon[_ngcontent-%COMP%]{position:absolute;right:0;cursor:pointer}main[_ngcontent-%COMP%]{height:92%;overflow-y:auto;overflow-x:hidden;scrollbar-color:#10CAF0 #EFF8FF}[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#1e3770;border-radius:10px}[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#f1f1f1}[_ngcontent-%COMP%]::-webkit-scrollbar{width:8px;height:8px}input.ng-invalid.ng-touched[_ngcontent-%COMP%]{border:2px solid red}label[_ngcontent-%COMP%]{width:150px}input[type=number][_ngcontent-%COMP%]:out-of-range{outline-color:red}"]}),r})();var fe=It(8527);function Qe(r){const o=r.featureTarget;return!(!o||!o.properties)&&"vertex"===o.properties.meta}function Ge(r){return 27===r.keyCode}function fn(r){return 13===r.keyCode}const hr={enable(r){setTimeout(()=>{!r.map||!r.map.doubleClickZoom||!r._ctx||!r._ctx.store||!r._ctx.store.getInitialConfigValue||!r._ctx.store.getInitialConfigValue("doubleClickZoom")||r.map.doubleClickZoom.enable()},0)},disable(r){setTimeout(()=>{!r.map||!r.map.doubleClickZoom||r.map.doubleClickZoom.disable()},0)}},Yn=function gn(r,o){return!!r.lngLat&&r.lngLat.lng===o[0]&&r.lngLat.lat===o[1]};function Jn(r,o,a,p){return{type:"Feature",properties:{meta:"vertex",parent:r,coord_path:a,active:p?"true":"false"},geometry:{type:"Point",coordinates:o}}}const Sn={onSetup:function(){const r=this.newFeature({type:"Feature",properties:{},geometry:{type:"Polygon",coordinates:[[]]}});return this.addFeature(r),this.clearSelectedFeatures(),hr.disable(this),this.updateUIClasses({mouse:"add"}),this.activateUIButton("polygon"),this.setActionableState({trash:!0}),{polygon:r,currentVertexPosition:0}},clickAnywhere:function(r,o){if(r.currentVertexPosition>0&&Yn(o,r.polygon.coordinates[0][r.currentVertexPosition-1]))return this.changeMode("simple_select",{featureIds:[r.polygon.id]});this.updateUIClasses({mouse:"add"}),r.polygon.updateCoordinate(`0.${r.currentVertexPosition}`,o.lngLat.lng,o.lngLat.lat),r.currentVertexPosition++,r.polygon.updateCoordinate(`0.${r.currentVertexPosition}`,o.lngLat.lng,o.lngLat.lat)},clickOnVertex:function(r){return this.changeMode("simple_select",{featureIds:[r.polygon.id]})},onMouseMove:function(r,o){r.polygon.updateCoordinate(`0.${r.currentVertexPosition}`,o.lngLat.lng,o.lngLat.lat),Qe(o)&&this.updateUIClasses({mouse:"pointer"})}};Sn.onTap=Sn.onClick=function(r,o){return Qe(o)?this.clickOnVertex(r,o):this.clickAnywhere(r,o)},Sn.onKeyUp=function(r,o){Ge(o)?(this.deleteFeature([r.polygon.id],{silent:!0}),this.changeMode("simple_select")):fn(o)&&this.changeMode("simple_select",{featureIds:[r.polygon.id]})},Sn.onStop=function(r){this.updateUIClasses({mouse:"none"}),hr.enable(this),this.activateUIButton(),void 0!==this.getFeature(r.polygon.id)&&(r.polygon.removeCoordinate(`0.${r.currentVertexPosition}`),r.polygon.isValid()?this.map.fire("draw.create",{features:[r.polygon.toGeoJSON()]}):(this.deleteFeature([r.polygon.id],{silent:!0}),this.changeMode("simple_select",{},{silent:!0})))},Sn.toDisplayFeatures=function(r,o,a){const p=o.properties.id===r.polygon.id;if(o.properties.active=p?"true":"false",!p)return a(o);if(0===o.geometry.coordinates.length)return;const y=o.geometry.coordinates[0].length;if(!(y<3)){if(o.properties.meta="feature",a(Jn(r.polygon.id,o.geometry.coordinates[0][0],"0.0",!1)),y>3){const v=o.geometry.coordinates[0].length-3;a(Jn(r.polygon.id,o.geometry.coordinates[0][v],`0.${v}`,!1))}if(y<=4&&(a({type:"Feature",properties:o.properties,geometry:{coordinates:[[o.geometry.coordinates[0][0][0],o.geometry.coordinates[0][0][1]],[o.geometry.coordinates[0][1][0],o.geometry.coordinates[0][1][1]]],type:"LineString"}}),3===y))return;return a(o)}},Sn.onTrash=function(r){this.deleteFeature([r.polygon.id],{silent:!0}),this.changeMode("simple_select")};var Br=6371008.8,Xo={centimeters:100*Br,centimetres:100*Br,degrees:Br/111325,feet:3.28084*Br,inches:39.37*Br,kilometers:Br/1e3,kilometres:Br/1e3,meters:Br,metres:Br,miles:Br/1609.344,millimeters:1e3*Br,millimetres:1e3*Br,nauticalmiles:Br/1852,radians:1,yards:1.0936*Br};function Gn(r,o,a){void 0===a&&(a={});var p={type:"Feature"};return(0===a.id||a.id)&&(p.id=a.id),a.bbox&&(p.bbox=a.bbox),p.properties=o||{},p.geometry=r,p}function xn(r,o,a){if(void 0===a&&(a={}),!r)throw new Error("coordinates is required");if(!Array.isArray(r))throw new Error("coordinates must be an Array");if(r.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!Xe(r[0])||!Xe(r[1]))throw new Error("coordinates must contain numbers");return Gn({type:"Point",coordinates:r},o,a)}function oi(r,o,a){void 0===a&&(a={});for(var p=0,y=r;p<y.length;p++){var v=y[p];if(v.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var b=0;b<v[v.length-1].length;b++)if(v[v.length-1][b]!==v[0][b])throw new Error("First and last Position are not equivalent.")}return Gn({type:"Polygon",coordinates:r},o,a)}function W(r,o,a){if(void 0===a&&(a={}),r.length<2)throw new Error("coordinates must be an array of two or more positions");return Gn({type:"LineString",coordinates:r},o,a)}function qe(r){return r%(2*Math.PI)*180/Math.PI}function pr(r){return r%360*Math.PI/180}function Xe(r){return!isNaN(r)&&null!==r&&!Array.isArray(r)}function $r(r){if(!r)throw new Error("coord is required");if(!Array.isArray(r)){if("Feature"===r.type&&null!==r.geometry&&"Point"===r.geometry.type)return r.geometry.coordinates;if("Point"===r.type)return r.coordinates}if(Array.isArray(r)&&r.length>=2&&!Array.isArray(r[0])&&!Array.isArray(r[1]))return r;throw new Error("coord must be GeoJSON Point or an Array of numbers")}function Lr(r){if(Array.isArray(r))return r;if("Feature"===r.type){if(null!==r.geometry)return r.geometry.coordinates}else if(r.coordinates)return r.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function kn(r){return"Feature"===r.type?r.geometry:r}function ni(r){var o=Lr(r);if(2===o.length&&!Xr(o[0],o[1]))return o;var a=[],p=o.length-1,y=a.length;a.push(o[0]);for(var v=1;v<p;v++){var b=a[a.length-1];o[v][0]===b[0]&&o[v][1]===b[1]||(a.push(o[v]),(y=a.length)>2&&ca(a[y-3],a[y-1],a[y-2])&&a.splice(a.length-2,1))}if(a.push(o[o.length-1]),y=a.length,Xr(o[0],o[o.length-1])&&y<4)throw new Error("invalid polygon");return ca(a[y-3],a[y-1],a[y-2])&&a.splice(a.length-2,1),a}function Xr(r,o){return r[0]===o[0]&&r[1]===o[1]}function ca(r,o,a){var p=a[0],y=a[1],v=r[0],b=r[1],I=o[0],P=o[1],k=I-v,R=P-b;return 0==(p-v)*R-(y-b)*k&&(Math.abs(k)>=Math.abs(R)?k>0?v<=p&&p<=I:I<=p&&p<=v:R>0?b<=y&&y<=P:P<=y&&y<=b)}function za(r){var o={type:"Feature"};return Object.keys(r).forEach(function(a){switch(a){case"type":case"properties":case"geometry":return;default:o[a]=r[a]}}),o.properties=No(r.properties),o.geometry=Ws(r.geometry),o}function No(r){var o={};return r&&Object.keys(r).forEach(function(a){var p=r[a];o[a]="object"==typeof p?null===p?null:Array.isArray(p)?p.map(function(y){return y}):No(p):p}),o}function Ws(r){var o={type:r.type};return r.bbox&&(o.bbox=r.bbox),"GeometryCollection"===r.type?(o.geometries=r.geometries.map(function(a){return Ws(a)}),o):(o.coordinates=Aa(r.coordinates),o)}function Aa(r){var o=r;return"object"!=typeof o[0]?o.slice():o.map(function(a){return Aa(a)})}function ss(r,o,a){if(null!==r)for(var p,y,v,b,I,P,C,R,O=0,k=0,B=r.type,jt="FeatureCollection"===B,Tt="Feature"===B,de=jt?r.features.length:1,Yt=0;Yt<de;Yt++){I=(R=!!(C=jt?r.features[Yt].geometry:Tt?r.geometry:r)&&"GeometryCollection"===C.type)?C.geometries.length:1;for(var wt=0;wt<I;wt++){var Ut=0,xe=0;if(null!==(b=R?C.geometries[wt]:C)){P=b.coordinates;var ve=b.type;switch(O=!a||"Polygon"!==ve&&"MultiPolygon"!==ve?0:1,ve){case null:break;case"Point":if(!1===o(P,k,Yt,Ut,xe))return!1;k++,Ut++;break;case"LineString":case"MultiPoint":for(p=0;p<P.length;p++){if(!1===o(P[p],k,Yt,Ut,xe))return!1;k++,"MultiPoint"===ve&&Ut++}"LineString"===ve&&Ut++;break;case"Polygon":case"MultiLineString":for(p=0;p<P.length;p++){for(y=0;y<P[p].length-O;y++){if(!1===o(P[p][y],k,Yt,Ut,xe))return!1;k++}"MultiLineString"===ve&&Ut++,"Polygon"===ve&&xe++}"Polygon"===ve&&Ut++;break;case"MultiPolygon":for(p=0;p<P.length;p++){for(xe=0,y=0;y<P[p].length;y++){for(v=0;v<P[p][y].length-O;v++){if(!1===o(P[p][y][v],k,Yt,Ut,xe))return!1;k++}xe++}Ut++}break;case"GeometryCollection":for(p=0;p<b.geometries.length;p++)if(!1===ss(b.geometries[p],o,a))return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function El(r,o){var a,p,y,v,b,I,P,C,O,k,R=0,B="FeatureCollection"===r.type,jt="Feature"===r.type,Tt=B?r.features.length:1;for(a=0;a<Tt;a++){for(C=B?r.features[a].properties:jt?r.properties:{},O=B?r.features[a].bbox:jt?r.bbox:void 0,k=B?r.features[a].id:jt?r.id:void 0,b=(P=!!(I=B?r.features[a].geometry:jt?r.geometry:r)&&"GeometryCollection"===I.type)?I.geometries.length:1,y=0;y<b;y++)if(null!==(v=P?I.geometries[y]:I))switch(v.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(!1===o(v,R,C,O,k))return!1;break;case"GeometryCollection":for(p=0;p<v.geometries.length;p++)if(!1===o(v.geometries[p],R,C,O,k))return!1;break;default:throw new Error("Unknown Geometry Type")}else if(!1===o(null,R,C,O,k))return!1;R++}}function U(r,o){El(r,function(a,p,y,v,b){var P,I=null===a?null:a.type;switch(I){case null:case"Point":case"LineString":case"Polygon":return!1!==o(Gn(a,y,{bbox:v,id:b}),p,0)&&void 0}switch(I){case"MultiPoint":P="Point";break;case"MultiLineString":P="LineString";break;case"MultiPolygon":P="Polygon"}for(var C=0;C<a.coordinates.length;C++)if(!1===o(Gn({type:P,coordinates:a.coordinates[C]},y),p,C))return!1})}function kr(r,o){var a=r.x-o.x,p=r.y-o.y;return a*a+p*p}function Ae(r,o,a){var p=o.x,y=o.y,v=a.x-p,b=a.y-y;if(0!==v||0!==b){var I=((r.x-p)*v+(r.y-y)*b)/(v*v+b*b);I>1?(p=a.x,y=a.y):I>0&&(p+=v*I,y+=b*I)}return(v=r.x-p)*v+(b=r.y-y)*b}function lr(r,o,a,p,y){for(var b,v=p,I=o+1;I<a;I++){var P=Ae(r[I],r[o],r[a]);P>v&&(b=I,v=P)}v>p&&(b-o>1&&lr(r,o,b,p,y),y.push(r[b]),a-b>1&&lr(r,b,a,p,y))}function Rr(r,o){var a=r.length-1,p=[r[0]];return lr(r,0,a,o,p),p.push(r[a]),p}function Cn(r,o,a){if(r.length<=2)return r;var p=void 0!==o?o*o:1;return r=a?r:function or(r,o){for(var y,a=r[0],p=[a],v=1,b=r.length;v<b;v++)kr(y=r[v],a)>o&&(p.push(y),a=y);return a!==y&&p.push(y),p}(r,p),Rr(r,p)}function Vr(r,o,a){return Cn(r.map(function(p){return{x:p[0],y:p[1],z:p[2]}}),o,a).map(function(p){return p.z?[p.x,p.y,p.z]:[p.x,p.y]})}function Kn(r,o,a){return r.map(function(p){var y=p.map(function(b){return{x:b[0],y:b[1]}});if(y.length<4)throw new Error("invalid polygon");for(var v=Cn(y,o,a).map(function(b){return[b.x,b.y]});!rn(v);)v=Cn(y,o-=.01*o,a).map(function(b){return[b.x,b.y]});return(v[v.length-1][0]!==v[0][0]||v[v.length-1][1]!==v[0][1])&&v.push(v[0]),v})}function rn(r){return!(r.length<3||3===r.length&&r[2][0]===r[0][0]&&r[2][1]===r[0][1])}const ci=function Jo(r,o){if(!function vr(r){return!!r&&r.constructor===Object}(o=o||{}))throw new Error("options is invalid");var a=void 0!==o.tolerance?o.tolerance:1,p=o.highQuality||!1,y=o.mutate||!1;if(!r)throw new Error("geojson is required");if(a&&a<0)throw new Error("invalid tolerance");return!0!==y&&(r=function Fa(r){if(!r)throw new Error("geojson is required");switch(r.type){case"Feature":return za(r);case"FeatureCollection":return function Wn(r){var o={type:"FeatureCollection"};return Object.keys(r).forEach(function(a){switch(a){case"type":case"features":return;default:o[a]=r[a]}}),o.features=r.features.map(function(a){return za(a)}),o}(r);case"Point":case"LineString":case"Polygon":case"MultiPoint":case"MultiLineString":case"MultiPolygon":case"GeometryCollection":return Ws(r);default:throw new Error("unknown GeoJSON type")}}(r)),El(r,function(v){!function $e(r,o,a){var p=r.type;if("Point"===p||"MultiPoint"===p)return r;!function co(r,o){void 0===o&&(o={});var a="object"==typeof o?o.mutate:o;if(!r)throw new Error("geojson is required");var p=function Tn(r,o){return"FeatureCollection"===r.type?"FeatureCollection":"GeometryCollection"===r.type?"GeometryCollection":"Feature"===r.type&&null!==r.geometry?r.geometry.type:r.type}(r),y=[];switch(p){case"LineString":y=ni(r);break;case"MultiLineString":case"Polygon":Lr(r).forEach(function(b){y.push(ni(b))});break;case"MultiPolygon":Lr(r).forEach(function(b){var I=[];b.forEach(function(P){I.push(ni(P))}),y.push(I)});break;case"Point":return r;case"MultiPoint":var v={};Lr(r).forEach(function(b){var I=b.join("-");Object.prototype.hasOwnProperty.call(v,I)||(y.push(b),v[I]=!0)});break;default:throw new Error(p+" geometry not supported")}r.coordinates?!0===a&&(r.coordinates=y):!0===a?r.geometry.coordinates=y:Gn({type:p,coordinates:y},r.properties,{bbox:r.bbox,id:r.id})}(r,!0);var y=r.coordinates;switch(p){case"LineString":r.coordinates=Vr(y,o,a);break;case"MultiLineString":r.coordinates=y.map(function(v){return Vr(v,o,a)});break;case"Polygon":r.coordinates=Kn(y,o,a);break;case"MultiPolygon":r.coordinates=y.map(function(v){return Kn(v,o,a)})}}(v,a,p)}),r},Cr=Object.assign({},Sn);Cr.onSetup=function(){const r=this.newFeature({type:"Feature",properties:{},geometry:{type:"Polygon",coordinates:[[]]}});return this.addFeature(r),this.clearSelectedFeatures(),setTimeout(()=>{!this.map||!this.map.dragPan||this.map.dragPan.disable()},0),this.updateUIClasses({mouse:"add"}),this.activateUIButton("polygon"),this.setActionableState({trash:!0}),{polygon:r,currentVertexPosition:0,dragMoving:!1}},Cr.onDrag=Cr.onTouchMove=function(r,o){r.dragMoving=!0,this.updateUIClasses({mouse:"add"}),r.polygon.updateCoordinate(`0.${r.currentVertexPosition}`,o.lngLat.lng,o.lngLat.lat),r.currentVertexPosition++,r.polygon.updateCoordinate(`0.${r.currentVertexPosition}`,o.lngLat.lng,o.lngLat.lat)},Cr.onMouseUp=function(r,o){r.dragMoving&&(this.simplify(r.polygon),this.fireUpdate(),this.changeMode("simple_select",{featureIds:[r.polygon.id]}))},Cr.onTouchEnd=function(r,o){this.onMouseUp(r,o)},Cr.fireUpdate=function(){this.map.fire("draw.update",{action:"move",features:this.getSelected().map(r=>r.toGeoJSON())})},Cr.simplify=function(r){const o=1/Math.pow(1.05,10*this.map.getZoom());ci(r,{mutate:!0,tolerance:o,highQuality:!0})};const us=Cr;var ls=It(6151);const qr={onSetup:function(r){const o=(r=r||{}).featureId;let a,p,y="forward";if(o){if(a=this.getFeature(o),!a)throw new Error("Could not find a feature with the provided featureId");let v=r.from;if(v&&"Feature"===v.type&&v.geometry&&"Point"===v.geometry.type&&(v=v.geometry),v&&"Point"===v.type&&v.coordinates&&2===v.coordinates.length&&(v=v.coordinates),!v||!Array.isArray(v))throw new Error("Please use the `from` property to indicate which point to continue the line from");const b=a.coordinates.length-1;if(a.coordinates[b][0]===v[0]&&a.coordinates[b][1]===v[1])p=b+1,a.addCoordinate(p,...a.coordinates[b]);else{if(a.coordinates[0][0]!==v[0]||a.coordinates[0][1]!==v[1])throw new Error("`from` should match the point at either the start or the end of the provided LineString");y="backwards",p=0,a.addCoordinate(p,...a.coordinates[0])}}else a=this.newFeature({type:"Feature",properties:{},geometry:{type:"LineString",coordinates:[]}}),p=0,this.addFeature(a);return this.clearSelectedFeatures(),hr.disable(this),this.updateUIClasses({mouse:"add"}),this.activateUIButton("line_string"),this.setActionableState({trash:!0}),{line:a,currentVertexPosition:p,direction:y}},clickAnywhere:function(r,o){if(r.currentVertexPosition>0&&Yn(o,r.line.coordinates[r.currentVertexPosition-1])||"backwards"===r.direction&&Yn(o,r.line.coordinates[r.currentVertexPosition+1]))return this.changeMode("simple_select",{featureIds:[r.line.id]});this.updateUIClasses({mouse:"add"}),r.line.updateCoordinate(r.currentVertexPosition,o.lngLat.lng,o.lngLat.lat),"forward"===r.direction?(r.currentVertexPosition++,r.line.updateCoordinate(r.currentVertexPosition,o.lngLat.lng,o.lngLat.lat)):r.line.addCoordinate(0,o.lngLat.lng,o.lngLat.lat)},clickOnVertex:function(r){return this.changeMode("simple_select",{featureIds:[r.line.id]})},onMouseMove:function(r,o){r.line.updateCoordinate(r.currentVertexPosition,o.lngLat.lng,o.lngLat.lat),Qe(o)&&this.updateUIClasses({mouse:"pointer"})}};qr.onTap=qr.onClick=function(r,o){if(Qe(o))return this.clickOnVertex(r,o);this.clickAnywhere(r,o)},qr.onKeyUp=function(r,o){fn(o)?this.changeMode("simple_select",{featureIds:[r.line.id]}):Ge(o)&&(this.deleteFeature([r.line.id],{silent:!0}),this.changeMode("simple_select"))},qr.onStop=function(r){hr.enable(this),this.activateUIButton(),void 0!==this.getFeature(r.line.id)&&(r.line.removeCoordinate(`${r.currentVertexPosition}`),r.line.isValid()?this.map.fire("draw.create",{features:[r.line.toGeoJSON()]}):(this.deleteFeature([r.line.id],{silent:!0}),this.changeMode("simple_select",{},{silent:!0})))},qr.onTrash=function(r){this.deleteFeature([r.line.id],{silent:!0}),this.changeMode("simple_select")},qr.toDisplayFeatures=function(r,o,a){const p=o.properties.id===r.line.id;if(o.properties.active=p?"true":"false",!p)return a(o);o.geometry.coordinates.length<2||(o.properties.meta="feature",a(Jn(r.line.id,o.geometry.coordinates["forward"===r.direction?o.geometry.coordinates.length-2:1],""+("forward"===r.direction?o.geometry.coordinates.length-2:1),!1)),a(o))};const Bi=qr;function xo(r){var o=[1/0,1/0,-1/0,-1/0];return ss(r,function(a){o[0]>a[0]&&(o[0]=a[0]),o[1]>a[1]&&(o[1]=a[1]),o[2]<a[0]&&(o[2]=a[0]),o[3]<a[1]&&(o[3]=a[1])}),o}xo.default=xo;const Uo=xo;function Hr(r,o,a){if(void 0===a&&(a={}),!r)throw new Error("point is required");if(!o)throw new Error("polygon is required");var p=$r(r),y=kn(o),v=y.type,b=o.bbox,I=y.coordinates;if(b&&!1===function fu(r,o){return o[0]<=r[0]&&o[1]<=r[1]&&o[2]>=r[0]&&o[3]>=r[1]}(p,b))return!1;"Polygon"===v&&(I=[I]);for(var P=!1,C=0;C<I.length&&!P;C++)if(bu(p,I[C][0],a.ignoreBoundary)){for(var O=!1,k=1;k<I[C].length&&!O;)bu(p,I[C][k],!a.ignoreBoundary)&&(O=!0),k++;O||(P=!0)}return P}function bu(r,o,a){var p=!1;o[0][0]===o[o.length-1][0]&&o[0][1]===o[o.length-1][1]&&(o=o.slice(0,o.length-1));for(var y=0,v=o.length-1;y<o.length;v=y++){var b=o[y][0],I=o[y][1],P=o[v][0],C=o[v][1];if(r[1]*(b-P)+I*(P-r[0])+C*(r[0]-b)==0&&(b-r[0])*(P-r[0])<=0&&(I-r[1])*(C-r[1])<=0)return!a;I>r[1]!=C>r[1]&&r[0]<(P-b)*(r[1]-I)/(C-I)+b&&(p=!p)}return p}It(5943),It(1335);const qi=function wu(r,o,a){void 0===a&&(a={});var p=$r(r),y=$r(o),v=pr(y[1]-p[1]),b=pr(y[0]-p[0]),I=pr(p[1]),P=pr(y[1]),C=Math.pow(Math.sin(v/2),2)+Math.pow(Math.sin(b/2),2)*Math.cos(I)*Math.cos(P);return function Ht(r,o){void 0===o&&(o="kilometers");var a=Xo[o];if(!a)throw new Error(o+" units is invalid");return r*a}(2*Math.atan2(Math.sqrt(C),Math.sqrt(1-C)),a.units)};var Wu=new ArrayBuffer(16);new Float64Array(Wu),new Uint32Array(Wu),It(3544);const Ga=function(){function r(o){this.points=o.points||[],this.duration=o.duration||1e4,this.sharpness=o.sharpness||.85,this.centers=[],this.controls=[],this.stepLength=o.stepLength||60,this.length=this.points.length,this.delay=0;for(var a=0;a<this.length;a++)this.points[a].z=this.points[a].z||0;for(a=0;a<this.length-1;a++){var p=this.points[a],y=this.points[a+1];this.centers.push({x:(p.x+y.x)/2,y:(p.y+y.y)/2,z:(p.z+y.z)/2})}for(this.controls.push([this.points[0],this.points[0]]),a=0;a<this.centers.length-1;a++){var v=this.points[a+1].x-(this.centers[a].x+this.centers[a+1].x)/2,b=this.points[a+1].y-(this.centers[a].y+this.centers[a+1].y)/2,I=this.points[a+1].z-(this.centers[a].y+this.centers[a+1].z)/2;this.controls.push([{x:(1-this.sharpness)*this.points[a+1].x+this.sharpness*(this.centers[a].x+v),y:(1-this.sharpness)*this.points[a+1].y+this.sharpness*(this.centers[a].y+b),z:(1-this.sharpness)*this.points[a+1].z+this.sharpness*(this.centers[a].z+I)},{x:(1-this.sharpness)*this.points[a+1].x+this.sharpness*(this.centers[a+1].x+v),y:(1-this.sharpness)*this.points[a+1].y+this.sharpness*(this.centers[a+1].y+b),z:(1-this.sharpness)*this.points[a+1].z+this.sharpness*(this.centers[a+1].z+I)}])}return this.controls.push([this.points[this.length-1],this.points[this.length-1]]),this.steps=this.cacheSteps(this.stepLength),this}return r.prototype.cacheSteps=function(o){var a=[],p=this.pos(0);a.push(0);for(var y=0;y<this.duration;y+=10){var v=this.pos(y);Math.sqrt((v.x-p.x)*(v.x-p.x)+(v.y-p.y)*(v.y-p.y)+(v.z-p.z)*(v.z-p.z))>o&&(a.push(y),p=v)}return a},r.prototype.vector=function(o){var a=this.pos(o+10),p=this.pos(o-10);return{angle:180*Math.atan2(a.y-p.y,a.x-p.x)/3.14,speed:Math.sqrt((p.x-a.x)*(p.x-a.x)+(p.y-a.y)*(p.y-a.y)+(p.z-a.z)*(p.z-a.z))}},r.prototype.pos=function(o){var a=o-this.delay;a<0&&(a=0),a>this.duration&&(a=this.duration-1);var p=a/this.duration;if(p>=1)return this.points[this.length-1];var y=Math.floor((this.points.length-1)*p);return function mi(r,o,a,p,y){var v=function $o(r){var o=r*r;return[o*r,3*o*(1-r),3*r*(1-r)*(1-r),(1-r)*(1-r)*(1-r)]}(r);return{x:y.x*v[0]+p.x*v[1]+a.x*v[2]+o.x*v[3],y:y.y*v[0]+p.y*v[1]+a.y*v[2]+o.y*v[3],z:y.z*v[0]+p.z*v[1]+a.z*v[2]+o.z*v[3]}}((this.length-1)*p-y,this.points[y],this.controls[y][1],this.controls[y+1][0],this.points[y+1])},r}();function bi(r,o,a,p){void 0===p&&(p={});var y=$r(r),v=pr(y[0]),b=pr(y[1]),I=pr(a),P=function nr(r,o){void 0===o&&(o="kilometers");var a=Xo[o];if(!a)throw new Error(o+" units is invalid");return r/a}(o,p.units),C=Math.asin(Math.sin(b)*Math.cos(P)+Math.cos(b)*Math.sin(P)*Math.cos(I));return xn([qe(v+Math.atan2(Math.sin(I)*Math.sin(P)*Math.cos(b),Math.cos(P)-Math.sin(b)*Math.sin(C))),qe(C)],p.properties)}function Ea(r){return function L(r,o,a){var p=a;return El(r,function(y,v,b,I,P){p=0===v&&void 0===a?y:o(p,y,v,b,I,P)}),p}(r,function(o,a){return o+function Os(r){var a,o=0;switch(r.type){case"Polygon":return Ys(r.coordinates);case"MultiPolygon":for(a=0;a<r.coordinates.length;a++)o+=Ys(r.coordinates[a]);return o;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0}return 0}(a)},0)}function Ys(r){var o=0;if(r&&r.length>0){o+=Math.abs(Sa(r[0]));for(var a=1;a<r.length;a++)o-=Math.abs(Sa(r[a]))}return o}function Sa(r){var o,a,y,v,b,I,P=0,C=r.length;if(C>2){for(I=0;I<C;I++)I===C-2?(y=C-2,v=C-1,b=0):I===C-1?(y=C-1,v=0,b=1):(y=I,v=I+1,b=I+2),o=r[y],a=r[v],P+=(hn(r[b][0])-hn(o[0]))*Math.sin(hn(a[1]));P=6378137*P*6378137/2}return P}function hn(r){return r*Math.PI/180}function bs(r,o){return void 0===o&&(o={}),function Se(r,o,a){var p=a,y=!1;return function oe(r,o){U(r,function(a,p,y){var v=0;if(a.geometry){var b=a.geometry.type;if("Point"!==b&&"MultiPoint"!==b){var I,P=0,C=0,O=0;if(!1===ss(a,function(k,R,B,jt,Tt){if(void 0===I||p>P||jt>C||Tt>O)return I=k,P=p,C=jt,O=Tt,void(v=0);var de=W([I,k],a.properties);if(!1===o(de,p,y,Tt,v))return!1;v++,I=k}))return!1}}})}(r,function(v,b,I,P,C){p=!1===y&&void 0===a?v:o(p,v,b,I,P,C),y=!0}),p}(r,function(a,p){var y=p.geometry.coordinates;return a+qi(y[0],y[1],o)},0)}It(5469),It(5406);var ge=Math.PI/180,Ee=180/Math.PI,Ue=function(r,o){this.lon=r,this.lat=o,this.x=ge*r,this.y=ge*o};Ue.prototype.view=function(){return String(this.lon).slice(0,4)+","+String(this.lat).slice(0,4)},Ue.prototype.antipode=function(){return new Ue(this.lon<0?180+this.lon:-1*(180-this.lon),-1*this.lat)};var Fe=function(){this.coords=[],this.length=0};Fe.prototype.move_to=function(r){this.length++,this.coords.push(r)};var We=function(r){this.properties=r||{},this.geometries=[]};We.prototype.json=function(){if(this.geometries.length<=0)return{geometry:{type:"LineString",coordinates:null},type:"Feature",properties:this.properties};if(1===this.geometries.length)return{geometry:{type:"LineString",coordinates:this.geometries[0].coords},type:"Feature",properties:this.properties};for(var r=[],o=0;o<this.geometries.length;o++)r.push(this.geometries[o].coords);return{geometry:{type:"MultiLineString",coordinates:r},type:"Feature",properties:this.properties}},We.prototype.wkt=function(){for(var r="",o="LINESTRING(",a=function(v){o+=v[0]+" "+v[1]+","},p=0;p<this.geometries.length;p++){if(0===this.geometries[p].coords.length)return"LINESTRING(empty)";this.geometries[p].coords.forEach(a),r+=o.substring(0,o.length-1)+")"}return r};var er=function(r,o,a){if(!r||void 0===r.x||void 0===r.y)throw new Error("GreatCircle constructor expects two args: start and end objects with x and y properties");if(!o||void 0===o.x||void 0===o.y)throw new Error("GreatCircle constructor expects two args: start and end objects with x and y properties");this.start=new Ue(r.x,r.y),this.end=new Ue(o.x,o.y),this.properties=a||{};var p=this.start.x-this.end.x,v=Math.pow(Math.sin((this.start.y-this.end.y)/2),2)+Math.cos(this.start.y)*Math.cos(this.end.y)*Math.pow(Math.sin(p/2),2);if(this.g=2*Math.asin(Math.sqrt(v)),this.g===Math.PI)throw new Error("it appears "+r.view()+" and "+o.view()+" are 'antipodal', e.g diametrically opposite, thus there is no single route but rather infinite");if(isNaN(this.g))throw new Error("could not calculate great circle between "+r+" and "+o)};er.prototype.interpolate=function(r){var o=Math.sin((1-r)*this.g)/Math.sin(this.g),a=Math.sin(r*this.g)/Math.sin(this.g),p=o*Math.cos(this.start.y)*Math.cos(this.start.x)+a*Math.cos(this.end.y)*Math.cos(this.end.x),y=o*Math.cos(this.start.y)*Math.sin(this.start.x)+a*Math.cos(this.end.y)*Math.sin(this.end.x),v=o*Math.sin(this.start.y)+a*Math.sin(this.end.y),b=Ee*Math.atan2(v,Math.sqrt(Math.pow(p,2)+Math.pow(y,2)));return[Ee*Math.atan2(y,p),b]},er.prototype.Arc=function(r,o){var a=[];if(!r||r<=2)a.push([this.start.lon,this.start.lat]),a.push([this.end.lon,this.end.lat]);else for(var p=1/(r-1),y=0;y<r;++y){var b=this.interpolate(p*y);a.push(b)}for(var I=!1,P=0,C=o&&o.offset?o.offset:10,O=180-C,k=-180+C,R=360-C,B=1;B<a.length;++B){var jt=a[B-1][0],Tt=a[B][0],de=Math.abs(Tt-jt);de>R&&(Tt>O&&jt<k||jt>O&&Tt<k)?I=!0:de>P&&(P=de)}var Yt=[];if(I&&P<C){var wt=[];Yt.push(wt);for(var Ut=0;Ut<a.length;++Ut){var xe=parseFloat(a[Ut][0]);if(Ut>0&&Math.abs(xe-a[Ut-1][0])>R){var ve=parseFloat(a[Ut-1][0]),ke=parseFloat(a[Ut-1][1]),Le=parseFloat(a[Ut][0]),Je=parseFloat(a[Ut][1]);if(ve>-180&&ve<k&&180===Le&&Ut+1<a.length&&a[Ut-1][0]>-180&&a[Ut-1][0]<k){wt.push([-180,a[Ut][1]]),Ut++,wt.push([a[Ut][0],a[Ut][1]]);continue}if(ve>O&&ve<180&&-180===Le&&Ut+1<a.length&&a[Ut-1][0]>O&&a[Ut-1][0]<180){wt.push([180,a[Ut][1]]),Ut++,wt.push([a[Ut][0],a[Ut][1]]);continue}if(ve<k&&Le>O){var ee=ve;ve=Le,Le=ee;var Fn=ke;ke=Je,Je=Fn}if(ve>O&&Le<k&&(Le+=360),ve<=180&&Le>=180&&ve<Le){var Qr=(180-ve)/(Le-ve),li=Qr*Je+(1-Qr)*ke;wt.push([a[Ut-1][0]>O?180:-180,li]),(wt=[]).push([a[Ut-1][0]>O?-180:180,li]),Yt.push(wt)}else Yt.push(wt=[]);wt.push([xe,a[Ut][1]])}else wt.push([a[Ut][0],a[Ut][1]])}}else{var _i=[];Yt.push(_i);for(var Or=0;Or<a.length;++Or)_i.push([a[Or][0],a[Or][1]])}for(var Rn=new We(this.properties),vn=0;vn<Yt.length;++vn){var Fo=new Fe;Rn.geometries.push(Fo);for(var ko=Yt[vn],Di=0;Di<ko.length;++Di)Fo.move_to(ko[Di])}return Rn},It(6952);var Ri=[],Zi=[],ji=[],Xi=[],Yi=[],Ti=[],Ji=[],Si=[],Fi=[],di=[],Ei=[],Hi=[],Wi=[],Ki=[],$i=[],Qi=[],to=[],eo=[],Ai=[],ro=[],yi=[],no=[],In=[],Ci=[];Ji[85]=di[85]=-1,Si[85]=Ei[85]=0,Fi[85]=Hi[85]=1,Ai[85]=no[85]=1,ro[85]=In[85]=0,yi[85]=Ci[85]=1,Ri[85]=Xi[85]=0,Zi[85]=Yi[85]=-1,ji[85]=$i[85]=0,Qi[85]=Wi[85]=0,to[85]=Ki[85]=1,Ti[85]=eo[85]=1,no[1]=no[169]=0,In[1]=In[169]=-1,Ci[1]=Ci[169]=0,Wi[1]=Wi[169]=-1,Ki[1]=Ki[169]=0,$i[1]=$i[169]=0,di[4]=di[166]=0,Ei[4]=Ei[166]=-1,Hi[4]=Hi[166]=1,Qi[4]=Qi[166]=1,to[4]=to[166]=0,eo[4]=eo[166]=0,Ji[16]=Ji[154]=0,Si[16]=Si[154]=1,Fi[16]=Fi[154]=1,Xi[16]=Xi[154]=1,Yi[16]=Yi[154]=0,Ti[16]=Ti[154]=1,Ai[64]=Ai[106]=0,ro[64]=ro[106]=1,yi[64]=yi[106]=0,Ri[64]=Ri[106]=-1,Zi[64]=Zi[106]=0,ji[64]=ji[106]=1,Ai[2]=Ai[168]=0,ro[2]=ro[168]=-1,yi[2]=yi[168]=1,no[2]=no[168]=0,In[2]=In[168]=-1,Ci[2]=Ci[168]=0,Wi[2]=Wi[168]=-1,Ki[2]=Ki[168]=0,$i[2]=$i[168]=0,Qi[2]=Qi[168]=-1,to[2]=to[168]=0,eo[2]=eo[168]=1,Ji[8]=Ji[162]=0,Si[8]=Si[162]=-1,Fi[8]=Fi[162]=0,di[8]=di[162]=0,Ei[8]=Ei[162]=-1,Hi[8]=Hi[162]=1,Wi[8]=Wi[162]=1,Ki[8]=Ki[162]=0,$i[8]=$i[162]=1,Qi[8]=Qi[162]=1,to[8]=to[162]=0,eo[8]=eo[162]=0,Ji[32]=Ji[138]=0,Si[32]=Si[138]=1,Fi[32]=Fi[138]=1,di[32]=di[138]=0,Ei[32]=Ei[138]=1,Hi[32]=Hi[138]=0,Ri[32]=Ri[138]=1,Zi[32]=Zi[138]=0,ji[32]=ji[138]=0,Xi[32]=Xi[138]=1,Yi[32]=Yi[138]=0,Ti[32]=Ti[138]=1,no[128]=no[42]=0,In[128]=In[42]=1,Ci[128]=Ci[42]=1,Ai[128]=Ai[42]=0,ro[128]=ro[42]=1,yi[128]=yi[42]=0,Ri[128]=Ri[42]=-1,Zi[128]=Zi[42]=0,ji[128]=ji[42]=1,Xi[128]=Xi[42]=-1,Yi[128]=Yi[42]=0,Ti[128]=Ti[42]=0,di[5]=di[165]=-1,Ei[5]=Ei[165]=0,Hi[5]=Hi[165]=0,no[5]=no[165]=1,In[5]=In[165]=0,Ci[5]=Ci[165]=0,Qi[20]=Qi[150]=0,to[20]=to[150]=1,eo[20]=eo[150]=1,Xi[20]=Xi[150]=0,Yi[20]=Yi[150]=-1,Ti[20]=Ti[150]=1,Ji[80]=Ji[90]=-1,Si[80]=Si[90]=0,Fi[80]=Fi[90]=1,Ai[80]=Ai[90]=1,ro[80]=ro[90]=0,yi[80]=yi[90]=1,Wi[65]=Wi[105]=0,Ki[65]=Ki[105]=1,$i[65]=$i[105]=0,Ri[65]=Ri[105]=0,Zi[65]=Zi[105]=-1,ji[65]=ji[105]=0,Ji[160]=Ji[10]=-1,Si[160]=Si[10]=0,Fi[160]=Fi[10]=1,di[160]=di[10]=-1,Ei[160]=Ei[10]=0,Hi[160]=Hi[10]=0,no[160]=no[10]=1,In[160]=In[10]=0,Ci[160]=Ci[10]=0,Ai[160]=Ai[10]=1,ro[160]=ro[10]=0,yi[160]=yi[10]=1,Qi[130]=Qi[40]=0,to[130]=to[40]=1,eo[130]=eo[40]=1,Wi[130]=Wi[40]=0,Ki[130]=Ki[40]=1,$i[130]=$i[40]=0,Ri[130]=Ri[40]=0,Zi[130]=Zi[40]=-1,ji[130]=ji[40]=0,Xi[130]=Xi[40]=0,Yi[130]=Yi[40]=-1,Ti[130]=Ti[40]=1,di[37]=di[133]=0,Ei[37]=Ei[133]=1,Hi[37]=Hi[133]=1,no[37]=no[133]=0,In[37]=In[133]=1,Ci[37]=Ci[133]=0,Ri[37]=Ri[133]=-1,Zi[37]=Zi[133]=0,ji[37]=ji[133]=0,Xi[37]=Xi[133]=1,Yi[37]=Yi[133]=0,Ti[37]=Ti[133]=0,Qi[148]=Qi[22]=-1,to[148]=to[22]=0,eo[148]=eo[22]=0,no[148]=no[22]=0,In[148]=In[22]=-1,Ci[148]=Ci[22]=1,Ai[148]=Ai[22]=0,ro[148]=ro[22]=1,yi[148]=yi[22]=1,Xi[148]=Xi[22]=-1,Yi[148]=Yi[22]=0,Ti[148]=Ti[22]=1,Ji[82]=Ji[88]=0,Si[82]=Si[88]=-1,Fi[82]=Fi[88]=1,Qi[82]=Qi[88]=1,to[82]=to[88]=0,eo[82]=eo[88]=1,Wi[82]=Wi[88]=-1,Ki[82]=Ki[88]=0,$i[82]=$i[88]=1,Ai[82]=Ai[88]=0,ro[82]=ro[88]=-1,yi[82]=yi[88]=0,Ji[73]=Ji[97]=0,Si[73]=Si[97]=1,Fi[73]=Fi[97]=0,di[73]=di[97]=0,Ei[73]=Ei[97]=-1,Hi[73]=Hi[97]=0,Wi[73]=Wi[97]=1,Ki[73]=Ki[97]=0,$i[73]=$i[97]=0,Ri[73]=Ri[97]=1,Zi[73]=Zi[97]=0,ji[73]=ji[97]=1,Ji[145]=Ji[25]=0,Si[145]=Si[25]=-1,Fi[145]=Fi[25]=0,Wi[145]=Wi[25]=1,Ki[145]=Ki[25]=0,$i[145]=$i[25]=1,no[145]=no[25]=0,In[145]=In[25]=1,Ci[145]=Ci[25]=1,Xi[145]=Xi[25]=-1,Yi[145]=Yi[25]=0,Ti[145]=Ti[25]=0,di[70]=di[100]=0,Ei[70]=Ei[100]=1,Hi[70]=Hi[100]=0,Qi[70]=Qi[100]=-1,to[70]=to[100]=0,eo[70]=eo[100]=1,Ai[70]=Ai[100]=0,ro[70]=ro[100]=-1,yi[70]=yi[100]=1,Ri[70]=Ri[100]=1,Zi[70]=Zi[100]=0,ji[70]=ji[100]=0,di[101]=di[69]=0,Ei[101]=Ei[69]=1,Hi[101]=Hi[69]=0,Ri[101]=Ri[69]=1,Zi[101]=Zi[69]=0,ji[101]=ji[69]=0,no[149]=no[21]=0,In[149]=In[21]=1,Ci[149]=Ci[21]=1,Xi[149]=Xi[21]=-1,Yi[149]=Yi[21]=0,Ti[149]=Ti[21]=0,Qi[86]=Qi[84]=-1,to[86]=to[84]=0,eo[86]=eo[84]=1,Ai[86]=Ai[84]=0,ro[86]=ro[84]=-1,yi[86]=yi[84]=1,Ji[89]=Ji[81]=0,Si[89]=Si[81]=-1,Fi[89]=Fi[81]=0,Wi[89]=Wi[81]=1,Ki[89]=Ki[81]=0,$i[89]=$i[81]=1,Ji[96]=Ji[74]=0,Si[96]=Si[74]=1,Fi[96]=Fi[74]=0,di[96]=di[74]=-1,Ei[96]=Ei[74]=0,Hi[96]=Hi[74]=1,Ai[96]=Ai[74]=1,ro[96]=ro[74]=0,yi[96]=yi[74]=0,Ri[96]=Ri[74]=1,Zi[96]=Zi[74]=0,ji[96]=ji[74]=1,Ji[24]=Ji[146]=0,Si[24]=Si[146]=-1,Fi[24]=Fi[146]=1,Qi[24]=Qi[146]=1,to[24]=to[146]=0,eo[24]=eo[146]=1,Wi[24]=Wi[146]=0,Ki[24]=Ki[146]=1,$i[24]=$i[146]=1,Xi[24]=Xi[146]=0,Yi[24]=Yi[146]=-1,Ti[24]=Ti[146]=0,di[6]=di[164]=-1,Ei[6]=Ei[164]=0,Hi[6]=Hi[164]=1,Qi[6]=Qi[164]=-1,to[6]=to[164]=0,eo[6]=eo[164]=0,no[6]=no[164]=0,In[6]=In[164]=-1,Ci[6]=Ci[164]=1,Ai[6]=Ai[164]=1,ro[6]=ro[164]=0,yi[6]=yi[164]=0,Wi[129]=Wi[41]=0,Ki[129]=Ki[41]=1,$i[129]=$i[41]=1,no[129]=no[41]=0,In[129]=In[41]=1,Ci[129]=Ci[41]=0,Ri[129]=Ri[41]=-1,Zi[129]=Zi[41]=0,ji[129]=ji[41]=0,Xi[129]=Xi[41]=0,Yi[129]=Yi[41]=-1,Ti[129]=Ti[41]=0,Qi[66]=Qi[104]=0,to[66]=to[104]=1,eo[66]=eo[104]=0,Wi[66]=Wi[104]=-1,Ki[66]=Ki[104]=0,$i[66]=$i[104]=1,Ai[66]=Ai[104]=0,ro[66]=ro[104]=-1,yi[66]=yi[104]=0,Ri[66]=Ri[104]=0,Zi[66]=Zi[104]=-1,ji[66]=ji[104]=1,Ji[144]=Ji[26]=-1,Si[144]=Si[26]=0,Fi[144]=Fi[26]=0,no[144]=no[26]=1,In[144]=In[26]=0,Ci[144]=Ci[26]=1,Ai[144]=Ai[26]=0,ro[144]=ro[26]=1,yi[144]=yi[26]=1,Xi[144]=Xi[26]=-1,Yi[144]=Yi[26]=0,Ti[144]=Ti[26]=1,di[36]=di[134]=0,Ei[36]=Ei[134]=1,Hi[36]=Hi[134]=1,Qi[36]=Qi[134]=0,to[36]=to[134]=1,eo[36]=eo[134]=0,Ri[36]=Ri[134]=0,Zi[36]=Zi[134]=-1,ji[36]=ji[134]=1,Xi[36]=Xi[134]=1,Yi[36]=Yi[134]=0,Ti[36]=Ti[134]=0,Ji[9]=Ji[161]=-1,Si[9]=Si[161]=0,Fi[9]=Fi[161]=0,di[9]=di[161]=0,Ei[9]=Ei[161]=-1,Hi[9]=Hi[161]=0,Wi[9]=Wi[161]=1,Ki[9]=Ki[161]=0,$i[9]=$i[161]=0,no[9]=no[161]=1,In[9]=In[161]=0,Ci[9]=Ci[161]=1,Ji[136]=0,Si[136]=1,Fi[136]=1,di[136]=0,Ei[136]=1,Hi[136]=0,Qi[136]=-1,to[136]=0,eo[136]=1,Wi[136]=-1,Ki[136]=0,$i[136]=0,no[136]=0,In[136]=-1,Ci[136]=0,Ai[136]=0,ro[136]=-1,yi[136]=1,Ri[136]=1,Zi[136]=0,ji[136]=0,Xi[136]=1,Yi[136]=0,Ti[136]=1,Ji[34]=0,Si[34]=-1,Fi[34]=0,di[34]=0,Ei[34]=-1,Hi[34]=1,Qi[34]=1,to[34]=0,eo[34]=0,Wi[34]=1,Ki[34]=0,$i[34]=1,no[34]=0,In[34]=1,Ci[34]=1,Ai[34]=0,ro[34]=1,yi[34]=0,Ri[34]=-1,Zi[34]=0,ji[34]=1,Xi[34]=-1,Yi[34]=0,Ti[34]=0,Ji[35]=0,Si[35]=1,Fi[35]=1,di[35]=0,Ei[35]=-1,Hi[35]=1,Qi[35]=1,to[35]=0,eo[35]=0,Wi[35]=-1,Ki[35]=0,$i[35]=0,no[35]=0,In[35]=-1,Ci[35]=0,Ai[35]=0,ro[35]=1,yi[35]=0,Ri[35]=-1,Zi[35]=0,ji[35]=1,Xi[35]=1,Yi[35]=0,Ti[35]=1,Ji[153]=0,Si[153]=1,Fi[153]=1,Wi[153]=-1,Ki[153]=0,$i[153]=0,no[153]=0,In[153]=-1,Ci[153]=0,Xi[153]=1,Yi[153]=0,Ti[153]=1,di[102]=0,Ei[102]=-1,Hi[102]=1,Qi[102]=1,to[102]=0,eo[102]=0,Ai[102]=0,ro[102]=1,yi[102]=0,Ri[102]=-1,Zi[102]=0,ji[102]=1,Ji[155]=0,Si[155]=-1,Fi[155]=0,Wi[155]=1,Ki[155]=0,$i[155]=1,no[155]=0,In[155]=1,Ci[155]=1,Xi[155]=-1,Yi[155]=0,Ti[155]=0,di[103]=0,Ei[103]=1,Hi[103]=0,Qi[103]=-1,to[103]=0,eo[103]=1,Ai[103]=0,ro[103]=-1,yi[103]=1,Ri[103]=1,Zi[103]=0,ji[103]=0,Ji[152]=0,Si[152]=1,Fi[152]=1,Qi[152]=-1,to[152]=0,eo[152]=1,Wi[152]=-1,Ki[152]=0,$i[152]=0,no[152]=0,In[152]=-1,Ci[152]=0,Ai[152]=0,ro[152]=-1,yi[152]=1,Xi[152]=1,Yi[152]=0,Ti[152]=1,Ji[156]=0,Si[156]=-1,Fi[156]=1,Qi[156]=1,to[156]=0,eo[156]=1,Wi[156]=-1,Ki[156]=0,$i[156]=0,no[156]=0,In[156]=-1,Ci[156]=0,Ai[156]=0,ro[156]=1,yi[156]=1,Xi[156]=-1,Yi[156]=0,Ti[156]=1,Ji[137]=0,Si[137]=1,Fi[137]=1,di[137]=0,Ei[137]=1,Hi[137]=0,Wi[137]=-1,Ki[137]=0,$i[137]=0,no[137]=0,In[137]=-1,Ci[137]=0,Ri[137]=1,Zi[137]=0,ji[137]=0,Xi[137]=1,Yi[137]=0,Ti[137]=1,Ji[139]=0,Si[139]=1,Fi[139]=1,di[139]=0,Ei[139]=-1,Hi[139]=0,Wi[139]=1,Ki[139]=0,$i[139]=0,no[139]=0,In[139]=1,Ci[139]=0,Ri[139]=-1,Zi[139]=0,ji[139]=0,Xi[139]=1,Yi[139]=0,Ti[139]=1,Ji[98]=0,Si[98]=-1,Fi[98]=0,di[98]=0,Ei[98]=-1,Hi[98]=1,Qi[98]=1,to[98]=0,eo[98]=0,Wi[98]=1,Ki[98]=0,$i[98]=1,Ai[98]=0,ro[98]=1,yi[98]=0,Ri[98]=-1,Zi[98]=0,ji[98]=1,Ji[99]=0,Si[99]=1,Fi[99]=0,di[99]=0,Ei[99]=-1,Hi[99]=1,Qi[99]=1,to[99]=0,eo[99]=0,Wi[99]=-1,Ki[99]=0,$i[99]=1,Ai[99]=0,ro[99]=-1,yi[99]=0,Ri[99]=1,Zi[99]=0,ji[99]=1,di[38]=0,Ei[38]=-1,Hi[38]=1,Qi[38]=1,to[38]=0,eo[38]=0,no[38]=0,In[38]=1,Ci[38]=1,Ai[38]=0,ro[38]=1,yi[38]=0,Ri[38]=-1,Zi[38]=0,ji[38]=1,Xi[38]=-1,Yi[38]=0,Ti[38]=0,di[39]=0,Ei[39]=1,Hi[39]=1,Qi[39]=-1,to[39]=0,eo[39]=0,no[39]=0,In[39]=-1,Ci[39]=1,Ai[39]=0,ro[39]=1,yi[39]=0,Ri[39]=-1,Zi[39]=0,ji[39]=1,Xi[39]=1,Yi[39]=0,Ti[39]=0;var Ph=function(r){return[[r.bottomleft,0],[0,0],[0,r.leftbottom]]},Mc=function(r){return[[1,r.rightbottom],[1,0],[r.bottomright,0]]},Tc=function(r){return[[r.topright,1],[1,1],[1,r.righttop]]},fc=function(r){return[[0,r.lefttop],[0,1],[r.topleft,1]]},Mh=function(r){return[[r.bottomright,0],[r.bottomleft,0],[0,r.leftbottom],[0,r.lefttop]]},Th=function(r){return[[r.bottomright,0],[r.bottomleft,0],[1,r.righttop],[1,r.rightbottom]]},dc=function(r){return[[1,r.righttop],[1,r.rightbottom],[r.topleft,1],[r.topright,1]]},$c=function(r){return[[0,r.leftbottom],[0,r.lefttop],[r.topleft,1],[r.topright,1]]},tn=[],Kr=[],Dn=[],yn=[],un=[],qn=[],zi=[],io=[];yn[1]=un[1]=18,yn[169]=un[169]=18,Dn[4]=Kr[4]=12,Dn[166]=Kr[166]=12,tn[16]=io[16]=4,tn[154]=io[154]=4,qn[64]=zi[64]=22,qn[106]=zi[106]=22,Dn[2]=qn[2]=17,yn[2]=un[2]=18,Dn[168]=qn[168]=17,yn[168]=un[168]=18,tn[8]=yn[8]=9,Kr[8]=Dn[8]=12,tn[162]=yn[162]=9,Kr[162]=Dn[162]=12,tn[32]=io[32]=4,Kr[32]=zi[32]=1,tn[138]=io[138]=4,Kr[138]=zi[138]=1,un[128]=io[128]=21,qn[128]=zi[128]=22,un[42]=io[42]=21,qn[42]=zi[42]=22,Kr[5]=un[5]=14,Kr[165]=un[165]=14,Dn[20]=io[20]=6,Dn[150]=io[150]=6,tn[80]=qn[80]=11,tn[90]=qn[90]=11,yn[65]=zi[65]=3,yn[105]=zi[105]=3,tn[160]=qn[160]=11,Kr[160]=un[160]=14,tn[10]=qn[10]=11,Kr[10]=un[10]=14,Dn[130]=io[130]=6,yn[130]=zi[130]=3,Dn[40]=io[40]=6,yn[40]=zi[40]=3,Kr[101]=zi[101]=1,Kr[69]=zi[69]=1,un[149]=io[149]=21,un[21]=io[21]=21,Dn[86]=qn[86]=17,Dn[84]=qn[84]=17,tn[89]=yn[89]=9,tn[81]=yn[81]=9,tn[96]=zi[96]=0,Kr[96]=qn[96]=15,tn[74]=zi[74]=0,Kr[74]=qn[74]=15,tn[24]=Dn[24]=8,yn[24]=io[24]=7,tn[146]=Dn[146]=8,yn[146]=io[146]=7,Kr[6]=qn[6]=15,Dn[6]=un[6]=16,Kr[164]=qn[164]=15,Dn[164]=un[164]=16,yn[129]=io[129]=7,un[129]=zi[129]=20,yn[41]=io[41]=7,un[41]=zi[41]=20,Dn[66]=zi[66]=2,yn[66]=qn[66]=19,Dn[104]=zi[104]=2,yn[104]=qn[104]=19,tn[144]=un[144]=10,qn[144]=io[144]=23,tn[26]=un[26]=10,qn[26]=io[26]=23,Kr[36]=io[36]=5,Dn[36]=zi[36]=2,Kr[134]=io[134]=5,Dn[134]=zi[134]=2,tn[9]=un[9]=10,Kr[9]=yn[9]=13,tn[161]=un[161]=10,Kr[161]=yn[161]=13,Kr[37]=io[37]=5,un[37]=zi[37]=20,Kr[133]=io[133]=5,un[133]=zi[133]=20,Dn[148]=un[148]=16,qn[148]=io[148]=23,Dn[22]=un[22]=16,qn[22]=io[22]=23,tn[82]=Dn[82]=8,yn[82]=qn[82]=19,tn[88]=Dn[88]=8,yn[88]=qn[88]=19,tn[73]=zi[73]=0,Kr[73]=yn[73]=13,tn[97]=zi[97]=0,Kr[97]=yn[97]=13,tn[145]=yn[145]=9,un[145]=io[145]=21,tn[25]=yn[25]=9,un[25]=io[25]=21,Kr[70]=zi[70]=1,Dn[70]=qn[70]=17,Kr[100]=zi[100]=1,Dn[100]=qn[100]=17,tn[34]=yn[34]=9,Kr[34]=Dn[34]=12,un[34]=io[34]=21,qn[34]=zi[34]=22,tn[136]=io[136]=4,Kr[136]=zi[136]=1,Dn[136]=qn[136]=17,yn[136]=un[136]=18,tn[35]=io[35]=4,Kr[35]=Dn[35]=12,yn[35]=un[35]=18,qn[35]=zi[35]=22,tn[153]=io[153]=4,yn[153]=un[153]=18,Kr[102]=Dn[102]=12,qn[102]=zi[102]=22,tn[155]=yn[155]=9,un[155]=io[155]=23,Kr[103]=zi[103]=1,Dn[103]=qn[103]=17,tn[152]=io[152]=4,Dn[152]=qn[152]=17,yn[152]=un[152]=18,tn[156]=Dn[156]=8,yn[156]=un[156]=18,qn[156]=io[156]=23,tn[137]=io[137]=4,Kr[137]=zi[137]=1,yn[137]=un[137]=18,tn[139]=io[139]=4,Kr[139]=yn[139]=13,un[139]=zi[139]=20,tn[98]=yn[98]=9,Kr[98]=Dn[98]=12,qn[98]=zi[98]=22,tn[99]=zi[99]=0,Kr[99]=Dn[99]=12,yn[99]=qn[99]=19,Kr[38]=Dn[38]=12,un[38]=io[38]=21,qn[38]=zi[38]=22,Kr[39]=io[39]=5,Dn[39]=un[39]=16,qn[39]=zi[39]=22;var Zr=[];function kc(r,o,a){return function su(r){return(r>0)-(r<0)||+r}((o[0]-r[0])*(a[1]-o[1])-(a[0]-o[0])*(o[1]-r[1]))}function Pu(r,o){return o.geometry.coordinates[0].every(function(a){return Hr(xn(a),r)})}Zr[1]=Zr[169]=Ph,Zr[4]=Zr[166]=Mc,Zr[16]=Zr[154]=Tc,Zr[64]=Zr[106]=fc,Zr[168]=Zr[2]=Mh,Zr[162]=Zr[8]=Th,Zr[138]=Zr[32]=dc,Zr[42]=Zr[128]=$c,Zr[5]=Zr[165]=function(r){return[[0,0],[0,r.leftbottom],[1,r.rightbottom],[1,0]]},Zr[20]=Zr[150]=function(r){return[[1,0],[r.bottomright,0],[r.topright,1],[1,1]]},Zr[80]=Zr[90]=function(r){return[[1,1],[1,r.righttop],[0,r.lefttop],[0,1]]},Zr[65]=Zr[105]=function(r){return[[r.bottomleft,0],[0,0],[0,1],[r.topleft,1]]},Zr[160]=Zr[10]=function(r){return[[1,r.righttop],[1,r.rightbottom],[0,r.leftbottom],[0,r.lefttop]]},Zr[130]=Zr[40]=function(r){return[[r.topleft,1],[r.topright,1],[r.bottomright,0],[r.bottomleft,0]]},Zr[85]=function(){return[[0,0],[0,1],[1,1],[1,0]]},Zr[101]=Zr[69]=function(r){return[[1,r.rightbottom],[1,0],[0,0],[0,1],[r.topleft,1]]},Zr[149]=Zr[21]=function(r){return[[r.topright,1],[1,1],[1,0],[0,0],[0,r.leftbottom]]},Zr[86]=Zr[84]=function(r){return[[1,0],[r.bottomright,0],[0,r.lefttop],[0,1],[1,1]]},Zr[89]=Zr[81]=function(r){return[[1,1],[1,r.righttop],[r.bottomleft,0],[0,0],[0,1]]},Zr[96]=Zr[74]=function(r){return[[1,r.righttop],[1,r.rightbottom],[0,r.lefttop],[0,1],[r.topleft,1]]},Zr[24]=Zr[146]=function(r){return[[1,1],[1,r.righttop],[r.bottomright,0],[r.bottomleft,0],[r.topright,1]]},Zr[6]=Zr[164]=function(r){return[[1,r.rightbottom],[1,0],[r.bottomright,0],[0,r.leftbottom],[0,r.lefttop]]},Zr[129]=Zr[41]=function(r){return[[r.topright,1],[r.bottomleft,0],[0,0],[0,r.leftbottom],[r.topleft,1]]},Zr[66]=Zr[104]=function(r){return[[r.bottomright,0],[r.bottomleft,0],[0,r.lefttop],[0,1],[r.topleft,1]]},Zr[144]=Zr[26]=function(r){return[[1,1],[1,r.righttop],[0,r.leftbottom],[0,r.lefttop],[r.topright,1]]},Zr[36]=Zr[134]=function(r){return[[1,r.rightbottom],[1,0],[r.bottomright,0],[r.topleft,1],[r.topright,1]]},Zr[9]=Zr[161]=function(r){return[[1,r.righttop],[1,r.rightbottom],[r.bottomleft,0],[0,0],[0,r.leftbottom]]},Zr[37]=Zr[133]=function(r){return[[1,r.rightbottom],[1,0],[0,0],[0,r.leftbottom],[r.topleft,1],[r.topright,1]]},Zr[148]=Zr[22]=function(r){return[[1,1],[1,0],[r.bottomright,0],[0,r.leftbottom],[0,r.lefttop],[r.topright,1]]},Zr[82]=Zr[88]=function(r){return[[1,1],[1,r.righttop],[r.bottomright,0],[r.bottomleft,0],[0,r.lefttop],[0,1]]},Zr[73]=Zr[97]=function(r){return[[1,r.righttop],[1,r.rightbottom],[r.bottomleft,0],[0,0],[0,1],[r.topleft,1]]},Zr[145]=Zr[25]=function(r){return[[1,1],[1,r.righttop],[r.bottomleft,0],[0,0],[0,r.leftbottom],[r.topright,1]]},Zr[70]=Zr[100]=function(r){return[[1,r.rightbottom],[1,0],[r.bottomright,0],[0,r.lefttop],[0,1],[r.topleft,1]]},Zr[34]=function(r){return[$c(r),Th(r)]},Zr[35]=function(r){return[[1,r.righttop],[1,r.rightbottom],[r.bottomright,0],[r.bottomleft,0],[0,r.leftbottom],[0,r.lefttop],[r.topleft,1],[r.topright,1]]},Zr[136]=function(r){return[dc(r),Mh(r)]},Zr[153]=function(r){return[Tc(r),Ph(r)]},Zr[102]=function(r){return[Mc(r),fc(r)]},Zr[155]=function(r){return[[1,1],[1,r.righttop],[r.bottomleft,0],[0,0],[0,r.leftbottom],[r.topright,1]]},Zr[103]=function(r){return[[1,r.rightbottom],[1,0],[r.bottomright,0],[0,r.lefttop],[0,1],[r.topleft,1]]},Zr[152]=function(r){return[Tc(r),Mh(r)]},Zr[156]=function(r){return[[1,1],[1,r.righttop],[r.bottomright,0],[r.bottomleft,0],[0,r.leftbottom],[0,r.lefttop],[r.topright,1]]},Zr[137]=function(r){return[dc(r),Ph(r)]},Zr[139]=function(r){return[[1,r.righttop],[1,r.rightbottom],[r.bottomleft,0],[0,0],[0,r.leftbottom],[r.topleft,1],[r.topright,1]]},Zr[98]=function(r){return[Th(r),fc(r)]},Zr[99]=function(r){return[[1,r.righttop],[1,r.rightbottom],[r.bottomright,0],[r.bottomleft,0],[0,r.lefttop],[0,1],[r.topleft,1]]},Zr[38]=function(r){return[Mc(r),$c(r)]},Zr[39]=function(r){return[[1,r.rightbottom],[1,0],[r.bottomright,0],[0,r.leftbottom],[0,r.lefttop],[r.topleft,1],[r.topright,1]]};const cf=function(){function r(o){this.id=r.buildId(o),this.coordinates=o,this.innerEdges=[],this.outerEdges=[],this.outerEdgesSorted=!1}return r.buildId=function(o){return o.join(",")},r.prototype.removeInnerEdge=function(o){this.innerEdges=this.innerEdges.filter(function(a){return a.from.id!==o.from.id})},r.prototype.removeOuterEdge=function(o){this.outerEdges=this.outerEdges.filter(function(a){return a.to.id!==o.to.id})},r.prototype.addOuterEdge=function(o){this.outerEdges.push(o),this.outerEdgesSorted=!1},r.prototype.sortOuterEdges=function(){var o=this;this.outerEdgesSorted||(this.outerEdges.sort(function(a,p){var y=a.to,v=p.to;if(y.coordinates[0]-o.coordinates[0]>=0&&v.coordinates[0]-o.coordinates[0]<0)return 1;if(y.coordinates[0]-o.coordinates[0]<0&&v.coordinates[0]-o.coordinates[0]>=0)return-1;if(y.coordinates[0]-o.coordinates[0]==0&&v.coordinates[0]-o.coordinates[0]==0)return y.coordinates[1]-o.coordinates[1]>=0||v.coordinates[1]-o.coordinates[1]>=0?y.coordinates[1]-v.coordinates[1]:v.coordinates[1]-y.coordinates[1];var b=kc(o.coordinates,y.coordinates,v.coordinates);return b<0?1:b>0?-1:Math.pow(y.coordinates[0]-o.coordinates[0],2)+Math.pow(y.coordinates[1]-o.coordinates[1],2)-(Math.pow(v.coordinates[0]-o.coordinates[0],2)+Math.pow(v.coordinates[1]-o.coordinates[1],2))}),this.outerEdgesSorted=!0)},r.prototype.getOuterEdges=function(){return this.sortOuterEdges(),this.outerEdges},r.prototype.getOuterEdge=function(o){return this.sortOuterEdges(),this.outerEdges[o]},r.prototype.addInnerEdge=function(o){this.innerEdges.push(o)},r}(),lp=function(){function r(o,a){this.from=o,this.to=a,this.next=void 0,this.label=void 0,this.symetric=void 0,this.ring=void 0,this.from.addOuterEdge(this),this.to.addInnerEdge(this)}return r.prototype.getSymetric=function(){return this.symetric||(this.symetric=new r(this.to,this.from),this.symetric.symetric=this),this.symetric},r.prototype.deleteEdge=function(){this.from.removeOuterEdge(this),this.to.removeInnerEdge(this)},r.prototype.isEqual=function(o){return this.from.id===o.from.id&&this.to.id===o.to.id},r.prototype.toString=function(){return"Edge { "+this.from.id+" -> "+this.to.id+" }"},r.prototype.toLineString=function(){return W([this.from.coordinates,this.to.coordinates])},r.prototype.compareTo=function(o){return kc(o.from.coordinates,o.to.coordinates,this.to.coordinates)},r}(),bd=function(){function r(){this.edges=[],this.polygon=void 0,this.envelope=void 0}return r.prototype.push=function(o){this.edges.push(o),this.polygon=this.envelope=void 0},r.prototype.get=function(o){return this.edges[o]},Object.defineProperty(r.prototype,"length",{get:function(){return this.edges.length},enumerable:!0,configurable:!0}),r.prototype.forEach=function(o){this.edges.forEach(o)},r.prototype.map=function(o){return this.edges.map(o)},r.prototype.some=function(o){return this.edges.some(o)},r.prototype.isValid=function(){return!0},r.prototype.isHole=function(){var o=this,a=this.edges.reduce(function(b,I,P){return I.from.coordinates[1]>o.edges[b].from.coordinates[1]&&(b=P),b},0),p=(0===a?this.length:a)-1,y=(a+1)%this.length,v=kc(this.edges[p].from.coordinates,this.edges[a].from.coordinates,this.edges[y].from.coordinates);return 0===v?this.edges[p].from.coordinates[0]>this.edges[y].from.coordinates[0]:v>0},r.prototype.toMultiPoint=function(){return function ae(r,o,a){return void 0===a&&(a={}),Gn({type:"MultiPoint",coordinates:r},o,a)}(this.edges.map(function(o){return o.from.coordinates}))},r.prototype.toPolygon=function(){if(this.polygon)return this.polygon;var o=this.edges.map(function(a){return a.from.coordinates});return o.push(this.edges[0].from.coordinates),this.polygon=oi([o])},r.prototype.getEnvelope=function(){return this.envelope?this.envelope:this.envelope=function ua(r){return function Zs(r,o){void 0===o&&(o={});var a=Number(r[0]),p=Number(r[1]),y=Number(r[2]),v=Number(r[3]);if(6===r.length)throw new Error("@turf/bbox-polygon does not support BBox with 6 positions");var b=[a,p];return oi([[b,[y,p],[y,v],[a,v],b]],o.properties,{bbox:r,id:o.id})}(Uo(r))}(this.toPolygon())},r.findEdgeRingContaining=function(o,a){var y,v,p=o.getEnvelope();return a.forEach(function(b){var I=b.getEnvelope();if(v&&(y=v.getEnvelope()),!function Oh(r,o){var a=r.geometry.coordinates[0].map(function(b){return b[0]}),p=r.geometry.coordinates[0].map(function(b){return b[1]}),y=o.geometry.coordinates[0].map(function(b){return b[0]}),v=o.geometry.coordinates[0].map(function(b){return b[1]});return Math.max.apply(null,a)===Math.max.apply(null,y)&&Math.max.apply(null,p)===Math.max.apply(null,v)&&Math.min.apply(null,a)===Math.min.apply(null,y)&&Math.min.apply(null,p)===Math.min.apply(null,v)}(I,p)&&Pu(I,p)){for(var P=o.map(function(jt){return jt.from.coordinates}),C=void 0,O=function(jt){b.some(function(Tt){return function uf(r,o){return r[0]===o[0]&&r[1]===o[1]}(jt,Tt.from.coordinates)})||(C=jt)},k=0,R=P;k<R.length;k++)O(R[k]);C&&b.inside(xn(C))&&(!v||Pu(y,I))&&(v=b)}}),v},r.prototype.inside=function(o){return Hr(o,this.toPolygon())},r}();function Ef(r){for(var o=r,a=[];o.parent;)a.unshift(o),o=o.parent;return a}!function(){function r(){this.edges=[],this.nodes={}}r.fromGeoJson=function(o){!function pf(r){if(!r)throw new Error("No geojson passed");if("FeatureCollection"!==r.type&&"GeometryCollection"!==r.type&&"MultiLineString"!==r.type&&"LineString"!==r.type&&"Feature"!==r.type)throw new Error("Invalid input type '"+r.type+"'. Geojson must be FeatureCollection, GeometryCollection, LineString, MultiLineString or Feature")}(o);var a=new r;return U(o,function(p){(function Oi(r,o,a){if(!r)throw new Error("No feature passed");if(!a)throw new Error(".featureOf() requires a name");if(!r||"Feature"!==r.type||!r.geometry)throw new Error("Invalid input to "+a+", Feature with geometry required");if(!r.geometry||r.geometry.type!==o)throw new Error("Invalid input to "+a+": must be a "+o+", given "+r.geometry.type)})(p,"LineString","Graph::fromGeoJson"),function Bn(r,o,a,p){var y=a;ss(r,function(v,b,I,P,C){y=0===b&&void 0===a?v:o(y,v,b,I,P,C)},p)}(p,function(y,v){if(y){var b=a.getNode(y),I=a.getNode(v);a.addEdge(b,I)}return v})}),a},r.prototype.getNode=function(o){var a=cf.buildId(o),p=this.nodes[a];return p||(p=this.nodes[a]=new cf(o)),p},r.prototype.addEdge=function(o,a){var p=new lp(o,a),y=p.getSymetric();this.edges.push(p),this.edges.push(y)},r.prototype.deleteDangles=function(){var o=this;Object.keys(this.nodes).map(function(a){return o.nodes[a]}).forEach(function(a){return o._removeIfDangle(a)})},r.prototype._removeIfDangle=function(o){var a=this;if(o.innerEdges.length<=1){var p=o.getOuterEdges().map(function(y){return y.to});this.removeNode(o),p.forEach(function(y){return a._removeIfDangle(y)})}},r.prototype.deleteCutEdges=function(){var o=this;this._computeNextCWEdges(),this._findLabeledEdgeRings(),this.edges.forEach(function(a){a.label===a.symetric.label&&(o.removeEdge(a.symetric),o.removeEdge(a))})},r.prototype._computeNextCWEdges=function(o){var a=this;typeof o>"u"?Object.keys(this.nodes).forEach(function(p){return a._computeNextCWEdges(a.nodes[p])}):o.getOuterEdges().forEach(function(p,y){o.getOuterEdge((0===y?o.getOuterEdges().length:y)-1).symetric.next=p})},r.prototype._computeNextCCWEdges=function(o,a){for(var y,v,p=o.getOuterEdges(),b=p.length-1;b>=0;--b){var I=p[b],P=I.symetric,C=void 0,O=void 0;I.label===a&&(C=I),P.label===a&&(O=P),C&&O&&(O&&(v=O),C&&(v&&(v.next=C,v=void 0),y||(y=C)))}v&&(v.next=y)},r.prototype._findLabeledEdgeRings=function(){var o=[],a=0;return this.edges.forEach(function(p){if(!(p.label>=0)){o.push(p);var y=p;do{y.label=a,y=y.next}while(!p.isEqual(y));a++}}),o},r.prototype.getEdgeRings=function(){var o=this;this._computeNextCWEdges(),this.edges.forEach(function(p){p.label=void 0}),this._findLabeledEdgeRings().forEach(function(p){o._findIntersectionNodes(p).forEach(function(y){o._computeNextCCWEdges(y,p.label)})});var a=[];return this.edges.forEach(function(p){p.ring||a.push(o._findEdgeRing(p))}),a},r.prototype._findIntersectionNodes=function(o){var a=[],p=o,y=function(){var v=0;p.from.getOuterEdges().forEach(function(b){b.label===o.label&&++v}),v>1&&a.push(p.from),p=p.next};do{y()}while(!o.isEqual(p));return a},r.prototype._findEdgeRing=function(o){var a=o,p=new bd;do{p.push(a),a.ring=p,a=a.next}while(!o.isEqual(a));return p},r.prototype.removeNode=function(o){var a=this;o.getOuterEdges().forEach(function(p){return a.removeEdge(p)}),o.innerEdges.forEach(function(p){return a.removeEdge(p)}),delete this.nodes[o.id]},r.prototype.removeEdge=function(o){this.edges=this.edges.filter(function(a){return!a.isEqual(o)}),o.deleteEdge()}}(),It(5013),It(7470),It(9475);var sh={search:function(r,o,a,p){r.cleanDirty();var y=(p=p||{}).heuristic||sh.heuristics.manhattan,v=p.closest||!1,b=function Ld(){return new _p(function(r){return r.f})}(),I=o;for(o.h=y(o,a),b.push(o);b.size()>0;){var P=b.pop();if(P===a)return Ef(P);P.closed=!0;for(var C=r.neighbors(P),O=0,k=C.length;O<k;++O){var R=C[O];if(!R.closed&&!R.isWall()){var B=P.g+R.getCost(P),jt=R.visited;(!jt||B<R.g)&&(R.visited=!0,R.parent=P,R.h=R.h||y(R,a),R.g=B,R.f=R.g+R.h,r.markDirty(R),v&&(R.h<I.h||R.h===I.h&&R.g<I.g)&&(I=R),jt?b.rescoreElement(R):b.push(R))}}}return v?Ef(I):[]},heuristics:{manhattan:function(r,o){return Math.abs(o.x-r.x)+Math.abs(o.y-r.y)},diagonal:function(r,o){var p=Math.sqrt(2),y=Math.abs(o.x-r.x),v=Math.abs(o.y-r.y);return 1*(y+v)+(p-2)*Math.min(y,v)}},cleanNode:function(r){r.f=0,r.g=0,r.h=0,r.visited=!1,r.closed=!1,r.parent=null}};function mc(r,o){o=o||{},this.nodes=[],this.diagonal=!!o.diagonal,this.grid=[];for(var a=0;a<r.length;a++){this.grid[a]=[];for(var p=0,y=r[a];p<y.length;p++){var v=new uh(a,p,y[p]);this.grid[a][p]=v,this.nodes.push(v)}}this.init()}function uh(r,o,a){this.x=r,this.y=o,this.weight=a}function _p(r){this.content=[],this.scoreFunction=r}function Kl(){this._=null}function lh(r){r.U=r.C=r.L=r.R=r.P=r.N=null}function ma(r,o){var a=o,p=o.R,y=a.U;y?y.L===a?y.L=p:y.R=p:r._=p,p.U=y,a.U=p,a.R=p.L,a.R&&(a.R.U=a),p.L=a}function Do(r,o){var a=o,p=o.L,y=a.U;y?y.L===a?y.L=p:y.R=p:r._=p,p.U=y,a.U=p,a.L=p.R,a.L&&(a.L.U=a),p.R=a}function bp(r){for(;r.L;)r=r.L;return r}mc.prototype.init=function(){this.dirtyNodes=[];for(var r=0;r<this.nodes.length;r++)sh.cleanNode(this.nodes[r])},mc.prototype.cleanDirty=function(){for(var r=0;r<this.dirtyNodes.length;r++)sh.cleanNode(this.dirtyNodes[r]);this.dirtyNodes=[]},mc.prototype.markDirty=function(r){this.dirtyNodes.push(r)},mc.prototype.neighbors=function(r){var o=[],a=r.x,p=r.y,y=this.grid;return y[a-1]&&y[a-1][p]&&o.push(y[a-1][p]),y[a+1]&&y[a+1][p]&&o.push(y[a+1][p]),y[a]&&y[a][p-1]&&o.push(y[a][p-1]),y[a]&&y[a][p+1]&&o.push(y[a][p+1]),this.diagonal&&(y[a-1]&&y[a-1][p-1]&&o.push(y[a-1][p-1]),y[a+1]&&y[a+1][p-1]&&o.push(y[a+1][p-1]),y[a-1]&&y[a-1][p+1]&&o.push(y[a-1][p+1]),y[a+1]&&y[a+1][p+1]&&o.push(y[a+1][p+1])),o},mc.prototype.toString=function(){for(var a,p,y,v,r=[],o=this.grid,b=0,I=o.length;b<I;b++){for(a=[],y=0,v=(p=o[b]).length;y<v;y++)a.push(p[y].weight);r.push(a.join(" "))}return r.join("\n")},uh.prototype.toString=function(){return"["+this.x+" "+this.y+"]"},uh.prototype.getCost=function(r){return r&&r.x!==this.x&&r.y!==this.y?1.41421*this.weight:this.weight},uh.prototype.isWall=function(){return 0===this.weight},_p.prototype={push:function(r){this.content.push(r),this.sinkDown(this.content.length-1)},pop:function(){var r=this.content[0],o=this.content.pop();return this.content.length>0&&(this.content[0]=o,this.bubbleUp(0)),r},remove:function(r){var o=this.content.indexOf(r),a=this.content.pop();o!==this.content.length-1&&(this.content[o]=a,this.scoreFunction(a)<this.scoreFunction(r)?this.sinkDown(o):this.bubbleUp(o))},size:function(){return this.content.length},rescoreElement:function(r){this.sinkDown(this.content.indexOf(r))},sinkDown:function(r){for(var o=this.content[r];r>0;){var a=(r+1>>1)-1,p=this.content[a];if(!(this.scoreFunction(o)<this.scoreFunction(p)))break;this.content[a]=o,this.content[r]=p,r=a}},bubbleUp:function(r){for(var o=this.content.length,a=this.content[r],p=this.scoreFunction(a);;){var I,y=r+1<<1,v=y-1,b=null;if(v<o&&(I=this.scoreFunction(this.content[v]))<p&&(b=v),y<o&&this.scoreFunction(this.content[y])<(null===b?p:I)&&(b=y),null===b)break;this.content[r]=this.content[b],this.content[b]=a,r=b}}},Kl.prototype={constructor:Kl,insert:function(r,o){var a,p,y;if(r){if(o.P=r,o.N=r.N,r.N&&(r.N.P=o),r.N=o,r.R){for(r=r.R;r.L;)r=r.L;r.L=o}else r.R=o;a=r}else this._?(r=bp(this._),o.P=null,o.N=r,r.P=r.L=o,a=r):(o.P=o.N=null,this._=o,a=null);for(o.L=o.R=null,o.U=a,o.C=!0,r=o;a&&a.C;)a===(p=a.U).L?(y=p.R)&&y.C?(a.C=y.C=!1,p.C=!0,r=p):(r===a.R&&(ma(this,a),a=(r=a).U),a.C=!1,p.C=!0,Do(this,p)):(y=p.L)&&y.C?(a.C=y.C=!1,p.C=!0,r=p):(r===a.L&&(Do(this,a),a=(r=a).U),a.C=!1,p.C=!0,ma(this,p)),a=r.U;this._.C=!1},remove:function(r){r.N&&(r.N.P=r.P),r.P&&(r.P.N=r.N),r.N=r.P=null;var a,v,b,o=r.U,p=r.L,y=r.R;if(v=p?y?bp(y):p:y,o?o.L===r?o.L=v:o.R=v:this._=v,p&&y?(b=v.C,v.C=r.C,v.L=p,p.U=v,v!==y?(o=v.U,v.U=r.U,o.L=r=v.R,v.R=y,y.U=v):(v.U=o,o=v,r=v.R)):(b=r.C,r=v),r&&(r.U=o),!b){if(r&&r.C)return void(r.C=!1);do{if(r===this._)break;if(r===o.L){if((a=o.R).C&&(a.C=!1,o.C=!0,ma(this,o),a=o.R),a.L&&a.L.C||a.R&&a.R.C){(!a.R||!a.R.C)&&(a.L.C=!1,a.C=!0,Do(this,a),a=o.R),a.C=o.C,o.C=a.R.C=!1,ma(this,o),r=this._;break}}else if((a=o.L).C&&(a.C=!1,o.C=!0,Do(this,o),a=o.L),a.L&&a.L.C||a.R&&a.R.C){(!a.L||!a.L.C)&&(a.R.C=!1,a.C=!0,ma(this,a),a=o.L),a.C=o.C,o.C=a.L.C=!1,Do(this,o),r=this._;break}a.C=!0,r=o,o=o.U}while(!r.C);r&&(r.C=!1)}}};const wp=Kl;function Fc(r,o,a,p){var y=[null,null],v=q.push(y)-1;return y.left=r,y.right=o,a&&ch(y,r,o,a),p&&ch(y,o,r,p),A[r.index].halfedges.push(v),A[o.index].halfedges.push(v),y}function zc(r,o,a){var p=[o,a];return p.left=r,p}function ch(r,o,a,p){r[0]||r[1]?r.left===a?r[1]=p:r[0]=p:(r[0]=p,r.left=o,r.right=a)}function Ep(r,o,a,p,y){var Tt,v=r[0],b=r[1],I=v[0],P=v[1],k=0,R=1,B=b[0]-I,jt=b[1]-P;if(Tt=o-I,B||!(Tt>0)){if(Tt/=B,B<0){if(Tt<k)return;Tt<R&&(R=Tt)}else if(B>0){if(Tt>R)return;Tt>k&&(k=Tt)}if(Tt=p-I,B||!(Tt<0)){if(Tt/=B,B<0){if(Tt>R)return;Tt>k&&(k=Tt)}else if(B>0){if(Tt<k)return;Tt<R&&(R=Tt)}if(Tt=a-P,jt||!(Tt>0)){if(Tt/=jt,jt<0){if(Tt<k)return;Tt<R&&(R=Tt)}else if(jt>0){if(Tt>R)return;Tt>k&&(k=Tt)}if(Tt=y-P,jt||!(Tt<0)){if(Tt/=jt,jt<0){if(Tt>R)return;Tt>k&&(k=Tt)}else if(jt>0){if(Tt<k)return;Tt<R&&(R=Tt)}return!(k>0)&&!(R<1)||(k>0&&(r[0]=[I+k*B,P+k*jt]),R<1&&(r[1]=[I+R*B,P+R*jt])),!0}}}}}function vc(r,o,a,p,y){var v=r[1];if(v)return!0;var Tt,de,b=r[0],I=r.left,P=r.right,C=I[0],O=I[1],k=P[0],R=P[1],B=(C+k)/2;if(R===O){if(B<o||B>=p)return;if(C>k){if(b){if(b[1]>=y)return}else b=[B,a];v=[B,y]}else{if(b){if(b[1]<a)return}else b=[B,y];v=[B,a]}}else if(de=(O+R)/2-(Tt=(C-k)/(R-O))*B,Tt<-1||Tt>1)if(C>k){if(b){if(b[1]>=y)return}else b=[(a-de)/Tt,a];v=[(y-de)/Tt,y]}else{if(b){if(b[1]<a)return}else b=[(y-de)/Tt,y];v=[(a-de)/Tt,a]}else if(O<R){if(b){if(b[0]>=p)return}else b=[o,Tt*o+de];v=[p,Tt*p+de]}else{if(b){if(b[0]<o)return}else b=[p,Tt*p+de];v=[o,Tt*o+de]}return r[0]=b,r[1]=v,!0}function ns(r,o){var a=r.site,p=o.left,y=o.right;return a===y&&(y=p,p=a),y?Math.atan2(y[1]-p[1],y[0]-p[0]):(a===p?(p=o[1],y=o[0]):(p=o[0],y=o[1]),Math.atan2(p[0]-y[0],y[1]-p[1]))}function Bc(r,o){return o[+(o.left!==r.site)]}function Fl(r,o){return o[+(o.left===r.site)]}var $l,qh=[];function zl(){lh(this),this.x=this.y=this.arc=this.site=this.cy=null}function xc(r){var o=r.P,a=r.N;if(o&&a){var p=o.site,y=r.site,v=a.site;if(p!==v){var b=y[0],I=y[1],P=p[0]-b,C=p[1]-I,O=v[0]-b,k=v[1]-I,R=2*(P*k-C*O);if(!(R>=-w)){var B=P*P+C*C,jt=O*O+k*k,Tt=(k*B-C*jt)/R,de=(P*jt-O*B)/R,Yt=qh.pop()||new zl;Yt.arc=r,Yt.site=y,Yt.x=Tt+b,Yt.y=(Yt.cy=de+I)+Math.sqrt(Tt*Tt+de*de),r.circle=Yt;for(var wt=null,Ut=z._;Ut;)if(Yt.y<Ut.y||Yt.y===Ut.y&&Yt.x<=Ut.x){if(!Ut.L){wt=Ut.P;break}Ut=Ut.L}else{if(!Ut.R){wt=Ut;break}Ut=Ut.R}z.insert(wt,Yt),wt||($l=Yt)}}}}function bc(r){var o=r.circle;o&&(o.P||($l=o.N),z.remove(o),qh.push(o),lh(o),r.circle=null)}var If=[];function Ss(){lh(this),this.edge=this.site=this.circle=null}function Bl(r){var o=If.pop()||new Ss;return o.site=r,o}function Gh(r){bc(r),S.remove(r),If.push(r),lh(r)}function t(r){var o=r.circle,a=o.x,p=o.cy,y=[a,p],v=r.P,b=r.N,I=[r];Gh(r);for(var P=v;P.circle&&Math.abs(a-P.circle.x)<_&&Math.abs(p-P.circle.cy)<_;)v=P.P,I.unshift(P),Gh(P),P=v;I.unshift(P),bc(P);for(var C=b;C.circle&&Math.abs(a-C.circle.x)<_&&Math.abs(p-C.circle.cy)<_;)b=C.N,I.push(C),Gh(C),C=b;I.push(C),bc(C);var k,O=I.length;for(k=1;k<O;++k)ch((C=I[k]).edge,(P=I[k-1]).site,C.site,y);(C=I[O-1]).edge=Fc((P=I[0]).site,C.site,null,y),xc(P),xc(C)}function n(r){for(var p,y,v,b,o=r[0],a=r[1],I=S._;I;)if((v=u(I,a)-o)>_)I=I.L;else{if(!((b=o-g(I,a))>_)){v>-_?(p=I.P,y=I):b>-_?(p=I,y=I.N):p=y=I;break}if(!I.R){p=I;break}I=I.R}!function Cf(r){A[r.index]={site:r,halfedges:[]}}(r);var P=Bl(r);if(S.insert(p,P),p||y){if(p===y)return bc(p),y=Bl(p.site),S.insert(P,y),P.edge=y.edge=Fc(p.site,P.site),xc(p),void xc(y);if(!y)return void(P.edge=Fc(p.site,P.site));bc(p),bc(y);var C=p.site,O=C[0],k=C[1],R=r[0]-O,B=r[1]-k,jt=y.site,Tt=jt[0]-O,de=jt[1]-k,Yt=2*(R*de-B*Tt),wt=R*R+B*B,Ut=Tt*Tt+de*de,xe=[(de*wt-B*Ut)/Yt+O,(R*Ut-Tt*wt)/Yt+k];ch(y.edge,C,jt,xe),P.edge=Fc(C,r,null,xe),y.edge=Fc(r,jt,null,xe),xc(p),xc(y)}}function u(r,o){var a=r.site,p=a[0],y=a[1],v=y-o;if(!v)return p;var b=r.P;if(!b)return-1/0;var I=(a=b.site)[0],P=a[1],C=P-o;if(!C)return I;var O=I-p,k=1/v-1/C,R=O/C;return k?(-R+Math.sqrt(R*R-2*k*(O*O/(-2*C)-P+C/2+y-v/2)))/k+p:(p+I)/2}function g(r,o){var a=r.N;if(a)return u(a,o);var p=r.site;return p[1]===o?p[0]:1/0}var S,A,z,q,_=1e-6,w=1e-12;function V(r,o,a){return(r[0]-a[0])*(o[1]-r[1])-(r[0]-o[0])*(a[1]-r[1])}function H(r,o){return o[1]-r[1]||o[0]-r[0]}function st(r,o){var p,y,v,a=r.sort(H).pop();for(q=[],A=new Array(r.length),S=new wp,z=new wp;;)if(v=$l,a&&(!v||a[1]<v.y||a[1]===v.y&&a[0]<v.x))(a[0]!==p||a[1]!==y)&&(n(a),p=a[0],y=a[1]),a=r.pop();else{if(!v)break;t(v.arc)}if(function Bh(){for(var a,p,y,v,r=0,o=A.length;r<o;++r)if((a=A[r])&&(v=(p=a.halfedges).length)){var b=new Array(v),I=new Array(v);for(y=0;y<v;++y)b[y]=y,I[y]=ns(a,q[p[y]]);for(b.sort(function(P,C){return I[C]-I[P]}),y=0;y<v;++y)I[y]=p[b[y]];for(y=0;y<v;++y)p[y]=I[y]}}(),o){var b=+o[0][0],I=+o[0][1],P=+o[1][0],C=+o[1][1];(function _c(r,o,a,p){for(var v,y=q.length;y--;)vc(v=q[y],r,o,a,p)&&Ep(v,r,o,a,p)&&(Math.abs(v[0][0]-v[1][0])>_||Math.abs(v[0][1]-v[1][1])>_)||delete q[y]})(b,I,P,C),function Uh(r,o,a,p){var v,b,I,P,C,O,k,R,B,jt,Tt,de,y=A.length,Yt=!0;for(v=0;v<y;++v)if(b=A[v]){for(I=b.site,P=(C=b.halfedges).length;P--;)q[C[P]]||C.splice(P,1);for(P=0,O=C.length;P<O;)Tt=(jt=Fl(b,q[C[P]]))[0],de=jt[1],R=(k=Bc(b,q[C[++P%O]]))[0],B=k[1],(Math.abs(Tt-R)>_||Math.abs(de-B)>_)&&(C.splice(P,0,q.push(zc(I,jt,Math.abs(Tt-r)<_&&p-de>_?[r,Math.abs(R-r)<_?B:p]:Math.abs(de-p)<_&&a-Tt>_?[Math.abs(B-p)<_?R:a,p]:Math.abs(Tt-a)<_&&de-o>_?[a,Math.abs(R-a)<_?B:o]:Math.abs(de-o)<_&&Tt-r>_?[Math.abs(B-o)<_?R:r,o]:null))-1),++O);O&&(Yt=!1)}if(Yt){var wt,Ut,xe,ve=1/0;for(v=0,Yt=null;v<y;++v)(b=A[v])&&(xe=(wt=(I=b.site)[0]-r)*wt+(Ut=I[1]-o)*Ut)<ve&&(ve=xe,Yt=b);if(Yt){var ke=[r,o],Le=[r,p],Je=[a,p],ee=[a,o];Yt.halfedges.push(q.push(zc(I=Yt.site,ke,Le))-1,q.push(zc(I,Le,Je))-1,q.push(zc(I,Je,ee))-1,q.push(zc(I,ee,ke))-1)}}for(v=0;v<y;++v)(b=A[v])&&(b.halfedges.length||delete A[v])}(b,I,P,C)}this.edges=q,this.cells=A,S=z=q=A=null}function Vu(){return new Gl}function Gl(){this.reset()}st.prototype={constructor:st,polygons:function(){var r=this.edges;return this.cells.map(function(o){var a=o.halfedges.map(function(p){return Bc(o,r[p])});return a.data=o.site.data,a})},triangles:function(){var r=[],o=this.edges;return this.cells.forEach(function(a,p){if(I=(v=a.halfedges).length)for(var v,I,P,y=a.site,b=-1,C=o[v[I-1]],O=C.left===y?C.right:C.left;++b<I;)P=O,O=(C=o[v[b]]).left===y?C.right:C.left,P&&O&&p<P.index&&p<O.index&&V(y,P,O)<0&&r.push([y.data,P.data,O.data])}),r},links:function(){return this.edges.filter(function(r){return r.right}).map(function(r){return{source:r.left.data,target:r.right.data}})},find:function(r,o,a){for(var y,I,p=this,v=p._found||0,b=p.cells.length;!(I=p.cells[v]);)if(++v>=b)return null;var P=r-I.site[0],C=o-I.site[1],O=P*P+C*C;do{I=p.cells[y=v],v=null,I.halfedges.forEach(function(k){var R=p.edges[k],B=R.left;if(B!==I.site&&B||(B=R.right)){var jt=r-B[0],Tt=o-B[1],de=jt*jt+Tt*Tt;de<O&&(O=de,v=B.index)}})}while(null!==v);return p._found=y,null==a||O<=a*a?I.site:null}},It(9855),It(770),Gl.prototype={constructor:Gl,reset:function(){this.s=this.t=0},add:function(r){wc(ol,r,this.t),wc(this,ol.s,this.s),this.s?this.t+=ol.t:this.s=ol.t},valueOf:function(){return this.s}};var ol=new Gl;function wc(r,o,a){var p=r.s=o+a,y=p-o;r.t=o-(p-y)+(a-y)}var va=Math.PI,xu=va/2,Zu=2*va,ta=va/180,Ml=(Math,Math.atan),Vl=Math.atan2,_o=Math.cos,Pi=(Math,Math,Math,Math,Math,Math.sin),ju=(Math,Math.sqrt);Math;function Tl(r){return r>1?xu:r<-1?-xu:Math.asin(r)}function Nd(r,o){return[r>va?r-Zu:r<-va?r+Zu:r,o]}function Ag(r,o){return r<o?-1:r>o?1:r>=o?0:NaN}Vu(),Vu(),Vu(),Nd.invert=Nd,function Cm(r){1===r.length&&(r=function Im(r){return function(o,a){return Ag(r(o),a)}}(r))}(Ag),Math.sqrt(50),Math.sqrt(10),Math.sqrt(2);Vu();function tg(){}function rm(r){return function(o,a){var p=_o(o),y=_o(a),v=r(p*y);return[v*y*Pi(o),v*Pi(a)]}}function jp(r){return function(o,a){var p=ju(o*o+a*a),y=r(p),v=Pi(y),b=_o(y);return[Vl(o*v,p*b),Tl(p&&a*v/p)]}}function rg(r,o){return[r,o]}Vu(),Vu(),Vu(),Vu(),function Qg(r){return"m0,"+r+"a"+r+","+r+" 0 1,1 0,"+-2*r+"a"+r+","+r+" 0 1,1 0,"+2*r+"z"}(4.5),tg.prototype={constructor:tg,point:function(r,o){this.stream.point(r,o)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}},_o(30*ta),function tm(r){return function(o){var a=new tg;for(var p in r)a[p]=r[p];return a.stream=o,a}}({point:function(r,o){this.stream.point(r*ta,o*ta)}}),rm(function(r){return ju(2/(1+r))}).invert=jp(function(r){return 2*Tl(r/2)}),rm(function(r){return(r=function Gc(r){return r>1?0:r<-1?va:Math.acos(r)}(r))&&r/Pi(r)}).invert=jp(function(r){return r}),rg.invert=rg,jp(Ml),jp(Tl),jp(function(r){return 2*Ml(r)});const Wc=Object.assign({},Bi);Wc.onSetup=function(){const r=this.newFeature({type:"Feature",properties:{},geometry:{type:"LineString",coordinates:[[]]}});return this.addFeature(r),this.clearSelectedFeatures(),setTimeout(()=>{!this.map||!this.map.dragPan||this.map.dragPan.disable()},0),this.updateUIClasses({mouse:"add"}),this.activateUIButton("line_string"),this.setActionableState({trash:!0}),{line:r,currentVertexPosition:0,dragMoving:!1}};var Xp=0;Wc.onDrag=Wc.onTouchMove=function(r,o){r.dragMoving=!0,this.updateUIClasses({mouse:"add"}),Xp||(Xp=+new Date,console.log(Xp));let a=new Date;a-Xp>=150&&(r.line.updateCoordinate(r.currentVertexPosition,o.lngLat.lng,o.lngLat.lat),"forward"===r.direction?(r.currentVertexPosition++,r.line.updateCoordinate(r.currentVertexPosition,o.lngLat.lng,o.lngLat.lat)):r.line.addCoordinate(0,o.lngLat.lng,o.lngLat.lat),Xp=a)},Wc.onMouseUp=function(r,o){r.dragMoving&&(console.log(r),this.bezierSpline(r.line),this.fireUpdate(),this.changeMode("simple_select",{featureIds:[r.line.id]}))},Wc.onTouchEnd=function(r,o){this.onMouseUp(r,o)},Wc.fireUpdate=function(){this.map.fire("draw.update",{action:"move",features:this.getSelected().map(r=>r.toGeoJSON())})},Wc.bezierSpline=function(r){!function As(r,o){void 0===o&&(o={});for(var a=o.resolution||1e4,p=o.sharpness||.85,y=[],v=kn(r).coordinates.map(function(C){return{x:C[0],y:C[1]}}),b=new Ga({duration:a,points:v,sharpness:p}),I=function(C){var O=b.pos(C);Math.floor(C/100)%2==0&&y.push([O.x,O.y])},P=0;P<b.duration;P+=10)I(P);I(b.duration),W(y,o.properties)}(r)};const _y=Wc;var xy=It(9990),by=It.n(xy),dm=It(3990);let Yf=(()=>{class r{constructor(){this.getCircleFeature=new s.vpe,this.style={version:8,sources:{osm:{type:"raster",tiles:["https://a.tile.openstreetmap.org/{z}/{x}/{y}.png"],tileSize:256,attribution:"&copy; OpenStreetMap Contributors",maxzoom:19}},glyphs:"https://fonts.openmaptiles.org/{fontstack}/{range}.pbf",layers:[{id:"osm",type:"raster",source:"osm"}]}}setDrawCircleMode(){const p=v=>function si(r,o,a){void 0===a&&(a={});for(var p=a.steps||64,y=a.properties?a.properties:!Array.isArray(r)&&"Feature"===r.type&&r.properties?r.properties:{},v=[],b=0;b<p;b++)v.push(bi(r,o,-360*b/p,a).geometry.coordinates);return v.push(v[0]),oi([v],y)}(v.geometry.coordinates[0],bs(v));return{...fe.modes.draw_line_string,clickAnywhere:function(v,b){return 1===v.currentVertexPosition?(v.line.addCoordinate(0,b.lngLat.lng,b.lngLat.lat),this.changeMode("simple_select",{featureIds:[v.line.id]})):(v.line.updateCoordinate(v.currentVertexPosition,b.lngLat.lng,b.lngLat.lat),"forward"===v.direction?(v.currentVertexPosition+=1,v.line.updateCoordinate(v.currentVertexPosition,b.lngLat.lng,b.lngLat.lat)):v.line.addCoordinate(0,b.lngLat.lng,b.lngLat.lat),null)},onStop:v=>{if(v.line.removeCoordinate("0"),v.line.isValid()){const b=v.line.toGeoJSON(),I=p(b);this.getCircleFeature.emit(JSON.parse(JSON.stringify({...I}))),this.map.fire("draw.create",{features:[I]}),this.draw.deleteAll()}else this.draw.deleteAll()},toDisplayFeatures:function(v,b,I){if(b.geometry.coordinates.length<2)return null;I({type:"Feature",properties:{active:"true"},geometry:{type:"Point",coordinates:b.geometry.coordinates[0]}}),b.properties.active="true",I(b);const P=(v=>{const b=1e3*bs(v);let C,R,I="m",P="0,0",O="ft",k="0,0";return C=b,b>=1e3&&(C=b/1e3,I="km",P="0.00"),R=3.28084*b,R>=5280&&(R/=5280,O="mi",k="0.00"),{metric:`${dm(C).format(P)} ${I}`,standard:`${dm(R).format(k)} ${O}`}})(b);I({type:"Feature",properties:{meta:"currentPosition",radius:`${P.metric} ${P.standard}`,parent:v.line.id},geometry:{type:"Point",coordinates:b.geometry.coordinates[1]}});const O=p(b);return O.properties={active:"true"},I(O),null}}}initializeDraw(){this.DrawCircle=this.setDrawCircleMode(),this.draw=new fe({displayControlsDefault:!1,modes:Object.assign(fe.modes,{draw_radius:this.DrawCircle,draw_freehand:us,draw_rectangle:ls.Z,draw_freehand_line:_y,rotate_mode:by()})})}initializeMap(a){this.map=new xt.Map({container:a,center:[0,0],zoom:1}),this.map.setStyle(this.style)}initializeGeolocator(){return new xt.GeolocateControl({positionOptions:{enableHighAccuracy:!0},trackUserLocation:!0})}addControlsOnMap(){this.map?.addControl(new xt.FullscreenControl,"bottom-left"),this.map?.addControl(new xt.NavigationControl,"bottom-left"),this.map?.addControl(this.initializeGeolocator(),"bottom-left"),this.map?.addControl(this.draw,"bottom-left")}getMapData(){return null==this.map||null==this.draw?void console.log("Error -------------- >>   Map and Draw is undefined"):{map:this.map,draw:this.draw}}removeLayerFn(){this.map.removeLayer("YourMapSourceIdLineString"),this.map.removeLayer("YourMapSourceIdPolygon"),this.map.removeLayer("YourMapSourceIdPoint"),this.map.removeLayer("YourMapSourceIdPolygonLineString")}removeSourceFn(){this.map.removeSource("YourMapSource")}addSourceFn(a={type:"FeatureCollection",features:[]}){this.map.addSource("YourMapSource",{type:"geojson",data:a}),this.addLayerFn()}addLayerFn(){this.map.addLayer({id:"YourMapSourceIdLineString",type:"line",source:"YourMapSource",layout:{"line-join":"round","line-cap":"round"},paint:{"line-color":"#572d06","line-width":2},filter:["==","$type","LineString"]}),this.map.addLayer({id:"YourMapSourceIdPolygon",type:"fill",source:"YourMapSource",paint:{"fill-color":"#10CAF0","fill-opacity":.4},filter:["==","$type","Polygon"]}),this.map.addLayer({id:"YourMapSourceIdPoint",type:"circle",source:"YourMapSource",paint:{"circle-radius":6,"circle-color":"#B42222"},filter:["==","$type","Point"]}),this.map.addLayer({id:"YourMapSourceIdPolygonLineString",type:"line",source:"YourMapSource",layout:{"line-join":"round","line-cap":"round"},paint:{"line-color":"#3b1513","line-width":2},filter:["==","$type","Polygon"]})}addLabelFn(a){this.map.addSource("YourMapLabelSource",{type:"geojson",data:a}),this.map.addLayer({id:"YourMapSourceLabels",type:"symbol",source:"YourMapLabelSource",layout:{"text-font":["Open Sans Bold"],"text-field":["get","featureid"],"text-variable-anchor":["top","bottom","left","right"],"text-radial-offset":.5,"text-justify":"center","icon-image":["concat",["get","icon"],"-15"],"text-size":15,"text-optional":!1},paint:{"text-color":"red","text-halo-color":"lightpink","text-halo-width":1}})}removeLabelFn(){this.map.removeLayer("YourMapSourceLabels"),this.map.removeSource("YourMapLabelSource")}}return r.\u0275fac=function(a){return new(a||r)},r.\u0275prov=s.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"}),r})();var gm=It(1572);function lo(r,o,a){return"<"+r+((p=a)&&p.length?" "+p.map(function(y){return y[0]+'="'+y[1]+'"'}).join(" "):"")+">"+o+"</"+r+">";var p}function Yp(r){return(null===r?"":r.toString()).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}function ng(r,o){return function(a){if(!a.properties||!Dl.valid(a.geometry))return"";var p=Dl.any(a.geometry);if(!p)return"";var I,P,y="",v="";if(r.simplestyle){var b=(P="",(I=a.properties)["marker-symbol"]&&(P=P+"ms"+I["marker-symbol"]),I["marker-color"]&&(P=P+"mc"+I["marker-color"].replace("#","")),I["marker-size"]&&(P=P+"ms"+I["marker-size"]),I.stroke&&(P=P+"s"+I.stroke.replace("#","")),I["stroke-width"]&&(P=P+"sw"+I["stroke-width"].toString().replace(".","")),I["stroke-opacity"]&&(P=P+"mo"+I["stroke-opacity"].toString().replace(".","")),I.fill&&(P=P+"f"+I.fill.replace("#","")),I["fill-opacity"]&&(P=P+"fo"+I["fill-opacity"].toString().replace(".","")),P);b&&(Dl.isPoint(a.geometry)&&function(I){return!!(I["marker-size"]||I["marker-symbol"]||I["marker-color"])}(a.properties)?(-1===o.indexOf(b)&&(y=function(I,P){return lo("Style",lo("IconStyle",lo("Icon",lo("href",(O=(C=I)["marker-size"]||"medium",k=C["marker-symbol"]?"-"+C["marker-symbol"]:"",R=(C["marker-color"]||"7e7e7e").replace("#",""),"https://api.tiles.mapbox.com/v3/marker/pin-"+O.charAt(0)+k+"+"+R+".png"))))+lo("hotSpot","",[["xunits","fraction"],["yunits","fraction"],["x",.5],["y",.5]]),[["id",P]]);var C,O,k,R}(a.properties,b),o.push(b)),v=lo("styleUrl","#"+b)):(Dl.isPolygon(a.geometry)||Dl.isLine(a.geometry))&&function(I){for(var P in I)if({stroke:!0,"stroke-opacity":!0,"stroke-width":!0,fill:!0,"fill-opacity":!0}[P])return!0}(a.properties)&&(-1===o.indexOf(b)&&(y=function(I,P){var C=lo("LineStyle",[lo("color",mm(I.stroke,I["stroke-opacity"])||"ff555555")+lo("width",void 0===I["stroke-width"]?2:I["stroke-width"])]),O="";return(I.fill||I["fill-opacity"])&&(O=lo("PolyStyle",[lo("color",mm(I.fill,I["fill-opacity"])||"88555555")])),lo("Style",C+O,[["id",P]])}(a.properties,b),o.push(b)),v=lo("styleUrl","#"+b)))}return y+lo("Placemark",function(I,P){return I[P.name]?lo("name",Yp(I[P.name])):""}(a.properties,r)+function(I,P){return I[P.description]?lo("description",Yp(I[P.description])):""}(a.properties,r)+function(I){return lo("ExtendedData",function(P){var C=[];for(var O in P)C.push([O,P[O]]);return C}(I).map(wy).join(""))}(a.properties)+function(I,P){return I[P.timestamp]?lo("TimeStamp",lo("when",Yp(I[P.timestamp]))):""}(a.properties,r)+p+v)}}var Dl={Point:function(r){return lo("Point",lo("coordinates",r.coordinates.join(",")))},LineString:function(r){return lo("LineString",lo("coordinates",ig(r.coordinates)))},Polygon:function(r){if(!r.coordinates.length)return"";var o=r.coordinates[0],a=r.coordinates.slice(1),p=lo("outerBoundaryIs",lo("LinearRing",lo("coordinates",ig(o)))),y=a.map(function(v){return lo("innerBoundaryIs",lo("LinearRing",lo("coordinates",ig(v))))}).join("");return lo("Polygon",p+y)},MultiPoint:function(r){return r.coordinates.length?lo("MultiGeometry",r.coordinates.map(function(o){return Dl.Point({coordinates:o})}).join("")):""},MultiPolygon:function(r){return r.coordinates.length?lo("MultiGeometry",r.coordinates.map(function(o){return Dl.Polygon({coordinates:o})}).join("")):""},MultiLineString:function(r){return r.coordinates.length?lo("MultiGeometry",r.coordinates.map(function(o){return Dl.LineString({coordinates:o})}).join("")):""},GeometryCollection:function(r){return lo("MultiGeometry",r.geometries.map(Dl.any).join(""))},valid:function(r){return r&&r.type&&(r.coordinates||"GeometryCollection"===r.type&&r.geometries&&r.geometries.every(Dl.valid))},any:function(r){return Dl[r.type]?Dl[r.type](r):""},isPoint:function(r){return"Point"===r.type||"MultiPoint"===r.type},isPolygon:function(r){return"Polygon"===r.type||"MultiPolygon"===r.type},isLine:function(r){return"LineString"===r.type||"MultiLineString"===r.type}};function ig(r){return r.map(function(o){return o.join(",")}).join(" ")}function wy(r){return lo("Data",lo("value",Yp(r[1])),[["name",Yp(r[0])]])}function mm(r,o){if("string"!=typeof r)return"";if(3===(r=r.replace("#","").toLowerCase()).length)r=r[0]+r[0]+r[1]+r[1]+r[2]+r[2];else if(6!==r.length)return"";var a=r[0]+r[1],p=r[2]+r[3],y=r[4]+r[5],v="ff";return"number"==typeof o&&o>=0&&o<=1&&((v=(255*o).toString(16)).indexOf(".")>-1&&(v=v.substr(0,v.indexOf("."))),v.length<2&&(v="0"+v)),v+y+p+a}function og(r,o){return'<?xml version="1.0" encoding="UTF-8"?>'+lo("kml",lo("Document",(void 0!==(a=o=o||{documentName:void 0,documentDescription:void 0,name:"name",description:"description",simplestyle:!1,timestamp:"timestamp"}).documentName?lo("name",a.documentName):"")+function(a){return void 0!==a.documentDescription?lo("description",a.documentDescription):""}(o)+function(a,p){if(!a.type)return"";var y=[];switch(a.type){case"FeatureCollection":return a.features?a.features.map(ng(p,y)).join(""):"";case"Feature":return ng(p,y)(a);default:return ng(p,y)({type:"Feature",geometry:a,properties:{}})}}(r,o)),[["xmlns","http://www.opengis.net/kml/2.2"]]);var a}let ag=(()=>{class r{constructor(){this.downloadDone=new s.vpe}downloadData(a,p){const y=JSON.parse(JSON.stringify(p));switch(a){case"geojson":this.downloadObjectAsJson(y,"map_geojson");break;case"kml":this.downloadObjectAsKml(y,"map_kml")}}downloadObjectAsKml(a,p){og(a),og(a,{name:p,description:"description"});const b=og(a,{documentName:"My List Of Markers",documentDescription:"One of the many places you are not I am"});var I="data:application/json;charset=utf-8,"+encodeURIComponent(b),P=document.createElement("a");P.setAttribute("href",I),P.setAttribute("download",p+".kml"),P.innerText=p,document.body.appendChild(P),P.click(),P.remove(),this.downloadDone.emit()}downloadObjectAsJson(a,p){var y="data:application/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(a)),v=document.createElement("a");v.setAttribute("href",y),v.setAttribute("download",p+".geojson"),v.innerText=p,document.body.appendChild(v),v.click(),v.remove(),this.downloadDone.emit()}changeTypeMarkerToPoint(a){return a.features.forEach((p,y)=>{"marker"==p.geometry.type&&(a.features[y].geometry.type="Point")}),a}}return r.\u0275fac=function(a){return new(a||r)},r.\u0275prov=s.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"}),r})();var sg=It(266);let Ey=(()=>{class r{transform(a,p){try{return this.applyColors("object"==typeof a?a:JSON.parse(a),p[0],p[1])}catch{return this.applyColors({error:"Invalid JSON"},p[0],p[1])}}applyColors(a,p=!1,y=4){return"string"!=typeof a&&(a=JSON.stringify(a,void 0,3)),(a=a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")).replace(/("(\\u[a-zA-Z0-9]{4}|\\[^u]|[^\\"])*"(\s*:)?|\b(true|false|null)\b|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?)/g,b=>{let I="number";return/^"/.test(b)?I=/:$/.test(b)?"key":"string":/true|false/.test(b)?I="boolean":/null/.test(b)&&(I="null"),'<span class="'+I+'">'+b+"</span>"})}}return r.\u0275fac=function(a){return new(a||r)},r.\u0275pipe=s.Yjl({name:"prettyjson",type:r,pure:!0}),r})();function Sy(r,o){1&r&&s._UZ(0,"mat-spinner",22)}const Cy=function(){return[!0,3]};function Iy(r,o){if(1&r&&(s._UZ(0,"pre",23),s.ALo(1,"prettyjson")),2&r){const a=s.oxw();s.Q6J("innerHTML",s.xi3(1,1,a.dataSource,s.DdM(4,Cy)),s.oJD)}}let Py=(()=>{class r{constructor(a,p,y){this.downloadDataService=a,this.dataShareService=p,this.snackbarService=y,this.dataSource={type:"FeatureCollection",features:[]},this.tableLoaded=!0,this.downloadType="geojson"}ngOnInit(){this.dataShareService.getSourceData.subscribe(a=>{this.tableLoaded=!1,this.dataSource=a,setTimeout(()=>{this.tableLoaded=!0},0)}),this.getShowDataTableStatus()}copyToClipboard(){if(null==this.dataSource)this.snackbarService.openSnackbar("Please draw atleast one geometry","snackbar-err");else if(this.dataSource.features.length>0){let a=this.downloadDataService.changeTypeMarkerToPoint(JSON.parse(JSON.stringify({...this.dataSource})));navigator.clipboard.writeText(JSON.stringify(a)),this.snackbarService.openSnackbar("Copied to clipboard","snackbar-success")}else this.snackbarService.openSnackbar("Please draw atleast one geometry","snackbar-err")}getShowDataTableStatus(){this.dataShareService.getDataTableStatus.subscribe(a=>{this.showDataTable=a})}downloadTypeSelect(a){this.downloadType=a.target.value}downloadData(){if(this.dataSource)if(this.dataSource.features.length>0){let a=this.downloadDataService.changeTypeMarkerToPoint(JSON.parse(JSON.stringify({...this.dataSource})));this.downloadDataService.downloadData(this.downloadType,{...a})}else this.snackbarService.openSnackbar("Please draw atleast one geometry","snackbar-err");else this.snackbarService.openSnackbar("Please draw atleast one geometry","snackbar-err")}}return r.\u0275fac=function(a){return new(a||r)(s.Y36(ag),s.Y36(Jt),s.Y36(K))},r.\u0275cmp=s.Xpm({type:r,selectors:[["app-data-table"]],decls:26,vars:4,consts:[[1,"data-table",3,"ngClass"],[1,"table-wrapper"],[1,"table-div"],[1,"download-div","d-flex","justify-content-between","pt-1"],["matTooltip","Select download type","aria-label","Default select example",1,"form-select",3,"change"],["selected","","value","geojson"],["value","kml"],["role","group",1,"btn-group"],["matTooltip","Download File Data",1,"btn","btn-outline",3,"click"],["xmlns","http://www.w3.org/2000/svg","width","16","height","16","fill","currentColor","viewBox","0 0 16 16",1,"bi","bi-download"],["d","M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"],["d","M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"],["matTooltip","Copy to clipboard",1,"btn","btn-outline",3,"click"],["xmlns","http://www.w3.org/2000/svg","width","16","height","16","fill","currentColor","viewBox","0 0 16 16",1,"bi","bi-clipboard"],["d","M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"],["d","M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"],[1,"p-flex","mt-2"],["class","p-flex","diameter","25","color","primary",4,"ngIf"],[3,"innerHTML",4,"ngIf"],[1,"toggler-btn"],["role","button",3,"click"],[1,"bg-primary","text-light",3,"ngClass"],["diameter","25","color","primary",1,"p-flex"],[3,"innerHTML"]],template:function(a,p){1&a&&(s.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"select",4),s.NdJ("change",function(v){return p.downloadTypeSelect(v)}),s.TgZ(5,"option",5),s._uU(6,"Geojson"),s.qZA(),s.TgZ(7,"option",6),s._uU(8,"Kml"),s.qZA()(),s.TgZ(9,"div",7)(10,"button",8),s.NdJ("click",function(){return p.downloadData()}),s.O4$(),s.TgZ(11,"svg",9),s._UZ(12,"path",10)(13,"path",11),s.qZA()(),s.kcU(),s.TgZ(14,"button",12),s.NdJ("click",function(){return p.copyToClipboard()}),s.O4$(),s.TgZ(15,"svg",13),s._UZ(16,"path",14)(17,"path",15),s.qZA()()()(),s.kcU(),s.TgZ(18,"div")(19,"div",16),s.YNc(20,Sy,1,0,"mat-spinner",17),s.qZA(),s.YNc(21,Iy,2,5,"pre",18),s.qZA()(),s.TgZ(22,"div",19)(23,"span",20),s.NdJ("click",function(){return p.showDataTable=!p.showDataTable}),s.TgZ(24,"mat-icon",21),s._uU(25,"keyboard_backspace"),s.qZA()()()()()),2&a&&(s.Q6J("ngClass",p.showDataTable?"data-table-show":"data-table-hide"),s.xp6(20),s.Q6J("ngIf",!p.tableLoaded),s.xp6(1),s.Q6J("ngIf",p.tableLoaded),s.xp6(3),s.Q6J("ngClass",p.showDataTable?"show-reverse-arrow":""))},dependencies:[gt.mk,gt.O5,sg.gM,X.Hw,gm.Ou,lt.YN,lt.Kr,Ey],styles:[".data-table[_ngcontent-%COMP%]{position:absolute;z-index:3;right:0;top:0;height:100%;background-color:#f0f8ff;border-left:1px solid gray;transition:transform .5s}[_ngcontent-%COMP%]::-webkit-scrollbar{width:10px;height:10px}[_ngcontent-%COMP%]::-webkit-scrollbar-track{background-color:#eff8ff}[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#10CAF0;border-radius:10px}.data-table-hide[_ngcontent-%COMP%]{transform:translate(100%)}.data-table-show[_ngcontent-%COMP%]{transform:translate(0)}.download-div[_ngcontent-%COMP%]{position:sticky;top:0}.table-wrapper[_ngcontent-%COMP%]{position:relative;height:100%}.toggler-btn[_ngcontent-%COMP%]{position:absolute;top:50%;left:-50px}.toggler-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{height:35px;width:50px;display:flex;align-items:center;justify-content:center;border-radius:50px 0 0 50px}.table-div[_ngcontent-%COMP%]{height:100%;width:100%;overflow-x:hidden;overflow-y:auto;scrollbar-color:#10CAF0 #EFF8FF}.show-reverse-arrow[_ngcontent-%COMP%]{transform:scaleX(-1)}@media only screen and (max-width: 992px){.data-table[_ngcontent-%COMP%]{width:300px}}@media only screen and (min-width: 993px){.data-table[_ngcontent-%COMP%]{width:500px}}"]}),r})();var My=It(529);let Ty=(()=>{class r{constructor(a){this.http=a,this.BASE_NOMINATIM_URL="https://nominatim.openstreetmap.org"}getGeocoderData(a){return this.http.get(`${this.BASE_NOMINATIM_URL}/search?q=${a}&format=geojson`)}reverseGeocodeData(a){return this.http.get(`${this.BASE_NOMINATIM_URL}/reverse?format=geojson&lat=${a.lat}&lon=${a.lng}`)}}return r.\u0275fac=function(a){return new(a||r)(s.LFG(My.eN))},r.\u0275prov=s.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"}),r})();function Ay(r,o){if(1&r){const a=s.EpF();s.TgZ(0,"div",5)(1,"div",6)(2,"input",7,8),s.NdJ("keydown.enter",function(){s.CHM(a);const y=s.MAs(3),v=s.MAs(8);return s.oxw().getGeocode(y.value),s.KtG(v.reset)}),s.qZA(),s.TgZ(4,"button",9),s.NdJ("click",function(){s.CHM(a);const y=s.MAs(3);return s.oxw().clearGeocode(),s.KtG(y.value="")}),s._uU(5,"X"),s.qZA()(),s.TgZ(6,"div",6)(7,"form",10,11),s.NdJ("keydown.enter",function(){s.CHM(a);const y=s.MAs(8),v=s.MAs(3);return s.oxw().getLngLat(y),s.KtG(v.value="")}),s._UZ(9,"input",12)(10,"input",13),s.qZA()()()}}function Ly(r,o){if(1&r){const a=s.EpF();s.TgZ(0,"button",16),s.NdJ("click",function(){const v=s.CHM(a).$implicit,b=s.oxw(2);return s.KtG(b.showDataInMap(v))}),s.O4$(),s.TgZ(1,"svg",17),s._UZ(2,"path",18),s.qZA(),s.kcU(),s.TgZ(3,"span",19),s._uU(4),s.qZA()()}if(2&r){const a=o.$implicit;s.Q6J("matTooltip",a.properties.display_name),s.xp6(4),s.Oqu(a.properties.display_name)}}function Dy(r,o){if(1&r&&(s.TgZ(0,"div",14),s.YNc(1,Ly,5,2,"button",15),s.qZA()),2&r){const a=s.oxw();s.xp6(1),s.Q6J("ngForOf",a.geocodeData)}}function Oy(r,o){if(1&r&&(s.TgZ(0,"div",20)(1,"div")(2,"span"),s._uU(3,"Display Name : "),s.qZA(),s.TgZ(4,"span"),s._uU(5),s.qZA()(),s.TgZ(6,"div")(7,"span"),s._uU(8,"Country : "),s.qZA(),s.TgZ(9,"span"),s._uU(10),s.qZA()(),s.TgZ(11,"div")(12,"span"),s._uU(13,"Country Code : "),s.qZA(),s.TgZ(14,"span"),s._uU(15),s.qZA()(),s.TgZ(16,"div")(17,"span"),s._uU(18,"County : "),s.qZA(),s.TgZ(19,"span"),s._uU(20),s.qZA()(),s.TgZ(21,"div")(22,"span"),s._uU(23,"Region : "),s.qZA(),s.TgZ(24,"span"),s._uU(25),s.qZA()(),s.TgZ(26,"div")(27,"span"),s._uU(28,"State : "),s.qZA(),s.TgZ(29,"span"),s._uU(30),s.qZA()(),s.TgZ(31,"div")(32,"span"),s._uU(33,"District : "),s.qZA(),s.TgZ(34,"span"),s._uU(35),s.qZA()(),s.TgZ(36,"div")(37,"span"),s._uU(38,"Village : "),s.qZA(),s.TgZ(39,"span"),s._uU(40),s.qZA()(),s.TgZ(41,"div")(42,"span"),s._uU(43,"City : "),s.qZA(),s.TgZ(44,"span"),s._uU(45),s.qZA()(),s.TgZ(46,"div")(47,"span"),s._uU(48,"House Number : "),s.qZA(),s.TgZ(49,"span"),s._uU(50),s.qZA()(),s.TgZ(51,"div")(52,"span"),s._uU(53,"Postcode : "),s.qZA(),s.TgZ(54,"span"),s._uU(55),s.qZA()(),s.TgZ(56,"div")(57,"span"),s._uU(58,"Road : "),s.qZA(),s.TgZ(59,"span"),s._uU(60),s.qZA()()()),2&r){const a=s.oxw();s.xp6(5),s.Oqu(a.reverseGeocodeData.properties.display_name),s.xp6(5),s.Oqu(a.reverseGeocodeData.properties.address.country),s.xp6(5),s.Oqu(a.reverseGeocodeData.properties.address.country_code),s.xp6(5),s.Oqu(a.reverseGeocodeData.properties.address.county),s.xp6(5),s.Oqu(a.reverseGeocodeData.properties.address.region),s.xp6(5),s.Oqu(a.reverseGeocodeData.properties.address.state),s.xp6(5),s.Oqu(a.reverseGeocodeData.properties.address.state_district),s.xp6(5),s.Oqu(a.reverseGeocodeData.properties.address.village),s.xp6(5),s.Oqu(a.reverseGeocodeData.properties.address.city),s.xp6(5),s.Oqu(a.reverseGeocodeData.properties.address.house_number),s.xp6(5),s.Oqu(a.reverseGeocodeData.properties.address.postcode),s.xp6(5),s.Oqu(a.reverseGeocodeData.properties.address.road)}}function ky(r,o){if(1&r){const a=s.EpF();s.TgZ(0,"div",21),s.NdJ("click",function(){s.CHM(a);const y=s.oxw();return s.KtG(y.showSearchDiv=!y.showSearchDiv)}),s.O4$(),s.TgZ(1,"svg",22),s._UZ(2,"path",23),s.qZA()()}}const Ny=function(){return{width:"400px"}},Ry=function(){return{width:"30px"}};let Fy=(()=>{class r{constructor(a,p,y){this.geocoderService=a,this.mapService=p,this.snackbarService=y,this.showSearchDiv=!1}ngOnInit(){this.map=this.mapService.getMapData()?.map,this.marker=new xt.Marker({color:"#9508c4",draggable:!1})}getGeocode(a){this.reverseGeocodeData=void 0,this.lngLatForm&&this.lngLatForm.resetForm(),this.geocoderService.getGeocoderData(a).subscribe(p=>{p&&(0==p.features.length?this.snackbarService.openSnackbar("Error In Fetching Data","snackbar-err"):this.geocodeData=p.features)},p=>{console.log(p)})}clearGeocode(){this.geocodeData=void 0,this.reverseGeocodeData=void 0,this.showSearchDiv=!1,this.marker.remove()}showDataInMap(a){this.map?.fitBounds(a.bbox),this.marker.setLngLat(a.geometry.coordinates).addTo(this.map)}showCoordinateOnMap(a){this.map.flyTo({center:a.geometry.coordinates,essential:!0,zoom:21}),this.marker.setLngLat(a.geometry.coordinates).addTo(this.map)}getLngLat(a){this.lngLatForm=a,this.reverseGeocode(a.value)}reverseGeocode(a){this.geocodeData=void 0,this.geocoderService.reverseGeocodeData(a).subscribe(p=>{p&&(p.error?this.snackbarService.openSnackbar("Error In Fetching Data","snackbar-err"):(this.reverseGeocodeData=p.features[0],console.log(p),this.showCoordinateOnMap(this.reverseGeocodeData)))},p=>{console.log(p)})}}return r.\u0275fac=function(a){return new(a||r)(s.Y36(Ty),s.Y36(Yf),s.Y36(K))},r.\u0275cmp=s.Xpm({type:r,selectors:[["app-geocoder"]],decls:5,vars:7,consts:[["id","geocoder",3,"ngStyle"],["class","row m-0",4,"ngIf"],["class","row","class","list-group",4,"ngIf"],["class","row","class","reverse-geocode-data",4,"ngIf"],["matTooltip","Search Address","class","search-icon p-flex rounded shadow","role","button",3,"click",4,"ngIf"],[1,"row","m-0"],[1,"row","m-0","p-0"],["autocomplete","off","type","text","id","search-input","placeholder","Search Address",1,"col-11",3,"keydown.enter"],["searchValue",""],[1,"close-btn","col-1",3,"click"],["id","lngLatForm",1,"m-0","p-0",3,"keydown.enter"],["lngLatForm","ngForm"],["type","number","autocomplete","off","name","lng","ngModel","","placeholder","Longitude",1,"w-50"],["type","number","autocomplete","off","name","lat","ngModel","","placeholder","Latitude",1,"w-50"],[1,"list-group"],["type","button","class","list-group-item list-group-item-action search-list-item",3,"matTooltip","click",4,"ngFor","ngForOf"],["type","button",1,"list-group-item","list-group-item-action","search-list-item",3,"matTooltip","click"],["xmlns","http://www.w3.org/2000/svg","width","16","height","16","fill","currentColor","viewBox","0 0 16 16",1,"bi","bi-geo-alt-fill"],["d","M8 16s6-5.686 6-10A6 6 0 0 0 2 6c0 4.314 6 10 6 10zm0-7a3 3 0 1 1 0-6 3 3 0 0 1 0 6z"],[1,"ms-2"],[1,"reverse-geocode-data"],["matTooltip","Search Address","role","button",1,"search-icon","p-flex","rounded","shadow",3,"click"],["xmlns","http://www.w3.org/2000/svg","width","16","height","16","fill","currentColor","viewBox","0 0 16 16",1,"bi","bi-search"],["d","M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z"]],template:function(a,p){1&a&&(s.TgZ(0,"div",0),s.YNc(1,Ay,11,0,"div",1),s.YNc(2,Dy,2,1,"div",2),s.YNc(3,Oy,61,12,"div",3),s.YNc(4,ky,3,0,"div",4),s.qZA()),2&a&&(s.Q6J("ngStyle",p.showSearchDiv?s.DdM(5,Ny):s.DdM(6,Ry)),s.xp6(1),s.Q6J("ngIf",p.showSearchDiv),s.xp6(1),s.Q6J("ngIf",p.geocodeData),s.xp6(1),s.Q6J("ngIf",p.reverseGeocodeData),s.xp6(1),s.Q6J("ngIf",!p.showSearchDiv))},dependencies:[gt.sg,gt.O5,gt.PC,sg.gM,lt._Y,lt.Fj,lt.wV,lt.JJ,lt.JL,lt.On,lt.F],styles:["#search-input[_ngcontent-%COMP%]::placeholder{font-size:15px}#lngLatForm[_ngcontent-%COMP%] > input[_ngcontent-%COMP%]::placeholder{font-size:15px}#lngLatForm[_ngcontent-%COMP%] > input[_ngcontent-%COMP%]{height:10px;font-size:15px;padding:12px 15px}#lngLatForm[_ngcontent-%COMP%] > input[_ngcontent-%COMP%]:focus{outline:none}button[_ngcontent-%COMP%]{font-size:15px}.close-btn[_ngcontent-%COMP%]{background:transparent;border:.1px solid rebeccapurple}.close-btn[_ngcontent-%COMP%]:hover{background:transparent;border:.1px solid red;color:red}#geocoder[_ngcontent-%COMP%]{position:absolute;z-index:2;left:5px;top:5px}#search-input[_ngcontent-%COMP%]{height:10px;font-size:15px;padding:15px}#search-input[_ngcontent-%COMP%]:focus{outline:none}.search-icon[_ngcontent-%COMP%]{height:30px;background-color:#fff;border:1px solid black}.search-list-item[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.reverse-geocode-data[_ngcontent-%COMP%]{background-color:#fff;padding:10px}.reverse-geocode-data[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:nth-child(1){font-weight:bolder}"]}),r})();function zy(r,o){1&r&&s._UZ(0,"mat-progress-spinner",3)}let ym=(()=>{class r{constructor(a){this.mapService=a,this.mapDataEmit=new s.vpe,this.showSpinner=!0}set content(a){a&&(this.identityFeatureSideNavCompontent=a)}ngOnInit(){this.mapService.initializeDraw(),this.mapService.initializeMap("map"),this.mapService.addControlsOnMap(),this.map=this.mapService.getMapData().map,this.draw=this.mapService.getMapData().draw,this.mapDataEmit.emit({map:this.map,draw:this.draw}),this.handleSpinner()}handleSpinner(){this.map.on("load",()=>{this.mapService.addSourceFn()}),this.map.on("idle",()=>{this.showSpinner=!1}),this.map.on("zoom",()=>{this.showSpinner=!0}),this.map.on("dragpen",()=>{this.showSpinner=!0})}sendIdentityFeatureData(a){this.identityFeatureSideNavCompontent.showIdentity(a)}}return r.\u0275fac=function(a){return new(a||r)(s.Y36(Yf))},r.\u0275cmp=s.Xpm({type:r,selectors:[["app-map-common"]],viewQuery:function(a,p){if(1&a&&s.Gf($t,5),2&a){let y;s.iGM(y=s.CRH())&&(p.content=y.first)}},outputs:{mapDataEmit:"mapDataEmit"},decls:5,vars:2,consts:[["id","map"],[3,"map"],["class","spinner","color","warn","mode","indeterminate","diameter","50",4,"ngIf"],["color","warn","mode","indeterminate","diameter","50",1,"spinner"]],template:function(a,p){1&a&&(s.TgZ(0,"div",0),s._UZ(1,"app-identity-feature-side-nav",1)(2,"app-geocoder"),s.YNc(3,zy,1,0,"mat-progress-spinner",2),s._UZ(4,"app-data-table"),s.qZA()),2&a&&(s.xp6(1),s.Q6J("map",p.map),s.xp6(2),s.Q6J("ngIf",p.showSpinner))},dependencies:[gt.O5,gm.Ou,Py,$t,Fy],styles:["#map[_ngcontent-%COMP%]{height:100vh;width:100%;position:relative;top:0;left:0}.spinner[_ngcontent-%COMP%]{z-index:2;position:absolute;left:0;right:0;top:5%;margin:auto}"]}),r})();function By(r,o){if(1&r){const a=s.EpF();s.TgZ(0,"span",21),s.NdJ("click",function(){s.CHM(a);const y=s.oxw();return s.KtG(y.showAboutUs=!1)}),s.O4$(),s.TgZ(1,"svg",22),s._UZ(2,"path",23)(3,"path",24),s.qZA()()}}let Uy=(()=>{class r{constructor(a,p,y){this.mapService=a,this.dataShareService=p,this.styleService=y,this.currentMapStyle="open-streets-map"}getRasterTile(a){return{version:8,sources:{"raster-tiles":{type:"raster",tiles:[a],tileSize:256,attribution:'Map tiles by <a target="_top" rel="noopener" href="http://stamen.com">Stamen Design</a>, under <a target="_top" rel="noopener" href="http://creativecommons.org/licenses/by/3.0">CC BY 3.0</a>. Data by <a target="_top" rel="noopener" href="http://openstreetmap.org">OpenStreetMap</a>, under <a target="_top" rel="noopener" href="http://creativecommons.org/licenses/by-sa/3.0">CC BY SA</a>'}},layers:[{id:"simple-tiles",type:"raster",source:"raster-tiles",minzoom:0,maxzoom:22}]}}ngOnInit(){this.dataShareService.getSourceData.subscribe(a=>{this.geo_json_main=a})}setMapStyle(a){let p=0;switch(this.removeSourceAndLayer(),this.currentMapStyle=a,a){case"maplibre-default":this.map.setStyle("https://demotiles.maplibre.org/style.json"),p=2e3;break;case"open-streets-map":this.map.setStyle(this.mapService.style);break;case"raster-tile":this.map.setStyle(this.getRasterTile("https://stamen-tiles.a.ssl.fastly.net/watercolor/{z}/{x}/{y}.jpg"));break;case"wikimedia":this.map.setStyle(this.getRasterTile("https://maps.wikimedia.org/osm-intl/{z}/{x}/{y}.png"))}setTimeout(()=>{this.addExistingSource()},p)}removeSourceAndLayer(){this.mapService.removeLayerFn(),this.mapService.removeSourceFn()}addExistingSource(){let a=0,p={...this.geo_json_main},y=JSON.parse(JSON.stringify(p));this.geo_json_main?(this.geo_json_main.features.forEach((v,b)=>{"marker"==v.geometry.type&&(y.features.splice(b-a,1),a++)}),this.mapService.addSourceFn(y),this.styleService.setDataOnMap(this.map,this.geo_json_main,!0,!1)):this.mapService.addSourceFn()}}return r.\u0275fac=function(a){return new(a||r)(s.Y36(Yf),s.Y36(Jt),s.Y36(tt))},r.\u0275cmp=s.Xpm({type:r,selectors:[["app-map-styles"]],inputs:{map:"map",draw:"draw"},decls:33,vars:5,consts:[["id","map-style"],[1,"d-flex","border","map-type"],["role","button",1,"px-2",3,"ngClass","click"],["id","about",1,"text-center","text-light","bg-dark",3,"ngClass"],[1,"border-bottom","border-3","border-primary","pointer"],[1,"mb-0",3,"click"],[3,"click",4,"ngIf"],["id","author-image",1,"mt-4"],[1,"mb-0"],[1,"px-3"],[1,"pt-2","pb-4"],["target","_blank","href","https://in.linkedin.com/in/pushpendra-sapkale-744125121?original_referer=https%3A%2F%2Fwww.google.com%2F"],["xmlns","http://www.w3.org/2000/svg","width","16","height","16","fill","currentColor","viewBox","0 0 16 16",1,"bi","bi-linkedin"],["d","M0 1.146C0 .513.526 0 1.175 0h13.65C15.474 0 16 .513 16 1.146v13.708c0 .633-.526 1.146-1.175 1.146H1.175C.526 16 0 15.487 0 14.854V1.146zm4.943 12.248V6.169H2.542v7.225h2.401zm-1.2-8.212c.837 0 1.358-.554 1.358-1.248-.015-.709-.52-1.248-1.342-1.248-.822 0-1.359.54-1.359 1.248 0 .694.521 1.248 1.327 1.248h.016zm4.908 8.212V9.359c0-.216.016-.432.08-.586.173-.431.568-.878 1.232-.878.869 0 1.216.662 1.216 1.634v3.865h2.401V9.25c0-2.22-1.184-3.252-2.764-3.252-1.274 0-1.845.7-2.165 1.193v.025h-.016a5.54 5.54 0 0 1 .016-.025V6.169h-2.4c.03.678 0 7.225 0 7.225h2.4z"],["href","mailto: dev.psapkale@gmail.com",1,"ms-3"],["xmlns","http://www.w3.org/2000/svg","width","16","height","16","fill","currentColor","viewBox","0 0 16 16",1,"bi","bi-google"],["d","M15.545 6.558a9.42 9.42 0 0 1 .139 1.626c0 2.434-.87 4.492-2.384 5.885h.002C11.978 15.292 10.158 16 8 16A8 8 0 1 1 8 0a7.689 7.689 0 0 1 5.352 2.082l-2.284 2.284A4.347 4.347 0 0 0 8 3.166c-2.087 0-3.86 1.408-4.492 3.304a4.792 4.792 0 0 0 0 3.063h.003c.635 1.893 2.405 3.301 4.492 3.301 1.078 0 2.004-.276 2.722-.764h-.003a3.702 3.702 0 0 0 1.599-2.431H8v-3.08h7.545z"],["target","_blank","href","https://www.instagram.com/pushpendr_a/",1,"ms-3"],["xmlns","http://www.w3.org/2000/svg","width","16","height","16","fill","currentColor","viewBox","0 0 16 16",1,"bi","bi-instagram"],["d","M8 0C5.829 0 5.556.01 4.703.048 3.85.088 3.269.222 2.76.42a3.917 3.917 0 0 0-1.417.923A3.927 3.927 0 0 0 .42 2.76C.222 3.268.087 3.85.048 4.7.01 5.555 0 5.827 0 8.001c0 2.172.01 2.444.048 3.297.04.852.174 1.433.372 1.942.205.526.478.972.923 1.417.444.445.89.719 1.416.923.51.198 1.09.333 1.942.372C5.555 15.99 5.827 16 8 16s2.444-.01 3.298-.048c.851-.04 1.434-.174 1.943-.372a3.916 3.916 0 0 0 1.416-.923c.445-.445.718-.891.923-1.417.197-.509.332-1.09.372-1.942C15.99 10.445 16 10.173 16 8s-.01-2.445-.048-3.299c-.04-.851-.175-1.433-.372-1.941a3.926 3.926 0 0 0-.923-1.417A3.911 3.911 0 0 0 13.24.42c-.51-.198-1.092-.333-1.943-.372C10.443.01 10.172 0 7.998 0h.003zm-.717 1.442h.718c2.136 0 2.389.007 3.232.046.78.035 1.204.166 1.486.275.373.145.64.319.92.599.28.28.453.546.598.92.11.281.24.705.275 1.485.039.843.047 1.096.047 3.231s-.008 2.389-.047 3.232c-.035.78-.166 1.203-.275 1.485a2.47 2.47 0 0 1-.599.919c-.28.28-.546.453-.92.598-.28.11-.704.24-1.485.276-.843.038-1.096.047-3.232.047s-2.39-.009-3.233-.047c-.78-.036-1.203-.166-1.485-.276a2.478 2.478 0 0 1-.92-.598 2.48 2.48 0 0 1-.6-.92c-.109-.281-.24-.705-.275-1.485-.038-.843-.046-1.096-.046-3.233 0-2.136.008-2.388.046-3.231.036-.78.166-1.204.276-1.486.145-.373.319-.64.599-.92.28-.28.546-.453.92-.598.282-.11.705-.24 1.485-.276.738-.034 1.024-.044 2.515-.045v.002zm4.988 1.328a.96.96 0 1 0 0 1.92.96.96 0 0 0 0-1.92zm-4.27 1.122a4.109 4.109 0 1 0 0 8.217 4.109 4.109 0 0 0 0-8.217zm0 1.441a2.667 2.667 0 1 1 0 5.334 2.667 2.667 0 0 1 0-5.334z"],[1,"mb-2"],[3,"click"],["xmlns","http://www.w3.org/2000/svg","width","16","height","16","fill","currentColor","viewBox","0 0 16 16",1,"bi","bi-x-circle","close-btn"],["d","M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"],["d","M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z"]],template:function(a,p){1&a&&(s.TgZ(0,"div",0)(1,"div",1)(2,"div",2),s.NdJ("click",function(){return p.setMapStyle("open-streets-map")}),s._uU(3,"OSM"),s.qZA(),s.TgZ(4,"div",2),s.NdJ("click",function(){return p.setMapStyle("maplibre-default")}),s._uU(5,"Maplib"),s.qZA(),s.TgZ(6,"div",2),s.NdJ("click",function(){return p.setMapStyle("raster-tile")}),s._uU(7,"Raster"),s.qZA()(),s.TgZ(8,"div",3)(9,"header",4)(10,"h3",5),s.NdJ("click",function(){return p.showAboutUs=!p.showAboutUs}),s._uU(11," About Us "),s.qZA(),s.YNc(12,By,4,0,"span",6),s.qZA(),s.TgZ(13,"div"),s._UZ(14,"div",7),s.TgZ(15,"h2",8),s._uU(16,"Pushpendra Sapkale"),s.qZA(),s.TgZ(17,"h4"),s._uU(18,"Full Stack Developer"),s.qZA(),s.TgZ(19,"p",9),s._uU(20," Creative and technical web developer, Post graduated in Master of computer application "),s.qZA(),s.TgZ(21,"div",10)(22,"a",11),s.O4$(),s.TgZ(23,"svg",12),s._UZ(24,"path",13),s.qZA()(),s.kcU(),s.TgZ(25,"a",14),s.O4$(),s.TgZ(26,"svg",15),s._UZ(27,"path",16),s.qZA()(),s.kcU(),s.TgZ(28,"a",17),s.O4$(),s.TgZ(29,"svg",18),s._UZ(30,"path",19),s.qZA()()(),s.kcU(),s.TgZ(31,"div",20),s._uU(32," Developer of this tool "),s.qZA()()()()),2&a&&(s.xp6(2),s.Q6J("ngClass","open-streets-map"==p.currentMapStyle?"active-map-style":""),s.xp6(2),s.Q6J("ngClass","maplibre-default"==p.currentMapStyle?"active-map-style":""),s.xp6(2),s.Q6J("ngClass","raster-tile"==p.currentMapStyle?"active-map-style":""),s.xp6(2),s.Q6J("ngClass",p.showAboutUs?"show-about-us":"hide-about-us"),s.xp6(4),s.Q6J("ngIf",p.showAboutUs))},dependencies:[gt.mk,gt.O5],styles:["#map-style[_ngcontent-%COMP%]{position:absolute;bottom:0;width:100%}.active-map-style[_ngcontent-%COMP%]{background-color:#8b0000;color:#fff}.map-type[_ngcontent-%COMP%]{position:absolute;bottom:31px}#about[_ngcontent-%COMP%]{position:absolute;background-color:red;width:100%;z-index:1;transition:transform 1s linear}.hide-about-us[_ngcontent-%COMP%]{transform:translatey(-28px)}.show-about-us[_ngcontent-%COMP%]{transform:translatey(-100%)}header[_ngcontent-%COMP%]{position:relative}.close-btn[_ngcontent-%COMP%]{position:absolute;right:10px;top:7px}#author-image[_ngcontent-%COMP%]{background-image:url(Author.f3824a30f28c559e.jpeg);height:150px;width:100%;background-position:top;background-size:cover;clip-path:circle(28% at 50% 37%)}#about[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:wheat}"]}),r})(),qy=(()=>{class r{constructor(){}ngOnInit(){}}return r.\u0275fac=function(a){return new(a||r)},r.\u0275cmp=s.Xpm({type:r,selectors:[["app-header"]],decls:6,vars:0,consts:[[1,"bg-info","header","p-2","fs-5","shadow-sm","p-flex"],["xmlns","http://www.w3.org/2000/svg","width","16","height","16","fill","currentColor","viewBox","0 0 16 16",1,"bi","bi-globe-americas","me-2"],["d","M8 0a8 8 0 1 0 0 16A8 8 0 0 0 8 0ZM2.04 4.326c.325 1.329 2.532 2.54 3.717 3.19.48.263.793.434.743.484-.08.08-.162.158-.242.234-.416.396-.787.749-.758 1.266.035.634.618.824 1.214 1.017.577.188 1.168.38 1.286.983.082.417-.075.988-.22 1.52-.215.782-.406 1.48.22 1.48 1.5-.5 3.798-3.186 4-5 .138-1.243-2-2-3.5-2.5-.478-.16-.755.081-.99.284-.172.15-.322.279-.51.216-.445-.148-2.5-2-1.5-2.5.78-.39.952-.171 1.227.182.078.099.163.208.273.318.609.304.662-.132.723-.633.039-.322.081-.671.277-.867.434-.434 1.265-.791 2.028-1.12.712-.306 1.365-.587 1.579-.88A7 7 0 1 1 2.04 4.327Z"],[1,"sub-name"]],template:function(a,p){1&a&&(s.TgZ(0,"h2",0),s.O4$(),s.TgZ(1,"svg",1),s._UZ(2,"path",2),s.qZA(),s._uU(3," GeoJSON Creator "),s.kcU(),s.TgZ(4,"sub",3),s._uU(5,"Tool"),s.qZA()())},styles:[".header[_ngcontent-%COMP%]{font-family:emoji}.sub-name[_ngcontent-%COMP%]{color:#8b0000;font-family:cursive}"]}),r})(),Gy=(()=>{class r{constructor(a,p,y,v,b){this.dialogRef=a,this.data=p,this.styleService=y,this.dataShareService=v,this.snackbarService=b}ngOnInit(){this.data&&(this.map=this.data.map)}uploadFile(a){this.uploadedFile=a.target.files[0];const p=new FileReader;p.readAsText(this.uploadedFile,"UTF-8"),p.onload=()=>{let y=this.setStyleOnUploadedFile(p.result.toString());this.uploadedJsonObj=this.setGeoJsonForOurTool(y),this.dataShareService.sendSourceData(this.uploadedJsonObj),this.styleService.setDataOnMap(this.map,this.uploadedJsonObj),this.snackbarService.openSnackbar("File uploaded successfully","snackbar-success"),this.dialogRef.close()},p.onerror=y=>{console.log(y),this.snackbarService.openSnackbar("Failed in uploading your flile please try again","snackbar-err")}}setGeoJsonForOurTool(a){return a.features.length>0&&a.features.forEach((p,y)=>{"Point"==p.geometry.type&&(a.features[y].geometry.type=void 0!==p.styledetails.styledata.markername||void 0!==p.styledetails.styledata.textname?"marker":"Point")}),a}setStyleOnUploadedFile(a){let p=0,y=JSON.parse(a),v=JSON.parse(JSON.stringify({...y})),b=JSON.parse(JSON.stringify({...v}));return v.features.forEach((I,P)=>{null==I.styledetails&&(null==I.id?(b.features[P].id="new_feature"+Number(Math.random()+p),b.features[P].properties={featureid:b.features[P].id},b.features[P].styledetails={id:b.features[P].id},b.features[P]=this.setStyleDetailsInFeature(b,P),p++):(b.features[P].properties={featureid:b.features[P].id},b.features[P].styledetails={id:b.features[P].id},b.features[P]=this.setStyleDetailsInFeature(b,P)))}),b}setStyleDetailsInFeature(a,p){let y=JSON.parse(JSON.stringify({...a}));switch(y.features[p].geometry.type){case"Polygon":y.features[p].styledetails={id:y.features[p].id,styledata:{fillcolor:"#10CAF0",fillopacity:.4,fillborderwidth:2,fillbordercolor:"#3b1513"}},y.features[p].measurement={squaremeters:Math.round(100*Ea(y))/100};break;case"Point":y.features[p].styledetails={id:y.features[p].id,styledata:{circleradius:6,circlecolor:"#B42222"}};break;case"LineString":y.features[p].styledetails={id:y.features[p].id,styledata:{linecolor:"#572d06",linewidth:2}},y.features[p].measurement={kilometers:bs(y)}}return y.features[p]}closeDialog(){this.dialogRef.close()}}return r.\u0275fac=function(a){return new(a||r)(s.Y36(ht.so),s.Y36(ht.WI),s.Y36(tt),s.Y36(Jt),s.Y36(K))},r.\u0275cmp=s.Xpm({type:r,selectors:[["app-upload-data"]],decls:9,vars:0,consts:[[1,"p-flex","mb-3","upload-header"],["role","button",3,"click"],["type","file","name","","id","file","accept",".json, .geojson","multiple","false","width","30px",3,"change"],[1,"p-flex","mt-1","mb-3","text-primary"]],template:function(a,p){1&a&&(s.TgZ(0,"div")(1,"div",0)(2,"h2"),s._uU(3,"UPLOAD FILE"),s.qZA(),s.TgZ(4,"mat-icon",1),s.NdJ("click",function(){return p.closeDialog()}),s._uU(5,"close"),s.qZA()(),s.TgZ(6,"input",2),s.NdJ("change",function(v){return p.uploadFile(v)}),s.qZA(),s.TgZ(7,"div",3),s._uU(8," size - 4 MB (MAX) "),s.qZA()())},dependencies:[X.Hw],styles:["input[_ngcontent-%COMP%]{width:100%}.upload-header[_ngcontent-%COMP%]{position:relative}.upload-header[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{position:absolute;right:0;top:3px}"]}),r})();const Vy=["mouseTip"];function Zy(r,o){1&r&&(s.TgZ(0,"div")(1,"h3",52),s._uU(2,"* Please use mouse right click for open feature form for marker and text"),s.qZA()())}function jy(r,o){1&r&&(s.TgZ(0,"div")(1,"h3",52),s._uU(2,"* Please do not drag or edit points while you are using rotate mode"),s.qZA()())}let Xy=(()=>{class r{constructor(a,p,y,v,b,I,P){this.styleService=a,this.dataShareService=p,this.identityFeatureService=y,this.snackbarService=v,this.mapService=b,this.matDialog=I,this.downloadDataService=P,this.editModeGeoJsonCheck=0,this.canDeleteGeom=!1,this.layerEditMode=!1,this.geo_json_main={type:"FeatureCollection",features:[]},this.activeTool="simple-select",this.canDrawMarker=!1,this.drawContinuously=!1,this.showMapCursorTip=!1,this.mousePopUpMessage="Welcome to Your Map<br><sub>Please select any drawing type and enjoy !!</sub>",this.sendIdentityFeatureData=new s.vpe,this.isRotateModeActive=!1}ngOnInit(){}ngAfterViewInit(){this.drawDefinations(),this.dataShareService.initializeMapPopUp(),this.dataShareService.getSourceData.subscribe(a=>{this.geo_json_main=a}),this.mapService.getCircleFeature.subscribe(a=>{this.circlePolygonFeature=a}),this.map.on("click",a=>{this.canDrawMarker&&this.getCoordinates(a)})}drawDefinations(){this.map.on("draw.create",()=>this.getDrawSource("create")),this.map.on("draw.delete",()=>this.getDrawSource("delete")),this.map.on("draw.update",()=>this.getDrawSource("update")),this.setIdentityFeature()}setIdentityFeature(){this.map.on("click","YourMapSourceIdLineString",a=>{this.geomClickHandler(a)}),this.map.on("click","YourMapSourceIdPolygon",a=>{this.geomClickHandler(a)}),this.map.on("click","YourMapSourceIdPoint",a=>{this.geomClickHandler(a)}),this.setMouseEffectOnMap()}geomClickHandler(a){this.canDeleteGeom?this.deleteFeatureOnClick(a):"simple-select"==this.activeTool&&this.sendIdentityFeatureStatus(a)}deleteFeatureOnClick(a){let p={...this.geo_json_main};const y=a.features[0].properties.featureid;let v=p.features.findIndex(b=>b.id==y);p.features.splice(v,1),this.styleService.setDataOnMap(this.map,p),this.dataShareService.sendSourceData(p)}setMouseEffectOnMap(){this.map.on("mouseenter","YourMapSourceIdLineString",()=>{this.map.getCanvas().style.cursor="pointer"}),this.map.on("mouseenter","YourMapSourceIdPolygon",()=>{this.map.getCanvas().style.cursor="pointer"}),this.map.on("mouseenter","YourMapSourceIdPoint",()=>{this.map.getCanvas().style.cursor="pointer"}),this.map.on("mouseleave","YourMapSourceIdLineString",()=>{this.map.getCanvas().style.cursor=""}),this.map.on("mouseleave","YourMapSourceIdPolygon",()=>{this.map.getCanvas().style.cursor=""}),this.map.on("mouseleave","YourMapSourceIdPoint",()=>{this.map.getCanvas().style.cursor=""})}identityFeatureData(a){let p=Object.keys(a),y=[];return p.forEach(v=>{let b={name:"",value:""};b.name=v,b.value=a[v],y.push(b)}),y}sendIdentityFeatureStatus(a){this.showIdentityFeature(this.identityFeatureData(a.features[0].properties)),this.activeFeatureId=a.features[0].properties.featureid}showIdentityFeature(a){setTimeout(()=>{this.identityFeatureService.sendShowIdentityFeatureStatus(!1),setTimeout(()=>{this.identityFeatureService.sendShowIdentityFeatureStatus(!0),this.sendIdentityFeatureData.emit(a)},200)},0)}getDrawSource(a){if("create"==a&&(this.setGeoJsonMain(),this.styleService.setDataOnMap(this.map,this.geo_json_main),this.drawContinuously||(this.mousePopUpMessage="Welcome to Your Map<br><sub>Please select any drawing type and enjoy !!</sub>")),"update"==a&&this.layerEditMode&&this.editModeGeoJsonCheck++,this.sendDrawSourceData(),this.drawContinuously||this.canDeleteGeom){if("create"!==a)return;setTimeout(()=>{this.draw.changeMode(this.activeDrawMode)},0)}else setTimeout(()=>{this.afterDrawCreated()},0);this.showMapCursorTip&&this.mousePopupTurnOn()}setGeoJsonMain(){let p,a=this.draw.getAll();"draw_radius"==this.activeDrawMode?(p=this.circlePolygonFeature,p.id=this.draw.getAll().features[0].id,this.circlePolygonFeature=void 0):p=a.features[0],p&&(p.properties.featureid=a.features[0].id,p=this.setStyleDetails(p),this.geo_json_main.features.push(p),this.geo_json_main.features=this.getUniqueValue(),this.draw.deleteAll())}setStyleDetails(a){let p=a,y={fillcolor:"#10CAF0",fillopacity:.4,fillborderwidth:2,fillbordercolor:"#3b1513"},v={linecolor:"#572d06",linewidth:2};if("Polygon"==a.geometry.type){const C=Ea(a);p.styledetails={id:a.id,styledata:y},p.measurement={squaremeters:Math.round(100*C)/100}}if("Point"==a.geometry.type&&(this.drawCustomMarker?(p.styledetails=this.drawText?{id:a.id,styledata:{height:"20",width:"fit-content",color:"blue",textfontsize:"15",textname:"Edit Text"}}:{id:a.id,styledata:{height:"20",width:"20",markername:"marker"}},p.geometry.type="marker"):p.styledetails={id:a.id,styledata:{circleradius:6,circlecolor:"#B42222"}}),"LineString"==a.geometry.type){const C=bs(this.draw.getAll());p.styledetails={id:a.id,styledata:v},p.measurement={kilometers:C}}return p}getUniqueValue(){return this.geo_json_main.features.reduce(function(p,y){return p.filter(function(b){return b.id===y.id}).length>0||p.push(y),p},[])}afterDrawCreated(){this.activeTool=this.layerEditMode?"edit-mode":"simple-select"}getCoordinates(a){let p=a.lngLat.wrap();this.drawMarker([p.lng,p.lat])}drawMarker(a){this.marker=new xt.Marker({draggable:!0}).setLngLat(a).addTo(this.map),this.drawContinuously||(this.handleMarker("deactive"),this.activeTool="simple-select")}startDraw(a){if(this.identityFeatureService.sendShowIdentityFeatureStatus(!1),this.layerEditMode)this.snackbarService.openSnackbar(this.isRotateModeActive?"Please turn off layer rotate mode to use this feature":"Please turn of edit layer to use this feature","snackbar-err");else{switch(this.activeTool=a,"marker"!==this.activeTool&&this.handleMarker("deactive"),this.drawCustomMarker=!1,"delete-tool"!==a&&(this.canDeleteGeom=!1,this.styleService.canDeleteMarker=!1),a){case"polygon":this.activeDrawMode="draw_polygon",this.draw.changeMode(this.activeDrawMode),this.mousePopUpMessage="Use mouse left click to drop polygon vertices on map and for stop use mouse double click";break;case"circle":this.activeDrawMode="draw_radius",this.draw.changeMode(this.activeDrawMode),this.mousePopUpMessage="Use mouse left click one time then drag mouse for set radius and use mouse left click to stop";break;case"line":this.activeDrawMode="draw_line_string",this.draw.changeMode(this.activeDrawMode),this.mousePopUpMessage="Use mouse left click to drop line vertices and for stop use mouse double click";break;case"freehand":this.activeDrawMode="draw_freehand",this.draw.changeMode(this.activeDrawMode),this.mousePopUpMessage="Hold mouse left click and drag mouse to draw freehand polygon like pencil sketch";break;case"points":this.activeDrawMode="draw_point",this.draw.changeMode(this.activeDrawMode),this.mousePopUpMessage="Use mouse left click to ploat point";break;case"marker":this.activeDrawMode="active",this.handleMarker(this.activeDrawMode),this.mousePopUpMessage="Use mouse left click and draw marker";break;case"square":this.activeDrawMode="draw_rectangle",this.draw.changeMode(this.activeDrawMode),this.mousePopUpMessage="Press mouse left click one time to start drawing freehand Square and for stop only use mouse left click once";break;case"freehand-line":this.activeDrawMode="draw_freehand_line",this.draw.changeMode(this.activeDrawMode),this.mousePopUpMessage="Hold mouse left click and draw on map like pencil skectch";break;case"custom-marker":this.drawCustomMarker=!0,this.drawText=!1,this.activeDrawMode="draw_point",this.draw.changeMode(this.activeDrawMode),this.mousePopUpMessage="Press mouse left click and add marker on map";break;case"add-text":this.drawCustomMarker=!0,this.drawText=!0,this.activeDrawMode="draw_point",this.draw.changeMode(this.activeDrawMode),this.mousePopUpMessage="Press mouse left click to add text on map";break;case"simple-select":this.activeDrawMode="simple_select",this.draw.changeMode(this.activeDrawMode),this.mousePopUpMessage="Welcome to Your Map<br><sub>Please select any drawing type and enjoy !!</sub>";break;case"delete-tool":this.draw.changeMode("simple_select"),this.canDeleteGeom=!0,this.styleService.canDeleteMarker=!0,this.mousePopUpMessage="Click on feature which you want to delte"}this.showMapCursorTip&&this.dataShareService.useMapPopUp(this.map,this.mousePopUpMessage,"color: gray; font-family: fantasy;")}}rotateModeHandler(){this.editModeHandler(),setTimeout(()=>{this.draw.changeMode("rotate_mode")},0),this.isRotateModeActive=!this.isRotateModeActive}editModeHandler(){if(this.layerEditMode=!this.layerEditMode,this.layerEditMode){this.activeTool="edit-mode",this.mousePopUpMessage="Click on feature to edit or drag it on map",this.showMapCursorTip&&this.dataShareService.useMapPopUp(this.map,this.mousePopUpMessage,"color: gray; font-family: fantasy;"),this.draw.changeMode("simple_select");let a=this.downloadDataService.changeTypeMarkerToPoint(JSON.parse(JSON.stringify({...this.geo_json_main})));this.styleService.deleteAllMarkers(),this.draw.add(a),this.map.getSource("YourMapSource").setData({type:"FeatureCollection",features:[]})}else this.activeTool="simple-select",this.geo_json_main=this.setGeoJsonForStopEditMode(),this.editModeGeoJsonCheck>0||this.isRotateModeActive?this.styleService.setDataOnMap(this.map,this.geo_json_main,!1):this.styleService.setDataOnMap(this.map,this.geo_json_main,!1,!1),this.dataShareService.sendSourceData(this.geo_json_main),this.draw.deleteAll(),this.stopDraw(),this.editModeGeoJsonCheck=0}changeTypeMarkerToPoint(a){return a.features.forEach((p,y)=>{"marker"==p.geometry.type&&(a.features[y].geometry.type="Point")}),a}setGeoJsonForStopEditMode(){let a=this.draw.getAll();return this.geo_json_main.features.forEach((p,y)=>{a.features.forEach((v,b)=>{v.id==p.id&&(this.geo_json_main.features[y].geometry.coordinates=a.features[b].geometry.coordinates)})}),this.geo_json_main}stopDraw(){this.activeTool="simple-select",this.showMapCursorTip&&(this.mousePopUpMessage="Welcome to Your Map<br><sub>Please select any drawing type and enjoy !!</sub>",this.dataShareService.useMapPopUp(this.map,this.mousePopUpMessage,"color: gray; font-family: fantasy;")),this.draw.changeMode("simple_select"),this.handleMarker("deactive"),this.canDeleteGeom=!1,this.styleService.canDeleteMarker=!1}handleMarker(a){"active"==a?(this.draw.trash(),this.canDrawMarker=!0):this.canDrawMarker=!1}getDrawContinousStatus(a){this.drawContinuously=a.checked,0==this.drawContinuously&&this.stopDraw()}getShowTipOnMouseStatus(a){a.checked?this.mousePopupTurnOn():this.mousePopupTurnOff()}mousePopupTurnOn(){this.showMapCursorTip=!0,this.dataShareService.useMapPopUp(this.map,this.mousePopUpMessage,"color: gray; font-family: fantasy;")}mousePopupTurnOff(){this.showMapCursorTip=!1,this.dataShareService.removeMapPopUp()}sendDrawSourceData(){this.dataShareService.sendSourceData(this.geo_json_main)}showDataTable(){this.dataShareService.sendShowDataTableStatus(!0),this.stopDraw()}addLabelHandler(a){if(1==a.checked){let p=this.downloadDataService.changeTypeMarkerToPoint(JSON.parse(JSON.stringify({...this.geo_json_main}))),y=this.changeTypePolygonToPoint(JSON.parse(JSON.stringify({...p})));this.mapService.addLabelFn(y),console.log(this.geo_json_main)}else this.mapService.removeLabelFn()}changeTypePolygonToPoint(a){let p={...a};return p.features.forEach((y,v)=>{if("Polygon"==y.geometry.type){let b=function Ro(r,o){void 0===o&&(o={});var a=0,p=0,y=0;return ss(r,function(v){a+=v[0],p+=v[1],y++},!0),xn([a/y,p/y],o.properties)}(y);p.features[v].geometry=b.geometry}}),p}undo(){this.layerEditMode?this.snackbarService.openSnackbar("Please turn of edit layer to use undo","snackbar-err"):this.styleService.handleUndo()}redo(){this.layerEditMode?this.snackbarService.openSnackbar("Please turn of edit layer to use redo","snackbar-err"):this.styleService.handleRedo()}showUploadDialog(){this.matDialog.open(Gy,{width:"250px",data:{map:this.map},enterAnimationDuration:"200ms",exitAnimationDuration:"200ms"})}downloadData(){let a=JSON.parse(JSON.stringify({...this.geo_json_main}));this.downloadDataFinal(a,"geojson")}downloadDataFinal(a,p){a&&a.features.length>0?(a=this.downloadDataService.changeTypeMarkerToPoint(JSON.parse(JSON.stringify({...a}))),this.downloadDataService.downloadData(p,{...a})):this.snackbarService.openSnackbar("Please draw atleast one geometry","snackbar-err")}resetData(){this.draw.deleteAll(),this.stopDraw(),this.geo_json_main={type:"FeatureCollection",features:[]},this.dataShareService.sendSourceData(this.geo_json_main),this.mapService.removeLayerFn(),this.mapService.removeSourceFn(),this.styleService.deleteAllMarkers(),this.mapService.addSourceFn(),this.layerEditMode=!1,this.isRotateModeActive=!1}}return r.\u0275fac=function(a){return new(a||r)(s.Y36(tt),s.Y36(Jt),s.Y36(mt),s.Y36(K),s.Y36(Yf),s.Y36(ht.uw),s.Y36(ag))},r.\u0275cmp=s.Xpm({type:r,selectors:[["app-draw-common"]],viewQuery:function(a,p){if(1&a&&s.Gf(Vy,5),2&a){let y;s.iGM(y=s.CRH())&&(p.mouseTip=y.first)}},inputs:{draw:"draw",map:"map"},outputs:{sendIdentityFeatureData:"sendIdentityFeatureData"},decls:72,vars:32,consts:[[1,"draw-main","px-3","pb-3"],["matTooltip","Hold mouse left click and drag mouse to draw freehand polygon like pencil sketch",1,"border","p-2","draw-tool","p-flex",3,"disabled","ngClass","click"],["xmlns","http://www.w3.org/2000/svg","width","16","height","16","fill","currentColor","viewBox","0 0 16 16",1,"bi","bi-pen"],["d","m13.498.795.149-.149a1.207 1.207 0 1 1 1.707 1.708l-.149.148a1.5 1.5 0 0 1-.059 2.059L4.854 14.854a.5.5 0 0 1-.233.131l-4 1a.5.5 0 0 1-.606-.606l1-4a.5.5 0 0 1 .131-.232l9.642-9.642a.5.5 0 0 0-.642.056L6.854 4.854a.5.5 0 1 1-.708-.708L9.44.854A1.5 1.5 0 0 1 11.5.796a1.5 1.5 0 0 1 1.998-.001zm-.644.766a.5.5 0 0 0-.707 0L1.95 11.756l-.764 3.057 3.057-.764L14.44 3.854a.5.5 0 0 0 0-.708l-1.585-1.585z"],["matTooltip","Use mouse left click to drop polygon vertices on map and for stop use mouse double click",1,"border","p-2","draw-tool","p-flex",3,"disabled","ngClass","click"],["xmlns","http://www.w3.org/2000/svg","width","16","height","16","fill","currentColor","viewBox","0 0 16 16",1,"bi","bi-pentagon"],["d","M7.685 1.545a.5.5 0 0 1 .63 0l6.263 5.088a.5.5 0 0 1 .161.539l-2.362 7.479a.5.5 0 0 1-.476.349H4.099a.5.5 0 0 1-.476-.35L1.26 7.173a.5.5 0 0 1 .161-.54l6.263-5.087Zm8.213 5.28a.5.5 0 0 0-.162-.54L8.316.257a.5.5 0 0 0-.631 0L.264 6.286a.5.5 0 0 0-.162.538l2.788 8.827a.5.5 0 0 0 .476.349h9.268a.5.5 0 0 0 .476-.35l2.788-8.826Z"],["matTooltip","Press mouse left click once to start drawing freehand Square and for stop only use mouse left click once",1,"border","p-2","draw-tool","p-flex",3,"disabled","ngClass","click"],["xmlns","http://www.w3.org/2000/svg","width","16","height","16","fill","currentColor","viewBox","0 0 16 16",1,"bi","bi-square"],["d","M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h12zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2z"],["matTooltip","Use mouse left click once then drag mouse for set radius then use mouse left click to stop",1,"border","p-2","draw-tool","p-flex",3,"disabled","ngClass","click"],["xmlns","http://www.w3.org/2000/svg","width","16","height","16","fill","currentColor","viewBox","0 0 16 16",1,"bi","bi-circle"],["d","M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"],["matTooltip","Use mouse left click to drop line vertices and for stop use mouse double click",1,"border","p-2","draw-tool","p-flex",3,"disabled","ngClass","click"],["xmlns","http://www.w3.org/2000/svg","width","16","height","16","fill","currentColor","viewBox","0 0 16 16",1,"bi","bi-dash-lg"],["fill-rule","evenodd","d","M2 8a.5.5 0 0 1 .5-.5h11a.5.5 0 0 1 0 1h-11A.5.5 0 0 1 2 8Z"],["matTooltip","Hold mouse left click and draw freehand line like pencil sketch",1,"border","p-2","draw-tool","p-flex",3,"disabled","ngClass","click"],["xmlns","http://www.w3.org/2000/svg","width","16","height","16","fill","currentColor","viewBox","0 0 16 16",1,"bi","bi-pencil"],["d","M12.146.146a.5.5 0 0 1 .708 0l3 3a.5.5 0 0 1 0 .708l-10 10a.5.5 0 0 1-.168.11l-5 2a.5.5 0 0 1-.65-.65l2-5a.5.5 0 0 1 .11-.168l10-10zM11.207 2.5 13.5 4.793 14.793 3.5 12.5 1.207 11.207 2.5zm1.586 3L10.5 3.207 4 9.707V10h.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.5h.293l6.5-6.5zm-9.761 5.175-.106.106-1.528 3.821 3.821-1.528.106-.106A.5.5 0 0 1 5 12.5V12h-.5a.5.5 0 0 1-.5-.5V11h-.5a.5.5 0 0 1-.468-.325z"],["matTooltip","Press mouse left click and add marker on map",1,"border","p-2","draw-tool","p-flex",3,"disabled","ngClass","click"],["xmlns","http://www.w3.org/2000/svg","width","16","height","16","fill","currentColor","viewBox","0 0 16 16",1,"bi","bi-geo-alt"],["d","M12.166 8.94c-.524 1.062-1.234 2.12-1.96 3.07A31.493 31.493 0 0 1 8 14.58a31.481 31.481 0 0 1-2.206-2.57c-.726-.95-1.436-2.008-1.96-3.07C3.304 7.867 3 6.862 3 6a5 5 0 0 1 10 0c0 .862-.305 1.867-.834 2.94zM8 16s6-5.686 6-10A6 6 0 0 0 2 6c0 4.314 6 10 6 10z"],["d","M8 8a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm0 1a3 3 0 1 0 0-6 3 3 0 0 0 0 6z"],["matTooltip","Draw points",1,"border","p-2","draw-tool","p-flex",3,"disabled","ngClass","click"],["xmlns","http://www.w3.org/2000/svg","width","16","height","16","fill","currentColor","viewBox","0 0 16 16",1,"bi","bi-circle-fill"],["cx","8","cy","8","r","8"],["matTooltip","Press mouse left click to add text on map then use click to customize it",1,"border","p-2","draw-tool","p-flex",3,"disabled","ngClass","click"],[1,"draw-main","px-3","mb-3"],["matTooltip","Simple select mode",1,"border","p-2","draw-tool","p-flex",3,"disabled","ngClass","click"],["xmlns","http://www.w3.org/2000/svg","width","16","height","16","fill","currentColor","viewBox","0 0 16 16",1,"bi","bi-hand-index-thumb-fill"],["d","M8.5 1.75v2.716l.047-.002c.312-.012.742-.016 1.051.046.28.056.543.18.738.288.273.152.456.385.56.642l.132-.012c.312-.024.794-.038 1.158.108.37.148.689.487.88.716.075.09.141.175.195.248h.582a2 2 0 0 1 1.99 2.199l-.272 2.715a3.5 3.5 0 0 1-.444 1.389l-1.395 2.441A1.5 1.5 0 0 1 12.42 16H6.118a1.5 1.5 0 0 1-1.342-.83l-1.215-2.43L1.07 8.589a1.517 1.517 0 0 1 2.373-1.852L5 8.293V1.75a1.75 1.75 0 0 1 3.5 0z"],["matTooltip","Undo changes",1,"border","p-2","draw-tool","p-flex",3,"disabled","click"],["matTooltip","Redo changes",1,"border","p-2","draw-tool","p-flex",3,"disabled","click"],["matTooltip","Delete features",1,"border","p-2","draw-tool","p-flex",3,"disabled","ngClass","click"],["matTooltip","Click on feature to edit or drag it on map",1,"border","py-2","draw-tool","p-flex",3,"disabled","ngClass","click"],["xmlns","http://www.w3.org/2000/svg","width","16","height","16","fill","currentColor","viewBox","0 0 16 16",1,"bi","bi-pencil-square"],["d","M15.502 1.94a.5.5 0 0 1 0 .706L14.459 3.69l-2-2L13.502.646a.5.5 0 0 1 .707 0l1.293 1.293zm-1.75 2.456-2-2L4.939 9.21a.5.5 0 0 0-.121.196l-.805 2.414a.25.25 0 0 0 .316.316l2.414-.805a.5.5 0 0 0 .196-.12l6.813-6.814z"],["fill-rule","evenodd","d","M1 13.5A1.5 1.5 0 0 0 2.5 15h11a1.5 1.5 0 0 0 1.5-1.5v-6a.5.5 0 0 0-1 0v6a.5.5 0 0 1-.5.5h-11a.5.5 0 0 1-.5-.5v-11a.5.5 0 0 1 .5-.5H9a.5.5 0 0 0 0-1H2.5A1.5 1.5 0 0 0 1 2.5v11z"],["matTooltip","Rotate features on map holding mouse left click",1,"border","py-2","draw-tool","p-flex",3,"disabled","ngClass","click"],[1,"px-3","toggle-div"],["color","primary",1,"d-block",3,"change"],["mouseTip",""],[4,"ngIf"],[1,"d-flex","justify-content-center"],[1,"mt-3","btn","btn-sm","btn-danger","me-1",3,"click"],[1,"mt-3","btn","btn-sm","btn-secondary",3,"click"],[1,"mt-3","btn","btn-sm","btn-warning","me-1",3,"disabled","click"],[1,"mt-3","btn","btn-sm","btn-success","d-flex","align-items-center",3,"disabled","click"],["xmlns","http://www.w3.org/2000/svg","width","16","height","16","fill","currentColor","viewBox","0 0 16 16",1,"bi","bi-download"],["d","M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"],["d","M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"],[1,"ms-1"],[1,"alert","alert-danger","text-dark","mt-3","p-2","text-center","border","border-danger","shadow-sm",2,"font-size","15px","line-height","15px"]],template:function(a,p){1&a&&(s.TgZ(0,"div",0)(1,"button",1),s.NdJ("click",function(){return p.startDraw("freehand")}),s.O4$(),s.TgZ(2,"svg",2),s._UZ(3,"path",3),s.qZA()(),s.kcU(),s.TgZ(4,"button",4),s.NdJ("click",function(){return p.startDraw("polygon")}),s.O4$(),s.TgZ(5,"svg",5),s._UZ(6,"path",6),s.qZA()(),s.kcU(),s.TgZ(7,"button",7),s.NdJ("click",function(){return p.startDraw("square")}),s.O4$(),s.TgZ(8,"svg",8),s._UZ(9,"path",9),s.qZA()(),s.kcU(),s.TgZ(10,"button",10),s.NdJ("click",function(){return p.startDraw("circle")}),s.O4$(),s.TgZ(11,"svg",11),s._UZ(12,"path",12),s.qZA()(),s.kcU(),s.TgZ(13,"button",13),s.NdJ("click",function(){return p.startDraw("line")}),s.O4$(),s.TgZ(14,"svg",14),s._UZ(15,"path",15),s.qZA()(),s.kcU(),s.TgZ(16,"button",16),s.NdJ("click",function(){return p.startDraw("freehand-line")}),s.O4$(),s.TgZ(17,"svg",17),s._UZ(18,"path",18),s.qZA()(),s.kcU(),s.TgZ(19,"button",19),s.NdJ("click",function(){return p.startDraw("custom-marker")}),s.O4$(),s.TgZ(20,"svg",20),s._UZ(21,"path",21)(22,"path",22),s.qZA()(),s.kcU(),s.TgZ(23,"button",23),s.NdJ("click",function(){return p.startDraw("points")}),s.O4$(),s.TgZ(24,"svg",24),s._UZ(25,"circle",25),s.qZA()(),s.kcU(),s.TgZ(26,"button",26),s.NdJ("click",function(){return p.startDraw("add-text")}),s.TgZ(27,"mat-icon"),s._uU(28," text_fields"),s.qZA()()(),s._UZ(29,"br"),s.TgZ(30,"div",27)(31,"button",28),s.NdJ("click",function(){return p.startDraw("simple-select")}),s.O4$(),s.TgZ(32,"svg",29),s._UZ(33,"path",30),s.qZA()(),s.kcU(),s.TgZ(34,"button",31),s.NdJ("click",function(){return p.undo()}),s.TgZ(35,"mat-icon"),s._uU(36,"undo"),s.qZA()(),s.TgZ(37,"button",32),s.NdJ("click",function(){return p.redo()}),s.TgZ(38,"mat-icon"),s._uU(39,"redo"),s.qZA()(),s.TgZ(40,"button",33),s.NdJ("click",function(){return p.startDraw("delete-tool")}),s.TgZ(41,"mat-icon"),s._uU(42,"delete_sweep"),s.qZA()(),s.TgZ(43,"button",34),s.NdJ("click",function(){return p.editModeHandler()}),s.O4$(),s.TgZ(44,"svg",35),s._UZ(45,"path",36)(46,"path",37),s.qZA()(),s.kcU(),s.TgZ(47,"button",38),s.NdJ("click",function(){return p.rotateModeHandler()}),s.TgZ(48,"mat-icon"),s._uU(49,"rotate_left"),s.qZA()()(),s.TgZ(50,"div",39)(51,"mat-slide-toggle",40),s.NdJ("change",function(v){return p.getDrawContinousStatus(v)}),s._uU(52,"Draw Continuously "),s.qZA(),s.TgZ(53,"mat-slide-toggle",40,41),s.NdJ("change",function(v){return p.getShowTipOnMouseStatus(v)}),s._uU(55,"Show Tip On Cursor"),s.qZA()(),s.YNc(56,Zy,3,0,"div",42),s.YNc(57,jy,3,0,"div",42),s.TgZ(58,"div",43)(59,"button",44),s.NdJ("click",function(){return p.resetData()}),s._uU(60,"Reset"),s.qZA(),s.TgZ(61,"button",45),s.NdJ("click",function(){return p.showDataTable()}),s._uU(62,"Show Table"),s.qZA()(),s.TgZ(63,"div",43)(64,"button",46),s.NdJ("click",function(){return p.showUploadDialog()}),s._uU(65,"Upload"),s.qZA(),s.TgZ(66,"button",47),s.NdJ("click",function(){return p.downloadData()}),s.O4$(),s.TgZ(67,"svg",48),s._UZ(68,"path",49)(69,"path",50),s.qZA(),s.kcU(),s.TgZ(70,"span",51),s._uU(71,"Download"),s.qZA()()()),2&a&&(s.xp6(1),s.Q6J("disabled",p.layerEditMode||p.isRotateModeActive)("ngClass","freehand"==p.activeTool?"active-tool":""),s.xp6(3),s.Q6J("disabled",p.layerEditMode||p.isRotateModeActive)("ngClass","polygon"==p.activeTool?"active-tool":""),s.xp6(3),s.Q6J("disabled",p.layerEditMode||p.isRotateModeActive)("ngClass","square"==p.activeTool?"active-tool":""),s.xp6(3),s.Q6J("disabled",p.layerEditMode||p.isRotateModeActive)("ngClass","circle"==p.activeTool?"active-tool":""),s.xp6(3),s.Q6J("disabled",p.layerEditMode||p.isRotateModeActive)("ngClass","line"==p.activeTool?"active-tool":""),s.xp6(3),s.Q6J("disabled",p.layerEditMode||p.isRotateModeActive)("ngClass","freehand-line"==p.activeTool?"active-tool":""),s.xp6(3),s.Q6J("disabled",p.layerEditMode||p.isRotateModeActive)("ngClass","custom-marker"==p.activeTool?"active-tool":""),s.xp6(4),s.Q6J("disabled",p.layerEditMode||p.isRotateModeActive)("ngClass","points"==p.activeTool?"active-tool":""),s.xp6(3),s.Q6J("disabled",p.layerEditMode||p.isRotateModeActive)("ngClass","add-text"==p.activeTool?"active-tool":""),s.xp6(5),s.Q6J("disabled",p.layerEditMode||p.isRotateModeActive)("ngClass","simple-select"==p.activeTool?"active-tool":""),s.xp6(3),s.Q6J("disabled",p.layerEditMode||p.isRotateModeActive),s.xp6(3),s.Q6J("disabled",p.layerEditMode||p.isRotateModeActive),s.xp6(3),s.Q6J("disabled",p.layerEditMode||p.isRotateModeActive)("ngClass","delete-tool"==p.activeTool?"active-tool":""),s.xp6(3),s.Q6J("disabled",p.isRotateModeActive||0==p.geo_json_main.features.length)("ngClass","edit-mode"!=p.activeTool||p.isRotateModeActive?"":"active-tool"),s.xp6(4),s.Q6J("disabled",p.layerEditMode&&!p.isRotateModeActive||0==p.geo_json_main.features.length)("ngClass",p.isRotateModeActive?"active-tool":""),s.xp6(9),s.Q6J("ngIf","custom-marker"==p.activeTool||"add-text"==p.activeTool),s.xp6(1),s.Q6J("ngIf",p.isRotateModeActive),s.xp6(7),s.Q6J("disabled",p.layerEditMode||p.isRotateModeActive),s.xp6(2),s.Q6J("disabled",0==p.geo_json_main.features.length||p.layerEditMode||p.isRotateModeActive))},dependencies:[gt.mk,gt.O5,sg.gM,X.Hw,nt.Rr],styles:[".draw-tool[_ngcontent-%COMP%]{cursor:pointer}.active-tool[_ngcontent-%COMP%]{background:cyan!important}.draw-main[_ngcontent-%COMP%]{display:grid;grid-template-columns:auto auto auto;text-align:center;column-gap:10px;row-gap:10px}.draw-main[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background:#FFFFFF;height:50px}"]}),r})(),Yy=(()=>{class r{constructor(){this.sendIdentityFeatureData=new s.vpe}ngOnInit(){}sendIdentityFeatureDataFn(a){this.sendIdentityFeatureData.emit(a)}}return r.\u0275fac=function(a){return new(a||r)},r.\u0275cmp=s.Xpm({type:r,selectors:[["app-create-data"]],inputs:{map:"map",draw:"draw"},outputs:{sendIdentityFeatureData:"sendIdentityFeatureData"},decls:1,vars:2,consts:[[3,"map","draw","sendIdentityFeatureData"]],template:function(a,p){1&a&&(s.TgZ(0,"app-draw-common",0),s.NdJ("sendIdentityFeatureData",function(v){return p.sendIdentityFeatureDataFn(v)}),s.qZA()),2&a&&s.Q6J("map",p.map)("draw",p.draw)},dependencies:[Xy]}),r})();const Jy=[{path:"",component:(()=>{class r{constructor(a,p){this.dataShareService=a,this.downloadDataService=p,this.temp_geo_json_main={type:"FeatureCollection",features:[]}}showMessage(a){0!==this.temp_geo_json_main.features.length&&(a.returnValue="Your data will be lost!")}set content(a){a&&(this.mapCommonComponent=a)}ngOnInit(){this.dataShareService.getSourceData.subscribe(a=>{this.temp_geo_json_main=a}),this.downloadDataService.downloadDone.subscribe(a=>{this.temp_geo_json_main={type:"FeatureCollection",features:[]}})}getMapData(a){this.map=a.map,this.draw=a.draw}sendIdentityFeatureDataFn(a){this.mapCommonComponent.sendIdentityFeatureData(a)}}return r.\u0275fac=function(a){return new(a||r)(s.Y36(Jt),s.Y36(ag))},r.\u0275cmp=s.Xpm({type:r,selectors:[["app-home"]],viewQuery:function(a,p){if(1&a&&s.Gf(ym,5),2&a){let y;s.iGM(y=s.CRH())&&(p.content=y.first)}},hostBindings:function(a,p){1&a&&s.NdJ("beforeunload",function(v){return p.showMessage(v)},!1,s.Jf7)},decls:7,vars:4,consts:[[1,"main-div"],[1,"map-wrapper"],[3,"mapDataEmit"],[1,"border-end","border-dark","side-nav-wrapper"],[3,"map","draw","sendIdentityFeatureData"],[3,"map","draw"]],template:function(a,p){1&a&&(s.TgZ(0,"div",0)(1,"div",1)(2,"app-map-common",2),s.NdJ("mapDataEmit",function(v){return p.getMapData(v)}),s.qZA()(),s.TgZ(3,"div",3),s._UZ(4,"app-header"),s.TgZ(5,"app-create-data",4),s.NdJ("sendIdentityFeatureData",function(v){return p.sendIdentityFeatureDataFn(v)}),s.qZA(),s._UZ(6,"app-map-styles",5),s.qZA()()),2&a&&(s.xp6(5),s.Q6J("map",p.map)("draw",p.draw),s.xp6(1),s.Q6J("map",p.map)("draw",p.draw))},dependencies:[ym,Uy,qy,Yy],styles:[".main-div[_ngcontent-%COMP%]{width:100%;height:100vh;display:flex;flex-direction:row-reverse}.map-wrapper[_ngcontent-%COMP%]{height:100vh;width:100%}.side-nav-wrapper[_ngcontent-%COMP%]{position:relative;width:300px;overflow:hidden}"]}),r})()}];let Hy=(()=>{class r{}return r.\u0275fac=function(a){return new(a||r)},r.\u0275mod=s.oAB({type:r}),r.\u0275inj=s.cJS({imports:[Pt.Bz.forChild(Jy),Pt.Bz]}),r})();const Wy=[];let Ky=(()=>{class r{}return r.\u0275fac=function(a){return new(a||r)},r.\u0275mod=s.oAB({type:r}),r.\u0275inj=s.cJS({imports:[Pt.Bz.forChild(Wy),Pt.Bz]}),r})();var ug=It(8147);const $y=[];let Qy=(()=>{class r{}return r.\u0275fac=function(a){return new(a||r)},r.\u0275mod=s.oAB({type:r}),r.\u0275inj=s.cJS({imports:[Pt.Bz.forChild($y),Pt.Bz]}),r})(),vm=(()=>{class r{}return r.\u0275fac=function(a){return new(a||r)},r.\u0275mod=s.oAB({type:r}),r.\u0275inj=s.cJS({imports:[gt.ez,Qy,ug.i,lt.UX,lt.u5,ye.e4]}),r})(),tv=(()=>{class r{}return r.\u0275fac=function(a){return new(a||r)},r.\u0275mod=s.oAB({type:r}),r.\u0275inj=s.cJS({imports:[gt.ez,Ky,ug.i,lt.u5,vm]}),r})(),ev=(()=>{class r{}return r.\u0275fac=function(a){return new(a||r)},r.\u0275mod=s.oAB({type:r}),r.\u0275inj=s.cJS({imports:[gt.ez,Hy,tv,ug.i,vm]}),r})()},1503:(tr,ce,It)=>{"use strict";var Pt=It(9626);function s(lt){var ht=[1/0,1/0,-1/0,-1/0];return Pt.coordEach(lt,function(Lt){ht[0]>Lt[0]&&(ht[0]=Lt[0]),ht[1]>Lt[1]&&(ht[1]=Lt[1]),ht[2]<Lt[0]&&(ht[2]=Lt[0]),ht[3]<Lt[1]&&(ht[3]=Lt[1])}),ht}s.default=s,ce.Z=s},5427:(tr,ce,It)=>{"use strict";var Pt=It(9626),s=It(8275);ce.Z=function lt(ht,Lt){void 0===Lt&&(Lt={});var Ft=0,Qt=0,qt=0;return Pt.coordEach(ht,function(_e){Ft+=_e[0],Qt+=_e[1],qt++},!0),s.point([Ft/qt,Qt/qt],Lt.properties)}},9814:(tr,ce,It)=>{"use strict";var Pt=It(8275),s=It(8418);ce.Z=function lt(ht,Lt,Ft,Qt){void 0===Qt&&(Qt={});var qt=s.getCoord(ht),_e=Pt.degreesToRadians(qt[0]),mt=Pt.degreesToRadians(qt[1]),xt=Pt.degreesToRadians(Ft),Jt=Pt.lengthToRadians(Lt,Qt.units),ye=Math.asin(Math.sin(mt)*Math.cos(Jt)+Math.cos(mt)*Math.sin(Jt)*Math.cos(xt)),j=_e+Math.atan2(Math.sin(xt)*Math.sin(Jt)*Math.cos(mt),Math.cos(Jt)-Math.sin(mt)*Math.sin(ye)),it=Pt.radiansToDegrees(j),K=Pt.radiansToDegrees(ye);return Pt.point([it,K],Qt.properties)}},2777:(tr,ce,It)=>{"use strict";var Pt=It(8418),s=It(8275);ce.Z=function lt(ht,Lt,Ft){void 0===Ft&&(Ft={});var Qt=Pt.getCoord(ht),qt=Pt.getCoord(Lt),_e=s.degreesToRadians(qt[1]-Qt[1]),mt=s.degreesToRadians(qt[0]-Qt[0]),xt=s.degreesToRadians(Qt[1]),Jt=s.degreesToRadians(qt[1]),ye=Math.pow(Math.sin(_e/2),2)+Math.pow(Math.sin(mt/2),2)*Math.cos(xt)*Math.cos(Jt);return s.radiansToLength(2*Math.atan2(Math.sqrt(ye),Math.sqrt(1-ye)),Ft.units)}},8275:(tr,ce)=>{"use strict";function It(St,kt,dt){void 0===dt&&(dt={});var je={type:"Feature"};return(0===dt.id||dt.id)&&(je.id=dt.id),dt.bbox&&(je.bbox=dt.bbox),je.properties=kt||{},je.geometry=St,je}function Pt(St,kt,dt){if(void 0===dt&&(dt={}),!St)throw new Error("coordinates is required");if(!Array.isArray(St))throw new Error("coordinates must be an Array");if(St.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!et(St[0])||!et(St[1]))throw new Error("coordinates must contain numbers");return It({type:"Point",coordinates:St},kt,dt)}function lt(St,kt,dt){void 0===dt&&(dt={});for(var je=0,Ce=St;je<Ce.length;je++){var Mt=Ce[je];if(Mt.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var pe=0;pe<Mt[Mt.length-1].length;pe++)if(Mt[Mt.length-1][pe]!==Mt[0][pe])throw new Error("First and last Position are not equivalent.")}return It({type:"Polygon",coordinates:St},kt,dt)}function Lt(St,kt,dt){if(void 0===dt&&(dt={}),St.length<2)throw new Error("coordinates must be an array of two or more positions");return It({type:"LineString",coordinates:St},kt,dt)}function Qt(St,kt){void 0===kt&&(kt={});var dt={type:"FeatureCollection"};return kt.id&&(dt.id=kt.id),kt.bbox&&(dt.bbox=kt.bbox),dt.features=St,dt}function qt(St,kt,dt){return void 0===dt&&(dt={}),It({type:"MultiLineString",coordinates:St},kt,dt)}function _e(St,kt,dt){return void 0===dt&&(dt={}),It({type:"MultiPoint",coordinates:St},kt,dt)}function mt(St,kt,dt){return void 0===dt&&(dt={}),It({type:"MultiPolygon",coordinates:St},kt,dt)}function ye(St,kt){void 0===kt&&(kt="kilometers");var dt=ce.factors[kt];if(!dt)throw new Error(kt+" units is invalid");return St*dt}function j(St,kt){void 0===kt&&(kt="kilometers");var dt=ce.factors[kt];if(!dt)throw new Error(kt+" units is invalid");return St/dt}function tt(St){return St%(2*Math.PI)*180/Math.PI}function et(St){return!isNaN(St)&&null!==St&&!Array.isArray(St)}Object.defineProperty(ce,"__esModule",{value:!0}),ce.earthRadius=6371008.8,ce.factors={centimeters:100*ce.earthRadius,centimetres:100*ce.earthRadius,degrees:ce.earthRadius/111325,feet:3.28084*ce.earthRadius,inches:39.37*ce.earthRadius,kilometers:ce.earthRadius/1e3,kilometres:ce.earthRadius/1e3,meters:ce.earthRadius,metres:ce.earthRadius,miles:ce.earthRadius/1609.344,millimeters:1e3*ce.earthRadius,millimetres:1e3*ce.earthRadius,nauticalmiles:ce.earthRadius/1852,radians:1,yards:1.0936*ce.earthRadius},ce.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:.001,kilometres:.001,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/ce.earthRadius,yards:1.0936133},ce.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046},ce.feature=It,ce.geometry=function gt(St,kt,dt){switch(void 0===dt&&(dt={}),St){case"Point":return Pt(kt).geometry;case"LineString":return Lt(kt).geometry;case"Polygon":return lt(kt).geometry;case"MultiPoint":return _e(kt).geometry;case"MultiLineString":return qt(kt).geometry;case"MultiPolygon":return mt(kt).geometry;default:throw new Error(St+" is invalid")}},ce.point=Pt,ce.points=function s(St,kt,dt){return void 0===dt&&(dt={}),Qt(St.map(function(je){return Pt(je,kt)}),dt)},ce.polygon=lt,ce.polygons=function ht(St,kt,dt){return void 0===dt&&(dt={}),Qt(St.map(function(je){return lt(je,kt)}),dt)},ce.lineString=Lt,ce.lineStrings=function Ft(St,kt,dt){return void 0===dt&&(dt={}),Qt(St.map(function(je){return Lt(je,kt)}),dt)},ce.featureCollection=Qt,ce.multiLineString=qt,ce.multiPoint=_e,ce.multiPolygon=mt,ce.geometryCollection=function xt(St,kt,dt){return void 0===dt&&(dt={}),It({type:"GeometryCollection",geometries:St},kt,dt)},ce.round=function Jt(St,kt){if(void 0===kt&&(kt=0),kt&&!(kt>=0))throw new Error("precision must be a positive number");var dt=Math.pow(10,kt||0);return Math.round(St*dt)/dt},ce.radiansToLength=ye,ce.lengthToRadians=j,ce.lengthToDegrees=function it(St,kt){return tt(j(St,kt))},ce.bearingToAzimuth=function K(St){var kt=St%360;return kt<0&&(kt+=360),kt},ce.radiansToDegrees=tt,ce.degreesToRadians=function X(St){return St%360*Math.PI/180},ce.convertLength=function nt(St,kt,dt){if(void 0===kt&&(kt="kilometers"),void 0===dt&&(dt="kilometers"),!(St>=0))throw new Error("length must be a positive number");return ye(j(St,kt),dt)},ce.convertArea=function J(St,kt,dt){if(void 0===kt&&(kt="meters"),void 0===dt&&(dt="kilometers"),!(St>=0))throw new Error("area must be a positive number");var je=ce.areaFactors[kt];if(!je)throw new Error("invalid original units");var Ce=ce.areaFactors[dt];if(!Ce)throw new Error("invalid final units");return St/je*Ce},ce.isNumber=et,ce.isObject=function at(St){return!!St&&St.constructor===Object},ce.validateBBox=function Z(St){if(!St)throw new Error("bbox is required");if(!Array.isArray(St))throw new Error("bbox must be an Array");if(4!==St.length&&6!==St.length)throw new Error("bbox must be an Array of 4 or 6 numbers");St.forEach(function(kt){if(!et(kt))throw new Error("bbox must only contain numbers")})},ce.validateId=function Wt(St){if(!St)throw new Error("id is required");if(-1===["string","number"].indexOf(typeof St))throw new Error("id must be a number or a string")}},8418:(tr,ce,It)=>{"use strict";Object.defineProperty(ce,"__esModule",{value:!0});var gt=It(8275);ce.getCoord=function Pt(_e){if(!_e)throw new Error("coord is required");if(!Array.isArray(_e)){if("Feature"===_e.type&&null!==_e.geometry&&"Point"===_e.geometry.type)return _e.geometry.coordinates;if("Point"===_e.type)return _e.coordinates}if(Array.isArray(_e)&&_e.length>=2&&!Array.isArray(_e[0])&&!Array.isArray(_e[1]))return _e;throw new Error("coord must be GeoJSON Point or an Array of numbers")},ce.getCoords=function s(_e){if(Array.isArray(_e))return _e;if("Feature"===_e.type){if(null!==_e.geometry)return _e.geometry.coordinates}else if(_e.coordinates)return _e.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")},ce.containsNumber=function lt(_e){if(_e.length>1&&gt.isNumber(_e[0])&&gt.isNumber(_e[1]))return!0;if(Array.isArray(_e[0])&&_e[0].length)return lt(_e[0]);throw new Error("coordinates must only contain numbers")},ce.geojsonType=function ht(_e,mt,xt){if(!mt||!xt)throw new Error("type and name required");if(!_e||_e.type!==mt)throw new Error("Invalid input to "+xt+": must be a "+mt+", given "+_e.type)},ce.featureOf=function Lt(_e,mt,xt){if(!_e)throw new Error("No feature passed");if(!xt)throw new Error(".featureOf() requires a name");if(!_e||"Feature"!==_e.type||!_e.geometry)throw new Error("Invalid input to "+xt+", Feature with geometry required");if(!_e.geometry||_e.geometry.type!==mt)throw new Error("Invalid input to "+xt+": must be a "+mt+", given "+_e.geometry.type)},ce.collectionOf=function Ft(_e,mt,xt){if(!_e)throw new Error("No featureCollection passed");if(!xt)throw new Error(".collectionOf() requires a name");if(!_e||"FeatureCollection"!==_e.type)throw new Error("Invalid input to "+xt+", FeatureCollection required");for(var Jt=0,ye=_e.features;Jt<ye.length;Jt++){var j=ye[Jt];if(!j||"Feature"!==j.type||!j.geometry)throw new Error("Invalid input to "+xt+", Feature with geometry required");if(!j.geometry||j.geometry.type!==mt)throw new Error("Invalid input to "+xt+": must be a "+mt+", given "+j.geometry.type)}},ce.getGeom=function Qt(_e){return"Feature"===_e.type?_e.geometry:_e},ce.getType=function qt(_e,mt){return"FeatureCollection"===_e.type?"FeatureCollection":"GeometryCollection"===_e.type?"GeometryCollection":"Feature"===_e.type&&null!==_e.geometry?_e.geometry.type:_e.type}},9626:(tr,ce,It)=>{"use strict";Object.defineProperty(ce,"__esModule",{value:!0});var gt=It(8275);function Pt(X,nt,J){if(null!==X)for(var et,at,Z,Wt,St,kt,dt,Mt,je=0,Ce=0,pe=X.type,At="FeatureCollection"===pe,$t="Feature"===pe,fe=At?X.features.length:1,Ot=0;Ot<fe;Ot++){St=(Mt=!!(dt=At?X.features[Ot].geometry:$t?X.geometry:X)&&"GeometryCollection"===dt.type)?dt.geometries.length:1;for(var Be=0;Be<St;Be++){var De=0,sr=0;if(null!==(Wt=Mt?dt.geometries[Be]:dt)){kt=Wt.coordinates;var Ie=Wt.type;switch(je=!J||"Polygon"!==Ie&&"MultiPolygon"!==Ie?0:1,Ie){case null:break;case"Point":if(!1===nt(kt,Ce,Ot,De,sr))return!1;Ce++,De++;break;case"LineString":case"MultiPoint":for(et=0;et<kt.length;et++){if(!1===nt(kt[et],Ce,Ot,De,sr))return!1;Ce++,"MultiPoint"===Ie&&De++}"LineString"===Ie&&De++;break;case"Polygon":case"MultiLineString":for(et=0;et<kt.length;et++){for(at=0;at<kt[et].length-je;at++){if(!1===nt(kt[et][at],Ce,Ot,De,sr))return!1;Ce++}"MultiLineString"===Ie&&De++,"Polygon"===Ie&&sr++}"Polygon"===Ie&&De++;break;case"MultiPolygon":for(et=0;et<kt.length;et++){for(sr=0,at=0;at<kt[et].length;at++){for(Z=0;Z<kt[et][at].length-je;Z++){if(!1===nt(kt[et][at][Z],Ce,Ot,De,sr))return!1;Ce++}sr++}De++}break;case"GeometryCollection":for(et=0;et<Wt.geometries.length;et++)if(!1===Pt(Wt.geometries[et],nt,J))return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function lt(X,nt){var J;switch(X.type){case"FeatureCollection":for(J=0;J<X.features.length&&!1!==nt(X.features[J].properties,J);J++);break;case"Feature":nt(X.properties,0)}}function Lt(X,nt){if("Feature"===X.type)nt(X,0);else if("FeatureCollection"===X.type)for(var J=0;J<X.features.length&&!1!==nt(X.features[J],J);J++);}function qt(X,nt){var J,et,at,Z,Wt,St,kt,dt,je,Ce,Mt=0,pe="FeatureCollection"===X.type,At="Feature"===X.type,$t=pe?X.features.length:1;for(J=0;J<$t;J++){for(dt=pe?X.features[J].properties:At?X.properties:{},je=pe?X.features[J].bbox:At?X.bbox:void 0,Ce=pe?X.features[J].id:At?X.id:void 0,Wt=(kt=!!(St=pe?X.features[J].geometry:At?X.geometry:X)&&"GeometryCollection"===St.type)?St.geometries.length:1,at=0;at<Wt;at++)if(null!==(Z=kt?St.geometries[at]:St))switch(Z.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(!1===nt(Z,Mt,dt,je,Ce))return!1;break;case"GeometryCollection":for(et=0;et<Z.geometries.length;et++)if(!1===nt(Z.geometries[et],Mt,dt,je,Ce))return!1;break;default:throw new Error("Unknown Geometry Type")}else if(!1===nt(null,Mt,dt,je,Ce))return!1;Mt++}}function mt(X,nt){qt(X,function(J,et,at,Z,Wt){var kt,St=null===J?null:J.type;switch(St){case null:case"Point":case"LineString":case"Polygon":return!1!==nt(gt.feature(J,at,{bbox:Z,id:Wt}),et,0)&&void 0}switch(St){case"MultiPoint":kt="Point";break;case"MultiLineString":kt="LineString";break;case"MultiPolygon":kt="Polygon"}for(var dt=0;dt<J.coordinates.length;dt++)if(!1===nt(gt.feature({type:kt,coordinates:J.coordinates[dt]},at),et,dt))return!1})}function Jt(X,nt){mt(X,function(J,et,at){var Z=0;if(J.geometry){var Wt=J.geometry.type;if("Point"!==Wt&&"MultiPoint"!==Wt){var St,kt=0,dt=0,je=0;if(!1===Pt(J,function(Ce,Mt,pe,At,$t){if(void 0===St||et>kt||At>dt||$t>je)return St=Ce,kt=et,dt=At,je=$t,void(Z=0);var fe=gt.lineString([St,Ce],J.properties);if(!1===nt(fe,et,at,$t,Z))return!1;Z++,St=Ce}))return!1}}})}function j(X,nt){if(!X)throw new Error("geojson is required");mt(X,function(J,et,at){if(null!==J.geometry){var Wt=J.geometry.coordinates;switch(J.geometry.type){case"LineString":if(!1===nt(J,et,at,0,0))return!1;break;case"Polygon":for(var St=0;St<Wt.length;St++)if(!1===nt(gt.lineString(Wt[St],J.properties),et,at,St))return!1}}})}ce.coordAll=function Qt(X){var nt=[];return Pt(X,function(J){nt.push(J)}),nt},ce.coordEach=Pt,ce.coordReduce=function s(X,nt,J,et){var at=J;return Pt(X,function(Z,Wt,St,kt,dt){at=0===Wt&&void 0===J?Z:nt(at,Z,Wt,St,kt,dt)},et),at},ce.featureEach=Lt,ce.featureReduce=function Ft(X,nt,J){var et=J;return Lt(X,function(at,Z){et=0===Z&&void 0===J?at:nt(et,at,Z)}),et},ce.findPoint=function tt(X,nt){if(!gt.isObject(nt=nt||{}))throw new Error("options is invalid");var St,J=nt.featureIndex||0,et=nt.multiFeatureIndex||0,at=nt.geometryIndex||0,Z=nt.coordIndex||0,Wt=nt.properties;switch(X.type){case"FeatureCollection":J<0&&(J=X.features.length+J),Wt=Wt||X.features[J].properties,St=X.features[J].geometry;break;case"Feature":Wt=Wt||X.properties,St=X.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":St=X;break;default:throw new Error("geojson is invalid")}if(null===St)return null;var kt=St.coordinates;switch(St.type){case"Point":return gt.point(kt,Wt,nt);case"MultiPoint":return et<0&&(et=kt.length+et),gt.point(kt[et],Wt,nt);case"LineString":return Z<0&&(Z=kt.length+Z),gt.point(kt[Z],Wt,nt);case"Polygon":return at<0&&(at=kt.length+at),Z<0&&(Z=kt[at].length+Z),gt.point(kt[at][Z],Wt,nt);case"MultiLineString":return et<0&&(et=kt.length+et),Z<0&&(Z=kt[et].length+Z),gt.point(kt[et][Z],Wt,nt);case"MultiPolygon":return et<0&&(et=kt.length+et),at<0&&(at=kt[et].length+at),Z<0&&(Z=kt[et][at].length-Z),gt.point(kt[et][at][Z],Wt,nt)}throw new Error("geojson is invalid")},ce.findSegment=function K(X,nt){if(!gt.isObject(nt=nt||{}))throw new Error("options is invalid");var St,J=nt.featureIndex||0,et=nt.multiFeatureIndex||0,at=nt.geometryIndex||0,Z=nt.segmentIndex||0,Wt=nt.properties;switch(X.type){case"FeatureCollection":J<0&&(J=X.features.length+J),Wt=Wt||X.features[J].properties,St=X.features[J].geometry;break;case"Feature":Wt=Wt||X.properties,St=X.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":St=X;break;default:throw new Error("geojson is invalid")}if(null===St)return null;var kt=St.coordinates;switch(St.type){case"Point":case"MultiPoint":return null;case"LineString":return Z<0&&(Z=kt.length+Z-1),gt.lineString([kt[Z],kt[Z+1]],Wt,nt);case"Polygon":return at<0&&(at=kt.length+at),Z<0&&(Z=kt[at].length+Z-1),gt.lineString([kt[at][Z],kt[at][Z+1]],Wt,nt);case"MultiLineString":return et<0&&(et=kt.length+et),Z<0&&(Z=kt[et].length+Z-1),gt.lineString([kt[et][Z],kt[et][Z+1]],Wt,nt);case"MultiPolygon":return et<0&&(et=kt.length+et),at<0&&(at=kt[et].length+at),Z<0&&(Z=kt[et][at].length-Z-1),gt.lineString([kt[et][at][Z],kt[et][at][Z+1]],Wt,nt)}throw new Error("geojson is invalid")},ce.flattenEach=mt,ce.flattenReduce=function xt(X,nt,J){var et=J;return mt(X,function(at,Z,Wt){et=0===Z&&0===Wt&&void 0===J?at:nt(et,at,Z,Wt)}),et},ce.geomEach=qt,ce.geomReduce=function _e(X,nt,J){var et=J;return qt(X,function(at,Z,Wt,St,kt){et=0===Z&&void 0===J?at:nt(et,at,Z,Wt,St,kt)}),et},ce.lineEach=j,ce.lineReduce=function it(X,nt,J){var et=J;return j(X,function(at,Z,Wt,St){et=0===Z&&void 0===J?at:nt(et,at,Z,Wt,St)}),et},ce.propEach=lt,ce.propReduce=function ht(X,nt,J){var et=J;return lt(X,function(at,Z){et=0===Z&&void 0===J?at:nt(et,at,Z)}),et},ce.segmentEach=Jt,ce.segmentReduce=function ye(X,nt,J){var et=J,at=!1;return Jt(X,function(Z,Wt,St,kt,dt){et=!1===at&&void 0===J?Z:nt(et,Z,Wt,St,kt,dt),at=!0}),et}},5834:(tr,ce,It)=>{"use strict";var gt=It(5203),Pt=It(5685),s=Pt(gt("String.prototype.indexOf"));tr.exports=function(ht,Lt){var Ft=gt(ht,!!Lt);return"function"==typeof Ft&&s(ht,".prototype.")>-1?Pt(Ft):Ft}},5685:(tr,ce,It)=>{"use strict";var gt=It(4444),Pt=It(5203),s=Pt("%Function.prototype.apply%"),lt=Pt("%Function.prototype.call%"),ht=Pt("%Reflect.apply%",!0)||gt.call(lt,s),Lt=Pt("%Object.getOwnPropertyDescriptor%",!0),Ft=Pt("%Object.defineProperty%",!0),Qt=Pt("%Math.max%");if(Ft)try{Ft({},"a",{value:1})}catch{Ft=null}tr.exports=function(mt){var xt=ht(gt,lt,arguments);if(Lt&&Ft){var Jt=Lt(xt,"length");Jt.configurable&&Ft(xt,"length",{value:1+Qt(0,mt.length-(arguments.length-1))})}return xt};var qt=function(){return ht(gt,s,arguments)};Ft?Ft(tr.exports,"apply",{value:qt}):tr.exports.apply=qt},1335:(tr,ce,It)=>{"use strict";var gt=It(3156),Pt=It(7253),s=It(3870),lt=It(7563).orient2d;function ht(J,et,at){et=Math.max(0,void 0===et?2:et),at=at||0;var Z=function ye(J){for(var et=J[0],at=J[0],Z=J[0],Wt=J[0],St=0;St<J.length;St++){var kt=J[St];kt[0]<et[0]&&(et=kt),kt[0]>Z[0]&&(Z=kt),kt[1]<at[1]&&(at=kt),kt[1]>Wt[1]&&(Wt=kt)}var dt=[et,at,Z,Wt],je=dt.slice();for(St=0;St<J.length;St++)s(J[St],dt)||je.push(J[St]);return function nt(J){J.sort(X);for(var et=[],at=0;at<J.length;at++){for(;et.length>=2&&mt(et[et.length-2],et[et.length-1],J[at])<=0;)et.pop();et.push(J[at])}for(var Z=[],Wt=J.length-1;Wt>=0;Wt--){for(;Z.length>=2&&mt(Z[Z.length-2],Z[Z.length-1],J[Wt])<=0;)Z.pop();Z.push(J[Wt])}return Z.pop(),et.pop(),et.concat(Z)}(je)}(J),Wt=new gt(16);Wt.toBBox=function(sr){return{minX:sr[0],minY:sr[1],maxX:sr[0],maxY:sr[1]}},Wt.compareMinX=function(sr,Ie){return sr[0]-Ie[0]},Wt.compareMinY=function(sr,Ie){return sr[1]-Ie[1]},Wt.load(J);for(var dt,St=[],kt=0;kt<Z.length;kt++){var je=Z[kt];Wt.remove(je),dt=j(je,dt),St.push(dt)}var Ce=new gt(16);for(kt=0;kt<St.length;kt++)Ce.insert(Jt(St[kt]));for(var Mt=et*et,pe=at*at;St.length;){var At=St.shift(),$t=At.p,fe=At.next.p,Ot=it($t,fe);if(!(Ot<pe)){var Be=Ot/Mt;(je=Lt(Wt,At.prev.p,$t,fe,At.next.next.p,Be,Ce))&&Math.min(it(je,$t),it(je,fe))<=Be&&(St.push(At),St.push(j(je,At)),Wt.remove(je),Ce.remove(At),Ce.insert(Jt(At)),Ce.insert(Jt(At.next)))}}At=dt;var De=[];do{De.push(At.p),At=At.next}while(At!==dt);return De.push(At.p),De}function Lt(J,et,at,Z,Wt,St,kt){for(var dt=new Pt([],Ft),je=J.data;je;){for(var Ce=0;Ce<je.children.length;Ce++){var Mt=je.children[Ce],pe=je.leaf?K(Mt,at,Z):Qt(at,Z,Mt);pe>St||dt.push({node:Mt,dist:pe})}for(;dt.length&&!dt.peek().node.children;){var At=dt.pop(),$t=At.node,fe=K($t,et,at),Ot=K($t,Z,Wt);if(At.dist<fe&&At.dist<Ot&&_e(at,$t,kt)&&_e(Z,$t,kt))return $t}(je=dt.pop())&&(je=je.node)}return null}function Ft(J,et){return J.dist-et.dist}function Qt(J,et,at){if(qt(J,at)||qt(et,at))return 0;var Z=tt(J[0],J[1],et[0],et[1],at.minX,at.minY,at.maxX,at.minY);if(0===Z)return 0;var Wt=tt(J[0],J[1],et[0],et[1],at.minX,at.minY,at.minX,at.maxY);if(0===Wt)return 0;var St=tt(J[0],J[1],et[0],et[1],at.maxX,at.minY,at.maxX,at.maxY);if(0===St)return 0;var kt=tt(J[0],J[1],et[0],et[1],at.minX,at.maxY,at.maxX,at.maxY);return 0===kt?0:Math.min(Z,Wt,St,kt)}function qt(J,et){return J[0]>=et.minX&&J[0]<=et.maxX&&J[1]>=et.minY&&J[1]<=et.maxY}function _e(J,et,at){for(var Z=Math.min(J[0],et[0]),Wt=Math.min(J[1],et[1]),St=Math.max(J[0],et[0]),kt=Math.max(J[1],et[1]),dt=at.search({minX:Z,minY:Wt,maxX:St,maxY:kt}),je=0;je<dt.length;je++)if(xt(dt[je].p,dt[je].next.p,J,et))return!1;return!0}function mt(J,et,at){return lt(J[0],J[1],et[0],et[1],at[0],at[1])}function xt(J,et,at,Z){return J!==Z&&et!==at&&mt(J,et,at)>0!=mt(J,et,Z)>0&&mt(at,Z,J)>0!=mt(at,Z,et)>0}function Jt(J){var et=J.p,at=J.next.p;return J.minX=Math.min(et[0],at[0]),J.minY=Math.min(et[1],at[1]),J.maxX=Math.max(et[0],at[0]),J.maxY=Math.max(et[1],at[1]),J}function j(J,et){var at={p:J,prev:null,next:null,minX:0,minY:0,maxX:0,maxY:0};return et?(at.next=et.next,at.prev=et,et.next.prev=at,et.next=at):(at.prev=at,at.next=at),at}function it(J,et){var at=J[0]-et[0],Z=J[1]-et[1];return at*at+Z*Z}function K(J,et,at){var Z=et[0],Wt=et[1],St=at[0]-Z,kt=at[1]-Wt;if(0!==St||0!==kt){var dt=((J[0]-Z)*St+(J[1]-Wt)*kt)/(St*St+kt*kt);dt>1?(Z=at[0],Wt=at[1]):dt>0&&(Z+=St*dt,Wt+=kt*dt)}return(St=J[0]-Z)*St+(kt=J[1]-Wt)*kt}function tt(J,et,at,Z,Wt,St,kt,dt){var Sr,mr,Ur,jr,je=at-J,Ce=Z-et,Mt=kt-Wt,pe=dt-St,At=J-Wt,$t=et-St,fe=je*je+Ce*Ce,Ot=je*Mt+Ce*pe,Be=Mt*Mt+pe*pe,De=je*At+Ce*$t,sr=Mt*At+pe*$t,Ie=fe*Be-Ot*Ot,Er=Ie,He=Ie;0===Ie?(mr=0,Er=1,jr=sr,He=Be):(jr=fe*sr-Ot*De,(mr=Ot*sr-Be*De)<0?(mr=0,jr=sr,He=Be):mr>Er&&(mr=Er,jr=sr+Ot,He=Be)),jr<0?(jr=0,-De<0?mr=0:-De>fe?mr=Er:(mr=-De,Er=fe)):jr>He&&(jr=He,-De+Ot<0?mr=0:-De+Ot>fe?mr=Er:(mr=-De+Ot,Er=fe));var Ze=(1-(Ur=0===jr?0:jr/He))*Wt+Ur*kt-((1-(Sr=0===mr?0:mr/Er))*J+Sr*at),Kt=(1-Ur)*St+Ur*dt-((1-Sr)*et+Sr*Z);return Ze*Ze+Kt*Kt}function X(J,et){return J[0]===et[0]?J[1]-et[1]:J[0]-et[0]}Pt.default&&(Pt=Pt.default),tr.exports=ht,tr.exports.default=ht},3156:function(tr){tr.exports=function(){"use strict";function ce(j,it,K,tt,X){!function nt(J,et,at,Z,Wt){for(;Z>at;){if(Z-at>600){var St=Z-at+1,kt=et-at+1,dt=Math.log(St),je=.5*Math.exp(2*dt/3),Ce=.5*Math.sqrt(dt*je*(St-je)/St)*(kt-St/2<0?-1:1);nt(J,et,Math.max(at,Math.floor(et-kt*je/St+Ce)),Math.min(Z,Math.floor(et+(St-kt)*je/St+Ce)),Wt)}var At=J[et],$t=at,fe=Z;for(It(J,at,et),Wt(J[Z],At)>0&&It(J,at,Z);$t<fe;){for(It(J,$t,fe),$t++,fe--;Wt(J[$t],At)<0;)$t++;for(;Wt(J[fe],At)>0;)fe--}0===Wt(J[at],At)?It(J,at,fe):It(J,++fe,Z),fe<=et&&(at=fe+1),et<=fe&&(Z=fe-1)}}(j,it,K||0,tt||j.length-1,X||gt)}function It(j,it,K){var tt=j[it];j[it]=j[K],j[K]=tt}function gt(j,it){return j<it?-1:j>it?1:0}var Pt=function(j){void 0===j&&(j=9),this._maxEntries=Math.max(4,j),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function s(j,it,K){if(!K)return it.indexOf(j);for(var tt=0;tt<it.length;tt++)if(K(j,it[tt]))return tt;return-1}function lt(j,it){ht(j,0,j.children.length,it,j)}function ht(j,it,K,tt,X){X||(X=Jt(null)),X.minX=1/0,X.minY=1/0,X.maxX=-1/0,X.maxY=-1/0;for(var nt=it;nt<K;nt++){var J=j.children[nt];Lt(X,j.leaf?tt(J):J)}return X}function Lt(j,it){return j.minX=Math.min(j.minX,it.minX),j.minY=Math.min(j.minY,it.minY),j.maxX=Math.max(j.maxX,it.maxX),j.maxY=Math.max(j.maxY,it.maxY),j}function Ft(j,it){return j.minX-it.minX}function Qt(j,it){return j.minY-it.minY}function qt(j){return(j.maxX-j.minX)*(j.maxY-j.minY)}function _e(j){return j.maxX-j.minX+(j.maxY-j.minY)}function mt(j,it){return j.minX<=it.minX&&j.minY<=it.minY&&it.maxX<=j.maxX&&it.maxY<=j.maxY}function xt(j,it){return it.minX<=j.maxX&&it.minY<=j.maxY&&it.maxX>=j.minX&&it.maxY>=j.minY}function Jt(j){return{children:j,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function ye(j,it,K,tt,X){for(var nt=[it,K];nt.length;)if(!((K=nt.pop())-(it=nt.pop())<=tt)){var J=it+Math.ceil((K-it)/tt/2)*tt;ce(j,J,it,K,X),nt.push(it,J,J,K)}}return Pt.prototype.all=function(){return this._all(this.data,[])},Pt.prototype.search=function(j){var it=this.data,K=[];if(!xt(j,it))return K;for(var tt=this.toBBox,X=[];it;){for(var nt=0;nt<it.children.length;nt++){var J=it.children[nt],et=it.leaf?tt(J):J;xt(j,et)&&(it.leaf?K.push(J):mt(j,et)?this._all(J,K):X.push(J))}it=X.pop()}return K},Pt.prototype.collides=function(j){var it=this.data;if(!xt(j,it))return!1;for(var K=[];it;){for(var tt=0;tt<it.children.length;tt++){var X=it.children[tt],nt=it.leaf?this.toBBox(X):X;if(xt(j,nt)){if(it.leaf||mt(j,nt))return!0;K.push(X)}}it=K.pop()}return!1},Pt.prototype.load=function(j){if(!j||!j.length)return this;if(j.length<this._minEntries){for(var it=0;it<j.length;it++)this.insert(j[it]);return this}var K=this._build(j.slice(),0,j.length-1,0);if(this.data.children.length)if(this.data.height===K.height)this._splitRoot(this.data,K);else{if(this.data.height<K.height){var tt=this.data;this.data=K,K=tt}this._insert(K,this.data.height-K.height-1,!0)}else this.data=K;return this},Pt.prototype.insert=function(j){return j&&this._insert(j,this.data.height-1),this},Pt.prototype.clear=function(){return this.data=Jt([]),this},Pt.prototype.remove=function(j,it){if(!j)return this;for(var K,tt,X,nt=this.data,J=this.toBBox(j),et=[],at=[];nt||et.length;){if(nt||(nt=et.pop(),tt=et[et.length-1],K=at.pop(),X=!0),nt.leaf){var Z=s(j,nt.children,it);if(-1!==Z)return nt.children.splice(Z,1),et.push(nt),this._condense(et),this}X||nt.leaf||!mt(nt,J)?tt?(K++,nt=tt.children[K],X=!1):nt=null:(et.push(nt),at.push(K),K=0,tt=nt,nt=nt.children[0])}return this},Pt.prototype.toBBox=function(j){return j},Pt.prototype.compareMinX=function(j,it){return j.minX-it.minX},Pt.prototype.compareMinY=function(j,it){return j.minY-it.minY},Pt.prototype.toJSON=function(){return this.data},Pt.prototype.fromJSON=function(j){return this.data=j,this},Pt.prototype._all=function(j,it){for(var K=[];j;)j.leaf?it.push.apply(it,j.children):K.push.apply(K,j.children),j=K.pop();return it},Pt.prototype._build=function(j,it,K,tt){var X,nt=K-it+1,J=this._maxEntries;if(nt<=J)return lt(X=Jt(j.slice(it,K+1)),this.toBBox),X;tt||(tt=Math.ceil(Math.log(nt)/Math.log(J)),J=Math.ceil(nt/Math.pow(J,tt-1))),(X=Jt([])).leaf=!1,X.height=tt;var et=Math.ceil(nt/J),at=et*Math.ceil(Math.sqrt(J));ye(j,it,K,at,this.compareMinX);for(var Z=it;Z<=K;Z+=at){var Wt=Math.min(Z+at-1,K);ye(j,Z,Wt,et,this.compareMinY);for(var St=Z;St<=Wt;St+=et){var kt=Math.min(St+et-1,Wt);X.children.push(this._build(j,St,kt,tt-1))}}return lt(X,this.toBBox),X},Pt.prototype._chooseSubtree=function(j,it,K,tt){for(;tt.push(it),!it.leaf&&tt.length-1!==K;){for(var X=1/0,nt=1/0,J=void 0,et=0;et<it.children.length;et++){var at=it.children[et],Z=qt(at),Wt=(St=j,kt=at,(Math.max(kt.maxX,St.maxX)-Math.min(kt.minX,St.minX))*(Math.max(kt.maxY,St.maxY)-Math.min(kt.minY,St.minY))-Z);Wt<nt?(nt=Wt,X=Z<X?Z:X,J=at):Wt===nt&&Z<X&&(X=Z,J=at)}it=J||it.children[0]}var St,kt;return it},Pt.prototype._insert=function(j,it,K){var tt=K?j:this.toBBox(j),X=[],nt=this._chooseSubtree(tt,this.data,it,X);for(nt.children.push(j),Lt(nt,tt);it>=0&&X[it].children.length>this._maxEntries;)this._split(X,it),it--;this._adjustParentBBoxes(tt,X,it)},Pt.prototype._split=function(j,it){var K=j[it],tt=K.children.length,X=this._minEntries;this._chooseSplitAxis(K,X,tt);var nt=this._chooseSplitIndex(K,X,tt),J=Jt(K.children.splice(nt,K.children.length-nt));J.height=K.height,J.leaf=K.leaf,lt(K,this.toBBox),lt(J,this.toBBox),it?j[it-1].children.push(J):this._splitRoot(K,J)},Pt.prototype._splitRoot=function(j,it){this.data=Jt([j,it]),this.data.height=j.height+1,this.data.leaf=!1,lt(this.data,this.toBBox)},Pt.prototype._chooseSplitIndex=function(j,it,K){for(var tt,X,nt,J,et,at,Z,Wt=1/0,St=1/0,kt=it;kt<=K-it;kt++){var dt=ht(j,0,kt,this.toBBox),je=ht(j,kt,K,this.toBBox),Ce=(X=dt,nt=je,void 0,void 0,void 0,void 0,J=Math.max(X.minX,nt.minX),et=Math.max(X.minY,nt.minY),at=Math.min(X.maxX,nt.maxX),Z=Math.min(X.maxY,nt.maxY),Math.max(0,at-J)*Math.max(0,Z-et)),Mt=qt(dt)+qt(je);Ce<Wt?(Wt=Ce,tt=kt,St=Mt<St?Mt:St):Ce===Wt&&Mt<St&&(St=Mt,tt=kt)}return tt||K-it},Pt.prototype._chooseSplitAxis=function(j,it,K){var tt=j.leaf?this.compareMinX:Ft,X=j.leaf?this.compareMinY:Qt;this._allDistMargin(j,it,K,tt)<this._allDistMargin(j,it,K,X)&&j.children.sort(tt)},Pt.prototype._allDistMargin=function(j,it,K,tt){j.children.sort(tt);for(var X=this.toBBox,nt=ht(j,0,it,X),J=ht(j,K-it,K,X),et=_e(nt)+_e(J),at=it;at<K-it;at++){var Z=j.children[at];Lt(nt,j.leaf?X(Z):Z),et+=_e(nt)}for(var Wt=K-it-1;Wt>=it;Wt--){var St=j.children[Wt];Lt(J,j.leaf?X(St):St),et+=_e(J)}return et},Pt.prototype._adjustParentBBoxes=function(j,it,K){for(var tt=K;tt>=0;tt--)Lt(it[tt],j)},Pt.prototype._condense=function(j){for(var it=j.length-1,K=void 0;it>=0;it--)0===j[it].children.length?it>0?(K=j[it-1].children).splice(K.indexOf(j[it]),1):this.clear():lt(j[it],this.toBBox)},Pt}()},6952:(tr,ce,It)=>{var gt=It(1356),Pt=It(3407),s=It(2e3),lt=It(2342),ht=It(9235),Lt=It(2374),Ft=Date.prototype.getTime;function qt(xt){return null==xt}function _e(xt){return!(!xt||"object"!=typeof xt||"number"!=typeof xt.length||"function"!=typeof xt.copy||"function"!=typeof xt.slice||xt.length>0&&"number"!=typeof xt[0])}tr.exports=function Qt(xt,Jt,ye){var j=ye||{};return!!(j.strict?s(xt,Jt):xt===Jt)||(!xt||!Jt||"object"!=typeof xt&&"object"!=typeof Jt?j.strict?s(xt,Jt):xt==Jt:function mt(xt,Jt,ye){var j,it;if(typeof xt!=typeof Jt||qt(xt)||qt(Jt)||xt.prototype!==Jt.prototype||Pt(xt)!==Pt(Jt))return!1;var K=lt(xt),tt=lt(Jt);if(K!==tt)return!1;if(K||tt)return xt.source===Jt.source&&ht(xt)===ht(Jt);if(Lt(xt)&&Lt(Jt))return Ft.call(xt)===Ft.call(Jt);var X=_e(xt),nt=_e(Jt);if(X!==nt)return!1;if(X||nt){if(xt.length!==Jt.length)return!1;for(j=0;j<xt.length;j++)if(xt[j]!==Jt[j])return!1;return!0}if(typeof xt!=typeof Jt)return!1;try{var J=gt(xt),et=gt(Jt)}catch{return!1}if(J.length!==et.length)return!1;for(J.sort(),et.sort(),j=J.length-1;j>=0;j--)if(J[j]!=et[j])return!1;for(j=J.length-1;j>=0;j--)if(!Qt(xt[it=J[j]],Jt[it],ye))return!1;return!0}(xt,Jt,j))}},2358:(tr,ce,It)=>{"use strict";var gt=It(1356),Pt="function"==typeof Symbol&&"symbol"==typeof Symbol("foo"),s=Object.prototype.toString,lt=Array.prototype.concat,ht=Object.defineProperty,Ft=It(7027)(),Qt=ht&&Ft,qt=function(mt,xt,Jt,ye){xt in mt&&(!function(mt){return"function"==typeof mt&&"[object Function]"===s.call(mt)}(ye)||!ye())||(Qt?ht(mt,xt,{configurable:!0,enumerable:!1,value:Jt,writable:!0}):mt[xt]=Jt)},_e=function(mt,xt){var Jt=arguments.length>2?arguments[2]:{},ye=gt(xt);Pt&&(ye=lt.call(ye,Object.getOwnPropertySymbols(xt)));for(var j=0;j<ye.length;j+=1)qt(mt,ye[j],xt[ye[j]],Jt[ye[j]])};_e.supportsDescriptors=!!Qt,tr.exports=_e},1817:tr=>{function ce(It,gt,Pt,s){this.dataset=[],this.epsilon=1,this.minPts=2,this.distance=this._euclideanDistance,this.clusters=[],this.noise=[],this._visited=[],this._assigned=[],this._datasetLength=0,this._init(It,gt,Pt,s)}ce.prototype.run=function(It,gt,Pt,s){this._init(It,gt,Pt,s);for(var lt=0;lt<this._datasetLength;lt++)if(1!==this._visited[lt]){this._visited[lt]=1;var ht=this._regionQuery(lt);if(ht.length<this.minPts)this.noise.push(lt);else{var Lt=this.clusters.length;this.clusters.push([]),this._addToCluster(lt,Lt),this._expandCluster(Lt,ht)}}return this.clusters},ce.prototype._init=function(It,gt,Pt,s){if(It){if(!(It instanceof Array))throw Error("Dataset must be of type array, "+typeof It+" given");this.dataset=It,this.clusters=[],this.noise=[],this._datasetLength=It.length,this._visited=new Array(this._datasetLength),this._assigned=new Array(this._datasetLength)}gt&&(this.epsilon=gt),Pt&&(this.minPts=Pt),s&&(this.distance=s)},ce.prototype._expandCluster=function(It,gt){for(var Pt=0;Pt<gt.length;Pt++){var s=gt[Pt];if(1!==this._visited[s]){this._visited[s]=1;var lt=this._regionQuery(s);lt.length>=this.minPts&&(gt=this._mergeArrays(gt,lt))}1!==this._assigned[s]&&this._addToCluster(s,It)}},ce.prototype._addToCluster=function(It,gt){this.clusters[gt].push(It),this._assigned[It]=1},ce.prototype._regionQuery=function(It){for(var gt=[],Pt=0;Pt<this._datasetLength;Pt++)this.distance(this.dataset[It],this.dataset[Pt])<this.epsilon&&gt.push(Pt);return gt},ce.prototype._mergeArrays=function(It,gt){for(var Pt=gt.length,s=0;s<Pt;s++){var lt=gt[s];It.indexOf(lt)<0&&It.push(lt)}return It},ce.prototype._euclideanDistance=function(It,gt){for(var Pt=0,s=Math.min(It.length,gt.length);s--;)Pt+=(It[s]-gt[s])*(It[s]-gt[s]);return Math.sqrt(Pt)},tr.exports&&(tr.exports=ce)},4273:tr=>{function ce(It,gt,Pt){this.k=3,this.dataset=[],this.assignments=[],this.centroids=[],this.init(It,gt,Pt)}ce.prototype.init=function(It,gt,Pt){this.assignments=[],this.centroids=[],typeof It<"u"&&(this.dataset=It),typeof gt<"u"&&(this.k=gt),typeof Pt<"u"&&(this.distance=Pt)},ce.prototype.run=function(It,gt){this.init(It,gt);for(var Pt=this.dataset.length,s=0;s<this.k;s++)this.centroids[s]=this.randomCentroid();for(var lt=!0;lt;){lt=this.assign();for(var ht=0;ht<this.k;ht++){for(var Lt=new Array(_e),Ft=0,Qt=0;Qt<_e;Qt++)Lt[Qt]=0;for(var qt=0;qt<Pt;qt++){var _e=this.dataset[qt].length;if(ht===this.assignments[qt]){for(Qt=0;Qt<_e;Qt++)Lt[Qt]+=this.dataset[qt][Qt];Ft++}}if(Ft>0){for(Qt=0;Qt<_e;Qt++)Lt[Qt]/=Ft;this.centroids[ht]=Lt}else this.centroids[ht]=this.randomCentroid(),lt=!0}}return this.getClusters()},ce.prototype.randomCentroid=function(){var gt,Pt,It=this.dataset.length-1;do{Pt=Math.round(Math.random()*It),gt=this.dataset[Pt]}while(this.centroids.indexOf(gt)>=0);return gt},ce.prototype.assign=function(){for(var Pt,It=!1,gt=this.dataset.length,s=0;s<gt;s++)(Pt=this.argmin(this.dataset[s],this.centroids,this.distance))!=this.assignments[s]&&(this.assignments[s]=Pt,It=!0);return It},ce.prototype.getClusters=function(){for(var gt,It=new Array(this.k),Pt=0;Pt<this.assignments.length;Pt++)typeof It[gt=this.assignments[Pt]]>"u"&&(It[gt]=[]),It[gt].push(Pt);return It},ce.prototype.argmin=function(It,gt,Pt){for(var Lt,s=Number.MAX_VALUE,lt=0,ht=gt.length,Ft=0;Ft<ht;Ft++)(Lt=Pt(It,gt[Ft]))<s&&(s=Lt,lt=Ft);return lt},ce.prototype.distance=function(It,gt){for(var Pt=0,s=Math.min(It.length,gt.length);s--;){var lt=It[s]-gt[s];Pt+=lt*lt}return Math.sqrt(Pt)},tr.exports&&(tr.exports=ce)},8680:(tr,ce,It)=>{if(tr.exports)var gt=It(8759);function Pt(s,lt,ht,Lt){this.epsilon=1,this.minPts=1,this.distance=this._euclideanDistance,this._reachability=[],this._processed=[],this._coreDistance=0,this._orderedList=[],this._init(s,lt,ht,Lt)}Pt.prototype.run=function(s,lt,ht,Lt){this._init(s,lt,ht,Lt);for(var Ft=0,Qt=this.dataset.length;Ft<Qt;Ft++)if(1!==this._processed[Ft]){this._processed[Ft]=1,this.clusters.push([Ft]);var qt=this.clusters.length-1;this._orderedList.push(Ft);var _e=new gt(null,null,"asc"),mt=this._regionQuery(Ft);void 0!==this._distanceToCore(Ft)&&(this._updateQueue(Ft,mt,_e),this._expandCluster(qt,_e))}return this.clusters},Pt.prototype.getReachabilityPlot=function(){for(var s=[],lt=0,ht=this._orderedList.length;lt<ht;lt++){var Lt=this._orderedList[lt];s.push([Lt,this._reachability[Lt]])}return s},Pt.prototype._init=function(s,lt,ht,Lt){if(s){if(!(s instanceof Array))throw Error("Dataset must be of type array, "+typeof s+" given");this.dataset=s,this.clusters=[],this._reachability=new Array(this.dataset.length),this._processed=new Array(this.dataset.length),this._coreDistance=0,this._orderedList=[]}lt&&(this.epsilon=lt),ht&&(this.minPts=ht),Lt&&(this.distance=Lt)},Pt.prototype._updateQueue=function(s,lt,ht){var Lt=this;this._coreDistance=this._distanceToCore(s),lt.forEach(function(Ft){if(void 0===Lt._processed[Ft]){var Qt=Lt.distance(Lt.dataset[s],Lt.dataset[Ft]),qt=Math.max(Lt._coreDistance,Qt);void 0===Lt._reachability[Ft]?(Lt._reachability[Ft]=qt,ht.insert(Ft,qt)):qt<Lt._reachability[Ft]&&(Lt._reachability[Ft]=qt,ht.remove(Ft),ht.insert(Ft,qt))}})},Pt.prototype._expandCluster=function(s,lt){for(var ht=lt.getElements(),Lt=0,Ft=ht.length;Lt<Ft;Lt++){var Qt=ht[Lt];if(void 0===this._processed[Qt]){var qt=this._regionQuery(Qt);this._processed[Qt]=1,this.clusters[s].push(Qt),this._orderedList.push(Qt),void 0!==this._distanceToCore(Qt)&&(this._updateQueue(Qt,qt,lt),this._expandCluster(s,lt))}}},Pt.prototype._distanceToCore=function(s){for(var lt=this.epsilon,ht=0;ht<lt;ht++)if(this._regionQuery(s,ht).length>=this.minPts)return ht},Pt.prototype._regionQuery=function(s,lt){lt=lt||this.epsilon;for(var ht=[],Lt=0,Ft=this.dataset.length;Lt<Ft;Lt++)this.distance(this.dataset[s],this.dataset[Lt])<lt&&ht.push(Lt);return ht},Pt.prototype._euclideanDistance=function(s,lt){for(var ht=0,Lt=Math.min(s.length,lt.length);Lt--;)ht+=(s[Lt]-lt[Lt])*(s[Lt]-lt[Lt]);return Math.sqrt(ht)},tr.exports&&(tr.exports=Pt)},8759:tr=>{function ce(It,gt,Pt){this._queue=[],this._priorities=[],this._sorting="desc",this._init(It,gt,Pt)}ce.prototype.insert=function(It,gt){for(var Pt=this._queue.length,s=Pt;s--;){var lt=this._priorities[s];"desc"===this._sorting?gt>lt&&(Pt=s):gt<lt&&(Pt=s)}this._insertAt(It,gt,Pt)},ce.prototype.remove=function(It){for(var gt=this._queue.length;gt--;)if(It===this._queue[gt]){this._queue.splice(gt,1),this._priorities.splice(gt,1);break}},ce.prototype.forEach=function(It){this._queue.forEach(It)},ce.prototype.getElements=function(){return this._queue},ce.prototype.getElementPriority=function(It){return this._priorities[It]},ce.prototype.getPriorities=function(){return this._priorities},ce.prototype.getElementsWithPriorities=function(){for(var It=[],gt=0,Pt=this._queue.length;gt<Pt;gt++)It.push([this._queue[gt],this._priorities[gt]]);return It},ce.prototype._init=function(It,gt,Pt){if(It&&gt){if(this._queue=[],this._priorities=[],It.length!==gt.length)throw new Error("Arrays must have the same length");for(var s=0;s<It.length;s++)this.insert(It[s],gt[s])}Pt&&(this._sorting=Pt)},ce.prototype._insertAt=function(It,gt,Pt){this._queue.length===Pt?(this._queue.push(It),this._priorities.push(gt)):(this._queue.splice(Pt,0,It),this._priorities.splice(Pt,0,gt))},tr.exports&&(tr.exports=ce)},7470:(tr,ce,It)=>{tr.exports&&(tr.exports={DBSCAN:It(1817),KMEANS:It(4273),OPTICS:It(8680),PriorityQueue:It(8759)})},5469:tr=>{"use strict";function ce(Mt,pe,At){At=At||2;var De,sr,Ie,Sr,mr,Ur,jr,$t=pe&&pe.length,fe=$t?pe[0]*At:Mt.length,Ot=It(Mt,0,fe,At,!0),Be=[];if(!Ot||Ot.next===Ot.prev)return Be;if($t&&(Ot=function Ft(Mt,pe,At,$t){var Ot,Be,Ie,fe=[];for(Ot=0,Be=pe.length;Ot<Be;Ot++)(Ie=It(Mt,pe[Ot]*$t,Ot<Be-1?pe[Ot+1]*$t:Mt.length,$t,!1))===Ie.next&&(Ie.steiner=!0),fe.push(j(Ie));for(fe.sort(Qt),Ot=0;Ot<fe.length;Ot++)At=qt(fe[Ot],At);return At}(Mt,pe,Ot,At)),Mt.length>80*At){De=Ie=Mt[0],sr=Sr=Mt[1];for(var Er=At;Er<fe;Er+=At)(mr=Mt[Er])<De&&(De=mr),(Ur=Mt[Er+1])<sr&&(sr=Ur),mr>Ie&&(Ie=mr),Ur>Sr&&(Sr=Ur);jr=0!==(jr=Math.max(Ie-De,Sr-sr))?32767/jr:0}return Pt(Ot,Be,At,De,sr,jr,0),Be}function It(Mt,pe,At,$t,fe){var Ot,Be;if(fe===Ce(Mt,pe,At,$t)>0)for(Ot=pe;Ot<At;Ot+=$t)Be=kt(Ot,Mt[Ot],Mt[Ot+1],Be);else for(Ot=At-$t;Ot>=pe;Ot-=$t)Be=kt(Ot,Mt[Ot],Mt[Ot+1],Be);return Be&&X(Be,Be.next)&&(dt(Be),Be=Be.next),Be}function gt(Mt,pe){if(!Mt)return Mt;pe||(pe=Mt);var $t,At=Mt;do{if($t=!1,At.steiner||!X(At,At.next)&&0!==tt(At.prev,At,At.next))At=At.next;else{if(dt(At),(At=pe=At.prev)===At.next)break;$t=!0}}while($t||At!==pe);return pe}function Pt(Mt,pe,At,$t,fe,Ot,Be){if(Mt){!Be&&Ot&&function xt(Mt,pe,At,$t){var fe=Mt;do{0===fe.z&&(fe.z=ye(fe.x,fe.y,pe,At,$t)),fe.prevZ=fe.prev,fe.nextZ=fe.next,fe=fe.next}while(fe!==Mt);fe.prevZ.nextZ=null,fe.prevZ=null,function Jt(Mt){var pe,At,$t,fe,Ot,Be,De,sr,Ie=1;do{for(At=Mt,Mt=null,Ot=null,Be=0;At;){for(Be++,$t=At,De=0,pe=0;pe<Ie&&(De++,$t=$t.nextZ);pe++);for(sr=Ie;De>0||sr>0&&$t;)0!==De&&(0===sr||!$t||At.z<=$t.z)?(fe=At,At=At.nextZ,De--):(fe=$t,$t=$t.nextZ,sr--),Ot?Ot.nextZ=fe:Mt=fe,fe.prevZ=Ot,Ot=fe;At=$t}Ot.nextZ=null,Ie*=2}while(Be>1)}(fe)}(Mt,$t,fe,Ot);for(var sr,Ie,De=Mt;Mt.prev!==Mt.next;)if(sr=Mt.prev,Ie=Mt.next,Ot?lt(Mt,$t,fe,Ot):s(Mt))pe.push(sr.i/At|0),pe.push(Mt.i/At|0),pe.push(Ie.i/At|0),dt(Mt),Mt=Ie.next,De=Ie.next;else if((Mt=Ie)===De){Be?1===Be?Pt(Mt=ht(gt(Mt),pe,At),pe,At,$t,fe,Ot,2):2===Be&&Lt(Mt,pe,At,$t,fe,Ot):Pt(gt(Mt),pe,At,$t,fe,Ot,1);break}}}function s(Mt){var pe=Mt.prev,At=Mt,$t=Mt.next;if(tt(pe,At,$t)>=0)return!1;for(var fe=pe.x,Ot=At.x,Be=$t.x,De=pe.y,sr=At.y,Ie=$t.y,Sr=fe<Ot?fe<Be?fe:Be:Ot<Be?Ot:Be,mr=De<sr?De<Ie?De:Ie:sr<Ie?sr:Ie,Ur=fe>Ot?fe>Be?fe:Be:Ot>Be?Ot:Be,jr=De>sr?De>Ie?De:Ie:sr>Ie?sr:Ie,Er=$t.next;Er!==pe;){if(Er.x>=Sr&&Er.x<=Ur&&Er.y>=mr&&Er.y<=jr&&it(fe,De,Ot,sr,Be,Ie,Er.x,Er.y)&&tt(Er.prev,Er,Er.next)>=0)return!1;Er=Er.next}return!0}function lt(Mt,pe,At,$t){var fe=Mt.prev,Ot=Mt,Be=Mt.next;if(tt(fe,Ot,Be)>=0)return!1;for(var De=fe.x,sr=Ot.x,Ie=Be.x,Sr=fe.y,mr=Ot.y,Ur=Be.y,jr=De<sr?De<Ie?De:Ie:sr<Ie?sr:Ie,Er=Sr<mr?Sr<Ur?Sr:Ur:mr<Ur?mr:Ur,He=De>sr?De>Ie?De:Ie:sr>Ie?sr:Ie,ei=Sr>mr?Sr>Ur?Sr:Ur:mr>Ur?mr:Ur,_n=ye(jr,Er,pe,At,$t),zn=ye(He,ei,pe,At,$t),se=Mt.prevZ,Ze=Mt.nextZ;se&&se.z>=_n&&Ze&&Ze.z<=zn;){if(se.x>=jr&&se.x<=He&&se.y>=Er&&se.y<=ei&&se!==fe&&se!==Be&&it(De,Sr,sr,mr,Ie,Ur,se.x,se.y)&&tt(se.prev,se,se.next)>=0||(se=se.prevZ,Ze.x>=jr&&Ze.x<=He&&Ze.y>=Er&&Ze.y<=ei&&Ze!==fe&&Ze!==Be&&it(De,Sr,sr,mr,Ie,Ur,Ze.x,Ze.y)&&tt(Ze.prev,Ze,Ze.next)>=0))return!1;Ze=Ze.nextZ}for(;se&&se.z>=_n;){if(se.x>=jr&&se.x<=He&&se.y>=Er&&se.y<=ei&&se!==fe&&se!==Be&&it(De,Sr,sr,mr,Ie,Ur,se.x,se.y)&&tt(se.prev,se,se.next)>=0)return!1;se=se.prevZ}for(;Ze&&Ze.z<=zn;){if(Ze.x>=jr&&Ze.x<=He&&Ze.y>=Er&&Ze.y<=ei&&Ze!==fe&&Ze!==Be&&it(De,Sr,sr,mr,Ie,Ur,Ze.x,Ze.y)&&tt(Ze.prev,Ze,Ze.next)>=0)return!1;Ze=Ze.nextZ}return!0}function ht(Mt,pe,At){var $t=Mt;do{var fe=$t.prev,Ot=$t.next.next;!X(fe,Ot)&&nt(fe,$t,$t.next,Ot)&&Z(fe,Ot)&&Z(Ot,fe)&&(pe.push(fe.i/At|0),pe.push($t.i/At|0),pe.push(Ot.i/At|0),dt($t),dt($t.next),$t=Mt=Ot),$t=$t.next}while($t!==Mt);return gt($t)}function Lt(Mt,pe,At,$t,fe,Ot){var Be=Mt;do{for(var De=Be.next.next;De!==Be.prev;){if(Be.i!==De.i&&K(Be,De)){var sr=St(Be,De);return Be=gt(Be,Be.next),sr=gt(sr,sr.next),Pt(Be,pe,At,$t,fe,Ot,0),void Pt(sr,pe,At,$t,fe,Ot,0)}De=De.next}Be=Be.next}while(Be!==Mt)}function Qt(Mt,pe){return Mt.x-pe.x}function qt(Mt,pe){var At=function _e(Mt,pe){var Be,At=pe,$t=Mt.x,fe=Mt.y,Ot=-1/0;do{if(fe<=At.y&&fe>=At.next.y&&At.next.y!==At.y){var De=At.x+(fe-At.y)*(At.next.x-At.x)/(At.next.y-At.y);if(De<=$t&&De>Ot&&(Ot=De,Be=At.x<At.next.x?At:At.next,De===$t))return Be}At=At.next}while(At!==pe);if(!Be)return null;var Ur,sr=Be,Ie=Be.x,Sr=Be.y,mr=1/0;At=Be;do{$t>=At.x&&At.x>=Ie&&$t!==At.x&&it(fe<Sr?$t:Ot,fe,Ie,Sr,fe<Sr?Ot:$t,fe,At.x,At.y)&&(Ur=Math.abs(fe-At.y)/($t-At.x),Z(At,Mt)&&(Ur<mr||Ur===mr&&(At.x>Be.x||At.x===Be.x&&mt(Be,At)))&&(Be=At,mr=Ur)),At=At.next}while(At!==sr);return Be}(Mt,pe);if(!At)return pe;var $t=St(At,Mt);return gt($t,$t.next),gt(At,At.next)}function mt(Mt,pe){return tt(Mt.prev,Mt,pe.prev)<0&&tt(pe.next,Mt,Mt.next)<0}function ye(Mt,pe,At,$t,fe){return(Mt=1431655765&((Mt=858993459&((Mt=252645135&((Mt=16711935&((Mt=(Mt-At)*fe|0)|Mt<<8))|Mt<<4))|Mt<<2))|Mt<<1))|(pe=1431655765&((pe=858993459&((pe=252645135&((pe=16711935&((pe=(pe-$t)*fe|0)|pe<<8))|pe<<4))|pe<<2))|pe<<1))<<1}function j(Mt){var pe=Mt,At=Mt;do{(pe.x<At.x||pe.x===At.x&&pe.y<At.y)&&(At=pe),pe=pe.next}while(pe!==Mt);return At}function it(Mt,pe,At,$t,fe,Ot,Be,De){return(fe-Be)*(pe-De)>=(Mt-Be)*(Ot-De)&&(Mt-Be)*($t-De)>=(At-Be)*(pe-De)&&(At-Be)*(Ot-De)>=(fe-Be)*($t-De)}function K(Mt,pe){return Mt.next.i!==pe.i&&Mt.prev.i!==pe.i&&!function at(Mt,pe){var At=Mt;do{if(At.i!==Mt.i&&At.next.i!==Mt.i&&At.i!==pe.i&&At.next.i!==pe.i&&nt(At,At.next,Mt,pe))return!0;At=At.next}while(At!==Mt);return!1}(Mt,pe)&&(Z(Mt,pe)&&Z(pe,Mt)&&function Wt(Mt,pe){var At=Mt,$t=!1,fe=(Mt.x+pe.x)/2,Ot=(Mt.y+pe.y)/2;do{At.y>Ot!=At.next.y>Ot&&At.next.y!==At.y&&fe<(At.next.x-At.x)*(Ot-At.y)/(At.next.y-At.y)+At.x&&($t=!$t),At=At.next}while(At!==Mt);return $t}(Mt,pe)&&(tt(Mt.prev,Mt,pe.prev)||tt(Mt,pe.prev,pe))||X(Mt,pe)&&tt(Mt.prev,Mt,Mt.next)>0&&tt(pe.prev,pe,pe.next)>0)}function tt(Mt,pe,At){return(pe.y-Mt.y)*(At.x-pe.x)-(pe.x-Mt.x)*(At.y-pe.y)}function X(Mt,pe){return Mt.x===pe.x&&Mt.y===pe.y}function nt(Mt,pe,At,$t){var fe=et(tt(Mt,pe,At)),Ot=et(tt(Mt,pe,$t)),Be=et(tt(At,$t,Mt)),De=et(tt(At,$t,pe));return!!(fe!==Ot&&Be!==De||0===fe&&J(Mt,At,pe)||0===Ot&&J(Mt,$t,pe)||0===Be&&J(At,Mt,$t)||0===De&&J(At,pe,$t))}function J(Mt,pe,At){return pe.x<=Math.max(Mt.x,At.x)&&pe.x>=Math.min(Mt.x,At.x)&&pe.y<=Math.max(Mt.y,At.y)&&pe.y>=Math.min(Mt.y,At.y)}function et(Mt){return Mt>0?1:Mt<0?-1:0}function Z(Mt,pe){return tt(Mt.prev,Mt,Mt.next)<0?tt(Mt,pe,Mt.next)>=0&&tt(Mt,Mt.prev,pe)>=0:tt(Mt,pe,Mt.prev)<0||tt(Mt,Mt.next,pe)<0}function St(Mt,pe){var At=new je(Mt.i,Mt.x,Mt.y),$t=new je(pe.i,pe.x,pe.y),fe=Mt.next,Ot=pe.prev;return Mt.next=pe,pe.prev=Mt,At.next=fe,fe.prev=At,$t.next=At,At.prev=$t,Ot.next=$t,$t.prev=Ot,$t}function kt(Mt,pe,At,$t){var fe=new je(Mt,pe,At);return $t?(fe.next=$t.next,fe.prev=$t,$t.next.prev=fe,$t.next=fe):(fe.prev=fe,fe.next=fe),fe}function dt(Mt){Mt.next.prev=Mt.prev,Mt.prev.next=Mt.next,Mt.prevZ&&(Mt.prevZ.nextZ=Mt.nextZ),Mt.nextZ&&(Mt.nextZ.prevZ=Mt.prevZ)}function je(Mt,pe,At){this.i=Mt,this.x=pe,this.y=At,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Ce(Mt,pe,At,$t){for(var fe=0,Ot=pe,Be=At-$t;Ot<At;Ot+=$t)fe+=(Mt[Be]-Mt[Ot])*(Mt[Ot+1]+Mt[Be+1]),Be=Ot;return fe}tr.exports=ce,tr.exports.default=ce,ce.deviation=function(Mt,pe,At,$t){var fe=pe&&pe.length,Be=Math.abs(Ce(Mt,0,fe?pe[0]*At:Mt.length,At));if(fe)for(var De=0,sr=pe.length;De<sr;De++)Be-=Math.abs(Ce(Mt,pe[De]*At,De<sr-1?pe[De+1]*At:Mt.length,At));var mr=0;for(De=0;De<$t.length;De+=3){var Ur=$t[De]*At,jr=$t[De+1]*At,Er=$t[De+2]*At;mr+=Math.abs((Mt[Ur]-Mt[Er])*(Mt[jr+1]-Mt[Ur+1])-(Mt[Ur]-Mt[jr])*(Mt[Er+1]-Mt[Ur+1]))}return 0===Be&&0===mr?0:Math.abs((mr-Be)/Be)},ce.flatten=function(Mt){for(var pe=Mt[0][0].length,At={vertices:[],holes:[],dimensions:pe},$t=0,fe=0;fe<Mt.length;fe++){for(var Ot=0;Ot<Mt[fe].length;Ot++)for(var Be=0;Be<pe;Be++)At.vertices.push(Mt[fe][Ot][Be]);fe>0&&At.holes.push($t+=Mt[fe-1].length)}return At}},9069:tr=>{"use strict";var gt,ce="object"==typeof Reflect?Reflect:null,It=ce&&"function"==typeof ce.apply?ce.apply:function(nt,J,et){return Function.prototype.apply.call(nt,J,et)};gt=ce&&"function"==typeof ce.ownKeys?ce.ownKeys:Object.getOwnPropertySymbols?function(nt){return Object.getOwnPropertyNames(nt).concat(Object.getOwnPropertySymbols(nt))}:function(nt){return Object.getOwnPropertyNames(nt)};var s=Number.isNaN||function(nt){return nt!=nt};function lt(){lt.init.call(this)}tr.exports=lt,tr.exports.once=function it(X,nt){return new Promise(function(J,et){function at(Wt){X.removeListener(nt,Z),et(Wt)}function Z(){"function"==typeof X.removeListener&&X.removeListener("error",at),J([].slice.call(arguments))}tt(X,nt,Z,{once:!0}),"error"!==nt&&function K(X,nt,J){"function"==typeof X.on&&tt(X,"error",nt,J)}(X,at,{once:!0})})},lt.EventEmitter=lt,lt.prototype._events=void 0,lt.prototype._eventsCount=0,lt.prototype._maxListeners=void 0;var ht=10;function Lt(X){if("function"!=typeof X)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof X)}function Ft(X){return void 0===X._maxListeners?lt.defaultMaxListeners:X._maxListeners}function Qt(X,nt,J,et){var at,Z,Wt;if(Lt(J),void 0===(Z=X._events)?(Z=X._events=Object.create(null),X._eventsCount=0):(void 0!==Z.newListener&&(X.emit("newListener",nt,J.listener?J.listener:J),Z=X._events),Wt=Z[nt]),void 0===Wt)Wt=Z[nt]=J,++X._eventsCount;else if("function"==typeof Wt?Wt=Z[nt]=et?[J,Wt]:[Wt,J]:et?Wt.unshift(J):Wt.push(J),(at=Ft(X))>0&&Wt.length>at&&!Wt.warned){Wt.warned=!0;var St=new Error("Possible EventEmitter memory leak detected. "+Wt.length+" "+String(nt)+" listeners added. Use emitter.setMaxListeners() to increase limit");St.name="MaxListenersExceededWarning",St.emitter=X,St.type=nt,St.count=Wt.length,function Pt(X){console&&console.warn&&console.warn(X)}(St)}return X}function qt(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function _e(X,nt,J){var et={fired:!1,wrapFn:void 0,target:X,type:nt,listener:J},at=qt.bind(et);return at.listener=J,et.wrapFn=at,at}function mt(X,nt,J){var et=X._events;if(void 0===et)return[];var at=et[nt];return void 0===at?[]:"function"==typeof at?J?[at.listener||at]:[at]:J?function j(X){for(var nt=new Array(X.length),J=0;J<nt.length;++J)nt[J]=X[J].listener||X[J];return nt}(at):Jt(at,at.length)}function xt(X){var nt=this._events;if(void 0!==nt){var J=nt[X];if("function"==typeof J)return 1;if(void 0!==J)return J.length}return 0}function Jt(X,nt){for(var J=new Array(nt),et=0;et<nt;++et)J[et]=X[et];return J}function tt(X,nt,J,et){if("function"==typeof X.on)et.once?X.once(nt,J):X.on(nt,J);else{if("function"!=typeof X.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof X);X.addEventListener(nt,function at(Z){et.once&&X.removeEventListener(nt,at),J(Z)})}}Object.defineProperty(lt,"defaultMaxListeners",{enumerable:!0,get:function(){return ht},set:function(X){if("number"!=typeof X||X<0||s(X))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+X+".");ht=X}}),lt.init=function(){(void 0===this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},lt.prototype.setMaxListeners=function(nt){if("number"!=typeof nt||nt<0||s(nt))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+nt+".");return this._maxListeners=nt,this},lt.prototype.getMaxListeners=function(){return Ft(this)},lt.prototype.emit=function(nt){for(var J=[],et=1;et<arguments.length;et++)J.push(arguments[et]);var at="error"===nt,Z=this._events;if(void 0!==Z)at=at&&void 0===Z.error;else if(!at)return!1;if(at){var Wt;if(J.length>0&&(Wt=J[0]),Wt instanceof Error)throw Wt;var St=new Error("Unhandled error."+(Wt?" ("+Wt.message+")":""));throw St.context=Wt,St}var kt=Z[nt];if(void 0===kt)return!1;if("function"==typeof kt)It(kt,this,J);else{var dt=kt.length,je=Jt(kt,dt);for(et=0;et<dt;++et)It(je[et],this,J)}return!0},lt.prototype.on=lt.prototype.addListener=function(nt,J){return Qt(this,nt,J,!1)},lt.prototype.prependListener=function(nt,J){return Qt(this,nt,J,!0)},lt.prototype.once=function(nt,J){return Lt(J),this.on(nt,_e(this,nt,J)),this},lt.prototype.prependOnceListener=function(nt,J){return Lt(J),this.prependListener(nt,_e(this,nt,J)),this},lt.prototype.off=lt.prototype.removeListener=function(nt,J){var et,at,Z,Wt,St;if(Lt(J),void 0===(at=this._events))return this;if(void 0===(et=at[nt]))return this;if(et===J||et.listener===J)0==--this._eventsCount?this._events=Object.create(null):(delete at[nt],at.removeListener&&this.emit("removeListener",nt,et.listener||J));else if("function"!=typeof et){for(Z=-1,Wt=et.length-1;Wt>=0;Wt--)if(et[Wt]===J||et[Wt].listener===J){St=et[Wt].listener,Z=Wt;break}if(Z<0)return this;0===Z?et.shift():function ye(X,nt){for(;nt+1<X.length;nt++)X[nt]=X[nt+1];X.pop()}(et,Z),1===et.length&&(at[nt]=et[0]),void 0!==at.removeListener&&this.emit("removeListener",nt,St||J)}return this},lt.prototype.removeAllListeners=function(nt){var J,et,at;if(void 0===(et=this._events))return this;if(void 0===et.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==et[nt]&&(0==--this._eventsCount?this._events=Object.create(null):delete et[nt]),this;if(0===arguments.length){var Wt,Z=Object.keys(et);for(at=0;at<Z.length;++at)"removeListener"!==(Wt=Z[at])&&this.removeAllListeners(Wt);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(J=et[nt]))this.removeListener(nt,J);else if(void 0!==J)for(at=J.length-1;at>=0;at--)this.removeListener(nt,J[at]);return this},lt.prototype.listeners=function(nt){return mt(this,nt,!0)},lt.prototype.rawListeners=function(nt){return mt(this,nt,!1)},lt.listenerCount=function(X,nt){return"function"==typeof X.listenerCount?X.listenerCount(nt):xt.call(X,nt)},lt.prototype.listenerCount=xt,lt.prototype.eventNames=function(){return this._eventsCount>0?gt(this._events):[]}},3457:tr=>{"use strict";var ce="Function.prototype.bind called on incompatible ",It=Array.prototype.slice,gt=Object.prototype.toString,Pt="[object Function]";tr.exports=function(lt){var ht=this;if("function"!=typeof ht||gt.call(ht)!==Pt)throw new TypeError(ce+ht);for(var Ft,Lt=It.call(arguments,1),Qt=function(){if(this instanceof Ft){var Jt=ht.apply(this,Lt.concat(It.call(arguments)));return Object(Jt)===Jt?Jt:this}return ht.apply(lt,Lt.concat(It.call(arguments)))},qt=Math.max(0,ht.length-Lt.length),_e=[],mt=0;mt<qt;mt++)_e.push("$"+mt);if(Ft=Function("binder","return function ("+_e.join(",")+"){ return binder.apply(this,arguments); }")(Qt),ht.prototype){var xt=function(){};xt.prototype=ht.prototype,Ft.prototype=new xt,xt.prototype=null}return Ft}},4444:(tr,ce,It)=>{"use strict";var gt=It(3457);tr.exports=Function.prototype.bind||gt},9582:tr=>{"use strict";var ce=function(){return"string"==typeof function(){}.name},It=Object.getOwnPropertyDescriptor;if(It)try{It([],"length")}catch{It=null}ce.functionsHaveConfigurableNames=function(){if(!ce()||!It)return!1;var s=It(function(){},"name");return!!s&&!!s.configurable};var gt=Function.prototype.bind;ce.boundFunctionsHaveNames=function(){return ce()&&"function"==typeof gt&&""!==function(){}.bind().name},tr.exports=ce},5013:(tr,ce,It)=>{var gt=It(6952),Pt=function(Lt){this.precision=Lt&&Lt.precision?Lt.precision:17,this.direction=!(!Lt||!Lt.direction)&&Lt.direction,this.pseudoNode=!(!Lt||!Lt.pseudoNode)&&Lt.pseudoNode,this.objectComparator=Lt&&Lt.objectComparator?Lt.objectComparator:ht};function s(Lt){return Lt.coordinates.map(function(Ft){return{type:Lt.type.replace("Multi",""),coordinates:Ft}})}function lt(Lt,Ft){return Lt.hasOwnProperty("coordinates")?Lt.coordinates.length===Ft.coordinates.length:Lt.length===Ft.length}function ht(Lt,Ft){return gt(Lt,Ft,{strict:!0})}Pt.prototype.compare=function(Lt,Ft){if(Lt.type!==Ft.type||!lt(Lt,Ft))return!1;switch(Lt.type){case"Point":return this.compareCoord(Lt.coordinates,Ft.coordinates);case"LineString":return this.compareLine(Lt.coordinates,Ft.coordinates,0,!1);case"Polygon":return this.comparePolygon(Lt,Ft);case"Feature":return this.compareFeature(Lt,Ft);default:if(0===Lt.type.indexOf("Multi")){var Qt=this,qt=s(Lt),_e=s(Ft);return qt.every(function(mt){return this.some(function(xt){return Qt.compare(mt,xt)})},_e)}}return!1},Pt.prototype.compareCoord=function(Lt,Ft){if(Lt.length!==Ft.length)return!1;for(var Qt=0;Qt<Lt.length;Qt++)if(Lt[Qt].toFixed(this.precision)!==Ft[Qt].toFixed(this.precision))return!1;return!0},Pt.prototype.compareLine=function(Lt,Ft,Qt,qt){if(!lt(Lt,Ft))return!1;var _e=this.pseudoNode?Lt:this.removePseudo(Lt),mt=this.pseudoNode?Ft:this.removePseudo(Ft);if(!qt||this.compareCoord(_e[0],mt[0])||(mt=this.fixStartIndex(mt,_e))){var xt=this.compareCoord(_e[Qt],mt[Qt]);return this.direction||xt?this.comparePath(_e,mt):!!this.compareCoord(_e[Qt],mt[mt.length-(1+Qt)])&&this.comparePath(_e.slice().reverse(),mt)}},Pt.prototype.fixStartIndex=function(Lt,Ft){for(var Qt,qt=-1,_e=0;_e<Lt.length;_e++)if(this.compareCoord(Lt[_e],Ft[0])){qt=_e;break}return qt>=0&&(Qt=[].concat(Lt.slice(qt,Lt.length),Lt.slice(1,qt+1))),Qt},Pt.prototype.comparePath=function(Lt,Ft){var Qt=this;return Lt.every(function(qt,_e){return Qt.compareCoord(qt,this[_e])},Ft)},Pt.prototype.comparePolygon=function(Lt,Ft){if(this.compareLine(Lt.coordinates[0],Ft.coordinates[0],1,!0)){var Qt=Lt.coordinates.slice(1,Lt.coordinates.length),qt=Ft.coordinates.slice(1,Ft.coordinates.length),_e=this;return Qt.every(function(mt){return this.some(function(xt){return _e.compareLine(mt,xt,1,!0)})},qt)}return!1},Pt.prototype.compareFeature=function(Lt,Ft){return!(Lt.id!==Ft.id||!this.objectComparator(Lt.properties,Ft.properties)||!this.compareBBox(Lt,Ft))&&this.compare(Lt.geometry,Ft.geometry)},Pt.prototype.compareBBox=function(Lt,Ft){return!!(!Lt.bbox&&!Ft.bbox||Lt.bbox&&Ft.bbox&&this.compareCoord(Lt.bbox,Ft.bbox))},Pt.prototype.removePseudo=function(Lt){return Lt},tr.exports=Pt},5406:(tr,ce,It)=>{var gt=It(7192),Pt=It(8275),s=It(9626),lt=It(1503).Z,ht=s.featureEach,Qt=Pt.featureCollection;function qt(_e){var mt=new gt(_e);return mt.insert=function(xt){if("Feature"!==xt.type)throw new Error("invalid feature");return xt.bbox=xt.bbox?xt.bbox:lt(xt),gt.prototype.insert.call(this,xt)},mt.load=function(xt){var Jt=[];return Array.isArray(xt)?xt.forEach(function(ye){if("Feature"!==ye.type)throw new Error("invalid features");ye.bbox=ye.bbox?ye.bbox:lt(ye),Jt.push(ye)}):ht(xt,function(ye){if("Feature"!==ye.type)throw new Error("invalid features");ye.bbox=ye.bbox?ye.bbox:lt(ye),Jt.push(ye)}),gt.prototype.load.call(this,Jt)},mt.remove=function(xt,Jt){if("Feature"!==xt.type)throw new Error("invalid feature");return xt.bbox=xt.bbox?xt.bbox:lt(xt),gt.prototype.remove.call(this,xt,Jt)},mt.clear=function(){return gt.prototype.clear.call(this)},mt.search=function(xt){var Jt=gt.prototype.search.call(this,this.toBBox(xt));return Qt(Jt)},mt.collides=function(xt){return gt.prototype.collides.call(this,this.toBBox(xt))},mt.all=function(){var xt=gt.prototype.all.call(this);return Qt(xt)},mt.toJSON=function(){return gt.prototype.toJSON.call(this)},mt.fromJSON=function(xt){return gt.prototype.fromJSON.call(this,xt)},mt.toBBox=function(xt){var Jt;if(xt.bbox)Jt=xt.bbox;else if(Array.isArray(xt)&&4===xt.length)Jt=xt;else if(Array.isArray(xt)&&6===xt.length)Jt=[xt[0],xt[1],xt[3],xt[4]];else if("Feature"===xt.type)Jt=lt(xt);else{if("FeatureCollection"!==xt.type)throw new Error("invalid geojson");Jt=lt(xt)}return{minX:Jt[0],minY:Jt[1],maxX:Jt[2],maxY:Jt[3]}},mt}tr.exports=qt,tr.exports.default=qt},7192:function(tr){tr.exports=function(){"use strict";function ce(j,it,K,tt,X){!function nt(J,et,at,Z,Wt){for(;Z>at;){if(Z-at>600){var St=Z-at+1,kt=et-at+1,dt=Math.log(St),je=.5*Math.exp(2*dt/3),Ce=.5*Math.sqrt(dt*je*(St-je)/St)*(kt-St/2<0?-1:1);nt(J,et,Math.max(at,Math.floor(et-kt*je/St+Ce)),Math.min(Z,Math.floor(et+(St-kt)*je/St+Ce)),Wt)}var At=J[et],$t=at,fe=Z;for(It(J,at,et),Wt(J[Z],At)>0&&It(J,at,Z);$t<fe;){for(It(J,$t,fe),$t++,fe--;Wt(J[$t],At)<0;)$t++;for(;Wt(J[fe],At)>0;)fe--}0===Wt(J[at],At)?It(J,at,fe):It(J,++fe,Z),fe<=et&&(at=fe+1),et<=fe&&(Z=fe-1)}}(j,it,K||0,tt||j.length-1,X||gt)}function It(j,it,K){var tt=j[it];j[it]=j[K],j[K]=tt}function gt(j,it){return j<it?-1:j>it?1:0}var Pt=function(j){void 0===j&&(j=9),this._maxEntries=Math.max(4,j),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function s(j,it,K){if(!K)return it.indexOf(j);for(var tt=0;tt<it.length;tt++)if(K(j,it[tt]))return tt;return-1}function lt(j,it){ht(j,0,j.children.length,it,j)}function ht(j,it,K,tt,X){X||(X=Jt(null)),X.minX=1/0,X.minY=1/0,X.maxX=-1/0,X.maxY=-1/0;for(var nt=it;nt<K;nt++){var J=j.children[nt];Lt(X,j.leaf?tt(J):J)}return X}function Lt(j,it){return j.minX=Math.min(j.minX,it.minX),j.minY=Math.min(j.minY,it.minY),j.maxX=Math.max(j.maxX,it.maxX),j.maxY=Math.max(j.maxY,it.maxY),j}function Ft(j,it){return j.minX-it.minX}function Qt(j,it){return j.minY-it.minY}function qt(j){return(j.maxX-j.minX)*(j.maxY-j.minY)}function _e(j){return j.maxX-j.minX+(j.maxY-j.minY)}function mt(j,it){return j.minX<=it.minX&&j.minY<=it.minY&&it.maxX<=j.maxX&&it.maxY<=j.maxY}function xt(j,it){return it.minX<=j.maxX&&it.minY<=j.maxY&&it.maxX>=j.minX&&it.maxY>=j.minY}function Jt(j){return{children:j,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function ye(j,it,K,tt,X){for(var nt=[it,K];nt.length;)if(!((K=nt.pop())-(it=nt.pop())<=tt)){var J=it+Math.ceil((K-it)/tt/2)*tt;ce(j,J,it,K,X),nt.push(it,J,J,K)}}return Pt.prototype.all=function(){return this._all(this.data,[])},Pt.prototype.search=function(j){var it=this.data,K=[];if(!xt(j,it))return K;for(var tt=this.toBBox,X=[];it;){for(var nt=0;nt<it.children.length;nt++){var J=it.children[nt],et=it.leaf?tt(J):J;xt(j,et)&&(it.leaf?K.push(J):mt(j,et)?this._all(J,K):X.push(J))}it=X.pop()}return K},Pt.prototype.collides=function(j){var it=this.data;if(!xt(j,it))return!1;for(var K=[];it;){for(var tt=0;tt<it.children.length;tt++){var X=it.children[tt],nt=it.leaf?this.toBBox(X):X;if(xt(j,nt)){if(it.leaf||mt(j,nt))return!0;K.push(X)}}it=K.pop()}return!1},Pt.prototype.load=function(j){if(!j||!j.length)return this;if(j.length<this._minEntries){for(var it=0;it<j.length;it++)this.insert(j[it]);return this}var K=this._build(j.slice(),0,j.length-1,0);if(this.data.children.length)if(this.data.height===K.height)this._splitRoot(this.data,K);else{if(this.data.height<K.height){var tt=this.data;this.data=K,K=tt}this._insert(K,this.data.height-K.height-1,!0)}else this.data=K;return this},Pt.prototype.insert=function(j){return j&&this._insert(j,this.data.height-1),this},Pt.prototype.clear=function(){return this.data=Jt([]),this},Pt.prototype.remove=function(j,it){if(!j)return this;for(var K,tt,X,nt=this.data,J=this.toBBox(j),et=[],at=[];nt||et.length;){if(nt||(nt=et.pop(),tt=et[et.length-1],K=at.pop(),X=!0),nt.leaf){var Z=s(j,nt.children,it);if(-1!==Z)return nt.children.splice(Z,1),et.push(nt),this._condense(et),this}X||nt.leaf||!mt(nt,J)?tt?(K++,nt=tt.children[K],X=!1):nt=null:(et.push(nt),at.push(K),K=0,tt=nt,nt=nt.children[0])}return this},Pt.prototype.toBBox=function(j){return j},Pt.prototype.compareMinX=function(j,it){return j.minX-it.minX},Pt.prototype.compareMinY=function(j,it){return j.minY-it.minY},Pt.prototype.toJSON=function(){return this.data},Pt.prototype.fromJSON=function(j){return this.data=j,this},Pt.prototype._all=function(j,it){for(var K=[];j;)j.leaf?it.push.apply(it,j.children):K.push.apply(K,j.children),j=K.pop();return it},Pt.prototype._build=function(j,it,K,tt){var X,nt=K-it+1,J=this._maxEntries;if(nt<=J)return lt(X=Jt(j.slice(it,K+1)),this.toBBox),X;tt||(tt=Math.ceil(Math.log(nt)/Math.log(J)),J=Math.ceil(nt/Math.pow(J,tt-1))),(X=Jt([])).leaf=!1,X.height=tt;var et=Math.ceil(nt/J),at=et*Math.ceil(Math.sqrt(J));ye(j,it,K,at,this.compareMinX);for(var Z=it;Z<=K;Z+=at){var Wt=Math.min(Z+at-1,K);ye(j,Z,Wt,et,this.compareMinY);for(var St=Z;St<=Wt;St+=et){var kt=Math.min(St+et-1,Wt);X.children.push(this._build(j,St,kt,tt-1))}}return lt(X,this.toBBox),X},Pt.prototype._chooseSubtree=function(j,it,K,tt){for(;tt.push(it),!it.leaf&&tt.length-1!==K;){for(var X=1/0,nt=1/0,J=void 0,et=0;et<it.children.length;et++){var at=it.children[et],Z=qt(at),Wt=(St=j,kt=at,(Math.max(kt.maxX,St.maxX)-Math.min(kt.minX,St.minX))*(Math.max(kt.maxY,St.maxY)-Math.min(kt.minY,St.minY))-Z);Wt<nt?(nt=Wt,X=Z<X?Z:X,J=at):Wt===nt&&Z<X&&(X=Z,J=at)}it=J||it.children[0]}var St,kt;return it},Pt.prototype._insert=function(j,it,K){var tt=K?j:this.toBBox(j),X=[],nt=this._chooseSubtree(tt,this.data,it,X);for(nt.children.push(j),Lt(nt,tt);it>=0&&X[it].children.length>this._maxEntries;)this._split(X,it),it--;this._adjustParentBBoxes(tt,X,it)},Pt.prototype._split=function(j,it){var K=j[it],tt=K.children.length,X=this._minEntries;this._chooseSplitAxis(K,X,tt);var nt=this._chooseSplitIndex(K,X,tt),J=Jt(K.children.splice(nt,K.children.length-nt));J.height=K.height,J.leaf=K.leaf,lt(K,this.toBBox),lt(J,this.toBBox),it?j[it-1].children.push(J):this._splitRoot(K,J)},Pt.prototype._splitRoot=function(j,it){this.data=Jt([j,it]),this.data.height=j.height+1,this.data.leaf=!1,lt(this.data,this.toBBox)},Pt.prototype._chooseSplitIndex=function(j,it,K){for(var tt,X,nt,J,et,at,Z,Wt=1/0,St=1/0,kt=it;kt<=K-it;kt++){var dt=ht(j,0,kt,this.toBBox),je=ht(j,kt,K,this.toBBox),Ce=(X=dt,nt=je,void 0,void 0,void 0,void 0,J=Math.max(X.minX,nt.minX),et=Math.max(X.minY,nt.minY),at=Math.min(X.maxX,nt.maxX),Z=Math.min(X.maxY,nt.maxY),Math.max(0,at-J)*Math.max(0,Z-et)),Mt=qt(dt)+qt(je);Ce<Wt?(Wt=Ce,tt=kt,St=Mt<St?Mt:St):Ce===Wt&&Mt<St&&(St=Mt,tt=kt)}return tt||K-it},Pt.prototype._chooseSplitAxis=function(j,it,K){var tt=j.leaf?this.compareMinX:Ft,X=j.leaf?this.compareMinY:Qt;this._allDistMargin(j,it,K,tt)<this._allDistMargin(j,it,K,X)&&j.children.sort(tt)},Pt.prototype._allDistMargin=function(j,it,K,tt){j.children.sort(tt);for(var X=this.toBBox,nt=ht(j,0,it,X),J=ht(j,K-it,K,X),et=_e(nt)+_e(J),at=it;at<K-it;at++){var Z=j.children[at];Lt(nt,j.leaf?X(Z):Z),et+=_e(nt)}for(var Wt=K-it-1;Wt>=it;Wt--){var St=j.children[Wt];Lt(J,j.leaf?X(St):St),et+=_e(J)}return et},Pt.prototype._adjustParentBBoxes=function(j,it,K){for(var tt=K;tt>=0;tt--)Lt(it[tt],j)},Pt.prototype._condense=function(j){for(var it=j.length-1,K=void 0;it>=0;it--)0===j[it].children.length?it>0?(K=j[it-1].children).splice(K.indexOf(j[it]),1):this.clear():lt(j[it],this.toBBox)},Pt}()},5203:(tr,ce,It)=>{"use strict";var gt,Pt=SyntaxError,s=Function,lt=TypeError,ht=function(kt){try{return s('"use strict"; return ('+kt+").constructor;")()}catch{}},Lt=Object.getOwnPropertyDescriptor;if(Lt)try{Lt({},"")}catch{Lt=null}var Ft=function(){throw new lt},Qt=Lt?function(){try{return Ft}catch{try{return Lt(arguments,"callee").get}catch{return Ft}}}():Ft,qt=It(2969)(),_e=Object.getPrototypeOf||function(kt){return kt.__proto__},mt={},xt=typeof Uint8Array>"u"?gt:_e(Uint8Array),Jt={"%AggregateError%":typeof AggregateError>"u"?gt:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?gt:ArrayBuffer,"%ArrayIteratorPrototype%":qt?_e([][Symbol.iterator]()):gt,"%AsyncFromSyncIteratorPrototype%":gt,"%AsyncFunction%":mt,"%AsyncGenerator%":mt,"%AsyncGeneratorFunction%":mt,"%AsyncIteratorPrototype%":mt,"%Atomics%":typeof Atomics>"u"?gt:Atomics,"%BigInt%":typeof BigInt>"u"?gt:BigInt,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?gt:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":typeof Float32Array>"u"?gt:Float32Array,"%Float64Array%":typeof Float64Array>"u"?gt:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?gt:FinalizationRegistry,"%Function%":s,"%GeneratorFunction%":mt,"%Int8Array%":typeof Int8Array>"u"?gt:Int8Array,"%Int16Array%":typeof Int16Array>"u"?gt:Int16Array,"%Int32Array%":typeof Int32Array>"u"?gt:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":qt?_e(_e([][Symbol.iterator]())):gt,"%JSON%":"object"==typeof JSON?JSON:gt,"%Map%":typeof Map>"u"?gt:Map,"%MapIteratorPrototype%":typeof Map>"u"||!qt?gt:_e((new Map)[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?gt:Promise,"%Proxy%":typeof Proxy>"u"?gt:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":typeof Reflect>"u"?gt:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?gt:Set,"%SetIteratorPrototype%":typeof Set>"u"||!qt?gt:_e((new Set)[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?gt:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":qt?_e(""[Symbol.iterator]()):gt,"%Symbol%":qt?Symbol:gt,"%SyntaxError%":Pt,"%ThrowTypeError%":Qt,"%TypedArray%":xt,"%TypeError%":lt,"%Uint8Array%":typeof Uint8Array>"u"?gt:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?gt:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?gt:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?gt:Uint32Array,"%URIError%":URIError,"%WeakMap%":typeof WeakMap>"u"?gt:WeakMap,"%WeakRef%":typeof WeakRef>"u"?gt:WeakRef,"%WeakSet%":typeof WeakSet>"u"?gt:WeakSet},ye=function kt(dt){var je;if("%AsyncFunction%"===dt)je=ht("async function () {}");else if("%GeneratorFunction%"===dt)je=ht("function* () {}");else if("%AsyncGeneratorFunction%"===dt)je=ht("async function* () {}");else if("%AsyncGenerator%"===dt){var Ce=kt("%AsyncGeneratorFunction%");Ce&&(je=Ce.prototype)}else if("%AsyncIteratorPrototype%"===dt){var Mt=kt("%AsyncGenerator%");Mt&&(je=_e(Mt.prototype))}return Jt[dt]=je,je},j={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},it=It(4444),K=It(3164),tt=it.call(Function.call,Array.prototype.concat),X=it.call(Function.apply,Array.prototype.splice),nt=it.call(Function.call,String.prototype.replace),J=it.call(Function.call,String.prototype.slice),et=it.call(Function.call,RegExp.prototype.exec),at=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,Z=/\\(\\)?/g,Wt=function(dt){var je=J(dt,0,1),Ce=J(dt,-1);if("%"===je&&"%"!==Ce)throw new Pt("invalid intrinsic syntax, expected closing `%`");if("%"===Ce&&"%"!==je)throw new Pt("invalid intrinsic syntax, expected opening `%`");var Mt=[];return nt(dt,at,function(pe,At,$t,fe){Mt[Mt.length]=$t?nt(fe,Z,"$1"):At||pe}),Mt},St=function(dt,je){var Mt,Ce=dt;if(K(j,Ce)&&(Ce="%"+(Mt=j[Ce])[0]+"%"),K(Jt,Ce)){var pe=Jt[Ce];if(pe===mt&&(pe=ye(Ce)),typeof pe>"u"&&!je)throw new lt("intrinsic "+dt+" exists, but is not available. Please file an issue!");return{alias:Mt,name:Ce,value:pe}}throw new Pt("intrinsic "+dt+" does not exist!")};tr.exports=function(dt,je){if("string"!=typeof dt||0===dt.length)throw new lt("intrinsic name must be a non-empty string");if(arguments.length>1&&"boolean"!=typeof je)throw new lt('"allowMissing" argument must be a boolean');if(null===et(/^%?[^%]*%?$/,dt))throw new Pt("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var Ce=Wt(dt),Mt=Ce.length>0?Ce[0]:"",pe=St("%"+Mt+"%",je),At=pe.name,$t=pe.value,fe=!1,Ot=pe.alias;Ot&&(Mt=Ot[0],X(Ce,tt([0,1],Ot)));for(var Be=1,De=!0;Be<Ce.length;Be+=1){var sr=Ce[Be],Ie=J(sr,0,1),Sr=J(sr,-1);if(('"'===Ie||"'"===Ie||"`"===Ie||'"'===Sr||"'"===Sr||"`"===Sr)&&Ie!==Sr)throw new Pt("property names with quotes must have matching quotes");if(("constructor"===sr||!De)&&(fe=!0),K(Jt,At="%"+(Mt+="."+sr)+"%"))$t=Jt[At];else if(null!=$t){if(!(sr in $t)){if(!je)throw new lt("base intrinsic for "+dt+" exists, but the property is not available.");return}if(Lt&&Be+1>=Ce.length){var mr=Lt($t,sr);$t=(De=!!mr)&&"get"in mr&&!("originalValue"in mr.get)?mr.get:$t[sr]}else De=K($t,sr),$t=$t[sr];De&&!fe&&(Jt[At]=$t)}}return $t}},7027:(tr,ce,It)=>{"use strict";var Pt=It(5203)("%Object.defineProperty%",!0),s=function(){if(Pt)try{return Pt({},"a",{value:1}),!0}catch{return!1}return!1};s.hasArrayLengthDefineBug=function(){if(!s())return null;try{return 1!==Pt([],"length",{value:1}).length}catch{return!0}},tr.exports=s},2969:(tr,ce,It)=>{"use strict";var gt=typeof Symbol<"u"&&Symbol,Pt=It(1983);tr.exports=function(){return"function"==typeof gt&&"function"==typeof Symbol&&"symbol"==typeof gt("foo")&&"symbol"==typeof Symbol("bar")&&Pt()}},1983:tr=>{"use strict";tr.exports=function(){if("function"!=typeof Symbol||"function"!=typeof Object.getOwnPropertySymbols)return!1;if("symbol"==typeof Symbol.iterator)return!0;var It={},gt=Symbol("test"),Pt=Object(gt);if("string"==typeof gt||"[object Symbol]"!==Object.prototype.toString.call(gt)||"[object Symbol]"!==Object.prototype.toString.call(Pt))return!1;for(gt in It[gt]=42,It)return!1;if("function"==typeof Object.keys&&0!==Object.keys(It).length||"function"==typeof Object.getOwnPropertyNames&&0!==Object.getOwnPropertyNames(It).length)return!1;var lt=Object.getOwnPropertySymbols(It);if(1!==lt.length||lt[0]!==gt||!Object.prototype.propertyIsEnumerable.call(It,gt))return!1;if("function"==typeof Object.getOwnPropertyDescriptor){var ht=Object.getOwnPropertyDescriptor(It,gt);if(42!==ht.value||!0!==ht.enumerable)return!1}return!0}},6259:(tr,ce,It)=>{"use strict";var gt=It(1983);tr.exports=function(){return gt()&&!!Symbol.toStringTag}},3164:(tr,ce,It)=>{"use strict";var gt=It(4444);tr.exports=gt.call(Function.call,Object.prototype.hasOwnProperty)},3407:(tr,ce,It)=>{"use strict";var gt=It(6259)(),s=It(5834)("Object.prototype.toString"),lt=function(Qt){return!(gt&&Qt&&"object"==typeof Qt&&Symbol.toStringTag in Qt)&&"[object Arguments]"===s(Qt)},ht=function(Qt){return!!lt(Qt)||null!==Qt&&"object"==typeof Qt&&"number"==typeof Qt.length&&Qt.length>=0&&"[object Array]"!==s(Qt)&&"[object Function]"===s(Qt.callee)},Lt=function(){return lt(arguments)}();lt.isLegacyArguments=ht,tr.exports=Lt?lt:ht},2374:(tr,ce,It)=>{"use strict";var gt=Date.prototype.getDay,s=Object.prototype.toString,ht=It(6259)();tr.exports=function(Ft){return"object"==typeof Ft&&null!==Ft&&(ht?function(Ft){try{return gt.call(Ft),!0}catch{return!1}}(Ft):"[object Date]"===s.call(Ft))}},2342:(tr,ce,It)=>{"use strict";var s,lt,ht,Lt,gt=It(5834),Pt=It(6259)();if(Pt){s=gt("Object.prototype.hasOwnProperty"),lt=gt("RegExp.prototype.exec"),ht={};var Ft=function(){throw ht};Lt={toString:Ft,valueOf:Ft},"symbol"==typeof Symbol.toPrimitive&&(Lt[Symbol.toPrimitive]=Ft)}var Qt=gt("Object.prototype.toString"),qt=Object.getOwnPropertyDescriptor;tr.exports=Pt?function(xt){if(!xt||"object"!=typeof xt)return!1;var Jt=qt(xt,"lastIndex");if(!Jt||!s(Jt,"value"))return!1;try{lt(xt,Lt)}catch(j){return j===ht}}:function(xt){return!(!xt||"object"!=typeof xt&&"function"!=typeof xt)&&"[object RegExp]"===Qt(xt)}},6151:(tr,ce)=>{"use strict";ce.Z={onSetup:function(lt){var ht=this.newFeature({type:"Feature",properties:{},geometry:{type:"Polygon",coordinates:[[]]}});return this.addFeature(ht),this.clearSelectedFeatures(),function(lt){setTimeout(function(){!lt.map||!lt.map.doubleClickZoom||lt.map.doubleClickZoom.disable()},0)}(this),this.updateUIClasses({mouse:"add"}),this.setActionableState({trash:!0}),{rectangle:ht}},onTap:function(lt,ht){lt.startPoint&&this.onMouseMove(lt,ht),this.onClick(lt,ht)},onClick:function(lt,ht){lt.startPoint&&lt.startPoint[0]!==ht.lngLat.lng&&lt.startPoint[1]!==ht.lngLat.lat&&(this.updateUIClasses({mouse:"pointer"}),lt.endPoint=[ht.lngLat.lng,ht.lngLat.lat],this.changeMode("simple_select",{featuresId:lt.rectangle.id})),lt.startPoint=[ht.lngLat.lng,ht.lngLat.lat]},onMouseMove:function(lt,ht){lt.startPoint&&(lt.rectangle.updateCoordinate("0.0",lt.startPoint[0],lt.startPoint[1]),lt.rectangle.updateCoordinate("0.1",ht.lngLat.lng,lt.startPoint[1]),lt.rectangle.updateCoordinate("0.2",ht.lngLat.lng,ht.lngLat.lat),lt.rectangle.updateCoordinate("0.3",lt.startPoint[0],ht.lngLat.lat),lt.rectangle.updateCoordinate("0.4",lt.startPoint[0],lt.startPoint[1]))},onKeyUp:function(lt,ht){if(27===ht.keyCode)return this.changeMode("simple_select")},onStop:function(lt){(function(lt){setTimeout(function(){!lt.map||!lt.map.doubleClickZoom||!lt._ctx||!lt._ctx.store||!lt._ctx.store.getInitialConfigValue||!lt._ctx.store.getInitialConfigValue("doubleClickZoom")||lt.map.doubleClickZoom.enable()},0)})(this),this.updateUIClasses({mouse:"none"}),this.activateUIButton(),void 0!==this.getFeature(lt.rectangle.id)&&(lt.rectangle.removeCoordinate("0.4"),lt.rectangle.isValid()?this.map.fire("draw.create",{features:[lt.rectangle.toGeoJSON()]}):(this.deleteFeature([lt.rectangle.id],{silent:!0}),this.changeMode("simple_select",{},{silent:!0})))},toDisplayFeatures:function(lt,ht,Lt){var Ft=ht.properties.id===lt.rectangle.id;return ht.properties.active=Ft?"true":"false",Ft?lt.startPoint?Lt(ht):void 0:Lt(ht)},onTrash:function(lt){this.deleteFeature([lt.rectangle.id],{silent:!0}),this.changeMode("simple_select")}}},9990:(tr,ce,It)=>{const gt=It(2777).Z,Pt=It(5427).Z,s=It(2586).Z,lt=It(9814).Z,Lt=new(It(9069));tr.exports={rotatestart:function(Qt,qt){},rotating:function(Qt,qt,_e){},rotateend:function(Qt){},onSetup:function(Qt){var qt={};return Lt.addListener("rotatestart",function(){this.rotatestart(qt.selectedFeature,qt.originalCenter)}.bind(this)),Lt.addListener("rotating",function(){this.rotating(qt.selectedFeature,qt.originalCenter,qt.lastMouseDownLngLat)}.bind(this)),Lt.addListener("rotateend",function(){this.rotateend(qt.selectedFeature,qt.lastMouseDownLngLat)}.bind(this)),qt.selectedFeature=Qt.selectedFeature||!1,qt.lastMouseDownLngLat=!1,qt.originalCenter=!1,qt.mode="rotate",qt},onMouseDown:function(Qt,qt){return qt.featureTarget&&this._ctx.api.get(qt.featureTarget.properties.id)&&(qt.target.dragPan.disable(),Qt.selectedFeature=this._ctx.api.get(qt.featureTarget.properties.id),Qt.originalCenter=Pt(qt.featureTarget),Qt.originalFeature=qt.featureTarget,Lt.emit("rotatestart")),Qt},toDisplayFeatures:function(Qt,qt,_e){_e(qt)},onDrag:function(Qt,qt){if(Qt.selectedFeature&&Qt.mode&&"rotate"===Qt.mode){Qt.lastMouseDownLngLat={lng:qt.lngLat.lng,lat:qt.lngLat.lat};var _e=s(Qt.originalCenter,[qt.lngLat.lng,qt.lngLat.lat]),mt=[];switch(Qt.originalFeature.properties["meta:type"]){case"Point":break;case"LineString":Qt.originalFeature.geometry.coordinates.forEach(function(it,K){var tt=gt(Qt.originalCenter,it),X=s(Qt.originalCenter,it),nt=lt(Qt.originalCenter,tt,X+_e);mt.push(nt.geometry.coordinates)});break;case"Polygon":var xt=[];Qt.originalFeature.geometry.coordinates[0].forEach(function(it,K){var tt=gt(Qt.originalCenter,it),X=s(Qt.originalCenter,it),nt=lt(Qt.originalCenter,tt,X+_e);xt.push(nt.geometry.coordinates)}),mt.push(xt);break;case"MultiLineString":var Jt=[];Qt.originalFeature.geometry.coordinates.forEach(function(it,K){var tt=[];it.forEach(function(X,nt){var J=gt(Qt.originalCenter,X),et=s(Qt.originalCenter,X),at=lt(Qt.originalCenter,J,et+_e);tt.push(at.geometry.coordinates)}),Jt.push(tt)}),mt=Jt;break;case"MultiPolygon":Jt=[],Qt.originalFeature.geometry.coordinates.forEach(function(it,K){var tt=[];it.forEach(function(X,nt){var J=[];X.forEach(function(et,at){var Z=gt(Qt.originalCenter,et),Wt=s(Qt.originalCenter,et),St=lt(Qt.originalCenter,Z,Wt+_e);J.push(St.geometry.coordinates)}),tt.push(J)}),Jt.push(tt)}),mt=Jt;break;default:return}Lt.emit("rotating");var ye=Qt.selectedFeature;ye.geometry.coordinates=mt,this._ctx.api.add(ye)}},onMouseUp:function(Qt,qt){return qt.target.dragPan.enable(),Lt.emit("rotateend"),Qt.selectedFeature=!1,Qt.lastMouseDownLngLat=!1,Qt.originalCenter=!1,Qt}}},2586:(tr,ce,It)=>{"use strict";function Z(se){if(null==se)throw new Error("degrees is required");return se%360*Math.PI/180}function De(se){if(!se)throw new Error("coord is required");if("Feature"===se.type&&null!==se.geometry&&"Point"===se.geometry.type)return se.geometry.coordinates;if("Point"===se.type)return se.coordinates;if(Array.isArray(se)&&se.length>=2&&void 0===se[0].length&&void 0===se[1].length)return se;throw new Error("coord must be GeoJSON Point or an Array of numbers")}It.d(ce,{Z:()=>zn});const zn=function ei(se,Ze,Kt){if(!function dt(se){return!!se&&se.constructor===Object}(Kt=Kt||{}))throw new Error("options is invalid");if(!0===Kt.final)return function _n(se,Ze){return(ei(Ze,se)+180)%360}(se,Ze);var rt=De(se),ot=De(Ze),Nt=Z(rt[0]),le=Z(ot[0]),Oe=Z(rt[1]),Qe=Z(ot[1]),ir=Math.sin(le-Nt)*Math.cos(Qe),Ge=Math.cos(Oe)*Math.sin(Qe)-Math.sin(Oe)*Math.cos(Qe)*Math.cos(le-Nt);return function at(se){if(null==se)throw new Error("radians is required");return se%(2*Math.PI)*180/Math.PI}(Math.atan2(ir,Ge))}},4987:function(tr){tr.exports=function(){"use strict";var ce,It,gt;function Pt(s,lt){if(ce)if(It){var ht="var sharedChunk = {}; ("+ce+")(sharedChunk); ("+It+")(sharedChunk);",Lt={};ce(Lt),gt=lt(Lt),typeof window<"u"&&(gt.workerUrl=window.URL.createObjectURL(new Blob([ht],{type:"text/javascript"})))}else It=lt;else ce=lt}return Pt(0,function(s){function lt(t,n){return t(n={exports:{}},n.exports),n.exports}var ht=Lt;function Lt(t,n,u,g){this.cx=3*t,this.bx=3*(u-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*n,this.by=3*(g-n)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=g,this.p2x=u,this.p2y=g}Lt.prototype.sampleCurveX=function(t){return((this.ax*t+this.bx)*t+this.cx)*t},Lt.prototype.sampleCurveY=function(t){return((this.ay*t+this.by)*t+this.cy)*t},Lt.prototype.sampleCurveDerivativeX=function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},Lt.prototype.solveCurveX=function(t,n){var u,g,_,w,S;for(void 0===n&&(n=1e-6),_=t,S=0;S<8;S++){if(w=this.sampleCurveX(_)-t,Math.abs(w)<n)return _;var A=this.sampleCurveDerivativeX(_);if(Math.abs(A)<1e-6)break;_-=w/A}if((_=t)<(u=0))return u;if(_>(g=1))return g;for(;u<g;){if(w=this.sampleCurveX(_),Math.abs(w-t)<n)return _;t>w?u=_:g=_,_=.5*(g-u)+u}return _},Lt.prototype.solve=function(t,n){return this.sampleCurveY(this.solveCurveX(t,n))};var Ft=Qt;function Qt(t,n){this.x=t,this.y=n}Qt.prototype={clone:function(){return new Qt(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,n){return this.clone()._rotateAround(t,n)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var n=t.x-this.x,u=t.y-this.y;return n*n+u*u},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,n){return Math.atan2(this.x*n-this.y*t,this.x*t+this.y*n)},_matMult:function(t){var n=t[2]*this.x+t[3]*this.y;return this.x=t[0]*this.x+t[1]*this.y,this.y=n,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var n=Math.cos(t),u=Math.sin(t),g=u*this.x+n*this.y;return this.x=n*this.x-u*this.y,this.y=g,this},_rotateAround:function(t,n){var u=Math.cos(t),g=Math.sin(t),_=n.y+g*(this.x-n.x)+u*(this.y-n.y);return this.x=n.x+u*(this.x-n.x)-g*(this.y-n.y),this.y=_,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},Qt.convert=function(t){return t instanceof Qt?t:Array.isArray(t)?new Qt(t[0],t[1]):t};var qt=typeof self<"u"?self:{},_e=Math.pow(2,53)-1;function mt(t,n,u,g){var _=new ht(t,n,u,g);return function(w){return _.solve(w)}}var xt=mt(.25,.1,.25,1);function Jt(t,n,u){return Math.min(u,Math.max(n,t))}function ye(t,n,u){var g=u-n,_=((t-n)%g+g)%g+n;return _===n?u:_}function j(t){for(var n=[],u=arguments.length-1;u-- >0;)n[u]=arguments[u+1];for(var g=0,_=n;g<_.length;g+=1){var w=_[g];for(var S in w)t[S]=w[S]}return t}var it=1;function K(){return it++}function tt(){return function t(n){return n?(n^16*Math.random()>>n/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,t)}()}function X(t){return!!t&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(t)}function nt(t,n){t.forEach(function(u){n[u]&&(n[u]=n[u].bind(n))})}function J(t,n){return-1!==t.indexOf(n,t.length-n.length)}function et(t,n,u){var g={};for(var _ in t)g[_]=n.call(u||this,t[_],_,t);return g}function at(t,n,u){var g={};for(var _ in t)n.call(u||this,t[_],_,t)&&(g[_]=t[_]);return g}function Z(t){return Array.isArray(t)?t.map(Z):"object"==typeof t&&t?et(t,Z):t}var Wt={};function St(t){Wt[t]||(typeof console<"u"&&console.warn(t),Wt[t]=!0)}function kt(t,n,u){return(u.y-t.y)*(n.x-t.x)>(n.y-t.y)*(u.x-t.x)}function dt(t){for(var n=0,u=0,g=t.length,_=g-1,w=void 0,S=void 0;u<g;_=u++)n+=((S=t[_]).x-(w=t[u]).x)*(w.y+S.y);return n}function je(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function Ce(t){var n={};if(t.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,function(g,_,w,S){var A=w||S;return n[_]=!A||A.toLowerCase(),""}),n["max-age"]){var u=parseInt(n["max-age"],10);isNaN(u)?delete n["max-age"]:n["max-age"]=u}return n}var Mt=null;function pe(t){if(null==Mt){var n=t.navigator?t.navigator.userAgent:null;Mt=!!t.safari||!(!n||!(/\b(iPad|iPhone|iPod)\b/.test(n)||n.match("Safari")&&!n.match("Chrome")))}return Mt}function At(t){try{var n=qt[t];return n.setItem("_mapbox_test_",1),n.removeItem("_mapbox_test_"),!0}catch{return!1}}var $t,fe,Ot,Be,De=qt.performance&&qt.performance.now?qt.performance.now.bind(qt.performance):Date.now.bind(Date),sr=qt.requestAnimationFrame||qt.mozRequestAnimationFrame||qt.webkitRequestAnimationFrame||qt.msRequestAnimationFrame,Ie=qt.cancelAnimationFrame||qt.mozCancelAnimationFrame||qt.webkitCancelAnimationFrame||qt.msCancelAnimationFrame,Sr={now:De,frame:function(t){var n=sr(t);return{cancel:function(){return Ie(n)}}},getImageData:function(t,n){void 0===n&&(n=0);var u=qt.document.createElement("canvas"),g=u.getContext("2d");if(!g)throw new Error("failed to create canvas 2d context");return u.width=t.width,u.height=t.height,g.drawImage(t,0,0,t.width,t.height),g.getImageData(-n,-n,t.width+2*n,t.height+2*n)},resolveURL:function(t){return $t||($t=qt.document.createElement("a")),$t.href=t,$t.href},hardwareConcurrency:qt.navigator&&qt.navigator.hardwareConcurrency||4,get devicePixelRatio(){return qt.devicePixelRatio},get prefersReducedMotion(){return!!qt.matchMedia&&(null==fe&&(fe=qt.matchMedia("(prefers-reduced-motion: reduce)")),fe.matches)}},mr={API_URL:"https://api.mapbox.com",get EVENTS_URL(){return this.API_URL?0===this.API_URL.indexOf("https://api.mapbox.cn")?"https://events.mapbox.cn/events/v2":0===this.API_URL.indexOf("https://api.mapbox.com")?"https://events.mapbox.com/events/v2":null:null},FEEDBACK_URL:"https://apps.mapbox.com/feedback",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16,REGISTERED_PROTOCOLS:{}},Ur={supported:!1,testSupport:function(t){!jr&&Be&&(Er?He(t):Ot=t)}},jr=!1,Er=!1;function He(t){var n=t.createTexture();t.bindTexture(t.TEXTURE_2D,n);try{if(t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,Be),t.isContextLost())return;Ur.supported=!0}catch{}t.deleteTexture(n),jr=!0}qt.document&&((Be=qt.document.createElement("img")).onload=function(){Ot&&He(Ot),Ot=null,Er=!0},Be.onerror=function(){jr=!0,Ot=null},Be.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");var ei="01",_n=function(t,n){this._transformRequestFn=t,this._customAccessToken=n,this._createSkuToken()};function zn(t){return 0===t.indexOf("mapbox:")}_n.prototype._createSkuToken=function(){var t=function(){for(var n="",u=0;u<10;u++)n+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",ei,n].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=t.token,this._skuTokenExpiresAt=t.tokenExpiresAt},_n.prototype._isSkuTokenExpired=function(){return Date.now()>this._skuTokenExpiresAt},_n.prototype.transformRequest=function(t,n){return this._transformRequestFn&&this._transformRequestFn(t,n)||{url:t}},_n.prototype.normalizeStyleURL=function(t,n){if(!zn(t))return t;var u=ut(t);return u.path="/styles/v1"+u.path,this._makeAPIURL(u,this._customAccessToken||n)},_n.prototype.normalizeGlyphsURL=function(t,n){if(!zn(t))return t;var u=ut(t);return u.path="/fonts/v1"+u.path,this._makeAPIURL(u,this._customAccessToken||n)},_n.prototype.normalizeSourceURL=function(t,n){if(!zn(t))return t;var u=ut(t);return u.path="/v4/"+u.authority+".json",u.params.push("secure"),this._makeAPIURL(u,this._customAccessToken||n)},_n.prototype.normalizeSpriteURL=function(t,n,u,g){var _=ut(t);return zn(t)?(_.path="/styles/v1"+_.path+"/sprite"+n+u,this._makeAPIURL(_,this._customAccessToken||g)):(_.path+=""+n+u,rt(_))},_n.prototype.normalizeTileURL=function(t,n){if(this._isSkuTokenExpired()&&this._createSkuToken(),t&&!zn(t))return t;var u=ut(t);u.path=u.path.replace(/(\.(png|jpg)\d*)(?=$)/,(Sr.devicePixelRatio>=2||512===n?"@2x":"")+(Ur.supported?".webp":"$1")),u.path=u.path.replace(/^.+\/v4\//,"/"),u.path="/v4"+u.path;var g=this._customAccessToken||function(_){for(var w=0,S=_;w<S.length;w+=1){var A=S[w].match(/^access_token=(.*)$/);if(A)return A[1]}return null}(u.params)||mr.ACCESS_TOKEN;return mr.REQUIRE_ACCESS_TOKEN&&g&&this._skuToken&&u.params.push("sku="+this._skuToken),this._makeAPIURL(u,g)},_n.prototype.canonicalizeTileURL=function(t,n){var u=ut(t);if(!u.path.match(/(^\/v4\/)/)||!u.path.match(/\.[\w]+$/))return t;var g="mapbox://tiles/";g+=u.path.replace("/v4/","");var _=u.params;return n&&(_=_.filter(function(w){return!w.match(/^access_token=/)})),_.length&&(g+="?"+_.join("&")),g},_n.prototype.canonicalizeTileset=function(t,n){for(var u=!!n&&zn(n),g=[],_=0,w=t.tiles||[];_<w.length;_+=1){var S=w[_];Ze(S)?g.push(this.canonicalizeTileURL(S,u)):g.push(S)}return g},_n.prototype._makeAPIURL=function(t,n){var u="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",g=ut(mr.API_URL);if(t.protocol=g.protocol,t.authority=g.authority,"http"===t.protocol){var _=t.params.indexOf("secure");_>=0&&t.params.splice(_,1)}if("/"!==g.path&&(t.path=""+g.path+t.path),!mr.REQUIRE_ACCESS_TOKEN)return rt(t);if(!(n=n||mr.ACCESS_TOKEN))throw new Error("An API access token is required to use Mapbox GL. "+u);if("s"===n[0])throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). "+u);return t.params=t.params.filter(function(w){return-1===w.indexOf("access_token")}),t.params.push("access_token="+n),rt(t)},_n.prototype.setTransformRequest=function(t){this._transformRequestFn=t};var se=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;function Ze(t){return se.test(t)}var Kt=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function ut(t){var n=t.match(Kt);if(!n)throw new Error("Unable to parse URL object");return{protocol:n[1],authority:n[2],path:n[3]||"/",params:n[4]?n[4].split("&"):[]}}function rt(t){var n=t.params.length?"?"+t.params.join("&"):"";return t.protocol+"://"+t.authority+t.path+n}function ot(t){if(!t)return null;var n=t.split(".");if(!n||3!==n.length)return null;try{return JSON.parse(decodeURIComponent(qt.atob(n[1]).split("").map(function(u){return"%"+("00"+u.charCodeAt(0).toString(16)).slice(-2)}).join("")))}catch{return null}}var Nt=function(t){this.type=t,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null};Nt.prototype.getStorageKey=function(t){var n,u=ot(mr.ACCESS_TOKEN);return n=u&&u.u?qt.btoa(encodeURIComponent(u.u).replace(/%([0-9A-F]{2})/g,function(g,_){return String.fromCharCode(Number("0x"+_))})):mr.ACCESS_TOKEN||"",t?"mapbox.eventData."+t+":"+n:"mapbox.eventData:"+n},Nt.prototype.fetchEventData=function(){var t=At("localStorage"),n=this.getStorageKey(),u=this.getStorageKey("uuid");if(t)try{var g=qt.localStorage.getItem(n);g&&(this.eventData=JSON.parse(g));var _=qt.localStorage.getItem(u);_&&(this.anonId=_)}catch{St("Unable to read from LocalStorage")}},Nt.prototype.saveEventData=function(){var t=At("localStorage"),n=this.getStorageKey(),u=this.getStorageKey("uuid");if(t)try{qt.localStorage.setItem(u,this.anonId),Object.keys(this.eventData).length>=1&&qt.localStorage.setItem(n,JSON.stringify(this.eventData))}catch{St("Unable to write to LocalStorage")}},Nt.prototype.processRequests=function(t){},Nt.prototype.postEvent=function(t,n,u,g){var _=this;if(mr.EVENTS_URL){var w=ut(mr.EVENTS_URL);w.params.push("access_token="+(g||mr.ACCESS_TOKEN||""));var S={event:this.type,created:new Date(t).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:"1.15.3",skuId:ei,userId:this.anonId},A=n?j(S,n):S,z={url:rt(w),headers:{"Content-Type":"text/plain"},body:JSON.stringify([A])};this.pendingRequest=Y(z,function(q){_.pendingRequest=null,u(q),_.saveEventData(),_.processRequests(g)})}},Nt.prototype.queueRequest=function(t,n){this.queue.push(t),this.processRequests(n)};var le,Oe,Qe=function(t){function n(){t.call(this,"map.load"),this.success={},this.skuToken=""}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n.prototype.postMapLoadEvent=function(u,g,_,w){this.skuToken=_,(mr.EVENTS_URL&&w||mr.ACCESS_TOKEN&&Array.isArray(u)&&u.some(function(S){return zn(S)||Ze(S)}))&&this.queueRequest({id:g,timestamp:Date.now()},w)},n.prototype.processRequests=function(u){var g=this;if(!this.pendingRequest&&0!==this.queue.length){var _=this.queue.shift(),w=_.id,S=_.timestamp;w&&this.success[w]||(this.anonId||this.fetchEventData(),X(this.anonId)||(this.anonId=tt()),this.postEvent(S,{skuToken:this.skuToken},function(A){A||w&&(g.success[w]=!0)},u))}},n}(Nt),ir=new(function(t){function n(u){t.call(this,"appUserTurnstile"),this._customAccessToken=u}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n.prototype.postTurnstileEvent=function(u,g){mr.EVENTS_URL&&mr.ACCESS_TOKEN&&Array.isArray(u)&&u.some(function(_){return zn(_)||Ze(_)})&&this.queueRequest(Date.now(),g)},n.prototype.processRequests=function(u){var g=this;if(!this.pendingRequest&&0!==this.queue.length){this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();var _=ot(mr.ACCESS_TOKEN),w=_?_.u:mr.ACCESS_TOKEN,S=w!==this.eventData.tokenU;X(this.anonId)||(this.anonId=tt(),S=!0);var A=this.queue.shift();if(this.eventData.lastSuccess){var z=new Date(this.eventData.lastSuccess),q=new Date(A),V=(A-this.eventData.lastSuccess)/864e5;S=S||V>=1||V<-1||z.getDate()!==q.getDate()}else S=!0;if(!S)return this.processRequests();this.postEvent(A,{"enabled.telemetry":!1},function(H){H||(g.eventData.lastSuccess=A,g.eventData.tokenU=w)},u)}},n}(Nt)),Ge=ir.postTurnstileEvent.bind(ir),fn=new Qe,en=fn.postMapLoadEvent.bind(fn),hr=500,gn=50;function Yn(){qt.caches&&!le&&(le=qt.caches.open("mapbox-tiles"))}function Jn(t){var n=t.indexOf("?");return n<0?t:t.slice(0,n)}var Sn,ri=1/0;function Br(){return null==Sn&&(Sn=qt.OffscreenCanvas&&new qt.OffscreenCanvas(1,1).getContext("2d")&&"function"==typeof qt.createImageBitmap),Sn}var Xo={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};"function"==typeof Object.freeze&&Object.freeze(Xo);var zo=function(t){function n(u,g,_){401===g&&Ze(_)&&(u+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),t.call(this,u),this.status=g,this.url=_,this.name=this.constructor.name,this.message=u}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n.prototype.toString=function(){return this.name+": "+this.message+" ("+this.status+"): "+this.url},n}(Error),Yo=je()?function(){return self.worker&&self.worker.referrer}:function(){return("blob:"===qt.location.protocol?qt.parent:qt).location.href};function Gn(t,n){var u,g=new qt.AbortController,_=new qt.Request(t.url,{method:t.method||"GET",body:t.body,credentials:t.credentials,headers:t.headers,referrer:Yo(),signal:g.signal}),w=!1,S=!1,A=(u=_.url).indexOf("sku=")>0&&Ze(u);"json"===t.type&&_.headers.set("Accept","application/json");var z=function(V,H,st){if(!S){if(V&&"SecurityError"!==V.message&&St(V),H&&st)return q(H);var vt=Date.now();qt.fetch(_).then(function(Rt){if(Rt.ok){var Vt=A?Rt.clone():null;return q(Rt,Vt,vt)}return n(new zo(Rt.statusText,Rt.status,t.url))}).catch(function(Rt){20!==Rt.code&&n(new Error(Rt.message))})}},q=function(V,H,st){("arrayBuffer"===t.type?V.arrayBuffer():"json"===t.type?V.json():V.text()).then(function(vt){S||(H&&st&&function(Rt,Vt,he){if(Yn(),le){var re={status:Vt.status,statusText:Vt.statusText,headers:new qt.Headers};Vt.headers.forEach(function(Pe,Re){return re.headers.set(Re,Pe)});var we=Ce(Vt.headers.get("Cache-Control")||"");we["no-store"]||(we["max-age"]&&re.headers.set("Expires",new Date(he+1e3*we["max-age"]).toUTCString()),new Date(re.headers.get("Expires")).getTime()-he<42e4||function(Pe,Re){if(void 0===Oe)try{new Response(new ReadableStream),Oe=!0}catch{Oe=!1}Oe?Re(Pe.body):Pe.blob().then(Re)}(Vt,function(Pe){var Re=new qt.Response(Pe,re);Yn(),le&&le.then(function(ze){return ze.put(Jn(Rt.url),Re)}).catch(function(ze){return St(ze.message)})}))}}(_,H,st),w=!0,n(null,vt,V.headers.get("Cache-Control"),V.headers.get("Expires")))}).catch(function(vt){S||n(new Error(vt.message))})};return A?function(V,H){if(Yn(),!le)return H(null);var st=Jn(V.url);le.then(function(vt){vt.match(st).then(function(Rt){var Vt=function(he){if(!he)return!1;var re=new Date(he.headers.get("Expires")||0),we=Ce(he.headers.get("Cache-Control")||"");return re>Date.now()&&!we["no-cache"]}(Rt);vt.delete(st),Vt&&vt.put(st,Rt.clone()),H(null,Rt,Vt)}).catch(H)}).catch(H)}(_,z):z(null,null),{cancel:function(){S=!0,w||g.abort()}}}var xa,xn,cr=function(t,n){if(/:\/\//.test(t.url)&&!/^https?:|^file:/.test(t.url)){if(je()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",t,n);if(!je()){var u=t.url.substring(0,t.url.indexOf("://"));return(mr.REGISTERED_PROTOCOLS[u]||Gn)(t,n)}}if(!(/^file:/.test(g=t.url)||/^file:/.test(Yo())&&!/^\w+:/.test(g))){if(qt.fetch&&qt.Request&&qt.AbortController&&qt.Request.prototype.hasOwnProperty("signal"))return Gn(t,n);if(je()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",t,n,void 0,!0)}var g;return function(_,w){var S=new qt.XMLHttpRequest;for(var A in S.open(_.method||"GET",_.url,!0),"arrayBuffer"===_.type&&(S.responseType="arraybuffer"),_.headers)S.setRequestHeader(A,_.headers[A]);return"json"===_.type&&(S.responseType="text",S.setRequestHeader("Accept","application/json")),S.withCredentials="include"===_.credentials,S.onerror=function(){w(new Error(S.statusText))},S.onload=function(){if((S.status>=200&&S.status<300||0===S.status)&&null!==S.response){var z=S.response;if("json"===_.type)try{z=JSON.parse(S.response)}catch(q){return w(q)}w(null,z,S.getResponseHeader("Cache-Control"),S.getResponseHeader("Expires"))}else w(new zo(S.statusText,S.status,_.url))},S.send(_.body),{cancel:function(){return S.abort()}}}(t,n)},oi=function(t,n){return cr(j(t,{type:"arrayBuffer"}),n)},Y=function(t,n){return cr(j(t,{method:"POST"}),n)},W="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";xa=[],xn=0;var ft=function(t,n){if(Ur.supported&&(t.headers||(t.headers={}),t.headers.accept="image/webp,*/*"),xn>=mr.MAX_PARALLEL_IMAGE_REQUESTS){var u={requestParameters:t,callback:n,cancelled:!1,cancel:function(){this.cancelled=!0}};return xa.push(u),u}xn++;var g=!1,_=function(){if(!g)for(g=!0,xn--;xa.length&&xn<mr.MAX_PARALLEL_IMAGE_REQUESTS;){var S=xa.shift();S.cancelled||(S.cancel=ft(S.requestParameters,S.callback).cancel)}},w=oi(t,function(S,A,z,q){var H,st;_(),S?n(S):A&&(Br()?(H=n,st=new qt.Blob([new Uint8Array(A)],{type:"image/png"}),qt.createImageBitmap(st).then(function(vt){H(null,vt)}).catch(function(vt){H(new Error("Could not load image because of "+vt.message+". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))})):function(V,H,st,vt){var Rt=new qt.Image,Vt=qt.URL;Rt.onload=function(){H(null,Rt),Vt.revokeObjectURL(Rt.src),Rt.onload=null,qt.requestAnimationFrame(function(){Rt.src=W})},Rt.onerror=function(){return H(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))};var he=new qt.Blob([new Uint8Array(V)],{type:"image/png"});Rt.cacheControl=st,Rt.expires=vt,Rt.src=V.byteLength?Vt.createObjectURL(he):W}(A,n,z,q))});return{cancel:function(){w.cancel(),_()}}};function bt(t,n,u){u[t]&&-1!==u[t].indexOf(n)||(u[t]=u[t]||[],u[t].push(n))}function zt(t,n,u){if(u&&u[t]){var g=u[t].indexOf(n);-1!==g&&u[t].splice(g,1)}}var ae=function(t,n){void 0===n&&(n={}),j(this,n),this.type=t},me=function(t){function n(u,g){void 0===g&&(g={}),t.call(this,"error",j({error:u},g))}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n}(ae),ue=function(){};ue.prototype.on=function(t,n){return this._listeners=this._listeners||{},bt(t,n,this._listeners),this},ue.prototype.off=function(t,n){return zt(t,n,this._listeners),zt(t,n,this._oneTimeListeners),this},ue.prototype.once=function(t,n){return this._oneTimeListeners=this._oneTimeListeners||{},bt(t,n,this._oneTimeListeners),this},ue.prototype.fire=function(t,n){"string"==typeof t&&(t=new ae(t,n||{}));var u=t.type;if(this.listens(u)){t.target=this;for(var g=0,_=this._listeners&&this._listeners[u]?this._listeners[u].slice():[];g<_.length;g+=1)_[g].call(this,t);for(var w=0,S=this._oneTimeListeners&&this._oneTimeListeners[u]?this._oneTimeListeners[u].slice():[];w<S.length;w+=1){var A=S[w];zt(u,A,this._oneTimeListeners),A.call(this,t)}var z=this._eventedParent;z&&(j(t,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),z.fire(t))}else t instanceof me&&console.error(t.error);return this},ue.prototype.listens=function(t){return this._listeners&&this._listeners[t]&&this._listeners[t].length>0||this._oneTimeListeners&&this._oneTimeListeners[t]&&this._oneTimeListeners[t].length>0||this._eventedParent&&this._eventedParent.listens(t)},ue.prototype.setEventedParent=function(t,n){return this._eventedParent=t,this._eventedParentData=n,this};var Dt={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}},Ht=function(t,n,u,g){this.message=(t?t+": ":"")+u,g&&(this.identifier=g),null!=n&&n.__line__&&(this.line=n.__line__)};function nr(t){var n=t.value;return n?[new Ht(t.key,n,"constants have been deprecated as of v8")]:[]}function xr(t){for(var n=[],u=arguments.length-1;u-- >0;)n[u]=arguments[u+1];for(var g=0,_=n;g<_.length;g+=1){var w=_[g];for(var S in w)t[S]=w[S]}return t}function Me(t){return t instanceof Number||t instanceof String||t instanceof Boolean?t.valueOf():t}function qe(t){if(Array.isArray(t))return t.map(qe);if(t instanceof Object&&!(t instanceof Number||t instanceof String||t instanceof Boolean)){var n={};for(var u in t)n[u]=qe(t[u]);return n}return Me(t)}var pr=function(t){function n(u,g){t.call(this,g),this.message=g,this.key=u}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n}(Error),wr=function(t,n){void 0===n&&(n=[]),this.parent=t,this.bindings={};for(var u=0,g=n;u<g.length;u+=1){var _=g[u];this.bindings[_[0]]=_[1]}};wr.prototype.concat=function(t){return new wr(this,t)},wr.prototype.get=function(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error(t+" not found in scope.")},wr.prototype.has=function(t){return!!this.bindings[t]||!!this.parent&&this.parent.has(t)};var Ar={kind:"null"},Xe={kind:"number"},vr={kind:"string"},Ke={kind:"boolean"},bn={kind:"color"},$r={kind:"object"},Lr={kind:"value"},Mn={kind:"collator"},Nr={kind:"formatted"},Oi={kind:"resolvedImage"};function ai(t,n){return{kind:"array",itemType:t,N:n}}function kn(t){if("array"===t.kind){var n=kn(t.itemType);return"number"==typeof t.N?"array<"+n+", "+t.N+">":"value"===t.itemType.kind?"array":"array<"+n+">"}return t.kind}var Tn=[Ar,Xe,vr,Ke,bn,Nr,$r,ai(Lr),Oi];function co(t,n){if("error"===n.kind)return null;if("array"===t.kind){if("array"===n.kind&&(0===n.N&&"value"===n.itemType.kind||!co(t.itemType,n.itemType))&&("number"!=typeof t.N||t.N===n.N))return null}else{if(t.kind===n.kind)return null;if("value"===t.kind)for(var u=0,g=Tn;u<g.length;u+=1)if(!co(g[u],n))return null}return"Expected "+kn(t)+" but found "+kn(n)+" instead."}function ni(t,n){return n.some(function(u){return u.kind===t.kind})}function Xr(t,n){return n.some(function(u){return"null"===u?null===t:"array"===u?Array.isArray(t):"object"===u?t&&!Array.isArray(t)&&"object"==typeof t:u===typeof t})}var ca=lt(function(t,n){var u={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function g(A){return(A=Math.round(A))<0?0:A>255?255:A}function _(A){return g("%"===A[A.length-1]?parseFloat(A)/100*255:parseInt(A))}function w(A){return(z="%"===A[A.length-1]?parseFloat(A)/100:parseFloat(A))<0?0:z>1?1:z;var z}function S(A,z,q){return q<0?q+=1:q>1&&(q-=1),6*q<1?A+(z-A)*q*6:2*q<1?z:3*q<2?A+(z-A)*(2/3-q)*6:A}try{n.parseCSSColor=function(A){var z,q=A.replace(/ /g,"").toLowerCase();if(q in u)return u[q].slice();if("#"===q[0])return 4===q.length?(z=parseInt(q.substr(1),16))>=0&&z<=4095?[(3840&z)>>4|(3840&z)>>8,240&z|(240&z)>>4,15&z|(15&z)<<4,1]:null:7===q.length&&(z=parseInt(q.substr(1),16))>=0&&z<=16777215?[(16711680&z)>>16,(65280&z)>>8,255&z,1]:null;var V=q.indexOf("("),H=q.indexOf(")");if(-1!==V&&H+1===q.length){var st=q.substr(0,V),vt=q.substr(V+1,H-(V+1)).split(","),Rt=1;switch(st){case"rgba":if(4!==vt.length)return null;Rt=w(vt.pop());case"rgb":return 3!==vt.length?null:[_(vt[0]),_(vt[1]),_(vt[2]),Rt];case"hsla":if(4!==vt.length)return null;Rt=w(vt.pop());case"hsl":if(3!==vt.length)return null;var Vt=(parseFloat(vt[0])%360+360)%360/360,he=w(vt[1]),re=w(vt[2]),we=re<=.5?re*(he+1):re+he-re*he,Pe=2*re-we;return[g(255*S(Pe,we,Vt+1/3)),g(255*S(Pe,we,Vt)),g(255*S(Pe,we,Vt-1/3)),Rt];default:return null}}return null}}catch{}}).parseCSSColor,Hn=function(t,n,u,g){void 0===g&&(g=1),this.r=t,this.g=n,this.b=u,this.a=g};Hn.parse=function(t){if(t){if(t instanceof Hn)return t;if("string"==typeof t){var n=ca(t);if(n)return new Hn(n[0]/255*n[3],n[1]/255*n[3],n[2]/255*n[3],n[3])}}},Hn.prototype.toString=function(){var t=this.toArray(),n=t[1],u=t[2],g=t[3];return"rgba("+Math.round(t[0])+","+Math.round(n)+","+Math.round(u)+","+g+")"},Hn.prototype.toArray=function(){var t=this.a;return 0===t?[0,0,0,0]:[255*this.r/t,255*this.g/t,255*this.b/t,t]},Hn.black=new Hn(0,0,0,1),Hn.white=new Hn(1,1,1,1),Hn.transparent=new Hn(0,0,0,0),Hn.red=new Hn(1,0,0,1);var Fa=function(t,n,u){this.sensitivity=t?n?"variant":"case":n?"accent":"base",this.locale=u,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})};Fa.prototype.compare=function(t,n){return this.collator.compare(t,n)},Fa.prototype.resolvedLocale=function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale};var za=function(t,n,u,g,_){this.text=t,this.image=n,this.scale=u,this.fontStack=g,this.textColor=_},No=function(t){this.sections=t};No.fromString=function(t){return new No([new za(t,null,null,null,null)])},No.prototype.isEmpty=function(){return 0===this.sections.length||!this.sections.some(function(t){return 0!==t.text.length||t.image&&0!==t.image.name.length})},No.factory=function(t){return t instanceof No?t:No.fromString(t)},No.prototype.toString=function(){return 0===this.sections.length?"":this.sections.map(function(t){return t.text}).join("")},No.prototype.serialize=function(){for(var t=["format"],n=0,u=this.sections;n<u.length;n+=1){var g=u[n];if(g.image)t.push(["image",g.image.name]);else{t.push(g.text);var _={};g.fontStack&&(_["text-font"]=["literal",g.fontStack.split(",")]),g.scale&&(_["font-scale"]=g.scale),g.textColor&&(_["text-color"]=["rgba"].concat(g.textColor.toArray())),t.push(_)}}return t};var Wn=function(t){this.name=t.name,this.available=t.available};function Ws(t,n,u,g){return"number"==typeof t&&t>=0&&t<=255&&"number"==typeof n&&n>=0&&n<=255&&"number"==typeof u&&u>=0&&u<=255?void 0===g||"number"==typeof g&&g>=0&&g<=1?null:"Invalid rgba value ["+[t,n,u,g].join(", ")+"]: 'a' must be between 0 and 1.":"Invalid rgba value ["+("number"==typeof g?[t,n,u,g]:[t,n,u]).join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}function Aa(t){if(null===t||"string"==typeof t||"boolean"==typeof t||"number"==typeof t||t instanceof Hn||t instanceof Fa||t instanceof No||t instanceof Wn)return!0;if(Array.isArray(t)){for(var n=0,u=t;n<u.length;n+=1)if(!Aa(u[n]))return!1;return!0}if("object"==typeof t){for(var g in t)if(!Aa(t[g]))return!1;return!0}return!1}function aa(t){if(null===t)return Ar;if("string"==typeof t)return vr;if("boolean"==typeof t)return Ke;if("number"==typeof t)return Xe;if(t instanceof Hn)return bn;if(t instanceof Fa)return Mn;if(t instanceof No)return Nr;if(t instanceof Wn)return Oi;if(Array.isArray(t)){for(var n,u=t.length,g=0,_=t;g<_.length;g+=1){var w=aa(_[g]);if(n){if(n===w)continue;n=Lr;break}n=w}return ai(n||Lr,u)}return $r}function ss(t){var n=typeof t;return null===t?"":"string"===n||"number"===n||"boolean"===n?String(t):t instanceof Hn||t instanceof No||t instanceof Wn?t.toString():JSON.stringify(t)}Wn.prototype.toString=function(){return this.name},Wn.fromString=function(t){return t?new Wn({name:t,available:!1}):null},Wn.prototype.serialize=function(){return["image",this.name]};var Bn=function(t,n){this.type=t,this.value=n};Bn.parse=function(t,n){if(2!==t.length)return n.error("'literal' expression requires exactly one argument, but found "+(t.length-1)+" instead.");if(!Aa(t[1]))return n.error("invalid value");var u=t[1],g=aa(u),_=n.expectedType;return"array"!==g.kind||0!==g.N||!_||"array"!==_.kind||"number"==typeof _.N&&0!==_.N||(g=_),new Bn(g,u)},Bn.prototype.evaluate=function(){return this.value},Bn.prototype.eachChild=function(){},Bn.prototype.outputDefined=function(){return!0},Bn.prototype.serialize=function(){return"array"===this.type.kind||"object"===this.type.kind?["literal",this.value]:this.value instanceof Hn?["rgba"].concat(this.value.toArray()):this.value instanceof No?this.value.serialize():this.value};var go=function(t){this.name="ExpressionEvaluationError",this.message=t};go.prototype.toJSON=function(){return this.message};var Bo={string:vr,number:Xe,boolean:Ke,object:$r},La=function(t,n){this.type=t,this.args=n};La.parse=function(t,n){if(t.length<2)return n.error("Expected at least one argument.");var u,g=1,_=t[0];if("array"===_){var w,S;if(t.length>2){var A=t[1];if("string"!=typeof A||!(A in Bo)||"object"===A)return n.error('The item type argument of "array" must be one of string, number, boolean',1);w=Bo[A],g++}else w=Lr;if(t.length>3){if(null!==t[2]&&("number"!=typeof t[2]||t[2]<0||t[2]!==Math.floor(t[2])))return n.error('The length argument to "array" must be a positive integer literal',2);S=t[2],g++}u=ai(w,S)}else u=Bo[_];for(var z=[];g<t.length;g++){var q=n.parse(t[g],g,Lr);if(!q)return null;z.push(q)}return new La(u,z)},La.prototype.evaluate=function(t){for(var n=0;n<this.args.length;n++){var u=this.args[n].evaluate(t);if(!co(this.type,aa(u)))return u;if(n===this.args.length-1)throw new go("Expected value to be of type "+kn(this.type)+", but found "+kn(aa(u))+" instead.")}return null},La.prototype.eachChild=function(t){this.args.forEach(t)},La.prototype.outputDefined=function(){return this.args.every(function(t){return t.outputDefined()})},La.prototype.serialize=function(){var t=this.type,n=[t.kind];if("array"===t.kind){var u=t.itemType;if("string"===u.kind||"number"===u.kind||"boolean"===u.kind){n.push(u.kind);var g=t.N;("number"==typeof g||this.args.length>1)&&n.push(g)}}return n.concat(this.args.map(function(_){return _.serialize()}))};var wn=function(t){this.type=Nr,this.sections=t};wn.parse=function(t,n){if(t.length<2)return n.error("Expected at least one argument.");var u=t[1];if(!Array.isArray(u)&&"object"==typeof u)return n.error("First argument must be an image or text section.");for(var g=[],_=!1,w=1;w<=t.length-1;++w){var S=t[w];if(_&&"object"==typeof S&&!Array.isArray(S)){_=!1;var A=null;if(S["font-scale"]&&!(A=n.parse(S["font-scale"],1,Xe)))return null;var z=null;if(S["text-font"]&&!(z=n.parse(S["text-font"],1,ai(vr))))return null;var q=null;if(S["text-color"]&&!(q=n.parse(S["text-color"],1,bn)))return null;var V=g[g.length-1];V.scale=A,V.font=z,V.textColor=q}else{var H=n.parse(t[w],1,Lr);if(!H)return null;var st=H.type.kind;if("string"!==st&&"value"!==st&&"null"!==st&&"resolvedImage"!==st)return n.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");_=!0,g.push({content:H,scale:null,font:null,textColor:null})}}return new wn(g)},wn.prototype.evaluate=function(t){return new No(this.sections.map(function(n){var u=n.content.evaluate(t);return aa(u)===Oi?new za("",u,null,null,null):new za(ss(u),null,n.scale?n.scale.evaluate(t):null,n.font?n.font.evaluate(t).join(","):null,n.textColor?n.textColor.evaluate(t):null)}))},wn.prototype.eachChild=function(t){for(var n=0,u=this.sections;n<u.length;n+=1){var g=u[n];t(g.content),g.scale&&t(g.scale),g.font&&t(g.font),g.textColor&&t(g.textColor)}},wn.prototype.outputDefined=function(){return!1},wn.prototype.serialize=function(){for(var t=["format"],n=0,u=this.sections;n<u.length;n+=1){var g=u[n];t.push(g.content.serialize());var _={};g.scale&&(_["font-scale"]=g.scale.serialize()),g.font&&(_["text-font"]=g.font.serialize()),g.textColor&&(_["text-color"]=g.textColor.serialize()),t.push(_)}return t};var Tu=function(t){this.type=Oi,this.input=t};Tu.parse=function(t,n){if(2!==t.length)return n.error("Expected two arguments.");var u=n.parse(t[1],1,vr);return u?new Tu(u):n.error("No image name provided.")},Tu.prototype.evaluate=function(t){var n=this.input.evaluate(t),u=Wn.fromString(n);return u&&t.availableImages&&(u.available=t.availableImages.indexOf(n)>-1),u},Tu.prototype.eachChild=function(t){t(this.input)},Tu.prototype.outputDefined=function(){return!1},Tu.prototype.serialize=function(){return["image",this.input.serialize()]};var El={"to-boolean":Ke,"to-color":bn,"to-number":Xe,"to-string":vr},L=function(t,n){this.type=t,this.args=n};L.parse=function(t,n){if(t.length<2)return n.error("Expected at least one argument.");var u=t[0];if(("to-boolean"===u||"to-string"===u)&&2!==t.length)return n.error("Expected one argument.");for(var g=El[u],_=[],w=1;w<t.length;w++){var S=n.parse(t[w],w,Lr);if(!S)return null;_.push(S)}return new L(g,_)},L.prototype.evaluate=function(t){if("boolean"===this.type.kind)return Boolean(this.args[0].evaluate(t));if("color"===this.type.kind){for(var n,u,g=0,_=this.args;g<_.length;g+=1){if(u=null,(n=_[g].evaluate(t))instanceof Hn)return n;if("string"==typeof n){var w=t.parseColor(n);if(w)return w}else if(Array.isArray(n)&&!(u=n.length<3||n.length>4?"Invalid rbga value "+JSON.stringify(n)+": expected an array containing either three or four numeric values.":Ws(n[0],n[1],n[2],n[3])))return new Hn(n[0]/255,n[1]/255,n[2]/255,n[3])}throw new go(u||"Could not parse color from value '"+("string"==typeof n?n:String(JSON.stringify(n)))+"'")}if("number"===this.type.kind){for(var S=null,A=0,z=this.args;A<z.length;A+=1){if(null===(S=z[A].evaluate(t)))return 0;var q=Number(S);if(!isNaN(q))return q}throw new go("Could not convert "+JSON.stringify(S)+" to number.")}return"formatted"===this.type.kind?No.fromString(ss(this.args[0].evaluate(t))):"resolvedImage"===this.type.kind?Wn.fromString(ss(this.args[0].evaluate(t))):ss(this.args[0].evaluate(t))},L.prototype.eachChild=function(t){this.args.forEach(t)},L.prototype.outputDefined=function(){return this.args.every(function(t){return t.outputDefined()})},L.prototype.serialize=function(){if("formatted"===this.type.kind)return new wn([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if("resolvedImage"===this.type.kind)return new Tu(this.args[0]).serialize();var t=["to-"+this.type.kind];return this.eachChild(function(n){t.push(n.serialize())}),t};var U=["Unknown","Point","LineString","Polygon"],ct=function(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null};ct.prototype.id=function(){return this.feature&&"id"in this.feature?this.feature.id:null},ct.prototype.geometryType=function(){return this.feature?"number"==typeof this.feature.type?U[this.feature.type]:this.feature.type:null},ct.prototype.geometry=function(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null},ct.prototype.canonicalID=function(){return this.canonical},ct.prototype.properties=function(){return this.feature&&this.feature.properties||{}},ct.prototype.parseColor=function(t){var n=this._parseColorCache[t];return n||(n=this._parseColorCache[t]=Hn.parse(t)),n};var oe=function(t,n,u,g){this.name=t,this.type=n,this._evaluate=u,this.args=g};oe.prototype.evaluate=function(t){return this._evaluate(t,this.args)},oe.prototype.eachChild=function(t){this.args.forEach(t)},oe.prototype.outputDefined=function(){return!1},oe.prototype.serialize=function(){return[this.name].concat(this.args.map(function(t){return t.serialize()}))},oe.parse=function(t,n){var u,g=t[0],_=oe.definitions[g];if(!_)return n.error('Unknown expression "'+g+'". If you wanted a literal array, use ["literal", [...]].',0);for(var w=Array.isArray(_)?_[0]:_.type,S=Array.isArray(_)?[[_[1],_[2]]]:_.overloads,A=S.filter(function(ln){var Fr=ln[0];return!Array.isArray(Fr)||Fr.length===t.length-1}),z=null,q=0,V=A;q<V.length;q+=1){var H=V[q],st=H[0],vt=H[1];z=new Bi(n.registry,n.path,null,n.scope);for(var Rt=[],Vt=!1,he=1;he<t.length;he++){var re=t[he],we=Array.isArray(st)?st[he-1]:st.type,Pe=z.parse(re,1+Rt.length,we);if(!Pe){Vt=!0;break}Rt.push(Pe)}if(!Vt)if(Array.isArray(st)&&st.length!==Rt.length)z.error("Expected "+st.length+" arguments, but found "+Rt.length+" instead.");else{for(var Re=0;Re<Rt.length;Re++){var ze=Array.isArray(st)?st[Re]:st.type,rr=Rt[Re];z.concat(Re+1).checkSubtype(ze,rr.type)}if(0===z.errors.length)return new oe(g,w,vt,Rt)}}if(1===A.length)(u=n.errors).push.apply(u,z.errors);else{for(var yr=(A.length?A:S).map(function(ln){var Fr;return Fr=ln[0],Array.isArray(Fr)?"("+Fr.map(kn).join(", ")+")":"("+kn(Fr.type)+"...)"}).join(" | "),Mr=[],Wr=1;Wr<t.length;Wr++){var Tr=n.parse(t[Wr],1+Mr.length);if(!Tr)return null;Mr.push(kn(Tr.type))}n.error("Expected arguments of type "+yr+", but found ("+Mr.join(", ")+") instead.")}return null},oe.register=function(t,n){for(var u in oe.definitions=n,n)t[u]=oe};var Se=function(t,n,u){this.type=Mn,this.locale=u,this.caseSensitive=t,this.diacriticSensitive=n};function Bt(t,n){t[0]=Math.min(t[0],n[0]),t[1]=Math.min(t[1],n[1]),t[2]=Math.max(t[2],n[0]),t[3]=Math.max(t[3],n[1])}function Te(t,n){return!(t[0]<=n[0]||t[2]>=n[2]||t[1]<=n[1]||t[3]>=n[3])}function ur(t,n){var u=(180+t[0])/360,g=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t[1]*Math.PI/360)))/360,_=Math.pow(2,n.z);return[Math.round(u*_*8192),Math.round(g*_*8192)]}function ar(t,n,u){return n[1]>t[1]!=u[1]>t[1]&&t[0]<(u[0]-n[0])*(t[1]-n[1])/(u[1]-n[1])+n[0]}function kr(t,n){for(var u,g,_,w,S,A,z,q=!1,V=0,H=n.length;V<H;V++)for(var st=n[V],vt=0,Rt=st.length;vt<Rt-1;vt++){if((w=(u=t)[0]-(g=st[vt])[0])*(z=u[1]-(_=st[vt+1])[1])-(A=u[0]-_[0])*(S=u[1]-g[1])==0&&w*A<=0&&S*z<=0)return!1;ar(t,st[vt],st[vt+1])&&(q=!q)}return q}function Ae(t,n){for(var u=0;u<n.length;u++)if(kr(t,n[u]))return!0;return!1}function or(t,n,u,g){var _=g[0]-u[0],w=g[1]-u[1],S=(t[0]-u[0])*w-_*(t[1]-u[1]),A=(n[0]-u[0])*w-_*(n[1]-u[1]);return S>0&&A<0||S<0&&A>0}function lr(t,n,u){for(var g=0,_=u;g<_.length;g+=1)for(var w=_[g],S=0;S<w.length-1;++S)if((H=[(V=w[S+1])[0]-(q=w[S])[0],V[1]-q[1]])[0]*(st=[(z=n)[0]-(A=t)[0],z[1]-A[1]])[1]-H[1]*st[0]!=0&&or(A,z,q,V)&&or(q,V,A,z))return!0;var A,z,q,V,H,st;return!1}function Rr(t,n){for(var u=0;u<t.length;++u)if(!kr(t[u],n))return!1;for(var g=0;g<t.length-1;++g)if(lr(t[g],t[g+1],n))return!1;return!0}function Cn(t,n){for(var u=0;u<n.length;u++)if(Rr(t,n[u]))return!0;return!1}function Jo(t,n,u){for(var g=[],_=0;_<t.length;_++){for(var w=[],S=0;S<t[_].length;S++){var A=ur(t[_][S],u);Bt(n,A),w.push(A)}g.push(w)}return g}function $e(t,n,u){for(var g=[],_=0;_<t.length;_++){var w=Jo(t[_],n,u);g.push(w)}return g}function Vr(t,n,u,g){if(t[0]<u[0]||t[0]>u[2]){var _=.5*g,w=t[0]-u[0]>_?-g:u[0]-t[0]>_?g:0;0===w&&(w=t[0]-u[2]>_?-g:u[2]-t[0]>_?g:0),t[0]+=w}Bt(n,t)}function Kn(t,n,u,g){for(var _=8192*Math.pow(2,g.z),w=[8192*g.x,8192*g.y],S=[],A=0,z=t;A<z.length;A+=1)for(var q=0,V=z[A];q<V.length;q+=1){var H=V[q],st=[H.x+w[0],H.y+w[1]];Vr(st,n,u,_),S.push(st)}return S}function rn(t,n,u,g){for(var _,w=8192*Math.pow(2,g.z),S=[8192*g.x,8192*g.y],A=[],z=0,q=t;z<q.length;z+=1){for(var V=[],H=0,st=q[z];H<st.length;H+=1){var vt=st[H],Rt=[vt.x+S[0],vt.y+S[1]];Bt(n,Rt),V.push(Rt)}A.push(V)}if(n[2]-n[0]<=w/2){(_=n)[0]=_[1]=1/0,_[2]=_[3]=-1/0;for(var Vt=0,he=A;Vt<he.length;Vt+=1)for(var re=0,we=he[Vt];re<we.length;re+=1)Vr(we[re],n,u,w)}return A}Se.parse=function(t,n){if(2!==t.length)return n.error("Expected one argument.");var u=t[1];if("object"!=typeof u||Array.isArray(u))return n.error("Collator options argument must be an object.");var g=n.parse(void 0!==u["case-sensitive"]&&u["case-sensitive"],1,Ke);if(!g)return null;var _=n.parse(void 0!==u["diacritic-sensitive"]&&u["diacritic-sensitive"],1,Ke);if(!_)return null;var w=null;return u.locale&&!(w=n.parse(u.locale,1,vr))?null:new Se(g,_,w)},Se.prototype.evaluate=function(t){return new Fa(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)},Se.prototype.eachChild=function(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)},Se.prototype.outputDefined=function(){return!1},Se.prototype.serialize=function(){var t={};return t["case-sensitive"]=this.caseSensitive.serialize(),t["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(t.locale=this.locale.serialize()),["collator",t]};var ci=function(t,n){this.type=Ke,this.geojson=t,this.geometries=n};function Cr(t){if(t instanceof oe&&("get"===t.name&&1===t.args.length||"feature-state"===t.name||"has"===t.name&&1===t.args.length||"properties"===t.name||"geometry-type"===t.name||"id"===t.name||/^filter-/.test(t.name))||t instanceof ci)return!1;var n=!0;return t.eachChild(function(u){n&&!Cr(u)&&(n=!1)}),n}function us(t){if(t instanceof oe&&"feature-state"===t.name)return!1;var n=!0;return t.eachChild(function(u){n&&!us(u)&&(n=!1)}),n}function ls(t,n){if(t instanceof oe&&n.indexOf(t.name)>=0)return!1;var u=!0;return t.eachChild(function(g){u&&!ls(g,n)&&(u=!1)}),u}ci.parse=function(t,n){if(2!==t.length)return n.error("'within' expression requires exactly one argument, but found "+(t.length-1)+" instead.");if(Aa(t[1])){var u=t[1];if("FeatureCollection"===u.type)for(var g=0;g<u.features.length;++g){var _=u.features[g].geometry.type;if("Polygon"===_||"MultiPolygon"===_)return new ci(u,u.features[g].geometry)}else if("Feature"===u.type){var w=u.geometry.type;if("Polygon"===w||"MultiPolygon"===w)return new ci(u,u.geometry)}else if("Polygon"===u.type||"MultiPolygon"===u.type)return new ci(u,u)}return n.error("'within' expression requires valid geojson object that contains polygon geometry type.")},ci.prototype.evaluate=function(t){if(null!=t.geometry()&&null!=t.canonicalID()){if("Point"===t.geometryType())return function(n,u){var g=[1/0,1/0,-1/0,-1/0],_=[1/0,1/0,-1/0,-1/0],w=n.canonicalID();if("Polygon"===u.type){var S=Jo(u.coordinates,_,w),A=Kn(n.geometry(),g,_,w);if(!Te(g,_))return!1;for(var z=0,q=A;z<q.length;z+=1)if(!kr(q[z],S))return!1}if("MultiPolygon"===u.type){var V=$e(u.coordinates,_,w),H=Kn(n.geometry(),g,_,w);if(!Te(g,_))return!1;for(var st=0,vt=H;st<vt.length;st+=1)if(!Ae(vt[st],V))return!1}return!0}(t,this.geometries);if("LineString"===t.geometryType())return function(n,u){var g=[1/0,1/0,-1/0,-1/0],_=[1/0,1/0,-1/0,-1/0],w=n.canonicalID();if("Polygon"===u.type){var S=Jo(u.coordinates,_,w),A=rn(n.geometry(),g,_,w);if(!Te(g,_))return!1;for(var z=0,q=A;z<q.length;z+=1)if(!Rr(q[z],S))return!1}if("MultiPolygon"===u.type){var V=$e(u.coordinates,_,w),H=rn(n.geometry(),g,_,w);if(!Te(g,_))return!1;for(var st=0,vt=H;st<vt.length;st+=1)if(!Cn(vt[st],V))return!1}return!0}(t,this.geometries)}return!1},ci.prototype.eachChild=function(){},ci.prototype.outputDefined=function(){return!0},ci.prototype.serialize=function(){return["within",this.geojson]};var qr=function(t,n){this.type=n.type,this.name=t,this.boundExpression=n};qr.parse=function(t,n){if(2!==t.length||"string"!=typeof t[1])return n.error("'var' expression requires exactly one string literal argument.");var u=t[1];return n.scope.has(u)?new qr(u,n.scope.get(u)):n.error('Unknown variable "'+u+'". Make sure "'+u+'" has been bound in an enclosing "let" expression before using it.',1)},qr.prototype.evaluate=function(t){return this.boundExpression.evaluate(t)},qr.prototype.eachChild=function(){},qr.prototype.outputDefined=function(){return!1},qr.prototype.serialize=function(){return["var",this.name]};var Bi=function(t,n,u,g,_){void 0===n&&(n=[]),void 0===g&&(g=new wr),void 0===_&&(_=[]),this.registry=t,this.path=n,this.key=n.map(function(w){return"["+w+"]"}).join(""),this.scope=g,this.errors=_,this.expectedType=u};function xo(t,n){for(var u,g=t.length-1,_=0,w=g,S=0;_<=w;)if((u=t[S=Math.floor((_+w)/2)])<=n){if(S===g||n<t[S+1])return S;_=S+1}else{if(!(u>n))throw new go("Input is not a number.");w=S-1}return 0}Bi.prototype.parse=function(t,n,u,g,_){return void 0===_&&(_={}),n?this.concat(n,u,g)._parse(t,_):this._parse(t,_)},Bi.prototype._parse=function(t,n){function u(q,V,H){return"assert"===H?new La(V,[q]):"coerce"===H?new L(V,[q]):q}if(null!==t&&"string"!=typeof t&&"boolean"!=typeof t&&"number"!=typeof t||(t=["literal",t]),Array.isArray(t)){if(0===t.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var g=t[0];if("string"!=typeof g)return this.error("Expression name must be a string, but found "+typeof g+' instead. If you wanted a literal array, use ["literal", [...]].',0),null;var _=this.registry[g];if(_){var w=_.parse(t,this);if(!w)return null;if(this.expectedType){var S=this.expectedType,A=w.type;if("string"!==S.kind&&"number"!==S.kind&&"boolean"!==S.kind&&"object"!==S.kind&&"array"!==S.kind||"value"!==A.kind)if("color"!==S.kind&&"formatted"!==S.kind&&"resolvedImage"!==S.kind||"value"!==A.kind&&"string"!==A.kind){if(this.checkSubtype(S,A))return null}else w=u(w,S,n.typeAnnotation||"coerce");else w=u(w,S,n.typeAnnotation||"assert")}if(!(w instanceof Bn)&&"resolvedImage"!==w.type.kind&&function q(V){if(V instanceof qr)return q(V.boundExpression);if(V instanceof oe&&"error"===V.name||V instanceof Se||V instanceof ci)return!1;var H=V instanceof L||V instanceof La,st=!0;return V.eachChild(function(vt){st=H?st&&q(vt):st&&vt instanceof Bn}),!!st&&Cr(V)&&ls(V,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}(w)){var z=new ct;try{w=new Bn(w.type,w.evaluate(z))}catch(q){return this.error(q.message),null}}return w}return this.error('Unknown expression "'+g+'". If you wanted a literal array, use ["literal", [...]].',0)}return this.error(void 0===t?"'undefined' value invalid. Use null instead.":"object"==typeof t?'Bare objects invalid. Use ["literal", {...}] instead.':"Expected an array, but found "+typeof t+" instead.")},Bi.prototype.concat=function(t,n,u){var g="number"==typeof t?this.path.concat(t):this.path,_=u?this.scope.concat(u):this.scope;return new Bi(this.registry,g,n||null,_,this.errors)},Bi.prototype.error=function(t){for(var n=[],u=arguments.length-1;u-- >0;)n[u]=arguments[u+1];var g=""+this.key+n.map(function(_){return"["+_+"]"}).join("");this.errors.push(new pr(g,t))},Bi.prototype.checkSubtype=function(t,n){var u=co(t,n);return u&&this.error(u),u};var Uo=function(t,n,u){this.type=t,this.input=n,this.labels=[],this.outputs=[];for(var g=0,_=u;g<_.length;g+=1){var w=_[g],S=w[1];this.labels.push(w[0]),this.outputs.push(S)}};function ho(t,n,u){return t*(1-u)+n*u}Uo.parse=function(t,n){if(t.length-1<4)return n.error("Expected at least 4 arguments, but found only "+(t.length-1)+".");if((t.length-1)%2!=0)return n.error("Expected an even number of arguments.");var u=n.parse(t[1],1,Xe);if(!u)return null;var g=[],_=null;n.expectedType&&"value"!==n.expectedType.kind&&(_=n.expectedType);for(var w=1;w<t.length;w+=2){var S=1===w?-1/0:t[w],A=t[w+1],z=w,q=w+1;if("number"!=typeof S)return n.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',z);if(g.length&&g[g.length-1][0]>=S)return n.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',z);var V=n.parse(A,q,_);if(!V)return null;_=_||V.type,g.push([S,V])}return new Uo(_,u,g)},Uo.prototype.evaluate=function(t){var n=this.labels,u=this.outputs;if(1===n.length)return u[0].evaluate(t);var g=this.input.evaluate(t);if(g<=n[0])return u[0].evaluate(t);var _=n.length;return g>=n[_-1]?u[_-1].evaluate(t):u[xo(n,g)].evaluate(t)},Uo.prototype.eachChild=function(t){t(this.input);for(var n=0,u=this.outputs;n<u.length;n+=1)t(u[n])},Uo.prototype.outputDefined=function(){return this.outputs.every(function(t){return t.outputDefined()})},Uo.prototype.serialize=function(){for(var t=["step",this.input.serialize()],n=0;n<this.labels.length;n++)n>0&&t.push(this.labels[n]),t.push(this.outputs[n].serialize());return t};var sa=Object.freeze({__proto__:null,number:ho,color:function(t,n,u){return new Hn(ho(t.r,n.r,u),ho(t.g,n.g,u),ho(t.b,n.b,u),ho(t.a,n.a,u))},array:function(t,n,u){return t.map(function(g,_){return ho(g,n[_],u)})}}),Ks=6/29*3*(6/29),Ho=Math.PI/180,Ui=180/Math.PI;function cs(t){return t>.008856451679035631?Math.pow(t,1/3):t/Ks+4/29}function bo(t){return t>6/29?t*t*t:Ks*(t-4/29)}function qo(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function Fu(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function Sl(t){var n=Fu(t.r),u=Fu(t.g),g=Fu(t.b),_=cs((.4124564*n+.3575761*u+.1804375*g)/.95047),w=cs((.2126729*n+.7151522*u+.072175*g)/1);return{l:116*w-16,a:500*(_-w),b:200*(w-cs((.0193339*n+.119192*u+.9503041*g)/1.08883)),alpha:t.a}}function zs(t){var n=(t.l+16)/116,u=isNaN(t.a)?n:n+t.a/500,g=isNaN(t.b)?n:n-t.b/200;return n=1*bo(n),u=.95047*bo(u),g=1.08883*bo(g),new Hn(qo(3.2404542*u-1.5371385*n-.4985314*g),qo(-.969266*u+1.8760108*n+.041556*g),qo(.0556434*u-.2040259*n+1.0572252*g),t.alpha)}function Ol(t,n,u){var g=n-t;return t+u*(g>180||g<-180?g-360*Math.round(g/360):g)}var el={forward:Sl,reverse:zs,interpolate:function(t,n,u){return{l:ho(t.l,n.l,u),a:ho(t.a,n.a,u),b:ho(t.b,n.b,u),alpha:ho(t.alpha,n.alpha,u)}}},ha={forward:function(t){var n=Sl(t),u=n.l,g=n.a,_=n.b,w=Math.atan2(_,g)*Ui;return{h:w<0?w+360:w,c:Math.sqrt(g*g+_*_),l:u,alpha:t.a}},reverse:function(t){var n=t.h*Ho,u=t.c;return zs({l:t.l,a:Math.cos(n)*u,b:Math.sin(n)*u,alpha:t.alpha})},interpolate:function(t,n,u){return{h:Ol(t.h,n.h,u),c:ho(t.c,n.c,u),l:ho(t.l,n.l,u),alpha:ho(t.alpha,n.alpha,u)}}},hu=Object.freeze({__proto__:null,lab:el,hcl:ha}),gi=function(t,n,u,g,_){this.type=t,this.operator=n,this.interpolation=u,this.input=g,this.labels=[],this.outputs=[];for(var w=0,S=_;w<S.length;w+=1){var A=S[w],z=A[1];this.labels.push(A[0]),this.outputs.push(z)}};function pu(t,n,u,g){var _=g-u,w=t-u;return 0===_?0:1===n?w/_:(Math.pow(n,w)-1)/(Math.pow(n,_)-1)}gi.interpolationFactor=function(t,n,u,g){var _=0;if("exponential"===t.name)_=pu(n,t.base,u,g);else if("linear"===t.name)_=pu(n,1,u,g);else if("cubic-bezier"===t.name){var w=t.controlPoints;_=new ht(w[0],w[1],w[2],w[3]).solve(pu(n,1,u,g))}return _},gi.parse=function(t,n){var u=t[0],g=t[1],_=t[2],w=t.slice(3);if(!Array.isArray(g)||0===g.length)return n.error("Expected an interpolation type expression.",1);if("linear"===g[0])g={name:"linear"};else if("exponential"===g[0]){var S=g[1];if("number"!=typeof S)return n.error("Exponential interpolation requires a numeric base.",1,1);g={name:"exponential",base:S}}else{if("cubic-bezier"!==g[0])return n.error("Unknown interpolation type "+String(g[0]),1,0);var A=g.slice(1);if(4!==A.length||A.some(function(he){return"number"!=typeof he||he<0||he>1}))return n.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);g={name:"cubic-bezier",controlPoints:A}}if(t.length-1<4)return n.error("Expected at least 4 arguments, but found only "+(t.length-1)+".");if((t.length-1)%2!=0)return n.error("Expected an even number of arguments.");if(!(_=n.parse(_,2,Xe)))return null;var z=[],q=null;"interpolate-hcl"===u||"interpolate-lab"===u?q=bn:n.expectedType&&"value"!==n.expectedType.kind&&(q=n.expectedType);for(var V=0;V<w.length;V+=2){var H=w[V],st=w[V+1],vt=V+3,Rt=V+4;if("number"!=typeof H)return n.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',vt);if(z.length&&z[z.length-1][0]>=H)return n.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',vt);var Vt=n.parse(st,Rt,q);if(!Vt)return null;q=q||Vt.type,z.push([H,Vt])}return"number"===q.kind||"color"===q.kind||"array"===q.kind&&"number"===q.itemType.kind&&"number"==typeof q.N?new gi(q,u,g,_,z):n.error("Type "+kn(q)+" is not interpolatable.")},gi.prototype.evaluate=function(t){var n=this.labels,u=this.outputs;if(1===n.length)return u[0].evaluate(t);var g=this.input.evaluate(t);if(g<=n[0])return u[0].evaluate(t);var _=n.length;if(g>=n[_-1])return u[_-1].evaluate(t);var w=xo(n,g),S=gi.interpolationFactor(this.interpolation,g,n[w],n[w+1]),A=u[w].evaluate(t),z=u[w+1].evaluate(t);return"interpolate"===this.operator?sa[this.type.kind.toLowerCase()](A,z,S):"interpolate-hcl"===this.operator?ha.reverse(ha.interpolate(ha.forward(A),ha.forward(z),S)):el.reverse(el.interpolate(el.forward(A),el.forward(z),S))},gi.prototype.eachChild=function(t){t(this.input);for(var n=0,u=this.outputs;n<u.length;n+=1)t(u[n])},gi.prototype.outputDefined=function(){return this.outputs.every(function(t){return t.outputDefined()})},gi.prototype.serialize=function(){var t;t="linear"===this.interpolation.name?["linear"]:"exponential"===this.interpolation.name?1===this.interpolation.base?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);for(var n=[this.operator,t,this.input.serialize()],u=0;u<this.labels.length;u++)n.push(this.labels[u],this.outputs[u].serialize());return n};var Da=function(t,n){this.type=t,this.args=n};Da.parse=function(t,n){if(t.length<2)return n.error("Expectected at least one argument.");var u=null,g=n.expectedType;g&&"value"!==g.kind&&(u=g);for(var _=[],w=0,S=t.slice(1);w<S.length;w+=1){var A=n.parse(S[w],1+_.length,u,void 0,{typeAnnotation:"omit"});if(!A)return null;u=u||A.type,_.push(A)}var z=g&&_.some(function(q){return co(g,q.type)});return new Da(z?Lr:u,_)},Da.prototype.evaluate=function(t){for(var n,u=null,g=0,_=0,w=this.args;_<w.length&&(g++,(u=w[_].evaluate(t))&&u instanceof Wn&&!u.available&&(n||(n=u.name),u=null,g===this.args.length&&(u=n)),null===u);_+=1);return u},Da.prototype.eachChild=function(t){this.args.forEach(t)},Da.prototype.outputDefined=function(){return this.args.every(function(t){return t.outputDefined()})},Da.prototype.serialize=function(){var t=["coalesce"];return this.eachChild(function(n){t.push(n.serialize())}),t};var Bs=function(t,n){this.type=n.type,this.bindings=[].concat(t),this.result=n};Bs.prototype.evaluate=function(t){return this.result.evaluate(t)},Bs.prototype.eachChild=function(t){for(var n=0,u=this.bindings;n<u.length;n+=1)t(u[n][1]);t(this.result)},Bs.parse=function(t,n){if(t.length<4)return n.error("Expected at least 3 arguments, but found "+(t.length-1)+" instead.");for(var u=[],g=1;g<t.length-1;g+=2){var _=t[g];if("string"!=typeof _)return n.error("Expected string, but found "+typeof _+" instead.",g);if(/[^a-zA-Z0-9_]/.test(_))return n.error("Variable names must contain only alphanumeric characters or '_'.",g);var w=n.parse(t[g+1],g+1);if(!w)return null;u.push([_,w])}var S=n.parse(t[t.length-1],t.length-1,n.expectedType,u);return S?new Bs(u,S):null},Bs.prototype.outputDefined=function(){return this.result.outputDefined()},Bs.prototype.serialize=function(){for(var t=["let"],n=0,u=this.bindings;n<u.length;n+=1){var g=u[n];t.push(g[0],g[1].serialize())}return t.push(this.result.serialize()),t};var ki=function(t,n,u){this.type=t,this.index=n,this.input=u};ki.parse=function(t,n){if(3!==t.length)return n.error("Expected 2 arguments, but found "+(t.length-1)+" instead.");var u=n.parse(t[1],1,Xe),g=n.parse(t[2],2,ai(n.expectedType||Lr));return u&&g?new ki(g.type.itemType,u,g):null},ki.prototype.evaluate=function(t){var n=this.index.evaluate(t),u=this.input.evaluate(t);if(n<0)throw new go("Array index out of bounds: "+n+" < 0.");if(n>=u.length)throw new go("Array index out of bounds: "+n+" > "+(u.length-1)+".");if(n!==Math.floor(n))throw new go("Array index must be an integer, but found "+n+" instead.");return u[n]},ki.prototype.eachChild=function(t){t(this.index),t(this.input)},ki.prototype.outputDefined=function(){return!1},ki.prototype.serialize=function(){return["at",this.index.serialize(),this.input.serialize()]};var Hr=function(t,n){this.type=Ke,this.needle=t,this.haystack=n};Hr.parse=function(t,n){if(3!==t.length)return n.error("Expected 2 arguments, but found "+(t.length-1)+" instead.");var u=n.parse(t[1],1,Lr),g=n.parse(t[2],2,Lr);return u&&g?ni(u.type,[Ke,vr,Xe,Ar,Lr])?new Hr(u,g):n.error("Expected first argument to be of type boolean, string, number or null, but found "+kn(u.type)+" instead"):null},Hr.prototype.evaluate=function(t){var n=this.needle.evaluate(t),u=this.haystack.evaluate(t);if(!u)return!1;if(!Xr(n,["boolean","string","number","null"]))throw new go("Expected first argument to be of type boolean, string, number or null, but found "+kn(aa(n))+" instead.");if(!Xr(u,["string","array"]))throw new go("Expected second argument to be of type array or string, but found "+kn(aa(u))+" instead.");return u.indexOf(n)>=0},Hr.prototype.eachChild=function(t){t(this.needle),t(this.haystack)},Hr.prototype.outputDefined=function(){return!0},Hr.prototype.serialize=function(){return["in",this.needle.serialize(),this.haystack.serialize()]};var bu=function(t,n,u){this.type=Xe,this.needle=t,this.haystack=n,this.fromIndex=u};bu.parse=function(t,n){if(t.length<=2||t.length>=5)return n.error("Expected 3 or 4 arguments, but found "+(t.length-1)+" instead.");var u=n.parse(t[1],1,Lr),g=n.parse(t[2],2,Lr);if(!u||!g)return null;if(!ni(u.type,[Ke,vr,Xe,Ar,Lr]))return n.error("Expected first argument to be of type boolean, string, number or null, but found "+kn(u.type)+" instead");if(4===t.length){var _=n.parse(t[3],3,Xe);return _?new bu(u,g,_):null}return new bu(u,g)},bu.prototype.evaluate=function(t){var n=this.needle.evaluate(t),u=this.haystack.evaluate(t);if(!Xr(n,["boolean","string","number","null"]))throw new go("Expected first argument to be of type boolean, string, number or null, but found "+kn(aa(n))+" instead.");if(!Xr(u,["string","array"]))throw new go("Expected second argument to be of type array or string, but found "+kn(aa(u))+" instead.");if(this.fromIndex){var g=this.fromIndex.evaluate(t);return u.indexOf(n,g)}return u.indexOf(n)},bu.prototype.eachChild=function(t){t(this.needle),t(this.haystack),this.fromIndex&&t(this.fromIndex)},bu.prototype.outputDefined=function(){return!1},bu.prototype.serialize=function(){if(null!=this.fromIndex&&void 0!==this.fromIndex){var t=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),t]}return["index-of",this.needle.serialize(),this.haystack.serialize()]};var fu=function(t,n,u,g,_,w){this.inputType=t,this.type=n,this.input=u,this.cases=g,this.outputs=_,this.otherwise=w};fu.parse=function(t,n){if(t.length<5)return n.error("Expected at least 4 arguments, but found only "+(t.length-1)+".");if(t.length%2!=1)return n.error("Expected an even number of arguments.");var u,g;n.expectedType&&"value"!==n.expectedType.kind&&(g=n.expectedType);for(var _={},w=[],S=2;S<t.length-1;S+=2){var A=t[S],z=t[S+1];Array.isArray(A)||(A=[A]);var q=n.concat(S);if(0===A.length)return q.error("Expected at least one branch label.");for(var V=0,H=A;V<H.length;V+=1){var st=H[V];if("number"!=typeof st&&"string"!=typeof st)return q.error("Branch labels must be numbers or strings.");if("number"==typeof st&&Math.abs(st)>Number.MAX_SAFE_INTEGER)return q.error("Branch labels must be integers no larger than "+Number.MAX_SAFE_INTEGER+".");if("number"==typeof st&&Math.floor(st)!==st)return q.error("Numeric branch labels must be integer values.");if(u){if(q.checkSubtype(u,aa(st)))return null}else u=aa(st);if(void 0!==_[String(st)])return q.error("Branch labels must be unique.");_[String(st)]=w.length}var vt=n.parse(z,S,g);if(!vt)return null;g=g||vt.type,w.push(vt)}var Rt=n.parse(t[1],1,Lr);if(!Rt)return null;var Vt=n.parse(t[t.length-1],t.length-1,g);return Vt?"value"!==Rt.type.kind&&n.concat(1).checkSubtype(u,Rt.type)?null:new fu(u,g,Rt,_,w,Vt):null},fu.prototype.evaluate=function(t){var n=this.input.evaluate(t);return(aa(n)===this.inputType&&this.outputs[this.cases[n]]||this.otherwise).evaluate(t)},fu.prototype.eachChild=function(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)},fu.prototype.outputDefined=function(){return this.outputs.every(function(t){return t.outputDefined()})&&this.otherwise.outputDefined()},fu.prototype.serialize=function(){for(var t=this,n=["match",this.input.serialize()],u=[],g={},_=0,w=Object.keys(this.cases).sort();_<w.length;_+=1){var S=w[_];void 0===(H=g[this.cases[S]])?(g[this.cases[S]]=u.length,u.push([this.cases[S],[S]])):u[H][1].push(S)}for(var A=function(vt){return"number"===t.inputType.kind?Number(vt):vt},z=0,q=u;z<q.length;z+=1){var V=q[z],H=V[0],st=V[1];n.push(1===st.length?A(st[0]):st.map(A)),n.push(this.outputs[outputIndex$1].serialize())}return n.push(this.otherwise.serialize()),n};var pa=function(t,n,u){this.type=t,this.branches=n,this.otherwise=u};pa.parse=function(t,n){if(t.length<4)return n.error("Expected at least 3 arguments, but found only "+(t.length-1)+".");if(t.length%2!=0)return n.error("Expected an odd number of arguments.");var u;n.expectedType&&"value"!==n.expectedType.kind&&(u=n.expectedType);for(var g=[],_=1;_<t.length-1;_+=2){var w=n.parse(t[_],_,Ke);if(!w)return null;var S=n.parse(t[_+1],_+1,u);if(!S)return null;g.push([w,S]),u=u||S.type}var A=n.parse(t[t.length-1],t.length-1,u);return A?new pa(u,g,A):null},pa.prototype.evaluate=function(t){for(var n=0,u=this.branches;n<u.length;n+=1){var g=u[n],_=g[1];if(g[0].evaluate(t))return _.evaluate(t)}return this.otherwise.evaluate(t)},pa.prototype.eachChild=function(t){for(var n=0,u=this.branches;n<u.length;n+=1){var g=u[n],_=g[1];t(g[0]),t(_)}t(this.otherwise)},pa.prototype.outputDefined=function(){return this.branches.every(function(t){return t[1].outputDefined()})&&this.otherwise.outputDefined()},pa.prototype.serialize=function(){var t=["case"];return this.eachChild(function(n){t.push(n.serialize())}),t};var Ba=function(t,n,u,g){this.type=t,this.input=n,this.beginIndex=u,this.endIndex=g};function wu(t,n){return"=="===t||"!="===t?"boolean"===n.kind||"string"===n.kind||"number"===n.kind||"null"===n.kind||"value"===n.kind:"string"===n.kind||"number"===n.kind||"value"===n.kind}function qi(t,n,u,g){return 0===g.compare(n,u)}function Us(t,n,u){var g="=="!==t&&"!="!==t;return function(){function _(w,S,A){this.type=Ke,this.lhs=w,this.rhs=S,this.collator=A,this.hasUntypedArgument="value"===w.type.kind||"value"===S.type.kind}return _.parse=function(w,S){if(3!==w.length&&4!==w.length)return S.error("Expected two or three arguments.");var A=w[0],z=S.parse(w[1],1,Lr);if(!z)return null;if(!wu(A,z.type))return S.concat(1).error('"'+A+"\" comparisons are not supported for type '"+kn(z.type)+"'.");var q=S.parse(w[2],2,Lr);if(!q)return null;if(!wu(A,q.type))return S.concat(2).error('"'+A+"\" comparisons are not supported for type '"+kn(q.type)+"'.");if(z.type.kind!==q.type.kind&&"value"!==z.type.kind&&"value"!==q.type.kind)return S.error("Cannot compare types '"+kn(z.type)+"' and '"+kn(q.type)+"'.");g&&("value"===z.type.kind&&"value"!==q.type.kind?z=new La(q.type,[z]):"value"!==z.type.kind&&"value"===q.type.kind&&(q=new La(z.type,[q])));var V=null;if(4===w.length){if("string"!==z.type.kind&&"string"!==q.type.kind&&"value"!==z.type.kind&&"value"!==q.type.kind)return S.error("Cannot use collator to compare non-string types.");if(!(V=S.parse(w[3],3,Mn)))return null}return new _(z,q,V)},_.prototype.evaluate=function(w){var S=this.lhs.evaluate(w),A=this.rhs.evaluate(w);if(g&&this.hasUntypedArgument){var z=aa(S),q=aa(A);if(z.kind!==q.kind||"string"!==z.kind&&"number"!==z.kind)throw new go('Expected arguments for "'+t+'" to be (string, string) or (number, number), but found ('+z.kind+", "+q.kind+") instead.")}if(this.collator&&!g&&this.hasUntypedArgument){var V=aa(S),H=aa(A);if("string"!==V.kind||"string"!==H.kind)return n(w,S,A)}return this.collator?u(w,S,A,this.collator.evaluate(w)):n(w,S,A)},_.prototype.eachChild=function(w){w(this.lhs),w(this.rhs),this.collator&&w(this.collator)},_.prototype.outputDefined=function(){return!0},_.prototype.serialize=function(){var w=[t];return this.eachChild(function(S){w.push(S.serialize())}),w},_}()}Ba.parse=function(t,n){if(t.length<=2||t.length>=5)return n.error("Expected 3 or 4 arguments, but found "+(t.length-1)+" instead.");var u=n.parse(t[1],1,Lr),g=n.parse(t[2],2,Xe);if(!u||!g)return null;if(!ni(u.type,[ai(Lr),vr,Lr]))return n.error("Expected first argument to be of type array or string, but found "+kn(u.type)+" instead");if(4===t.length){var _=n.parse(t[3],3,Xe);return _?new Ba(u.type,u,g,_):null}return new Ba(u.type,u,g)},Ba.prototype.evaluate=function(t){var n=this.input.evaluate(t),u=this.beginIndex.evaluate(t);if(!Xr(n,["string","array"]))throw new go("Expected first argument to be of type array or string, but found "+kn(aa(n))+" instead.");if(this.endIndex){var g=this.endIndex.evaluate(t);return n.slice(u,g)}return n.slice(u)},Ba.prototype.eachChild=function(t){t(this.input),t(this.beginIndex),this.endIndex&&t(this.endIndex)},Ba.prototype.outputDefined=function(){return!1},Ba.prototype.serialize=function(){if(null!=this.endIndex&&void 0!==this.endIndex){var t=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),t]}return["slice",this.input.serialize(),this.beginIndex.serialize()]};var Ms=Us("==",function(t,n,u){return n===u},qi),$n=Us("!=",function(t,n,u){return n!==u},function(t,n,u,g){return!qi(0,n,u,g)}),Ts=Us("<",function(t,n,u){return n<u},function(t,n,u,g){return g.compare(n,u)<0}),Ni=Us(">",function(t,n,u){return n>u},function(t,n,u,g){return g.compare(n,u)>0}),sl=Us("<=",function(t,n,u){return n<=u},function(t,n,u,g){return g.compare(n,u)<=0}),fa=Us(">=",function(t,n,u){return n>=u},function(t,n,u,g){return g.compare(n,u)>=0}),qs=function(t,n,u,g,_){this.type=vr,this.number=t,this.locale=n,this.currency=u,this.minFractionDigits=g,this.maxFractionDigits=_};qs.parse=function(t,n){if(3!==t.length)return n.error("Expected two arguments.");var u=n.parse(t[1],1,Xe);if(!u)return null;var g=t[2];if("object"!=typeof g||Array.isArray(g))return n.error("NumberFormat options argument must be an object.");var _=null;if(g.locale&&!(_=n.parse(g.locale,1,vr)))return null;var w=null;if(g.currency&&!(w=n.parse(g.currency,1,vr)))return null;var S=null;if(g["min-fraction-digits"]&&!(S=n.parse(g["min-fraction-digits"],1,Xe)))return null;var A=null;return g["max-fraction-digits"]&&!(A=n.parse(g["max-fraction-digits"],1,Xe))?null:new qs(u,_,w,S,A)},qs.prototype.evaluate=function(t){return new Intl.NumberFormat(this.locale?this.locale.evaluate(t):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(t):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(t):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(t):void 0}).format(this.number.evaluate(t))},qs.prototype.eachChild=function(t){t(this.number),this.locale&&t(this.locale),this.currency&&t(this.currency),this.minFractionDigits&&t(this.minFractionDigits),this.maxFractionDigits&&t(this.maxFractionDigits)},qs.prototype.outputDefined=function(){return!1},qs.prototype.serialize=function(){var t={};return this.locale&&(t.locale=this.locale.serialize()),this.currency&&(t.currency=this.currency.serialize()),this.minFractionDigits&&(t["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(t["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),t]};var Un=function(t){this.type=Xe,this.input=t};Un.parse=function(t,n){if(2!==t.length)return n.error("Expected 1 argument, but found "+(t.length-1)+" instead.");var u=n.parse(t[1],1);return u?"array"!==u.type.kind&&"string"!==u.type.kind&&"value"!==u.type.kind?n.error("Expected argument of type string or array, but found "+kn(u.type)+" instead."):new Un(u):null},Un.prototype.evaluate=function(t){var n=this.input.evaluate(t);if("string"==typeof n||Array.isArray(n))return n.length;throw new go("Expected value to be of type string or array, but found "+kn(aa(n))+" instead.")},Un.prototype.eachChild=function(t){t(this.input)},Un.prototype.outputDefined=function(){return!1},Un.prototype.serialize=function(){var t=["length"];return this.eachChild(function(n){t.push(n.serialize())}),t};var $s={"==":Ms,"!=":$n,">":Ni,"<":Ts,">=":fa,"<=":sl,array:La,at:ki,boolean:La,case:pa,coalesce:Da,collator:Se,format:wn,image:Tu,in:Hr,"index-of":bu,interpolate:gi,"interpolate-hcl":gi,"interpolate-lab":gi,length:Un,let:Bs,literal:Bn,match:fu,number:La,"number-format":qs,object:La,slice:Ba,step:Uo,string:La,"to-boolean":L,"to-color":L,"to-number":L,"to-string":L,var:qr,within:ci};function wo(t,n){var u=n[0],g=n[1],_=n[2],w=n[3];u=u.evaluate(t),g=g.evaluate(t),_=_.evaluate(t);var S=w?w.evaluate(t):1,A=Ws(u,g,_,S);if(A)throw new go(A);return new Hn(u/255*S,g/255*S,_/255*S,S)}function Wu(t,n){return t in n}function da(t,n){var u=n[t];return void 0===u?null:u}function Ka(t){return{type:t}}function rl(t){return{result:"success",value:t}}function Ua(t){return{result:"error",value:t}}function hi(t){return"data-driven"===t["property-type"]||"cross-faded-data-driven"===t["property-type"]}function Wo(t){return!!t.expression&&t.expression.parameters.indexOf("zoom")>-1}function Eu(t){return!!t.expression&&t.expression.interpolated}function Qn(t){return t instanceof Number?"number":t instanceof String?"string":t instanceof Boolean?"boolean":Array.isArray(t)?"array":null===t?"null":typeof t}function qa(t){return"object"==typeof t&&null!==t&&!Array.isArray(t)}function Oa(t){return t}function zu(t,n,u){return void 0!==t?t:void 0!==n?n:void 0!==u?u:void 0}function Cl(t,n,u,g,_){return zu(typeof u===_?g[u]:void 0,t.default,n.default)}function Su(t,n,u){if("number"!==Qn(u))return zu(t.default,n.default);var g=t.stops.length;if(1===g||u<=t.stops[0][0])return t.stops[0][1];if(u>=t.stops[g-1][0])return t.stops[g-1][1];var _=xo(t.stops.map(function(w){return w[0]}),u);return t.stops[_][1]}function $a(t,n,u){var g=void 0!==t.base?t.base:1;if("number"!==Qn(u))return zu(t.default,n.default);var _=t.stops.length;if(1===_||u<=t.stops[0][0])return t.stops[0][1];if(u>=t.stops[_-1][0])return t.stops[_-1][1];var st,vt,Vt,he,w=xo(t.stops.map(function(H){return H[0]}),u),S=(st=g,he=u-(vt=t.stops[w][0]),0==(Vt=t.stops[w+1][0]-vt)?0:1===st?he/Vt:(Math.pow(st,he)-1)/(Math.pow(st,Vt)-1)),A=t.stops[w][1],z=t.stops[w+1][1],q=sa[n.type]||Oa;if(t.colorSpace&&"rgb"!==t.colorSpace){var V=hu[t.colorSpace];q=function(H,st){return V.reverse(V.interpolate(V.forward(H),V.forward(st),S))}}return"function"==typeof A.evaluate?{evaluate:function(){for(var H=[],st=arguments.length;st--;)H[st]=arguments[st];var vt=A.evaluate.apply(void 0,H),Rt=z.evaluate.apply(void 0,H);if(void 0!==vt&&void 0!==Rt)return q(vt,Rt,S)}}:q(A,z,S)}function Au(t,n,u){return"color"===n.type?u=Hn.parse(u):"formatted"===n.type?u=No.fromString(u.toString()):"resolvedImage"===n.type?u=Wn.fromString(u.toString()):Qn(u)===n.type||"enum"===n.type&&n.values[u]||(u=void 0),zu(u,t.default,n.default)}oe.register($s,{error:[{kind:"error"},[vr],function(t,n){throw new go(n[0].evaluate(t))}],typeof:[vr,[Lr],function(t,n){return kn(aa(n[0].evaluate(t)))}],"to-rgba":[ai(Xe,4),[bn],function(t,n){return n[0].evaluate(t).toArray()}],rgb:[bn,[Xe,Xe,Xe],wo],rgba:[bn,[Xe,Xe,Xe,Xe],wo],has:{type:Ke,overloads:[[[vr],function(t,n){return Wu(n[0].evaluate(t),t.properties())}],[[vr,$r],function(t,n){var u=n[1];return Wu(n[0].evaluate(t),u.evaluate(t))}]]},get:{type:Lr,overloads:[[[vr],function(t,n){return da(n[0].evaluate(t),t.properties())}],[[vr,$r],function(t,n){var u=n[1];return da(n[0].evaluate(t),u.evaluate(t))}]]},"feature-state":[Lr,[vr],function(t,n){return da(n[0].evaluate(t),t.featureState||{})}],properties:[$r,[],function(t){return t.properties()}],"geometry-type":[vr,[],function(t){return t.geometryType()}],id:[Lr,[],function(t){return t.id()}],zoom:[Xe,[],function(t){return t.globals.zoom}],"heatmap-density":[Xe,[],function(t){return t.globals.heatmapDensity||0}],"line-progress":[Xe,[],function(t){return t.globals.lineProgress||0}],accumulated:[Lr,[],function(t){return void 0===t.globals.accumulated?null:t.globals.accumulated}],"+":[Xe,Ka(Xe),function(t,n){for(var u=0,g=0,_=n;g<_.length;g+=1)u+=_[g].evaluate(t);return u}],"*":[Xe,Ka(Xe),function(t,n){for(var u=1,g=0,_=n;g<_.length;g+=1)u*=_[g].evaluate(t);return u}],"-":{type:Xe,overloads:[[[Xe,Xe],function(t,n){var u=n[1];return n[0].evaluate(t)-u.evaluate(t)}],[[Xe],function(t,n){return-n[0].evaluate(t)}]]},"/":[Xe,[Xe,Xe],function(t,n){var u=n[1];return n[0].evaluate(t)/u.evaluate(t)}],"%":[Xe,[Xe,Xe],function(t,n){var u=n[1];return n[0].evaluate(t)%u.evaluate(t)}],ln2:[Xe,[],function(){return Math.LN2}],pi:[Xe,[],function(){return Math.PI}],e:[Xe,[],function(){return Math.E}],"^":[Xe,[Xe,Xe],function(t,n){var u=n[1];return Math.pow(n[0].evaluate(t),u.evaluate(t))}],sqrt:[Xe,[Xe],function(t,n){return Math.sqrt(n[0].evaluate(t))}],log10:[Xe,[Xe],function(t,n){return Math.log(n[0].evaluate(t))/Math.LN10}],ln:[Xe,[Xe],function(t,n){return Math.log(n[0].evaluate(t))}],log2:[Xe,[Xe],function(t,n){return Math.log(n[0].evaluate(t))/Math.LN2}],sin:[Xe,[Xe],function(t,n){return Math.sin(n[0].evaluate(t))}],cos:[Xe,[Xe],function(t,n){return Math.cos(n[0].evaluate(t))}],tan:[Xe,[Xe],function(t,n){return Math.tan(n[0].evaluate(t))}],asin:[Xe,[Xe],function(t,n){return Math.asin(n[0].evaluate(t))}],acos:[Xe,[Xe],function(t,n){return Math.acos(n[0].evaluate(t))}],atan:[Xe,[Xe],function(t,n){return Math.atan(n[0].evaluate(t))}],min:[Xe,Ka(Xe),function(t,n){return Math.min.apply(Math,n.map(function(u){return u.evaluate(t)}))}],max:[Xe,Ka(Xe),function(t,n){return Math.max.apply(Math,n.map(function(u){return u.evaluate(t)}))}],abs:[Xe,[Xe],function(t,n){return Math.abs(n[0].evaluate(t))}],round:[Xe,[Xe],function(t,n){var u=n[0].evaluate(t);return u<0?-Math.round(-u):Math.round(u)}],floor:[Xe,[Xe],function(t,n){return Math.floor(n[0].evaluate(t))}],ceil:[Xe,[Xe],function(t,n){return Math.ceil(n[0].evaluate(t))}],"filter-==":[Ke,[vr,Lr],function(t,n){var u=n[0],g=n[1];return t.properties()[u.value]===g.value}],"filter-id-==":[Ke,[Lr],function(t,n){var u=n[0];return t.id()===u.value}],"filter-type-==":[Ke,[vr],function(t,n){var u=n[0];return t.geometryType()===u.value}],"filter-<":[Ke,[vr,Lr],function(t,n){var u=n[0],g=n[1],_=t.properties()[u.value],w=g.value;return typeof _==typeof w&&_<w}],"filter-id-<":[Ke,[Lr],function(t,n){var u=n[0],g=t.id(),_=u.value;return typeof g==typeof _&&g<_}],"filter->":[Ke,[vr,Lr],function(t,n){var u=n[0],g=n[1],_=t.properties()[u.value],w=g.value;return typeof _==typeof w&&_>w}],"filter-id->":[Ke,[Lr],function(t,n){var u=n[0],g=t.id(),_=u.value;return typeof g==typeof _&&g>_}],"filter-<=":[Ke,[vr,Lr],function(t,n){var u=n[0],g=n[1],_=t.properties()[u.value],w=g.value;return typeof _==typeof w&&_<=w}],"filter-id-<=":[Ke,[Lr],function(t,n){var u=n[0],g=t.id(),_=u.value;return typeof g==typeof _&&g<=_}],"filter->=":[Ke,[vr,Lr],function(t,n){var u=n[0],g=n[1],_=t.properties()[u.value],w=g.value;return typeof _==typeof w&&_>=w}],"filter-id->=":[Ke,[Lr],function(t,n){var u=n[0],g=t.id(),_=u.value;return typeof g==typeof _&&g>=_}],"filter-has":[Ke,[Lr],function(t,n){return n[0].value in t.properties()}],"filter-has-id":[Ke,[],function(t){return null!==t.id()&&void 0!==t.id()}],"filter-type-in":[Ke,[ai(vr)],function(t,n){return n[0].value.indexOf(t.geometryType())>=0}],"filter-id-in":[Ke,[ai(Lr)],function(t,n){return n[0].value.indexOf(t.id())>=0}],"filter-in-small":[Ke,[vr,ai(Lr)],function(t,n){var u=n[0];return n[1].value.indexOf(t.properties()[u.value])>=0}],"filter-in-large":[Ke,[vr,ai(Lr)],function(t,n){var u=n[0],g=n[1];return function(_,w,S,A){for(;S<=A;){var z=S+A>>1;if(w[z]===_)return!0;w[z]>_?A=z-1:S=z+1}return!1}(t.properties()[u.value],g.value,0,g.value.length-1)}],all:{type:Ke,overloads:[[[Ke,Ke],function(t,n){var u=n[1];return n[0].evaluate(t)&&u.evaluate(t)}],[Ka(Ke),function(t,n){for(var u=0,g=n;u<g.length;u+=1)if(!g[u].evaluate(t))return!1;return!0}]]},any:{type:Ke,overloads:[[[Ke,Ke],function(t,n){var u=n[1];return n[0].evaluate(t)||u.evaluate(t)}],[Ka(Ke),function(t,n){for(var u=0,g=n;u<g.length;u+=1)if(g[u].evaluate(t))return!0;return!1}]]},"!":[Ke,[Ke],function(t,n){return!n[0].evaluate(t)}],"is-supported-script":[Ke,[vr],function(t,n){var u=t.globals&&t.globals.isSupportedScript;return!u||u(n[0].evaluate(t))}],upcase:[vr,[vr],function(t,n){return n[0].evaluate(t).toUpperCase()}],downcase:[vr,[vr],function(t,n){return n[0].evaluate(t).toLowerCase()}],concat:[vr,Ka(Lr),function(t,n){return n.map(function(u){return ss(u.evaluate(t))}).join("")}],"resolved-locale":[vr,[Mn],function(t,n){return n[0].evaluate(t).resolvedLocale()}]});var Ko=function(t,n){var u;this.expression=t,this._warningHistory={},this._evaluator=new ct,this._defaultValue=n?"color"===(u=n).type&&qa(u.default)?new Hn(0,0,0,0):"color"===u.type?Hn.parse(u.default)||null:void 0===u.default?null:u.default:null,this._enumValues=n&&"enum"===n.type?n.values:null};function ms(t){return Array.isArray(t)&&t.length>0&&"string"==typeof t[0]&&t[0]in $s}function Gs(t,n){var _,w,u=new Bi($s,[],n?(w={color:bn,string:vr,number:Xe,enum:vr,boolean:Ke,formatted:Nr,resolvedImage:Oi},"array"===(_=n).type?ai(w[_.value]||Lr,_.length):w[_.type]):void 0),g=u.parse(t,void 0,void 0,void 0,n&&"string"===n.type?{typeAnnotation:"coerce"}:void 0);return g?rl(new Ko(g,n)):Ua(u.errors)}Ko.prototype.evaluateWithoutErrorHandling=function(t,n,u,g,_,w){return this._evaluator.globals=t,this._evaluator.feature=n,this._evaluator.featureState=u,this._evaluator.canonical=g,this._evaluator.availableImages=_||null,this._evaluator.formattedSection=w,this.expression.evaluate(this._evaluator)},Ko.prototype.evaluate=function(t,n,u,g,_,w){this._evaluator.globals=t,this._evaluator.feature=n||null,this._evaluator.featureState=u||null,this._evaluator.canonical=g,this._evaluator.availableImages=_||null,this._evaluator.formattedSection=w||null;try{var S=this.expression.evaluate(this._evaluator);if(null==S||"number"==typeof S&&S!=S)return this._defaultValue;if(this._enumValues&&!(S in this._enumValues))throw new go("Expected value to be one of "+Object.keys(this._enumValues).map(function(A){return JSON.stringify(A)}).join(", ")+", but found "+JSON.stringify(S)+" instead.");return S}catch(A){return this._warningHistory[A.message]||(this._warningHistory[A.message]=!0,typeof console<"u"&&console.warn(A.message)),this._defaultValue}};var be=function(t,n){this.kind=t,this._styleExpression=n,this.isStateDependent="constant"!==t&&!us(n.expression)};be.prototype.evaluateWithoutErrorHandling=function(t,n,u,g,_,w){return this._styleExpression.evaluateWithoutErrorHandling(t,n,u,g,_,w)},be.prototype.evaluate=function(t,n,u,g,_,w){return this._styleExpression.evaluate(t,n,u,g,_,w)};var Ye=function(t,n,u,g){this.kind=t,this.zoomStops=u,this._styleExpression=n,this.isStateDependent="camera"!==t&&!us(n.expression),this.interpolationType=g};function dr(t,n){if("error"===(t=Gs(t,n)).result)return t;var u=t.value.expression,g=Cr(u);if(!g&&!hi(n))return Ua([new pr("","data expressions not supported")]);var _=ls(u,["zoom"]);if(!_&&!Wo(n))return Ua([new pr("","zoom expressions not supported")]);var w=function S(A){var z=null;if(A instanceof Bs)z=S(A.result);else if(A instanceof Da)for(var q=0,V=A.args;q<V.length&&!(z=S(V[q]));q+=1);else(A instanceof Uo||A instanceof gi)&&A.input instanceof oe&&"zoom"===A.input.name&&(z=A);return z instanceof pr||A.eachChild(function(H){var st=S(H);st instanceof pr?z=st:!z&&st?z=new pr("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):z&&st&&z!==st&&(z=new pr("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),z}(u);return w||_?w instanceof pr?Ua([w]):w instanceof gi&&!Eu(n)?Ua([new pr("",'"interpolate" expressions cannot be used with this property')]):rl(w?new Ye(g?"camera":"composite",t.value,w.labels,w instanceof gi?w.interpolation:void 0):new be(g?"constant":"source",t.value)):Ua([new pr("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}Ye.prototype.evaluateWithoutErrorHandling=function(t,n,u,g,_,w){return this._styleExpression.evaluateWithoutErrorHandling(t,n,u,g,_,w)},Ye.prototype.evaluate=function(t,n,u,g,_,w){return this._styleExpression.evaluate(t,n,u,g,_,w)},Ye.prototype.interpolationFactor=function(t,n,u){return this.interpolationType?gi.interpolationFactor(this.interpolationType,t,n,u):0};var dn=function(t,n){this._parameters=t,this._specification=n,xr(this,function u(g,_){var w,S,A,z="color"===_.type,q=g.stops&&"object"==typeof g.stops[0][0],V=q||!(q||void 0!==g.property),H=g.type||(Eu(_)?"exponential":"interval");if(z&&((g=xr({},g)).stops&&(g.stops=g.stops.map(function(Tr){return[Tr[0],Hn.parse(Tr[1])]})),g.default=Hn.parse(g.default?g.default:_.default)),g.colorSpace&&"rgb"!==g.colorSpace&&!hu[g.colorSpace])throw new Error("Unknown color space: "+g.colorSpace);if("exponential"===H)w=$a;else if("interval"===H)w=Su;else if("categorical"===H){w=Cl,S=Object.create(null);for(var st=0,vt=g.stops;st<vt.length;st+=1){var Rt=vt[st];S[Rt[0]]=Rt[1]}A=typeof g.stops[0][0]}else{if("identity"!==H)throw new Error('Unknown function type "'+H+'"');w=Au}if(q){for(var Vt={},he=[],re=0;re<g.stops.length;re++){var we=g.stops[re],Pe=we[0].zoom;void 0===Vt[Pe]&&(Vt[Pe]={zoom:Pe,type:g.type,property:g.property,default:g.default,stops:[]},he.push(Pe)),Vt[Pe].stops.push([we[0].value,we[1]])}for(var Re=[],ze=0,rr=he;ze<rr.length;ze+=1){var yr=rr[ze];Re.push([Vt[yr].zoom,u(Vt[yr],_)])}var Mr={name:"linear"};return{kind:"composite",interpolationType:Mr,interpolationFactor:gi.interpolationFactor.bind(void 0,Mr),zoomStops:Re.map(function(Tr){return Tr[0]}),evaluate:function(Tr,ln){var Fr=Tr.zoom;return $a({stops:Re,base:g.base},_,Fr).evaluate(Fr,ln)}}}if(V){var Wr="exponential"===H?{name:"exponential",base:void 0!==g.base?g.base:1}:null;return{kind:"camera",interpolationType:Wr,interpolationFactor:gi.interpolationFactor.bind(void 0,Wr),zoomStops:g.stops.map(function(Tr){return Tr[0]}),evaluate:function(Tr){return w(g,_,Tr.zoom,S,A)}}}return{kind:"source",evaluate:function(Tr,ln){var Fr=ln&&ln.properties?ln.properties[g.property]:void 0;return void 0===Fr?zu(g.default,_.default):w(g,_,Fr,S,A)}}}(this._parameters,this._specification))};function xi(t){var n=t.key,u=t.value,g=t.valueSpec||{},_=t.objectElementValidators||{},w=t.style,S=t.styleSpec,A=[],z=Qn(u);if("object"!==z)return[new Ht(n,u,"object expected, "+z+" found")];for(var q in u){var V=q.split(".")[0],H=g[V]||g["*"],st=void 0;if(_[V])st=_[V];else if(g[V])st=jn;else if(_["*"])st=_["*"];else{if(!g["*"]){A.push(new Ht(n,u[q],'unknown property "'+q+'"'));continue}st=jn}A=A.concat(st({key:(n&&n+".")+q,value:u[q],valueSpec:H,style:w,styleSpec:S,object:u,objectKey:q},u))}for(var vt in g)_[vt]||g[vt].required&&void 0===g[vt].default&&void 0===u[vt]&&A.push(new Ht(n,u,'missing required property "'+vt+'"'));return A}function Ln(t){var n=t.value,u=t.valueSpec,g=t.style,_=t.styleSpec,w=t.key,S=t.arrayElementValidator||jn;if("array"!==Qn(n))return[new Ht(w,n,"array expected, "+Qn(n)+" found")];if(u.length&&n.length!==u.length)return[new Ht(w,n,"array length "+u.length+" expected, length "+n.length+" found")];if(u["min-length"]&&n.length<u["min-length"])return[new Ht(w,n,"array length at least "+u["min-length"]+" expected, length "+n.length+" found")];var A={type:u.value,values:u.values};_.$version<7&&(A.function=u.function),"object"===Qn(u.value)&&(A=u.value);for(var z=[],q=0;q<n.length;q++)z=z.concat(S({array:n,arrayIndex:q,value:n[q],valueSpec:A,style:g,styleSpec:_,key:w+"["+q+"]"}));return z}function mo(t){var n=t.key,u=t.value,g=t.valueSpec,_=Qn(u);return"number"===_&&u!=u&&(_="NaN"),"number"!==_?[new Ht(n,u,"number expected, "+_+" found")]:"minimum"in g&&u<g.minimum?[new Ht(n,u,u+" is less than the minimum value "+g.minimum)]:"maximum"in g&&u>g.maximum?[new Ht(n,u,u+" is greater than the maximum value "+g.maximum)]:[]}function Gi(t){var n,u,g,_=t.valueSpec,w=Me(t.value.type),S={},A="categorical"!==w&&void 0===t.value.property,z=!A,q="array"===Qn(t.value.stops)&&"array"===Qn(t.value.stops[0])&&"object"===Qn(t.value.stops[0][0]),V=xi({key:t.key,value:t.value,valueSpec:t.styleSpec.function,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{stops:function(vt){if("identity"===w)return[new Ht(vt.key,vt.value,'identity function may not have a "stops" property')];var Rt=[],Vt=vt.value;return Rt=Rt.concat(Ln({key:vt.key,value:Vt,valueSpec:vt.valueSpec,style:vt.style,styleSpec:vt.styleSpec,arrayElementValidator:H})),"array"===Qn(Vt)&&0===Vt.length&&Rt.push(new Ht(vt.key,Vt,"array must have at least one stop")),Rt},default:function(vt){return jn({key:vt.key,value:vt.value,valueSpec:_,style:vt.style,styleSpec:vt.styleSpec})}}});return"identity"===w&&A&&V.push(new Ht(t.key,t.value,'missing required property "property"')),"identity"===w||t.value.stops||V.push(new Ht(t.key,t.value,'missing required property "stops"')),"exponential"===w&&t.valueSpec.expression&&!Eu(t.valueSpec)&&V.push(new Ht(t.key,t.value,"exponential functions not supported")),t.styleSpec.$version>=8&&(z&&!hi(t.valueSpec)?V.push(new Ht(t.key,t.value,"property functions not supported")):A&&!Wo(t.valueSpec)&&V.push(new Ht(t.key,t.value,"zoom functions not supported"))),"categorical"!==w&&!q||void 0!==t.value.property||V.push(new Ht(t.key,t.value,'"property" property is required')),V;function H(vt){var Rt=[],Vt=vt.value,he=vt.key;if("array"!==Qn(Vt))return[new Ht(he,Vt,"array expected, "+Qn(Vt)+" found")];if(2!==Vt.length)return[new Ht(he,Vt,"array length 2 expected, length "+Vt.length+" found")];if(q){if("object"!==Qn(Vt[0]))return[new Ht(he,Vt,"object expected, "+Qn(Vt[0])+" found")];if(void 0===Vt[0].zoom)return[new Ht(he,Vt,"object stop key must have zoom")];if(void 0===Vt[0].value)return[new Ht(he,Vt,"object stop key must have value")];if(g&&g>Me(Vt[0].zoom))return[new Ht(he,Vt[0].zoom,"stop zoom values must appear in ascending order")];Me(Vt[0].zoom)!==g&&(g=Me(Vt[0].zoom),u=void 0,S={}),Rt=Rt.concat(xi({key:he+"[0]",value:Vt[0],valueSpec:{zoom:{}},style:vt.style,styleSpec:vt.styleSpec,objectElementValidators:{zoom:mo,value:st}}))}else Rt=Rt.concat(st({key:he+"[0]",value:Vt[0],valueSpec:{},style:vt.style,styleSpec:vt.styleSpec},Vt));return ms(qe(Vt[1]))?Rt.concat([new Ht(he+"[1]",Vt[1],"expressions are not allowed in function stops.")]):Rt.concat(jn({key:he+"[1]",value:Vt[1],valueSpec:_,style:vt.style,styleSpec:vt.styleSpec}))}function st(vt,Rt){var Vt=Qn(vt.value),he=Me(vt.value),re=null!==vt.value?vt.value:Rt;if(n){if(Vt!==n)return[new Ht(vt.key,re,Vt+" stop domain type must match previous stop domain type "+n)]}else n=Vt;if("number"!==Vt&&"string"!==Vt&&"boolean"!==Vt)return[new Ht(vt.key,re,"stop domain value must be a number, string, or boolean")];if("number"!==Vt&&"categorical"!==w){var we="number expected, "+Vt+" found";return hi(_)&&void 0===w&&(we+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Ht(vt.key,re,we)]}return"categorical"!==w||"number"!==Vt||isFinite(he)&&Math.floor(he)===he?"categorical"!==w&&"number"===Vt&&void 0!==u&&he<u?[new Ht(vt.key,re,"stop domain values must appear in ascending order")]:(u=he,"categorical"===w&&he in S?[new Ht(vt.key,re,"stop domain values must be unique")]:(S[he]=!0,[])):[new Ht(vt.key,re,"integer expected, found "+he)]}}function Ga(t){var n=("property"===t.expressionContext?dr:Gs)(qe(t.value),t.valueSpec);if("error"===n.result)return n.value.map(function(g){return new Ht(""+t.key+g.key,t.value,g.message)});var u=n.value.expression||n.value._styleExpression.expression;if("property"===t.expressionContext&&"text-font"===t.propertyKey&&!u.outputDefined())return[new Ht(t.key,t.value,'Invalid data expression for "'+t.propertyKey+'". Output values must be contained as literals within the expression.')];if("property"===t.expressionContext&&"layout"===t.propertyType&&!us(u))return[new Ht(t.key,t.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===t.expressionContext&&!us(u))return[new Ht(t.key,t.value,'"feature-state" data expressions are not supported with filters.')];if(t.expressionContext&&0===t.expressionContext.indexOf("cluster")){if(!ls(u,["zoom","feature-state"]))return[new Ht(t.key,t.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===t.expressionContext&&!Cr(u))return[new Ht(t.key,t.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function mi(t){var n=t.key,u=t.value,g=t.valueSpec,_=[];return Array.isArray(g.values)?-1===g.values.indexOf(Me(u))&&_.push(new Ht(n,u,"expected one of ["+g.values.join(", ")+"], "+JSON.stringify(u)+" found")):-1===Object.keys(g.values).indexOf(Me(u))&&_.push(new Ht(n,u,"expected one of ["+Object.keys(g.values).join(", ")+"], "+JSON.stringify(u)+" found")),_}function $o(t){if(!0===t||!1===t)return!0;if(!Array.isArray(t)||0===t.length)return!1;switch(t[0]){case"has":return t.length>=2&&"$id"!==t[1]&&"$type"!==t[1];case"in":return t.length>=3&&("string"!=typeof t[1]||Array.isArray(t[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==t.length||Array.isArray(t[1])||Array.isArray(t[2]);case"any":case"all":for(var n=0,u=t.slice(1);n<u.length;n+=1){var g=u[n];if(!$o(g)&&"boolean"!=typeof g)return!1}return!0;default:return!0}}dn.deserialize=function(t){return new dn(t._parameters,t._specification)},dn.serialize=function(t){return{_parameters:t._parameters,_specification:t._specification}};var As={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Qa(t){if(null==t)return{filter:function(){return!0},needGeometry:!1};$o(t)||(t=Qs(t));var n=Gs(t,As);if("error"===n.result)throw new Error(n.value.map(function(u){return u.key+": "+u.message}).join(", "));return{filter:function(u,g,_){return n.value.evaluate(u,g,{},_)},needGeometry:function u(g){if(!Array.isArray(g))return!1;if("within"===g[0])return!0;for(var _=1;_<g.length;_++)if(u(g[_]))return!0;return!1}(t)}}function ys(t,n){return t<n?-1:t>n?1:0}function Qs(t){if(!t)return!0;var n,u=t[0];return t.length<=1?"any"!==u:"=="===u?Vs(t[1],t[2],"=="):"!="===u?Zs(Vs(t[1],t[2],"==")):"<"===u||">"===u||"<="===u||">="===u?Vs(t[1],t[2],u):"any"===u?(n=t.slice(1),["any"].concat(n.map(Qs))):"all"===u?["all"].concat(t.slice(1).map(Qs)):"none"===u?["all"].concat(t.slice(1).map(Qs).map(Zs)):"in"===u?vs(t[1],t.slice(2)):"!in"===u?Zs(vs(t[1],t.slice(2))):"has"===u?Go(t[1]):"!has"===u?Zs(Go(t[1])):"within"!==u||t}function Vs(t,n,u){switch(t){case"$type":return["filter-type-"+u,n];case"$id":return["filter-id-"+u,n];default:return["filter-"+u,t,n]}}function vs(t,n){if(0===n.length)return!1;switch(t){case"$type":return["filter-type-in",["literal",n]];case"$id":return["filter-id-in",["literal",n]];default:return n.length>200&&!n.some(function(u){return typeof u!=typeof n[0]})?["filter-in-large",t,["literal",n.sort(ys)]]:["filter-in-small",t,["literal",n]]}}function Go(t){switch(t){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",t]}}function Zs(t){return["!",t]}function ua(t){return $o(qe(t.value))?Ga(xr({},t,{expressionContext:"filter",valueSpec:{value:"boolean"}})):function n(u){var g=u.value,_=u.key;if("array"!==Qn(g))return[new Ht(_,g,"array expected, "+Qn(g)+" found")];var w,S=u.styleSpec,A=[];if(g.length<1)return[new Ht(_,g,"filter array must have at least 1 element")];switch(A=A.concat(mi({key:_+"[0]",value:g[0],valueSpec:S.filter_operator,style:u.style,styleSpec:u.styleSpec})),Me(g[0])){case"<":case"<=":case">":case">=":g.length>=2&&"$type"===Me(g[1])&&A.push(new Ht(_,g,'"$type" cannot be use with operator "'+g[0]+'"'));case"==":case"!=":3!==g.length&&A.push(new Ht(_,g,'filter array for operator "'+g[0]+'" must have 3 elements'));case"in":case"!in":g.length>=2&&"string"!==(w=Qn(g[1]))&&A.push(new Ht(_+"[1]",g[1],"string expected, "+w+" found"));for(var z=2;z<g.length;z++)w=Qn(g[z]),"$type"===Me(g[1])?A=A.concat(mi({key:_+"["+z+"]",value:g[z],valueSpec:S.geometry_type,style:u.style,styleSpec:u.styleSpec})):"string"!==w&&"number"!==w&&"boolean"!==w&&A.push(new Ht(_+"["+z+"]",g[z],"string, number, or boolean expected, "+w+" found"));break;case"any":case"all":case"none":for(var q=1;q<g.length;q++)A=A.concat(n({key:_+"["+q+"]",value:g[q],style:u.style,styleSpec:u.styleSpec}));break;case"has":case"!has":w=Qn(g[1]),2!==g.length?A.push(new Ht(_,g,'filter array for "'+g[0]+'" operator must have 2 elements')):"string"!==w&&A.push(new Ht(_+"[1]",g[1],"string expected, "+w+" found"));break;case"within":w=Qn(g[1]),2!==g.length?A.push(new Ht(_,g,'filter array for "'+g[0]+'" operator must have 2 elements')):"object"!==w&&A.push(new Ht(_+"[1]",g[1],"object expected, "+w+" found"))}return A}(t)}function js(t,n){var u=t.key,g=t.style,_=t.styleSpec,w=t.value,S=t.objectKey,A=_[n+"_"+t.layerType];if(!A)return[];var z=S.match(/^(.*)-transition$/);if("paint"===n&&z&&A[z[1]]&&A[z[1]].transition)return jn({key:u,value:w,valueSpec:_.transition,style:g,styleSpec:_});var q,V=t.valueSpec||A[S];if(!V)return[new Ht(u,w,'unknown property "'+S+'"')];if("string"===Qn(w)&&hi(V)&&!V.tokens&&(q=/^{([^}]+)}$/.exec(w)))return[new Ht(u,w,'"'+S+'" does not support interpolation syntax\nUse an identity property function instead: `{ "type": "identity", "property": '+JSON.stringify(q[1])+" }`.")];var H=[];return"symbol"===t.layerType&&("text-field"===S&&g&&!g.glyphs&&H.push(new Ht(u,w,'use of "text-field" requires a style "glyphs" property')),"text-font"===S&&qa(qe(w))&&"identity"===Me(w.type)&&H.push(new Ht(u,w,'"text-font" does not support identity functions'))),H.concat(jn({key:t.key,value:w,valueSpec:V,style:g,styleSpec:_,expressionContext:"property",propertyType:n,propertyKey:S}))}function du(t){return js(t,"paint")}function Eo(t){return js(t,"layout")}function bi(t){var n=[],u=t.value,g=t.key,_=t.style,w=t.styleSpec;u.type||u.ref||n.push(new Ht(g,u,'either "type" or "ref" is required'));var S,A=Me(u.type),z=Me(u.ref);if(u.id)for(var q=Me(u.id),V=0;V<t.arrayIndex;V++){var H=_.layers[V];Me(H.id)===q&&n.push(new Ht(g,u.id,'duplicate layer id "'+u.id+'", previously used at line '+H.id.__line__))}if("ref"in u)["type","source","source-layer","filter","layout"].forEach(function(Rt){Rt in u&&n.push(new Ht(g,u[Rt],'"'+Rt+'" is prohibited for ref layers'))}),_.layers.forEach(function(Rt){Me(Rt.id)===z&&(S=Rt)}),S?S.ref?n.push(new Ht(g,u.ref,"ref cannot reference another ref layer")):A=Me(S.type):n.push(new Ht(g,u.ref,'ref layer "'+z+'" not found'));else if("background"!==A)if(u.source){var st=_.sources&&_.sources[u.source],vt=st&&Me(st.type);st?"vector"===vt&&"raster"===A?n.push(new Ht(g,u.source,'layer "'+u.id+'" requires a raster source')):"raster"===vt&&"raster"!==A?n.push(new Ht(g,u.source,'layer "'+u.id+'" requires a vector source')):"vector"!==vt||u["source-layer"]?"raster-dem"===vt&&"hillshade"!==A?n.push(new Ht(g,u.source,"raster-dem source can only be used with layer type 'hillshade'.")):"line"!==A||!u.paint||!u.paint["line-gradient"]||"geojson"===vt&&st.lineMetrics||n.push(new Ht(g,u,'layer "'+u.id+'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.')):n.push(new Ht(g,u,'layer "'+u.id+'" must specify a "source-layer"')):n.push(new Ht(g,u.source,'source "'+u.source+'" not found'))}else n.push(new Ht(g,u,'missing required property "source"'));return n=n.concat(xi({key:g,value:u,valueSpec:w.layer,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{"*":function(){return[]},type:function(){return jn({key:g+".type",value:u.type,valueSpec:w.layer.type,style:t.style,styleSpec:t.styleSpec,object:u,objectKey:"type"})},filter:ua,layout:function(Rt){return xi({layer:u,key:Rt.key,value:Rt.value,style:Rt.style,styleSpec:Rt.styleSpec,objectElementValidators:{"*":function(Vt){return Eo(xr({layerType:A},Vt))}}})},paint:function(Rt){return xi({layer:u,key:Rt.key,value:Rt.value,style:Rt.style,styleSpec:Rt.styleSpec,objectElementValidators:{"*":function(Vt){return du(xr({layerType:A},Vt))}}})}}}))}function si(t){var n=t.value,u=t.key,g=Qn(n);return"string"!==g?[new Ht(u,n,"string expected, "+g+" found")]:[]}var ba={promoteId:function(t){var n=t.key,u=t.value;if("string"===Qn(u))return si({key:n,value:u});var g=[];for(var _ in u)g.push.apply(g,si({key:n+"."+_,value:u[_]}));return g}};function Po(t){var n=t.value,u=t.key,g=t.styleSpec,_=t.style;if(!n.type)return[new Ht(u,n,'"type" is required')];var w,S=Me(n.type);switch(S){case"vector":case"raster":case"raster-dem":return xi({key:u,value:n,valueSpec:g["source_"+S.replace("-","_")],style:t.style,styleSpec:g,objectElementValidators:ba});case"geojson":if(w=xi({key:u,value:n,valueSpec:g.source_geojson,style:_,styleSpec:g,objectElementValidators:ba}),n.cluster)for(var A in n.clusterProperties){var z=n.clusterProperties[A],q=z[0],V="string"==typeof q?[q,["accumulated"],["get",A]]:q;w.push.apply(w,Ga({key:u+"."+A+".map",value:z[1],expressionContext:"cluster-map"})),w.push.apply(w,Ga({key:u+"."+A+".reduce",value:V,expressionContext:"cluster-reduce"}))}return w;case"video":return xi({key:u,value:n,valueSpec:g.source_video,style:_,styleSpec:g});case"image":return xi({key:u,value:n,valueSpec:g.source_image,style:_,styleSpec:g});case"canvas":return[new Ht(u,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return mi({key:u+".type",value:n.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:_,styleSpec:g})}}function po(t){var n=t.value,u=t.styleSpec,g=u.light,_=t.style,w=[],S=Qn(n);if(void 0===n)return w;if("object"!==S)return w.concat([new Ht("light",n,"object expected, "+S+" found")]);for(var A in n){var z=A.match(/^(.*)-transition$/);w=w.concat(z&&g[z[1]]&&g[z[1]].transition?jn({key:A,value:n[A],valueSpec:u.transition,style:_,styleSpec:u}):g[A]?jn({key:A,value:n[A],valueSpec:g[A],style:_,styleSpec:u}):[new Ht(A,n[A],'unknown property "'+A+'"')])}return w}var En={"*":function(){return[]},array:Ln,boolean:function(t){var n=t.value,u=t.key,g=Qn(n);return"boolean"!==g?[new Ht(u,n,"boolean expected, "+g+" found")]:[]},number:mo,color:function(t){var n=t.key,u=t.value,g=Qn(u);return"string"!==g?[new Ht(n,u,"color expected, "+g+" found")]:null===ca(u)?[new Ht(n,u,'color expected, "'+u+'" found')]:[]},constants:nr,enum:mi,filter:ua,function:Gi,layer:bi,object:xi,source:Po,light:po,string:si,formatted:function(t){return 0===si(t).length?[]:Ga(t)},resolvedImage:function(t){return 0===si(t).length?[]:Ga(t)}};function jn(t){var n=t.value,u=t.valueSpec,g=t.styleSpec;return u.expression&&qa(Me(n))?Gi(t):u.expression&&ms(qe(n))?Ga(t):u.type&&En[u.type]?En[u.type](t):xi(xr({},t,{valueSpec:u.type?g[u.type]:u}))}function Va(t){var n=t.value,u=t.key,g=si(t);return g.length||(-1===n.indexOf("{fontstack}")&&g.push(new Ht(u,n,'"glyphs" url must include a "{fontstack}" token')),-1===n.indexOf("{range}")&&g.push(new Ht(u,n,'"glyphs" url must include a "{range}" token'))),g}function Za(t,n){void 0===n&&(n=Dt);var u=[];return u=u.concat(jn({key:"",value:t,valueSpec:n.$root,styleSpec:n,style:t,objectElementValidators:{glyphs:Va,"*":function(){return[]}}})),t.constants&&(u=u.concat(nr({key:"constants",value:t.constants,style:t,styleSpec:n}))),Ro(u)}function Ro(t){return[].concat(t).sort(function(n,u){return n.line-u.line})}function fo(t){return function(){for(var n=[],u=arguments.length;u--;)n[u]=arguments[u];return Ro(t.apply(this,n))}}Za.source=fo(Po),Za.light=fo(po),Za.layer=fo(bi),Za.filter=fo(ua),Za.paintProperty=fo(du),Za.layoutProperty=fo(Eo);var ts=Za,hs=ts.light,Bu=ts.paintProperty,tu=ts.layoutProperty;function _s(t,n){var u=!1;if(n&&n.length)for(var g=0,_=n;g<_.length;g+=1)t.fire(new me(new Error(_[g].message))),u=!0;return u}var ao=es;function es(t,n,u){var g=this.cells=[];if(t instanceof ArrayBuffer){this.arrayBuffer=t;var _=new Int32Array(this.arrayBuffer);t=_[0],this.d=(n=_[1])+2*(u=_[2]);for(var w=0;w<this.d*this.d;w++){var S=_[3+w],A=_[3+w+1];g.push(S===A?null:_.subarray(S,A))}var z=_[3+g.length+1];this.keys=_.subarray(_[3+g.length],z),this.bboxes=_.subarray(z),this.insert=this._insertReadonly}else{this.d=n+2*u;for(var q=0;q<this.d*this.d;q++)g.push([]);this.keys=[],this.bboxes=[]}this.n=n,this.extent=t,this.padding=u,this.scale=n/t,this.uid=0;var V=u/n*t;this.min=-V,this.max=t+V}es.prototype.insert=function(t,n,u,g,_){this._forEachCell(n,u,g,_,this._insertCell,this.uid++),this.keys.push(t),this.bboxes.push(n),this.bboxes.push(u),this.bboxes.push(g),this.bboxes.push(_)},es.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},es.prototype._insertCell=function(t,n,u,g,_,w){this.cells[_].push(w)},es.prototype.query=function(t,n,u,g,_){var w=this.min,S=this.max;if(t<=w&&n<=w&&S<=u&&S<=g&&!_)return Array.prototype.slice.call(this.keys);var A=[];return this._forEachCell(t,n,u,g,this._queryCell,A,{},_),A},es.prototype._queryCell=function(t,n,u,g,_,w,S,A){var z=this.cells[_];if(null!==z)for(var q=this.keys,V=this.bboxes,H=0;H<z.length;H++){var st=z[H];if(void 0===S[st]){var vt=4*st;(A?A(V[vt+0],V[vt+1],V[vt+2],V[vt+3]):t<=V[vt+2]&&n<=V[vt+3]&&u>=V[vt+0]&&g>=V[vt+1])?(S[st]=!0,w.push(q[st])):S[st]=!1}}},es.prototype._forEachCell=function(t,n,u,g,_,w,S,A){for(var z=this._convertToCellCoord(t),q=this._convertToCellCoord(n),V=this._convertToCellCoord(u),H=this._convertToCellCoord(g),st=z;st<=V;st++)for(var vt=q;vt<=H;vt++){var Rt=this.d*vt+st;if((!A||A(this._convertFromCellCoord(st),this._convertFromCellCoord(vt),this._convertFromCellCoord(st+1),this._convertFromCellCoord(vt+1)))&&_.call(this,t,n,u,g,Rt,w,S,A))return}},es.prototype._convertFromCellCoord=function(t){return(t-this.padding)/this.scale},es.prototype._convertToCellCoord=function(t){return Math.max(0,Math.min(this.d-1,Math.floor(t*this.scale)+this.padding))},es.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var t=this.cells,n=3+this.cells.length+1+1,u=0,g=0;g<this.cells.length;g++)u+=this.cells[g].length;var _=new Int32Array(n+u+this.keys.length+this.bboxes.length);_[0]=this.extent,_[1]=this.n,_[2]=this.padding;for(var w=n,S=0;S<t.length;S++){var A=t[S];_[3+S]=w,_.set(A,w),w+=A.length}return _[3+t.length]=w,_.set(this.keys,w),_[3+t.length+1]=w+=this.keys.length,_.set(this.bboxes,w),w+=this.bboxes.length,_.buffer};var ea=qt.ImageData,wa=qt.ImageBitmap,ra={};function _r(t,n,u){void 0===u&&(u={}),Object.defineProperty(n,"_classRegistryKey",{value:t,writeable:!1}),ra[t]={klass:n,omit:u.omit||[],shallow:u.shallow||[]}}for(var Ls in _r("Object",Object),ao.serialize=function(t,n){var u=t.toArrayBuffer();return n&&n.push(u),{buffer:u}},ao.deserialize=function(t){return new ao(t.buffer)},_r("Grid",ao),_r("Color",Hn),_r("Error",Error),_r("ResolvedImage",Wn),_r("StylePropertyFunction",dn),_r("StyleExpression",Ko,{omit:["_evaluator"]}),_r("ZoomDependentExpression",Ye),_r("ZoomConstantExpression",be),_r("CompoundExpression",oe,{omit:["_evaluate"]}),$s)$s[Ls]._classRegistryKey||_r("Expression_"+Ls,$s[Ls]);function Cu(t){return t&&typeof ArrayBuffer<"u"&&(t instanceof ArrayBuffer||t.constructor&&"ArrayBuffer"===t.constructor.name)}function gu(t){return wa&&t instanceof wa}function na(t,n){if(null==t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp)return t;if(Cu(t)||gu(t))return n&&n.push(t),t;if(ArrayBuffer.isView(t)){var u=t;return n&&n.push(u.buffer),u}if(t instanceof ea)return n&&n.push(t.data.buffer),t;if(Array.isArray(t)){for(var g=[],_=0,w=t;_<w.length;_+=1)g.push(na(w[_],n));return g}if("object"==typeof t){var S=t.constructor,A=S._classRegistryKey;if(!A)throw new Error("can't serialize object of unregistered class");var z=S.serialize?S.serialize(t,n):{};if(!S.serialize){for(var q in t)if(t.hasOwnProperty(q)&&!(ra[A].omit.indexOf(q)>=0)){var V=t[q];z[q]=ra[A].shallow.indexOf(q)>=0?V:na(V,n)}t instanceof Error&&(z.message=t.message)}if(z.$name)throw new Error("$name property is reserved for worker serialization logic.");return"Object"!==A&&(z.$name=A),z}throw new Error("can't serialize object of type "+typeof t)}function Lu(t){if(null==t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp||Cu(t)||gu(t)||ArrayBuffer.isView(t)||t instanceof ea)return t;if(Array.isArray(t))return t.map(Lu);if("object"==typeof t){var n=t.$name||"Object",u=ra[n].klass;if(!u)throw new Error("can't deserialize unregistered class "+n);if(u.deserialize)return u.deserialize(t);for(var g=Object.create(u.prototype),_=0,w=Object.keys(t);_<w.length;_+=1){var S=w[_];if("$name"!==S){var A=t[S];g[S]=ra[n].shallow.indexOf(S)>=0?A:Lu(A)}}return g}throw new Error("can't deserialize object of type "+typeof t)}var So=function(){this.first=!0};So.prototype.update=function(t,n){var u=Math.floor(t);return this.first?(this.first=!1,this.lastIntegerZoom=u,this.lastIntegerZoomTime=0,this.lastZoom=t,this.lastFloorZoom=u,!0):(this.lastFloorZoom>u?(this.lastIntegerZoom=u+1,this.lastIntegerZoomTime=n):this.lastFloorZoom<u&&(this.lastIntegerZoom=u,this.lastIntegerZoomTime=n),t!==this.lastZoom&&(this.lastZoom=t,this.lastFloorZoom=u,!0))};var Ir={"Latin-1 Supplement":function(t){return t>=128&&t<=255},Arabic:function(t){return t>=1536&&t<=1791},"Arabic Supplement":function(t){return t>=1872&&t<=1919},"Arabic Extended-A":function(t){return t>=2208&&t<=2303},"Hangul Jamo":function(t){return t>=4352&&t<=4607},"Unified Canadian Aboriginal Syllabics":function(t){return t>=5120&&t<=5759},Khmer:function(t){return t>=6016&&t<=6143},"Unified Canadian Aboriginal Syllabics Extended":function(t){return t>=6320&&t<=6399},"General Punctuation":function(t){return t>=8192&&t<=8303},"Letterlike Symbols":function(t){return t>=8448&&t<=8527},"Number Forms":function(t){return t>=8528&&t<=8591},"Miscellaneous Technical":function(t){return t>=8960&&t<=9215},"Control Pictures":function(t){return t>=9216&&t<=9279},"Optical Character Recognition":function(t){return t>=9280&&t<=9311},"Enclosed Alphanumerics":function(t){return t>=9312&&t<=9471},"Geometric Shapes":function(t){return t>=9632&&t<=9727},"Miscellaneous Symbols":function(t){return t>=9728&&t<=9983},"Miscellaneous Symbols and Arrows":function(t){return t>=11008&&t<=11263},"CJK Radicals Supplement":function(t){return t>=11904&&t<=12031},"Kangxi Radicals":function(t){return t>=12032&&t<=12255},"Ideographic Description Characters":function(t){return t>=12272&&t<=12287},"CJK Symbols and Punctuation":function(t){return t>=12288&&t<=12351},Hiragana:function(t){return t>=12352&&t<=12447},Katakana:function(t){return t>=12448&&t<=12543},Bopomofo:function(t){return t>=12544&&t<=12591},"Hangul Compatibility Jamo":function(t){return t>=12592&&t<=12687},Kanbun:function(t){return t>=12688&&t<=12703},"Bopomofo Extended":function(t){return t>=12704&&t<=12735},"CJK Strokes":function(t){return t>=12736&&t<=12783},"Katakana Phonetic Extensions":function(t){return t>=12784&&t<=12799},"Enclosed CJK Letters and Months":function(t){return t>=12800&&t<=13055},"CJK Compatibility":function(t){return t>=13056&&t<=13311},"CJK Unified Ideographs Extension A":function(t){return t>=13312&&t<=19903},"Yijing Hexagram Symbols":function(t){return t>=19904&&t<=19967},"CJK Unified Ideographs":function(t){return t>=19968&&t<=40959},"Yi Syllables":function(t){return t>=40960&&t<=42127},"Yi Radicals":function(t){return t>=42128&&t<=42191},"Hangul Jamo Extended-A":function(t){return t>=43360&&t<=43391},"Hangul Syllables":function(t){return t>=44032&&t<=55215},"Hangul Jamo Extended-B":function(t){return t>=55216&&t<=55295},"Private Use Area":function(t){return t>=57344&&t<=63743},"CJK Compatibility Ideographs":function(t){return t>=63744&&t<=64255},"Arabic Presentation Forms-A":function(t){return t>=64336&&t<=65023},"Vertical Forms":function(t){return t>=65040&&t<=65055},"CJK Compatibility Forms":function(t){return t>=65072&&t<=65103},"Small Form Variants":function(t){return t>=65104&&t<=65135},"Arabic Presentation Forms-B":function(t){return t>=65136&&t<=65279},"Halfwidth and Fullwidth Forms":function(t){return t>=65280&&t<=65519}};function Vo(t){for(var n=0,u=t;n<u.length;n+=1)if(jl(u[n].charCodeAt(0)))return!0;return!1}function jl(t){return!(746!==t&&747!==t&&(t<4352||!(Ir["Bopomofo Extended"](t)||Ir.Bopomofo(t)||Ir["CJK Compatibility Forms"](t)&&!(t>=65097&&t<=65103)||Ir["CJK Compatibility Ideographs"](t)||Ir["CJK Compatibility"](t)||Ir["CJK Radicals Supplement"](t)||Ir["CJK Strokes"](t)||!(!Ir["CJK Symbols and Punctuation"](t)||t>=12296&&t<=12305||t>=12308&&t<=12319||12336===t)||Ir["CJK Unified Ideographs Extension A"](t)||Ir["CJK Unified Ideographs"](t)||Ir["Enclosed CJK Letters and Months"](t)||Ir["Hangul Compatibility Jamo"](t)||Ir["Hangul Jamo Extended-A"](t)||Ir["Hangul Jamo Extended-B"](t)||Ir["Hangul Jamo"](t)||Ir["Hangul Syllables"](t)||Ir.Hiragana(t)||Ir["Ideographic Description Characters"](t)||Ir.Kanbun(t)||Ir["Kangxi Radicals"](t)||Ir["Katakana Phonetic Extensions"](t)||Ir.Katakana(t)&&12540!==t||!(!Ir["Halfwidth and Fullwidth Forms"](t)||65288===t||65289===t||65293===t||t>=65306&&t<=65310||65339===t||65341===t||65343===t||t>=65371&&t<=65503||65507===t||t>=65512&&t<=65519)||!(!Ir["Small Form Variants"](t)||t>=65112&&t<=65118||t>=65123&&t<=65126)||Ir["Unified Canadian Aboriginal Syllabics"](t)||Ir["Unified Canadian Aboriginal Syllabics Extended"](t)||Ir["Vertical Forms"](t)||Ir["Yijing Hexagram Symbols"](t)||Ir["Yi Syllables"](t)||Ir["Yi Radicals"](t))))}function eu(t){return!(jl(t)||(n=t,Ir["Latin-1 Supplement"](n)&&(167===n||169===n||174===n||177===n||188===n||189===n||190===n||215===n||247===n)||Ir["General Punctuation"](n)&&(8214===n||8224===n||8225===n||8240===n||8241===n||8251===n||8252===n||8258===n||8263===n||8264===n||8265===n||8273===n)||Ir["Letterlike Symbols"](n)||Ir["Number Forms"](n)||Ir["Miscellaneous Technical"](n)&&(n>=8960&&n<=8967||n>=8972&&n<=8991||n>=8996&&n<=9e3||9003===n||n>=9085&&n<=9114||n>=9150&&n<=9165||9167===n||n>=9169&&n<=9179||n>=9186&&n<=9215)||Ir["Control Pictures"](n)&&9251!==n||Ir["Optical Character Recognition"](n)||Ir["Enclosed Alphanumerics"](n)||Ir["Geometric Shapes"](n)||Ir["Miscellaneous Symbols"](n)&&!(n>=9754&&n<=9759)||Ir["Miscellaneous Symbols and Arrows"](n)&&(n>=11026&&n<=11055||n>=11088&&n<=11097||n>=11192&&n<=11243)||Ir["CJK Symbols and Punctuation"](n)||Ir.Katakana(n)||Ir["Private Use Area"](n)||Ir["CJK Compatibility Forms"](n)||Ir["Small Form Variants"](n)||Ir["Halfwidth and Fullwidth Forms"](n)||8734===n||8756===n||8757===n||n>=9984&&n<=10087||n>=10102&&n<=10131||65532===n||65533===n));var n}function Co(t){return t>=1424&&t<=2303||Ir["Arabic Presentation Forms-A"](t)||Ir["Arabic Presentation Forms-B"](t)}function Du(t,n){return!(!n&&Co(t)||t>=2304&&t<=3583||t>=3840&&t<=4255||Ir.Khmer(t))}function lc(t){for(var n=0,u=t;n<u.length;n+=1)if(Co(u[n].charCodeAt(0)))return!0;return!1}var nl=null,ga="unavailable",Zo=null,ja=function(t){t&&"string"==typeof t&&t.indexOf("NetworkError")>-1&&(ga="error"),nl&&nl(t)};function ul(){rs.fire(new ae("pluginStateChange",{pluginStatus:ga,pluginURL:Zo}))}var rs=new ue,Xs=function(){return ga},Xl=function(){if("deferred"!==ga||!Zo)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");ga="loading",ul(),Zo&&oi({url:Zo},function(t){t?ja(t):(ga="loaded",ul())})},ui={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:function(){return"loaded"===ga||null!=ui.applyArabicShaping},isLoading:function(){return"loading"===ga},setState:function(t){ga=t.pluginStatus,Zo=t.pluginURL},isParsed:function(){return null!=ui.applyArabicShaping&&null!=ui.processBidirectionalText&&null!=ui.processStyledBidirectionalText},getPluginURL:function(){return Zo}},so=function(t,n){this.zoom=t,n?(this.now=n.now,this.fadeDuration=n.fadeDuration,this.zoomHistory=n.zoomHistory,this.transition=n.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new So,this.transition={})};so.prototype.isSupportedScript=function(t){return function(n,u){for(var g=0,_=n;g<_.length;g+=1)if(!Du(_[g].charCodeAt(0),u))return!1;return!0}(t,ui.isLoaded())},so.prototype.crossFadingFactor=function(){return 0===this.fadeDuration?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)},so.prototype.getCrossfadeParameters=function(){var t=this.zoom,n=t-Math.floor(t),u=this.crossFadingFactor();return t>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:n+(1-n)*u}:{fromScale:.5,toScale:1,t:1-(1-u)*n}};var ka=function(t,n){this.property=t,this.value=n,this.expression=function(u,g){if(qa(u))return new dn(u,g);if(ms(u)){var _=dr(u,g);if("error"===_.result)throw new Error(_.value.map(function(S){return S.key+": "+S.message}).join(", "));return _.value}var w=u;return"string"==typeof u&&"color"===g.type&&(w=Hn.parse(u)),{kind:"constant",evaluate:function(){return w}}}(void 0===n?t.specification.default:n,t.specification)};ka.prototype.isDataDriven=function(){return"source"===this.expression.kind||"composite"===this.expression.kind},ka.prototype.possiblyEvaluate=function(t,n,u){return this.property.possiblyEvaluate(this,t,n,u)};var ru=function(t){this.property=t,this.value=new ka(t,void 0)};ru.prototype.transitioned=function(t,n){return new Il(this.property,this.value,n,j({},t.transition,this.transition),t.now)},ru.prototype.untransitioned=function(){return new Il(this.property,this.value,null,{},0)};var Ds=function(t){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues)};Ds.prototype.getValue=function(t){return Z(this._values[t].value.value)},Ds.prototype.setValue=function(t,n){this._values.hasOwnProperty(t)||(this._values[t]=new ru(this._values[t].property)),this._values[t].value=new ka(this._values[t].property,null===n?void 0:Z(n))},Ds.prototype.getTransition=function(t){return Z(this._values[t].transition)},Ds.prototype.setTransition=function(t,n){this._values.hasOwnProperty(t)||(this._values[t]=new ru(this._values[t].property)),this._values[t].transition=Z(n)||void 0},Ds.prototype.serialize=function(){for(var t={},n=0,u=Object.keys(this._values);n<u.length;n+=1){var g=u[n],_=this.getValue(g);void 0!==_&&(t[g]=_);var w=this.getTransition(g);void 0!==w&&(t[g+"-transition"]=w)}return t},Ds.prototype.transitioned=function(t,n){for(var u=new Uu(this._properties),g=0,_=Object.keys(this._values);g<_.length;g+=1){var w=_[g];u._values[w]=this._values[w].transitioned(t,n._values[w])}return u},Ds.prototype.untransitioned=function(){for(var t=new Uu(this._properties),n=0,u=Object.keys(this._values);n<u.length;n+=1){var g=u[n];t._values[g]=this._values[g].untransitioned()}return t};var Il=function(t,n,u,g,_){this.property=t,this.value=n,this.begin=_+g.delay||0,this.end=this.begin+g.duration||0,t.specification.transition&&(g.delay||g.duration)&&(this.prior=u)};Il.prototype.possiblyEvaluate=function(t,n,u){var g=t.now||0,_=this.value.possiblyEvaluate(t,n,u),w=this.prior;if(w){if(g>this.end)return this.prior=null,_;if(this.value.isDataDriven())return this.prior=null,_;if(g<this.begin)return w.possiblyEvaluate(t,n,u);var S=(g-this.begin)/(this.end-this.begin);return this.property.interpolate(w.possiblyEvaluate(t,n,u),_,function(A){if(A<=0)return 0;if(A>=1)return 1;var z=A*A,q=z*A;return 4*(A<.5?q:3*(A-z)+q-.75)}(S))}return _};var Uu=function(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)};Uu.prototype.possiblyEvaluate=function(t,n,u){for(var g=new mu(this._properties),_=0,w=Object.keys(this._values);_<w.length;_+=1){var S=w[_];g._values[S]=this._values[S].possiblyEvaluate(t,n,u)}return g},Uu.prototype.hasTransition=function(){for(var t=0,n=Object.keys(this._values);t<n.length;t+=1)if(this._values[n[t]].prior)return!0;return!1};var xs=function(t){this._properties=t,this._values=Object.create(t.defaultPropertyValues)};xs.prototype.getValue=function(t){return Z(this._values[t].value)},xs.prototype.setValue=function(t,n){this._values[t]=new ka(this._values[t].property,null===n?void 0:Z(n))},xs.prototype.serialize=function(){for(var t={},n=0,u=Object.keys(this._values);n<u.length;n+=1){var g=u[n],_=this.getValue(g);void 0!==_&&(t[g]=_)}return t},xs.prototype.possiblyEvaluate=function(t,n,u){for(var g=new mu(this._properties),_=0,w=Object.keys(this._values);_<w.length;_+=1){var S=w[_];g._values[S]=this._values[S].possiblyEvaluate(t,n,u)}return g};var ps=function(t,n,u){this.property=t,this.value=n,this.parameters=u};ps.prototype.isConstant=function(){return"constant"===this.value.kind},ps.prototype.constantOr=function(t){return"constant"===this.value.kind?this.value.value:t},ps.prototype.evaluate=function(t,n,u,g){return this.property.evaluate(this.value,this.parameters,t,n,u,g)};var mu=function(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)};mu.prototype.get=function(t){return this._values[t]};var Dr=function(t){this.specification=t};Dr.prototype.possiblyEvaluate=function(t,n){return t.expression.evaluate(n)},Dr.prototype.interpolate=function(t,n,u){var g=sa[this.specification.type];return g?g(t,n,u):t};var cn=function(t,n){this.specification=t,this.overrides=n};cn.prototype.possiblyEvaluate=function(t,n,u,g){return new ps(this,"constant"===t.expression.kind||"camera"===t.expression.kind?{kind:"constant",value:t.expression.evaluate(n,null,{},u,g)}:t.expression,n)},cn.prototype.interpolate=function(t,n,u){if("constant"!==t.value.kind||"constant"!==n.value.kind)return t;if(void 0===t.value.value||void 0===n.value.value)return new ps(this,{kind:"constant",value:void 0},t.parameters);var g=sa[this.specification.type];return g?new ps(this,{kind:"constant",value:g(t.value.value,n.value.value,u)},t.parameters):t},cn.prototype.evaluate=function(t,n,u,g,_,w){return"constant"===t.kind?t.value:t.evaluate(n,u,g,_,w)};var Ea=function(t){function n(){t.apply(this,arguments)}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n.prototype.possiblyEvaluate=function(u,g,_,w){if(void 0===u.value)return new ps(this,{kind:"constant",value:void 0},g);if("constant"===u.expression.kind){var S=u.expression.evaluate(g,null,{},_,w),A="resolvedImage"===u.property.specification.type&&"string"!=typeof S?S.name:S,z=this._calculate(A,A,A,g);return new ps(this,{kind:"constant",value:z},g)}if("camera"===u.expression.kind){var q=this._calculate(u.expression.evaluate({zoom:g.zoom-1}),u.expression.evaluate({zoom:g.zoom}),u.expression.evaluate({zoom:g.zoom+1}),g);return new ps(this,{kind:"constant",value:q},g)}return new ps(this,u.expression,g)},n.prototype.evaluate=function(u,g,_,w,S,A){if("source"===u.kind){var z=u.evaluate(g,_,w,S,A);return this._calculate(z,z,z,g)}return"composite"===u.kind?this._calculate(u.evaluate({zoom:Math.floor(g.zoom)-1},_,w),u.evaluate({zoom:Math.floor(g.zoom)},_,w),u.evaluate({zoom:Math.floor(g.zoom)+1},_,w),g):u.value},n.prototype._calculate=function(u,g,_,w){return w.zoom>w.zoomHistory.lastIntegerZoom?{from:u,to:g}:{from:_,to:g}},n.prototype.interpolate=function(u){return u},n}(cn),Os=function(t){this.specification=t};Os.prototype.possiblyEvaluate=function(t,n,u,g){if(void 0!==t.value){if("constant"===t.expression.kind){var _=t.expression.evaluate(n,null,{},u,g);return this._calculate(_,_,_,n)}return this._calculate(t.expression.evaluate(new so(Math.floor(n.zoom-1),n)),t.expression.evaluate(new so(Math.floor(n.zoom),n)),t.expression.evaluate(new so(Math.floor(n.zoom+1),n)),n)}},Os.prototype._calculate=function(t,n,u,g){return g.zoom>g.zoomHistory.lastIntegerZoom?{from:t,to:n}:{from:u,to:n}},Os.prototype.interpolate=function(t){return t};var Ys=function(t){this.specification=t};Ys.prototype.possiblyEvaluate=function(t,n,u,g){return!!t.expression.evaluate(n,null,{},u,g)},Ys.prototype.interpolate=function(){return!1};var Sa=function(t){for(var n in this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[],t){var u=t[n];u.specification.overridable&&this.overridableProperties.push(n);var g=this.defaultPropertyValues[n]=new ka(u,void 0),_=this.defaultTransitionablePropertyValues[n]=new ru(u);this.defaultTransitioningPropertyValues[n]=_.untransitioned(),this.defaultPossiblyEvaluatedValues[n]=g.possiblyEvaluate({})}};_r("DataDrivenProperty",cn),_r("DataConstantProperty",Dr),_r("CrossFadedDataDrivenProperty",Ea),_r("CrossFadedProperty",Os),_r("ColorRampProperty",Ys);var hn=function(t){function n(u,g){if(t.call(this),this.id=u.id,this.type=u.type,this._featureFilter={filter:function(){return!0},needGeometry:!1},"custom"!==u.type&&(this.metadata=u.metadata,this.minzoom=u.minzoom,this.maxzoom=u.maxzoom,"background"!==u.type&&(this.source=u.source,this.sourceLayer=u["source-layer"],this.filter=u.filter),g.layout&&(this._unevaluatedLayout=new xs(g.layout)),g.paint)){for(var _ in this._transitionablePaint=new Ds(g.paint),u.paint)this.setPaintProperty(_,u.paint[_],{validate:!1});for(var w in u.layout)this.setLayoutProperty(w,u.layout[w],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new mu(g.paint)}}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n.prototype.getCrossfadeParameters=function(){return this._crossfadeParameters},n.prototype.getLayoutProperty=function(u){return"visibility"===u?this.visibility:this._unevaluatedLayout.getValue(u)},n.prototype.setLayoutProperty=function(u,g,_){void 0===_&&(_={}),null!=g&&this._validate(tu,"layers."+this.id+".layout."+u,u,g,_)||("visibility"!==u?this._unevaluatedLayout.setValue(u,g):this.visibility=g)},n.prototype.getPaintProperty=function(u){return J(u,"-transition")?this._transitionablePaint.getTransition(u.slice(0,-11)):this._transitionablePaint.getValue(u)},n.prototype.setPaintProperty=function(u,g,_){if(void 0===_&&(_={}),null!=g&&this._validate(Bu,"layers."+this.id+".paint."+u,u,g,_))return!1;if(J(u,"-transition"))return this._transitionablePaint.setTransition(u.slice(0,-11),g||void 0),!1;var w=this._transitionablePaint._values[u],S="cross-faded-data-driven"===w.property.specification["property-type"],A=w.value.isDataDriven(),z=w.value;this._transitionablePaint.setValue(u,g),this._handleSpecialPaintPropertyUpdate(u);var q=this._transitionablePaint._values[u].value;return q.isDataDriven()||A||S||this._handleOverridablePaintPropertyUpdate(u,z,q)},n.prototype._handleSpecialPaintPropertyUpdate=function(u){},n.prototype._handleOverridablePaintPropertyUpdate=function(u,g,_){return!1},n.prototype.isHidden=function(u){return!!(this.minzoom&&u<this.minzoom)||!!(this.maxzoom&&u>=this.maxzoom)||"none"===this.visibility},n.prototype.updateTransitions=function(u){this._transitioningPaint=this._transitionablePaint.transitioned(u,this._transitioningPaint)},n.prototype.hasTransition=function(){return this._transitioningPaint.hasTransition()},n.prototype.recalculate=function(u,g){u.getCrossfadeParameters&&(this._crossfadeParameters=u.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(u,void 0,g)),this.paint=this._transitioningPaint.possiblyEvaluate(u,void 0,g)},n.prototype.serialize=function(){var u={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(u.layout=u.layout||{},u.layout.visibility=this.visibility),at(u,function(g,_){return!(void 0===g||"layout"===_&&!Object.keys(g).length||"paint"===_&&!Object.keys(g).length)})},n.prototype._validate=function(u,g,_,w,S){return void 0===S&&(S={}),(!S||!1!==S.validate)&&_s(this,u.call(ts,{key:g,layerType:this.type,objectKey:_,value:w,styleSpec:Dt,style:{glyphs:!0,sprite:!0}}))},n.prototype.is3D=function(){return!1},n.prototype.isTileClipped=function(){return!1},n.prototype.hasOffscreenPass=function(){return!1},n.prototype.resize=function(){},n.prototype.isStateDependent=function(){for(var u in this.paint._values){var g=this.paint.get(u);if(g instanceof ps&&hi(g.property.specification)&&("source"===g.value.kind||"composite"===g.value.kind)&&g.value.isStateDependent)return!0}return!1},n}(ue),il={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},bs=function(t,n){this._structArray=t,this._pos1=n*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8},Vi=function(){this.isTransferred=!1,this.capacity=-1,this.resize(0)};function yo(t,n){void 0===n&&(n=1);var u=0,g=0;return{members:t.map(function(_){var w=il[_.type].BYTES_PER_ELEMENT,S=u=cc(u,Math.max(n,w)),A=_.components||1;return g=Math.max(g,w),u+=w*A,{name:_.name,type:_.type,components:A,offset:S}}),size:cc(u,Math.max(g,n)),alignment:n}}function cc(t,n){return Math.ceil(t/n)*n}Vi.serialize=function(t,n){return t._trim(),n&&(t.isTransferred=!0,n.push(t.arrayBuffer)),{length:t.length,arrayBuffer:t.arrayBuffer}},Vi.deserialize=function(t){var n=Object.create(this.prototype);return n.arrayBuffer=t.arrayBuffer,n.length=t.length,n.capacity=t.arrayBuffer.byteLength/n.bytesPerElement,n._refreshViews(),n},Vi.prototype._trim=function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())},Vi.prototype.clear=function(){this.length=0},Vi.prototype.resize=function(t){this.reserve(t),this.length=t},Vi.prototype.reserve=function(t){if(t>this.capacity){this.capacity=Math.max(t,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var n=this.uint8;this._refreshViews(),n&&this.uint8.set(n)}},Vi.prototype._refreshViews=function(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")};var fs=function(t){function n(){t.apply(this,arguments)}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},n.prototype.emplaceBack=function(u,g){var _=this.length;return this.resize(_+1),this.emplace(_,u,g)},n.prototype.emplace=function(u,g,_){var w=2*u;return this.int16[w+0]=g,this.int16[w+1]=_,u},n}(Vi);fs.prototype.bytesPerElement=4,_r("StructArrayLayout2i4",fs);var Io=function(t){function n(){t.apply(this,arguments)}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},n.prototype.emplaceBack=function(u,g,_,w){var S=this.length;return this.resize(S+1),this.emplace(S,u,g,_,w)},n.prototype.emplace=function(u,g,_,w,S){var A=4*u;return this.int16[A+0]=g,this.int16[A+1]=_,this.int16[A+2]=w,this.int16[A+3]=S,u},n}(Vi);Io.prototype.bytesPerElement=8,_r("StructArrayLayout4i8",Io);var Js=function(t){function n(){t.apply(this,arguments)}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},n.prototype.emplaceBack=function(u,g,_,w,S,A){var z=this.length;return this.resize(z+1),this.emplace(z,u,g,_,w,S,A)},n.prototype.emplace=function(u,g,_,w,S,A,z){var q=6*u;return this.int16[q+0]=g,this.int16[q+1]=_,this.int16[q+2]=w,this.int16[q+3]=S,this.int16[q+4]=A,this.int16[q+5]=z,u},n}(Vi);Js.prototype.bytesPerElement=12,_r("StructArrayLayout2i4i12",Js);var ll=function(t){function n(){t.apply(this,arguments)}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},n.prototype.emplaceBack=function(u,g,_,w,S,A){var z=this.length;return this.resize(z+1),this.emplace(z,u,g,_,w,S,A)},n.prototype.emplace=function(u,g,_,w,S,A,z){var q=4*u,V=8*u;return this.int16[q+0]=g,this.int16[q+1]=_,this.uint8[V+4]=w,this.uint8[V+5]=S,this.uint8[V+6]=A,this.uint8[V+7]=z,u},n}(Vi);ll.prototype.bytesPerElement=8,_r("StructArrayLayout2i4ub8",ll);var e=function(t){function n(){t.apply(this,arguments)}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},n.prototype.emplaceBack=function(u,g){var _=this.length;return this.resize(_+1),this.emplace(_,u,g)},n.prototype.emplace=function(u,g,_){var w=2*u;return this.float32[w+0]=g,this.float32[w+1]=_,u},n}(Vi);e.prototype.bytesPerElement=8,_r("StructArrayLayout2f8",e);var i=function(t){function n(){t.apply(this,arguments)}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},n.prototype.emplaceBack=function(u,g,_,w,S,A,z,q,V,H){var st=this.length;return this.resize(st+1),this.emplace(st,u,g,_,w,S,A,z,q,V,H)},n.prototype.emplace=function(u,g,_,w,S,A,z,q,V,H,st){var vt=10*u;return this.uint16[vt+0]=g,this.uint16[vt+1]=_,this.uint16[vt+2]=w,this.uint16[vt+3]=S,this.uint16[vt+4]=A,this.uint16[vt+5]=z,this.uint16[vt+6]=q,this.uint16[vt+7]=V,this.uint16[vt+8]=H,this.uint16[vt+9]=st,u},n}(Vi);i.prototype.bytesPerElement=20,_r("StructArrayLayout10ui20",i);var h=function(t){function n(){t.apply(this,arguments)}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},n.prototype.emplaceBack=function(u,g,_,w,S,A,z,q,V,H,st,vt){var Rt=this.length;return this.resize(Rt+1),this.emplace(Rt,u,g,_,w,S,A,z,q,V,H,st,vt)},n.prototype.emplace=function(u,g,_,w,S,A,z,q,V,H,st,vt,Rt){var Vt=12*u;return this.int16[Vt+0]=g,this.int16[Vt+1]=_,this.int16[Vt+2]=w,this.int16[Vt+3]=S,this.uint16[Vt+4]=A,this.uint16[Vt+5]=z,this.uint16[Vt+6]=q,this.uint16[Vt+7]=V,this.int16[Vt+8]=H,this.int16[Vt+9]=st,this.int16[Vt+10]=vt,this.int16[Vt+11]=Rt,u},n}(Vi);h.prototype.bytesPerElement=24,_r("StructArrayLayout4i4ui4i24",h);var d=function(t){function n(){t.apply(this,arguments)}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},n.prototype.emplaceBack=function(u,g,_){var w=this.length;return this.resize(w+1),this.emplace(w,u,g,_)},n.prototype.emplace=function(u,g,_,w){var S=3*u;return this.float32[S+0]=g,this.float32[S+1]=_,this.float32[S+2]=w,u},n}(Vi);d.prototype.bytesPerElement=12,_r("StructArrayLayout3f12",d);var x=function(t){function n(){t.apply(this,arguments)}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)},n.prototype.emplaceBack=function(u){var g=this.length;return this.resize(g+1),this.emplace(g,u)},n.prototype.emplace=function(u,g){return this.uint32[1*u+0]=g,u},n}(Vi);x.prototype.bytesPerElement=4,_r("StructArrayLayout1ul4",x);var D=function(t){function n(){t.apply(this,arguments)}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},n.prototype.emplaceBack=function(u,g,_,w,S,A,z,q,V){var H=this.length;return this.resize(H+1),this.emplace(H,u,g,_,w,S,A,z,q,V)},n.prototype.emplace=function(u,g,_,w,S,A,z,q,V,H){var st=10*u,vt=5*u;return this.int16[st+0]=g,this.int16[st+1]=_,this.int16[st+2]=w,this.int16[st+3]=S,this.int16[st+4]=A,this.int16[st+5]=z,this.uint32[vt+3]=q,this.uint16[st+8]=V,this.uint16[st+9]=H,u},n}(Vi);D.prototype.bytesPerElement=20,_r("StructArrayLayout6i1ul2ui20",D);var F=function(t){function n(){t.apply(this,arguments)}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},n.prototype.emplaceBack=function(u,g,_,w,S,A){var z=this.length;return this.resize(z+1),this.emplace(z,u,g,_,w,S,A)},n.prototype.emplace=function(u,g,_,w,S,A,z){var q=6*u;return this.int16[q+0]=g,this.int16[q+1]=_,this.int16[q+2]=w,this.int16[q+3]=S,this.int16[q+4]=A,this.int16[q+5]=z,u},n}(Vi);F.prototype.bytesPerElement=12,_r("StructArrayLayout2i2i2i12",F);var $=function(t){function n(){t.apply(this,arguments)}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},n.prototype.emplaceBack=function(u,g,_,w,S){var A=this.length;return this.resize(A+1),this.emplace(A,u,g,_,w,S)},n.prototype.emplace=function(u,g,_,w,S,A){var z=4*u,q=8*u;return this.float32[z+0]=g,this.float32[z+1]=_,this.float32[z+2]=w,this.int16[q+6]=S,this.int16[q+7]=A,u},n}(Vi);$.prototype.bytesPerElement=16,_r("StructArrayLayout2f1f2i16",$);var Ct=function(t){function n(){t.apply(this,arguments)}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},n.prototype.emplaceBack=function(u,g,_,w){var S=this.length;return this.resize(S+1),this.emplace(S,u,g,_,w)},n.prototype.emplace=function(u,g,_,w,S){var A=12*u,z=3*u;return this.uint8[A+0]=g,this.uint8[A+1]=_,this.float32[z+1]=w,this.float32[z+2]=S,u},n}(Vi);Ct.prototype.bytesPerElement=12,_r("StructArrayLayout2ub2f12",Ct);var te=function(t){function n(){t.apply(this,arguments)}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},n.prototype.emplaceBack=function(u,g,_){var w=this.length;return this.resize(w+1),this.emplace(w,u,g,_)},n.prototype.emplace=function(u,g,_,w){var S=3*u;return this.uint16[S+0]=g,this.uint16[S+1]=_,this.uint16[S+2]=w,u},n}(Vi);te.prototype.bytesPerElement=6,_r("StructArrayLayout3ui6",te);var Ne=function(t){function n(){t.apply(this,arguments)}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},n.prototype.emplaceBack=function(u,g,_,w,S,A,z,q,V,H,st,vt,Rt,Vt,he,re,we){var Pe=this.length;return this.resize(Pe+1),this.emplace(Pe,u,g,_,w,S,A,z,q,V,H,st,vt,Rt,Vt,he,re,we)},n.prototype.emplace=function(u,g,_,w,S,A,z,q,V,H,st,vt,Rt,Vt,he,re,we,Pe){var Re=24*u,ze=12*u,rr=48*u;return this.int16[Re+0]=g,this.int16[Re+1]=_,this.uint16[Re+2]=w,this.uint16[Re+3]=S,this.uint32[ze+2]=A,this.uint32[ze+3]=z,this.uint32[ze+4]=q,this.uint16[Re+10]=V,this.uint16[Re+11]=H,this.uint16[Re+12]=st,this.float32[ze+7]=vt,this.float32[ze+8]=Rt,this.uint8[rr+36]=Vt,this.uint8[rr+37]=he,this.uint8[rr+38]=re,this.uint32[ze+10]=we,this.int16[Re+22]=Pe,u},n}(Vi);Ne.prototype.bytesPerElement=48,_r("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",Ne);var Ve=function(t){function n(){t.apply(this,arguments)}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},n.prototype.emplaceBack=function(u,g,_,w,S,A,z,q,V,H,st,vt,Rt,Vt,he,re,we,Pe,Re,ze,rr,yr,Mr,Wr,Tr,ln,Fr,ii){var Pn=this.length;return this.resize(Pn+1),this.emplace(Pn,u,g,_,w,S,A,z,q,V,H,st,vt,Rt,Vt,he,re,we,Pe,Re,ze,rr,yr,Mr,Wr,Tr,ln,Fr,ii)},n.prototype.emplace=function(u,g,_,w,S,A,z,q,V,H,st,vt,Rt,Vt,he,re,we,Pe,Re,ze,rr,yr,Mr,Wr,Tr,ln,Fr,ii,Pn){var Jr=34*u,fi=17*u;return this.int16[Jr+0]=g,this.int16[Jr+1]=_,this.int16[Jr+2]=w,this.int16[Jr+3]=S,this.int16[Jr+4]=A,this.int16[Jr+5]=z,this.int16[Jr+6]=q,this.int16[Jr+7]=V,this.uint16[Jr+8]=H,this.uint16[Jr+9]=st,this.uint16[Jr+10]=vt,this.uint16[Jr+11]=Rt,this.uint16[Jr+12]=Vt,this.uint16[Jr+13]=he,this.uint16[Jr+14]=re,this.uint16[Jr+15]=we,this.uint16[Jr+16]=Pe,this.uint16[Jr+17]=Re,this.uint16[Jr+18]=ze,this.uint16[Jr+19]=rr,this.uint16[Jr+20]=yr,this.uint16[Jr+21]=Mr,this.uint16[Jr+22]=Wr,this.uint32[fi+12]=Tr,this.float32[fi+13]=ln,this.float32[fi+14]=Fr,this.float32[fi+15]=ii,this.float32[fi+16]=Pn,u},n}(Vi);Ve.prototype.bytesPerElement=68,_r("StructArrayLayout8i15ui1ul4f68",Ve);var gr=function(t){function n(){t.apply(this,arguments)}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},n.prototype.emplaceBack=function(u){var g=this.length;return this.resize(g+1),this.emplace(g,u)},n.prototype.emplace=function(u,g){return this.float32[1*u+0]=g,u},n}(Vi);gr.prototype.bytesPerElement=4,_r("StructArrayLayout1f4",gr);var Pr=function(t){function n(){t.apply(this,arguments)}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},n.prototype.emplaceBack=function(u,g,_){var w=this.length;return this.resize(w+1),this.emplace(w,u,g,_)},n.prototype.emplace=function(u,g,_,w){var S=3*u;return this.int16[S+0]=g,this.int16[S+1]=_,this.int16[S+2]=w,u},n}(Vi);Pr.prototype.bytesPerElement=6,_r("StructArrayLayout3i6",Pr);var Yr=function(t){function n(){t.apply(this,arguments)}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},n.prototype.emplaceBack=function(u,g,_){var w=this.length;return this.resize(w+1),this.emplace(w,u,g,_)},n.prototype.emplace=function(u,g,_,w){var S=4*u;return this.uint32[2*u+0]=g,this.uint16[S+2]=_,this.uint16[S+3]=w,u},n}(Vi);Yr.prototype.bytesPerElement=8,_r("StructArrayLayout1ul2ui8",Yr);var an=function(t){function n(){t.apply(this,arguments)}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},n.prototype.emplaceBack=function(u,g){var _=this.length;return this.resize(_+1),this.emplace(_,u,g)},n.prototype.emplace=function(u,g,_){var w=2*u;return this.uint16[w+0]=g,this.uint16[w+1]=_,u},n}(Vi);an.prototype.bytesPerElement=4,_r("StructArrayLayout2ui4",an);var Mi=function(t){function n(){t.apply(this,arguments)}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},n.prototype.emplaceBack=function(u){var g=this.length;return this.resize(g+1),this.emplace(g,u)},n.prototype.emplace=function(u,g){return this.uint16[1*u+0]=g,u},n}(Vi);Mi.prototype.bytesPerElement=2,_r("StructArrayLayout1ui2",Mi);var l=function(t){function n(){t.apply(this,arguments)}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},n.prototype.emplaceBack=function(u,g,_,w){var S=this.length;return this.resize(S+1),this.emplace(S,u,g,_,w)},n.prototype.emplace=function(u,g,_,w,S){var A=4*u;return this.float32[A+0]=g,this.float32[A+1]=_,this.float32[A+2]=w,this.float32[A+3]=S,u},n}(Vi);l.prototype.bytesPerElement=16,_r("StructArrayLayout4f16",l);var f=function(t){function n(){t.apply(this,arguments)}t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n;var u={anchorPointX:{configurable:!0},anchorPointY:{configurable:!0},x1:{configurable:!0},y1:{configurable:!0},x2:{configurable:!0},y2:{configurable:!0},featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0},anchorPoint:{configurable:!0}};return u.anchorPointX.get=function(){return this._structArray.int16[this._pos2+0]},u.anchorPointY.get=function(){return this._structArray.int16[this._pos2+1]},u.x1.get=function(){return this._structArray.int16[this._pos2+2]},u.y1.get=function(){return this._structArray.int16[this._pos2+3]},u.x2.get=function(){return this._structArray.int16[this._pos2+4]},u.y2.get=function(){return this._structArray.int16[this._pos2+5]},u.featureIndex.get=function(){return this._structArray.uint32[this._pos4+3]},u.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+8]},u.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+9]},u.anchorPoint.get=function(){return new Ft(this.anchorPointX,this.anchorPointY)},Object.defineProperties(n.prototype,u),n}(bs);f.prototype.size=20;var c=function(t){function n(){t.apply(this,arguments)}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n.prototype.get=function(u){return new f(this,u)},n}(D);_r("CollisionBoxArray",c);var m=function(t){function n(){t.apply(this,arguments)}t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n;var u={anchorX:{configurable:!0},anchorY:{configurable:!0},glyphStartIndex:{configurable:!0},numGlyphs:{configurable:!0},vertexStartIndex:{configurable:!0},lineStartIndex:{configurable:!0},lineLength:{configurable:!0},segment:{configurable:!0},lowerSize:{configurable:!0},upperSize:{configurable:!0},lineOffsetX:{configurable:!0},lineOffsetY:{configurable:!0},writingMode:{configurable:!0},placedOrientation:{configurable:!0},hidden:{configurable:!0},crossTileID:{configurable:!0},associatedIconIndex:{configurable:!0}};return u.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},u.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},u.glyphStartIndex.get=function(){return this._structArray.uint16[this._pos2+2]},u.numGlyphs.get=function(){return this._structArray.uint16[this._pos2+3]},u.vertexStartIndex.get=function(){return this._structArray.uint32[this._pos4+2]},u.lineStartIndex.get=function(){return this._structArray.uint32[this._pos4+3]},u.lineLength.get=function(){return this._structArray.uint32[this._pos4+4]},u.segment.get=function(){return this._structArray.uint16[this._pos2+10]},u.lowerSize.get=function(){return this._structArray.uint16[this._pos2+11]},u.upperSize.get=function(){return this._structArray.uint16[this._pos2+12]},u.lineOffsetX.get=function(){return this._structArray.float32[this._pos4+7]},u.lineOffsetY.get=function(){return this._structArray.float32[this._pos4+8]},u.writingMode.get=function(){return this._structArray.uint8[this._pos1+36]},u.placedOrientation.get=function(){return this._structArray.uint8[this._pos1+37]},u.placedOrientation.set=function(g){this._structArray.uint8[this._pos1+37]=g},u.hidden.get=function(){return this._structArray.uint8[this._pos1+38]},u.hidden.set=function(g){this._structArray.uint8[this._pos1+38]=g},u.crossTileID.get=function(){return this._structArray.uint32[this._pos4+10]},u.crossTileID.set=function(g){this._structArray.uint32[this._pos4+10]=g},u.associatedIconIndex.get=function(){return this._structArray.int16[this._pos2+22]},Object.defineProperties(n.prototype,u),n}(bs);m.prototype.size=48;var E=function(t){function n(){t.apply(this,arguments)}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n.prototype.get=function(u){return new m(this,u)},n}(Ne);_r("PlacedSymbolArray",E);var M=function(t){function n(){t.apply(this,arguments)}t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n;var u={anchorX:{configurable:!0},anchorY:{configurable:!0},rightJustifiedTextSymbolIndex:{configurable:!0},centerJustifiedTextSymbolIndex:{configurable:!0},leftJustifiedTextSymbolIndex:{configurable:!0},verticalPlacedTextSymbolIndex:{configurable:!0},placedIconSymbolIndex:{configurable:!0},verticalPlacedIconSymbolIndex:{configurable:!0},key:{configurable:!0},textBoxStartIndex:{configurable:!0},textBoxEndIndex:{configurable:!0},verticalTextBoxStartIndex:{configurable:!0},verticalTextBoxEndIndex:{configurable:!0},iconBoxStartIndex:{configurable:!0},iconBoxEndIndex:{configurable:!0},verticalIconBoxStartIndex:{configurable:!0},verticalIconBoxEndIndex:{configurable:!0},featureIndex:{configurable:!0},numHorizontalGlyphVertices:{configurable:!0},numVerticalGlyphVertices:{configurable:!0},numIconVertices:{configurable:!0},numVerticalIconVertices:{configurable:!0},useRuntimeCollisionCircles:{configurable:!0},crossTileID:{configurable:!0},textBoxScale:{configurable:!0},textOffset0:{configurable:!0},textOffset1:{configurable:!0},collisionCircleDiameter:{configurable:!0}};return u.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},u.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},u.rightJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+2]},u.centerJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+3]},u.leftJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+4]},u.verticalPlacedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+5]},u.placedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+6]},u.verticalPlacedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+7]},u.key.get=function(){return this._structArray.uint16[this._pos2+8]},u.textBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+9]},u.textBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+10]},u.verticalTextBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+11]},u.verticalTextBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+12]},u.iconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+13]},u.iconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+14]},u.verticalIconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+15]},u.verticalIconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+16]},u.featureIndex.get=function(){return this._structArray.uint16[this._pos2+17]},u.numHorizontalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+18]},u.numVerticalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+19]},u.numIconVertices.get=function(){return this._structArray.uint16[this._pos2+20]},u.numVerticalIconVertices.get=function(){return this._structArray.uint16[this._pos2+21]},u.useRuntimeCollisionCircles.get=function(){return this._structArray.uint16[this._pos2+22]},u.crossTileID.get=function(){return this._structArray.uint32[this._pos4+12]},u.crossTileID.set=function(g){this._structArray.uint32[this._pos4+12]=g},u.textBoxScale.get=function(){return this._structArray.float32[this._pos4+13]},u.textOffset0.get=function(){return this._structArray.float32[this._pos4+14]},u.textOffset1.get=function(){return this._structArray.float32[this._pos4+15]},u.collisionCircleDiameter.get=function(){return this._structArray.float32[this._pos4+16]},Object.defineProperties(n.prototype,u),n}(bs);M.prototype.size=68;var T=function(t){function n(){t.apply(this,arguments)}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n.prototype.get=function(u){return new M(this,u)},n}(Ve);_r("SymbolInstanceArray",T);var N=function(t){function n(){t.apply(this,arguments)}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n.prototype.getoffsetX=function(u){return this.float32[1*u+0]},n}(gr);_r("GlyphOffsetArray",N);var G=function(t){function n(){t.apply(this,arguments)}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n.prototype.getx=function(u){return this.int16[3*u+0]},n.prototype.gety=function(u){return this.int16[3*u+1]},n.prototype.gettileUnitDistanceFromAnchor=function(u){return this.int16[3*u+2]},n}(Pr);_r("SymbolLineVertexArray",G);var Q=function(t){function n(){t.apply(this,arguments)}t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n;var u={featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0}};return u.featureIndex.get=function(){return this._structArray.uint32[this._pos4+0]},u.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+2]},u.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+3]},Object.defineProperties(n.prototype,u),n}(bs);Q.prototype.size=8;var yt=function(t){function n(){t.apply(this,arguments)}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n.prototype.get=function(u){return new Q(this,u)},n}(Yr);_r("FeatureIndexArray",yt);var Et=yo([{name:"a_pos",components:2,type:"Int16"}],4).members,_t=function(t){void 0===t&&(t=[]),this.segments=t};function Xt(t,n){return 256*(t=Jt(Math.floor(t),0,255))+Jt(Math.floor(n),0,255)}_t.prototype.prepareSegment=function(t,n,u,g){var _=this.segments[this.segments.length-1];return t>_t.MAX_VERTEX_ARRAY_LENGTH&&St("Max vertices per segment is "+_t.MAX_VERTEX_ARRAY_LENGTH+": bucket requested "+t),(!_||_.vertexLength+t>_t.MAX_VERTEX_ARRAY_LENGTH||_.sortKey!==g)&&(_={vertexOffset:n.length,primitiveOffset:u.length,vertexLength:0,primitiveLength:0},void 0!==g&&(_.sortKey=g),this.segments.push(_)),_},_t.prototype.get=function(){return this.segments},_t.prototype.destroy=function(){for(var t=0,n=this.segments;t<n.length;t+=1){var u=n[t];for(var g in u.vaos)u.vaos[g].destroy()}},_t.simpleSegment=function(t,n,u,g){return new _t([{vertexOffset:t,primitiveOffset:n,vertexLength:u,primitiveLength:g,vaos:{},sortKey:0}])},_t.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,_r("SegmentVector",_t);var Gt=yo([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]),ie=lt(function(t){t.exports=function(n,u){var g,_,w,S,A,z,q,V;for(_=n.length-(g=3&n.length),w=u,A=3432918353,z=461845907,V=0;V<_;)q=255&n.charCodeAt(V)|(255&n.charCodeAt(++V))<<8|(255&n.charCodeAt(++V))<<16|(255&n.charCodeAt(++V))<<24,++V,w=27492+(65535&(S=5*(65535&(w=(w^=q=(65535&(q=(q=(65535&q)*A+(((q>>>16)*A&65535)<<16)&4294967295)<<15|q>>>17))*z+(((q>>>16)*z&65535)<<16)&4294967295)<<13|w>>>19))+((5*(w>>>16)&65535)<<16)&4294967295))+((58964+(S>>>16)&65535)<<16);switch(q=0,g){case 3:q^=(255&n.charCodeAt(V+2))<<16;case 2:q^=(255&n.charCodeAt(V+1))<<8;case 1:w^=q=(65535&(q=(q=(65535&(q^=255&n.charCodeAt(V)))*A+(((q>>>16)*A&65535)<<16)&4294967295)<<15|q>>>17))*z+(((q>>>16)*z&65535)<<16)&4294967295}return w^=n.length,w=2246822507*(65535&(w^=w>>>16))+((2246822507*(w>>>16)&65535)<<16)&4294967295,w=3266489909*(65535&(w^=w>>>13))+((3266489909*(w>>>16)&65535)<<16)&4294967295,(w^=w>>>16)>>>0}}),Zt=lt(function(t){t.exports=function(n,u){for(var g,_=n.length,w=u^_,S=0;_>=4;)g=1540483477*(65535&(g=255&n.charCodeAt(S)|(255&n.charCodeAt(++S))<<8|(255&n.charCodeAt(++S))<<16|(255&n.charCodeAt(++S))<<24))+((1540483477*(g>>>16)&65535)<<16),w=1540483477*(65535&w)+((1540483477*(w>>>16)&65535)<<16)^(g=1540483477*(65535&(g^=g>>>24))+((1540483477*(g>>>16)&65535)<<16)),_-=4,++S;switch(_){case 3:w^=(255&n.charCodeAt(S+2))<<16;case 2:w^=(255&n.charCodeAt(S+1))<<8;case 1:w=1540483477*(65535&(w^=255&n.charCodeAt(S)))+((1540483477*(w>>>16)&65535)<<16)}return w=1540483477*(65535&(w^=w>>>13))+((1540483477*(w>>>16)&65535)<<16),(w^=w>>>15)>>>0}}),ne=ie,ge=Zt;ne.murmur3=ie,ne.murmur2=ge;var Ee=function(){this.ids=[],this.positions=[],this.indexed=!1};Ee.prototype.add=function(t,n,u,g){this.ids.push(Fe(t)),this.positions.push(n,u,g)},Ee.prototype.getPositions=function(t){for(var n=Fe(t),u=0,g=this.ids.length-1;u<g;){var _=u+g>>1;this.ids[_]>=n?g=_:u=_+1}for(var w=[];this.ids[u]===n;)w.push({index:this.positions[3*u],start:this.positions[3*u+1],end:this.positions[3*u+2]}),u++;return w},Ee.serialize=function(t,n){var u=new Float64Array(t.ids),g=new Uint32Array(t.positions);return function _(w,S,A,z){for(;A<z;){for(var q=w[A+z>>1],V=A-1,H=z+1;;){do{V++}while(w[V]<q);do{H--}while(w[H]>q);if(V>=H)break;We(w,V,H),We(S,3*V,3*H),We(S,3*V+1,3*H+1),We(S,3*V+2,3*H+2)}H-A<z-H?(_(w,S,A,H),A=H+1):(_(w,S,H+1,z),z=H)}}(u,g,0,u.length-1),n&&n.push(u.buffer,g.buffer),{ids:u,positions:g}},Ee.deserialize=function(t){var n=new Ee;return n.ids=t.ids,n.positions=t.positions,n.indexed=!0,n};var Ue=Math.pow(2,53)-1;function Fe(t){var n=+t;return!isNaN(n)&&n<=Ue?n:ne(String(t))}function We(t,n,u){var g=t[n];t[n]=t[u],t[u]=g}_r("FeaturePositionMap",Ee);var er=function(t,n){this.gl=t.gl,this.location=n},br=function(t){function n(u,g){t.call(this,u,g),this.current=0}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n.prototype.set=function(u){this.current!==u&&(this.current=u,this.gl.uniform1i(this.location,u))},n}(er),fr=function(t){function n(u,g){t.call(this,u,g),this.current=0}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n.prototype.set=function(u){this.current!==u&&(this.current=u,this.gl.uniform1f(this.location,u))},n}(er),zr=function(t){function n(u,g){t.call(this,u,g),this.current=[0,0]}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n.prototype.set=function(u){u[0]===this.current[0]&&u[1]===this.current[1]||(this.current=u,this.gl.uniform2f(this.location,u[0],u[1]))},n}(er),nn=function(t){function n(u,g){t.call(this,u,g),this.current=[0,0,0]}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n.prototype.set=function(u){u[0]===this.current[0]&&u[1]===this.current[1]&&u[2]===this.current[2]||(this.current=u,this.gl.uniform3f(this.location,u[0],u[1],u[2]))},n}(er),sn=function(t){function n(u,g){t.call(this,u,g),this.current=[0,0,0,0]}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n.prototype.set=function(u){u[0]===this.current[0]&&u[1]===this.current[1]&&u[2]===this.current[2]&&u[3]===this.current[3]||(this.current=u,this.gl.uniform4f(this.location,u[0],u[1],u[2],u[3]))},n}(er),on=function(t){function n(u,g){t.call(this,u,g),this.current=Hn.transparent}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n.prototype.set=function(u){u.r===this.current.r&&u.g===this.current.g&&u.b===this.current.b&&u.a===this.current.a||(this.current=u,this.gl.uniform4f(this.location,u.r,u.g,u.b,u.a))},n}(er),wi=new Float32Array(16),Gr=function(t){function n(u,g){t.call(this,u,g),this.current=wi}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n.prototype.set=function(u){if(u[12]!==this.current[12]||u[0]!==this.current[0])return this.current=u,void this.gl.uniformMatrix4fv(this.location,!1,u);for(var g=1;g<16;g++)if(u[g]!==this.current[g]){this.current=u,this.gl.uniformMatrix4fv(this.location,!1,u);break}},n}(er);function Vn(t){return[Xt(255*t.r,255*t.g),Xt(255*t.b,255*t.a)]}var ti=function(t,n,u){this.value=t,this.uniformNames=n.map(function(g){return"u_"+g}),this.type=u};ti.prototype.setUniform=function(t,n,u){t.set(u.constantOr(this.value))},ti.prototype.getBinding=function(t,n,u){return"color"===this.type?new on(t,n):new fr(t,n)};var Zn=function(t,n){this.uniformNames=n.map(function(u){return"u_"+u}),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1};Zn.prototype.setConstantPatternPositions=function(t,n){this.pixelRatioFrom=n.pixelRatio,this.pixelRatioTo=t.pixelRatio,this.patternFrom=n.tlbr,this.patternTo=t.tlbr},Zn.prototype.setUniform=function(t,n,u,g){var _="u_pattern_to"===g?this.patternTo:"u_pattern_from"===g?this.patternFrom:"u_pixel_ratio_to"===g?this.pixelRatioTo:"u_pixel_ratio_from"===g?this.pixelRatioFrom:null;_&&t.set(_)},Zn.prototype.getBinding=function(t,n,u){return"u_pattern"===u.substr(0,9)?new sn(t,n):new fr(t,n)};var Nn=function(t,n,u,g){this.expression=t,this.type=u,this.maxValue=0,this.paintVertexAttributes=n.map(function(_){return{name:"a_"+_,type:"Float32",components:"color"===u?2:1,offset:0}}),this.paintVertexArray=new g};Nn.prototype.populatePaintArray=function(t,n,u,g,_){var w=this.paintVertexArray.length,S=this.expression.evaluate(new so(0),n,{},g,[],_);this.paintVertexArray.resize(t),this._setPaintValue(w,t,S)},Nn.prototype.updatePaintArray=function(t,n,u,g){var _=this.expression.evaluate({zoom:0},u,g);this._setPaintValue(t,n,_)},Nn.prototype._setPaintValue=function(t,n,u){if("color"===this.type)for(var g=Vn(u),_=t;_<n;_++)this.paintVertexArray.emplace(_,g[0],g[1]);else{for(var w=t;w<n;w++)this.paintVertexArray.emplace(w,u);this.maxValue=Math.max(this.maxValue,Math.abs(u))}},Nn.prototype.upload=function(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},Nn.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()};var On=function(t,n,u,g,_,w){this.expression=t,this.uniformNames=n.map(function(S){return"u_"+S+"_t"}),this.type=u,this.useIntegerZoom=g,this.zoom=_,this.maxValue=0,this.paintVertexAttributes=n.map(function(S){return{name:"a_"+S,type:"Float32",components:"color"===u?4:2,offset:0}}),this.paintVertexArray=new w};On.prototype.populatePaintArray=function(t,n,u,g,_){var w=this.expression.evaluate(new so(this.zoom),n,{},g,[],_),S=this.expression.evaluate(new so(this.zoom+1),n,{},g,[],_),A=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValue(A,t,w,S)},On.prototype.updatePaintArray=function(t,n,u,g){var _=this.expression.evaluate({zoom:this.zoom},u,g),w=this.expression.evaluate({zoom:this.zoom+1},u,g);this._setPaintValue(t,n,_,w)},On.prototype._setPaintValue=function(t,n,u,g){if("color"===this.type)for(var _=Vn(u),w=Vn(g),S=t;S<n;S++)this.paintVertexArray.emplace(S,_[0],_[1],w[0],w[1]);else{for(var A=t;A<n;A++)this.paintVertexArray.emplace(A,u,g);this.maxValue=Math.max(this.maxValue,Math.abs(u),Math.abs(g))}},On.prototype.upload=function(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},On.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},On.prototype.setUniform=function(t,n){var u=this.useIntegerZoom?Math.floor(n.zoom):n.zoom,g=Jt(this.expression.interpolationFactor(u,this.zoom,this.zoom+1),0,1);t.set(g)},On.prototype.getBinding=function(t,n,u){return new fr(t,n)};var An=function(t,n,u,g,_,w){this.expression=t,this.type=n,this.useIntegerZoom=u,this.zoom=g,this.layerId=w,this.zoomInPaintVertexArray=new _,this.zoomOutPaintVertexArray=new _};An.prototype.populatePaintArray=function(t,n,u){var g=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(t),this.zoomOutPaintVertexArray.resize(t),this._setPaintValues(g,t,n.patterns&&n.patterns[this.layerId],u)},An.prototype.updatePaintArray=function(t,n,u,g,_){this._setPaintValues(t,n,u.patterns&&u.patterns[this.layerId],_)},An.prototype._setPaintValues=function(t,n,u,g){if(g&&u){var _=g[u.min],w=g[u.mid],S=g[u.max];if(_&&w&&S)for(var A=t;A<n;A++)this.zoomInPaintVertexArray.emplace(A,w.tl[0],w.tl[1],w.br[0],w.br[1],_.tl[0],_.tl[1],_.br[0],_.br[1],w.pixelRatio,_.pixelRatio),this.zoomOutPaintVertexArray.emplace(A,w.tl[0],w.tl[1],w.br[0],w.br[1],S.tl[0],S.tl[1],S.br[0],S.br[1],w.pixelRatio,S.pixelRatio)}},An.prototype.upload=function(t){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=t.createVertexBuffer(this.zoomInPaintVertexArray,Gt.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=t.createVertexBuffer(this.zoomOutPaintVertexArray,Gt.members,this.expression.isStateDependent))},An.prototype.destroy=function(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()};var mn=function(t,n,u){this.binders={},this._buffers=[];var g=[];for(var _ in t.paint._values)if(u(_)){var w=t.paint.get(_);if(w instanceof ps&&hi(w.property.specification)){var S=Ca(_,t.type),A=w.value,z=w.property.specification.type,q=w.property.useIntegerZoom,V=w.property.specification["property-type"],H="cross-faded"===V||"cross-faded-data-driven"===V;if("constant"===A.kind)this.binders[_]=H?new Zn(A.value,S):new ti(A.value,S,z),g.push("/u_"+_);else if("source"===A.kind||H){var st=nu(_,z,"source");this.binders[_]=H?new An(A,z,q,n,st,t.id):new Nn(A,S,z,st),g.push("/a_"+_)}else{var vt=nu(_,z,"composite");this.binders[_]=new On(A,S,z,q,n,vt),g.push("/z_"+_)}}}this.cacheKey=g.sort().join("")};mn.prototype.getMaxValue=function(t){var n=this.binders[t];return n instanceof Nn||n instanceof On?n.maxValue:0},mn.prototype.populatePaintArrays=function(t,n,u,g,_){for(var w in this.binders){var S=this.binders[w];(S instanceof Nn||S instanceof On||S instanceof An)&&S.populatePaintArray(t,n,u,g,_)}},mn.prototype.setConstantPatternPositions=function(t,n){for(var u in this.binders){var g=this.binders[u];g instanceof Zn&&g.setConstantPatternPositions(t,n)}},mn.prototype.updatePaintArrays=function(t,n,u,g,_){var w=!1;for(var S in t)for(var A=0,z=n.getPositions(S);A<z.length;A+=1){var q=z[A],V=u.feature(q.index);for(var H in this.binders){var st=this.binders[H];if((st instanceof Nn||st instanceof On||st instanceof An)&&!0===st.expression.isStateDependent){var vt=g.paint.get(H);st.expression=vt.value,st.updatePaintArray(q.start,q.end,V,t[S],_),w=!0}}}return w},mn.prototype.defines=function(){var t=[];for(var n in this.binders){var u=this.binders[n];(u instanceof ti||u instanceof Zn)&&t.push.apply(t,u.uniformNames.map(function(g){return"#define HAS_UNIFORM_"+g}))}return t},mn.prototype.getBinderAttributes=function(){var t=[];for(var n in this.binders){var u=this.binders[n];if(u instanceof Nn||u instanceof On)for(var g=0;g<u.paintVertexAttributes.length;g++)t.push(u.paintVertexAttributes[g].name);else if(u instanceof An)for(var _=0;_<Gt.members.length;_++)t.push(Gt.members[_].name)}return t},mn.prototype.getBinderUniforms=function(){var t=[];for(var n in this.binders){var u=this.binders[n];if(u instanceof ti||u instanceof Zn||u instanceof On)for(var g=0,_=u.uniformNames;g<_.length;g+=1)t.push(_[g])}return t},mn.prototype.getPaintVertexBuffers=function(){return this._buffers},mn.prototype.getUniforms=function(t,n){var u=[];for(var g in this.binders){var _=this.binders[g];if(_ instanceof ti||_ instanceof Zn||_ instanceof On)for(var w=0,S=_.uniformNames;w<S.length;w+=1){var A=S[w];if(n[A]){var z=_.getBinding(t,n[A],A);u.push({name:A,property:g,binding:z})}}}return u},mn.prototype.setUniforms=function(t,n,u,g){for(var _=0,w=n;_<w.length;_+=1){var S=w[_],A=S.name,z=S.property;this.binders[z].setUniform(S.binding,g,u.get(z),A)}},mn.prototype.updatePaintBuffers=function(t){for(var n in this._buffers=[],this.binders){var u=this.binders[n];if(t&&u instanceof An){var g=2===t.fromScale?u.zoomInPaintVertexBuffer:u.zoomOutPaintVertexBuffer;g&&this._buffers.push(g)}else(u instanceof Nn||u instanceof On)&&u.paintVertexBuffer&&this._buffers.push(u.paintVertexBuffer)}},mn.prototype.upload=function(t){for(var n in this.binders){var u=this.binders[n];(u instanceof Nn||u instanceof On||u instanceof An)&&u.upload(t)}this.updatePaintBuffers()},mn.prototype.destroy=function(){for(var t in this.binders){var n=this.binders[t];(n instanceof Nn||n instanceof On||n instanceof An)&&n.destroy()}};var Mo=function(t,n,u){void 0===u&&(u=function(){return!0}),this.programConfigurations={};for(var g=0,_=t;g<_.length;g+=1){var w=_[g];this.programConfigurations[w.id]=new mn(w,n,u)}this.needsUpload=!1,this._featureMap=new Ee,this._bufferOffset=0};function Ca(t,n){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[t]||[t.replace(n+"-","").replace(/-/g,"_")]}function nu(t,n,u){var _={"line-pattern":{source:i,composite:i},"fill-pattern":{source:i,composite:i},"fill-extrusion-pattern":{source:i,composite:i}}[t];return _&&_[u]||{color:{source:e,composite:l},number:{source:gr,composite:e}}[n][u]}Mo.prototype.populatePaintArrays=function(t,n,u,g,_,w){for(var S in this.programConfigurations)this.programConfigurations[S].populatePaintArrays(t,n,g,_,w);void 0!==n.id&&this._featureMap.add(n.id,u,this._bufferOffset,t),this._bufferOffset=t,this.needsUpload=!0},Mo.prototype.updatePaintArrays=function(t,n,u,g){for(var _=0,w=u;_<w.length;_+=1){var S=w[_];this.needsUpload=this.programConfigurations[S.id].updatePaintArrays(t,this._featureMap,n,S,g)||this.needsUpload}},Mo.prototype.get=function(t){return this.programConfigurations[t]},Mo.prototype.upload=function(t){if(this.needsUpload){for(var n in this.programConfigurations)this.programConfigurations[n].upload(t);this.needsUpload=!1}},Mo.prototype.destroy=function(){for(var t in this.programConfigurations)this.programConfigurations[t].destroy()},_r("ConstantBinder",ti),_r("CrossFadedConstantBinder",Zn),_r("SourceExpressionBinder",Nn),_r("CrossFadedCompositeBinder",An),_r("CompositeExpressionBinder",On),_r("ProgramConfiguration",mn,{omit:["_buffers"]}),_r("ProgramConfigurationSet",Mo);var ws=Math.pow(2,14)-1,Es=-ws-1;function Ia(t){for(var n=8192/t.extent,u=t.loadGeometry(),g=0;g<u.length;g++)for(var _=u[g],w=0;w<_.length;w++){var S=_[w],A=Math.round(S.x*n),z=Math.round(S.y*n);S.x=Jt(A,Es,ws),S.y=Jt(z,Es,ws),(A<S.x||A>S.x+1||z<S.y||z>S.y+1)&&St("Geometry exceeds allowed extent, reduce your vector tile buffer size")}return u}function iu(t,n){return{type:t.type,id:t.id,properties:t.properties,geometry:n?Ia(t):[]}}function cl(t,n,u,g,_){t.emplaceBack(2*n+(g+1)/2,2*u+(_+1)/2)}var ks=function(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(n){return n.id}),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new fs,this.indexArray=new te,this.segments=new _t,this.programConfigurations=new Mo(t.layers,t.zoom),this.stateDependentLayerIds=this.layers.filter(function(n){return n.isStateDependent()}).map(function(n){return n.id})};function yu(t,n){for(var u=0;u<t.length;u++)if(pl(n,t[u]))return!0;for(var g=0;g<n.length;g++)if(pl(t,n[g]))return!0;return!!kl(t,n)}function hl(t,n,u){return!!pl(t,n)||!!Yl(n,t,u)}function Iu(t,n){if(1===t.length)return Jl(n,t[0]);for(var u=0;u<n.length;u++)for(var g=n[u],_=0;_<g.length;_++)if(pl(t,g[_]))return!0;for(var w=0;w<t.length;w++)if(Jl(n,t[w]))return!0;for(var S=0;S<n.length;S++)if(kl(t,n[S]))return!0;return!1}function Sh(t,n,u){if(t.length>1){if(kl(t,n))return!0;for(var g=0;g<n.length;g++)if(Yl(n[g],t,u))return!0}for(var _=0;_<t.length;_++)if(Yl(t[_],n,u))return!0;return!1}function kl(t,n){if(0===t.length||0===n.length)return!1;for(var u=0;u<t.length-1;u++)for(var g=t[u],_=t[u+1],w=0;w<n.length-1;w++)if(Nl(g,_,n[w],n[w+1]))return!0;return!1}function Nl(t,n,u,g){return kt(t,u,g)!==kt(n,u,g)&&kt(t,n,u)!==kt(t,n,g)}function Yl(t,n,u){var g=u*u;if(1===n.length)return t.distSqr(n[0])<g;for(var _=1;_<n.length;_++)if(Ic(t,n[_-1],n[_])<g)return!0;return!1}function Ic(t,n,u){var g=n.distSqr(u);if(0===g)return t.distSqr(n);var _=((t.x-n.x)*(u.x-n.x)+(t.y-n.y)*(u.y-n.y))/g;return t.distSqr(_<0?n:_>1?u:u.sub(n)._mult(_)._add(n))}function Jl(t,n){for(var u,g,_,w=!1,S=0;S<t.length;S++)for(var A=0,z=(u=t[S]).length-1;A<u.length;z=A++)(g=u[A]).y>n.y!=(_=u[z]).y>n.y&&n.x<(_.x-g.x)*(n.y-g.y)/(_.y-g.y)+g.x&&(w=!w);return w}function pl(t,n){for(var u=!1,g=0,_=t.length-1;g<t.length;_=g++){var w=t[g],S=t[_];w.y>n.y!=S.y>n.y&&n.x<(S.x-w.x)*(n.y-w.y)/(S.y-w.y)+w.x&&(u=!u)}return u}function hc(t,n,u){var g=u[0],_=u[2];if(t.x<g.x&&n.x<g.x||t.x>_.x&&n.x>_.x||t.y<g.y&&n.y<g.y||t.y>_.y&&n.y>_.y)return!1;var w=kt(t,n,u[0]);return w!==kt(t,n,u[1])||w!==kt(t,n,u[2])||w!==kt(t,n,u[3])}function Xa(t,n,u){var g=n.paint.get(t).value;return"constant"===g.kind?g.value:u.programConfigurations.get(n.id).getMaxValue(t)}function fl(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function Ku(t,n,u,g,_){if(!n[0]&&!n[1])return t;var w=Ft.convert(n)._mult(_);"viewport"===u&&w._rotate(-g);for(var S=[],A=0;A<t.length;A++)S.push(t[A].sub(w));return S}ks.prototype.populate=function(t,n,u){var g=this.layers[0],_=[],w=null,S=!1;"circle"===g.type&&(S=!(w=g.layout.get("circle-sort-key")).isConstant());for(var A=0,z=t;A<z.length;A+=1){var q=z[A],V=q.feature,H=q.id,st=q.index,vt=q.sourceLayerIndex,Rt=this.layers[0]._featureFilter.needGeometry,Vt=iu(V,Rt);if(this.layers[0]._featureFilter.filter(new so(this.zoom),Vt,u)){var he=S?w.evaluate(Vt,{},u):void 0,re={id:H,properties:V.properties,type:V.type,sourceLayerIndex:vt,index:st,geometry:Rt?Vt.geometry:Ia(V),patterns:{},sortKey:he};_.push(re)}}S&&_.sort(function(Wr,Tr){return Wr.sortKey-Tr.sortKey});for(var we=0,Pe=_;we<Pe.length;we+=1){var Re=Pe[we],ze=Re.geometry,rr=Re.index,yr=Re.sourceLayerIndex,Mr=t[rr].feature;this.addFeature(Re,ze,rr,u),n.featureIndex.insert(Mr,ze,rr,yr,this.index)}},ks.prototype.update=function(t,n,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,n,this.stateDependentLayers,u)},ks.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},ks.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},ks.prototype.upload=function(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Et),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0},ks.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},ks.prototype.addFeature=function(t,n,u,g){for(var _=0,w=n;_<w.length;_+=1)for(var S=0,A=w[_];S<A.length;S+=1){var z=A[S],q=z.x,V=z.y;if(!(q<0||q>=8192||V<0||V>=8192)){var H=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,t.sortKey),st=H.vertexLength;cl(this.layoutVertexArray,q,V,-1,-1),cl(this.layoutVertexArray,q,V,1,-1),cl(this.layoutVertexArray,q,V,1,1),cl(this.layoutVertexArray,q,V,-1,1),this.indexArray.emplaceBack(st,st+1,st+2),this.indexArray.emplaceBack(st,st+3,st+2),H.vertexLength+=4,H.primitiveLength+=2}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,u,{},g)},_r("CircleBucket",ks,{omit:["layers"]});var $u=new Sa({"circle-sort-key":new cn(Dt.layout_circle["circle-sort-key"])}),Ya={paint:new Sa({"circle-radius":new cn(Dt.paint_circle["circle-radius"]),"circle-color":new cn(Dt.paint_circle["circle-color"]),"circle-blur":new cn(Dt.paint_circle["circle-blur"]),"circle-opacity":new cn(Dt.paint_circle["circle-opacity"]),"circle-translate":new Dr(Dt.paint_circle["circle-translate"]),"circle-translate-anchor":new Dr(Dt.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Dr(Dt.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Dr(Dt.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new cn(Dt.paint_circle["circle-stroke-width"]),"circle-stroke-color":new cn(Dt.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new cn(Dt.paint_circle["circle-stroke-opacity"])}),layout:$u},Na=typeof Float32Array<"u"?Float32Array:Array;function vu(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Pl(t,n,u){var g=n[0],_=n[1],w=n[2],S=n[3],A=n[4],z=n[5],q=n[6],V=n[7],H=n[8],st=n[9],vt=n[10],Rt=n[11],Vt=n[12],he=n[13],re=n[14],we=n[15],Pe=u[0],Re=u[1],ze=u[2],rr=u[3];return t[0]=Pe*g+Re*A+ze*H+rr*Vt,t[1]=Pe*_+Re*z+ze*st+rr*he,t[2]=Pe*w+Re*q+ze*vt+rr*re,t[3]=Pe*S+Re*V+ze*Rt+rr*we,t[4]=(Pe=u[4])*g+(Re=u[5])*A+(ze=u[6])*H+(rr=u[7])*Vt,t[5]=Pe*_+Re*z+ze*st+rr*he,t[6]=Pe*w+Re*q+ze*vt+rr*re,t[7]=Pe*S+Re*V+ze*Rt+rr*we,t[8]=(Pe=u[8])*g+(Re=u[9])*A+(ze=u[10])*H+(rr=u[11])*Vt,t[9]=Pe*_+Re*z+ze*st+rr*he,t[10]=Pe*w+Re*q+ze*vt+rr*re,t[11]=Pe*S+Re*V+ze*Rt+rr*we,t[12]=(Pe=u[12])*g+(Re=u[13])*A+(ze=u[14])*H+(rr=u[15])*Vt,t[13]=Pe*_+Re*z+ze*st+rr*he,t[14]=Pe*w+Re*q+ze*vt+rr*re,t[15]=Pe*S+Re*V+ze*Rt+rr*we,t}Math.hypot||(Math.hypot=function(){for(var t=arguments,n=0,u=arguments.length;u--;)n+=t[u]*t[u];return Math.sqrt(n)});var pc,t,Ch=Pl;function Kc(t,n,u){var g=n[0],_=n[1],w=n[2],S=n[3];return t[0]=u[0]*g+u[4]*_+u[8]*w+u[12]*S,t[1]=u[1]*g+u[5]*_+u[9]*w+u[13]*S,t[2]=u[2]*g+u[6]*_+u[10]*w+u[14]*S,t[3]=u[3]*g+u[7]*_+u[11]*w+u[15]*S,t}pc=new Na(3),Na!=Float32Array&&(pc[0]=0,pc[1]=0,pc[2]=0),t=new Na(4),Na!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0);var Pc=(function(){var t=new Na(2);Na!=Float32Array&&(t[0]=0,t[1]=0)}(),function(t){function n(u){t.call(this,u,Ya)}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n.prototype.createBucket=function(u){return new ks(u)},n.prototype.queryRadius=function(u){var g=u;return Xa("circle-radius",this,g)+Xa("circle-stroke-width",this,g)+fl(this.paint.get("circle-translate"))},n.prototype.queryIntersectsFeature=function(u,g,_,w,S,A,z,q){for(var V=Ku(u,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),A.angle,z),H=this.paint.get("circle-radius").evaluate(g,_)+this.paint.get("circle-stroke-width").evaluate(g,_),st="map"===this.paint.get("circle-pitch-alignment"),vt=st?V:function(yr,Mr){return yr.map(function(Wr){return Ih(Wr,Mr)})}(V,q),Rt=st?H*z:H,Vt=0,he=w;Vt<he.length;Vt+=1)for(var re=0,we=he[Vt];re<we.length;re+=1){var Pe=we[re],Re=st?Pe:Ih(Pe,q),ze=Rt,rr=Kc([],[Pe.x,Pe.y,0,1],q);if("viewport"===this.paint.get("circle-pitch-scale")&&"map"===this.paint.get("circle-pitch-alignment")?ze*=rr[3]/A.cameraToCenterDistance:"map"===this.paint.get("circle-pitch-scale")&&"viewport"===this.paint.get("circle-pitch-alignment")&&(ze*=A.cameraToCenterDistance/rr[3]),hl(vt,Re,ze))return!0}return!1},n}(hn));function Ih(t,n){var u=Kc([],[t.x,t.y,0,1],n);return new Ft(u[0]/u[3],u[1]/u[3])}var Hl=function(t){function n(){t.apply(this,arguments)}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n}(ks);function Qu(t,n,u,g){var _=n.width,w=n.height;if(g){if(g instanceof Uint8ClampedArray)g=new Uint8Array(g.buffer);else if(g.length!==_*w*u)throw new RangeError("mismatched image size")}else g=new Uint8Array(_*w*u);return t.width=_,t.height=w,t.data=g,t}function Hp(t,n,u){var g=n.width,_=n.height;if(g!==t.width||_!==t.height){var w=Qu({},{width:g,height:_},u);Hs(t,w,{x:0,y:0},{x:0,y:0},{width:Math.min(t.width,g),height:Math.min(t.height,_)},u),t.width=g,t.height=_,t.data=w.data}}function Hs(t,n,u,g,_,w){if(0===_.width||0===_.height)return n;if(_.width>t.width||_.height>t.height||u.x>t.width-_.width||u.y>t.height-_.height)throw new RangeError("out of range source coordinates for image copy");if(_.width>n.width||_.height>n.height||g.x>n.width-_.width||g.y>n.height-_.height)throw new RangeError("out of range destination coordinates for image copy");for(var S=t.data,A=n.data,z=0;z<_.height;z++)for(var q=((u.y+z)*t.width+u.x)*w,V=((g.y+z)*n.width+g.x)*w,H=0;H<_.width*w;H++)A[V+H]=S[q+H];return n}_r("HeatmapBucket",Hl,{omit:["layers"]});var ou=function(t,n){Qu(this,t,1,n)};ou.prototype.resize=function(t){Hp(this,t,1)},ou.prototype.clone=function(){return new ou({width:this.width,height:this.height},new Uint8Array(this.data))},ou.copy=function(t,n,u,g,_){Hs(t,n,u,g,_,1)};var To=function(t,n){Qu(this,t,4,n)};To.prototype.resize=function(t){Hp(this,t,4)},To.prototype.replace=function(t,n){n?this.data.set(t):this.data=t instanceof Uint8ClampedArray?new Uint8Array(t.buffer):t},To.prototype.clone=function(){return new To({width:this.width,height:this.height},new Uint8Array(this.data))},To.copy=function(t,n,u,g,_){Hs(t,n,u,g,_,4)},_r("AlphaImage",ou),_r("RGBAImage",To);var au={paint:new Sa({"heatmap-radius":new cn(Dt.paint_heatmap["heatmap-radius"]),"heatmap-weight":new cn(Dt.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Dr(Dt.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Ys(Dt.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Dr(Dt.paint_heatmap["heatmap-opacity"])})};function Ri(t){var n={},u=t.resolution||256,g=t.clips?t.clips.length:1,_=t.image||new To({width:u,height:g}),w=function(Rt,Vt,he){n[t.evaluationKey]=he;var re=t.expression.evaluate(n);_.data[Rt+Vt+0]=Math.floor(255*re.r/re.a),_.data[Rt+Vt+1]=Math.floor(255*re.g/re.a),_.data[Rt+Vt+2]=Math.floor(255*re.b/re.a),_.data[Rt+Vt+3]=Math.floor(255*re.a)};if(t.clips)for(var S=0,A=0;S<g;++S,A+=4*u)for(var z=0,q=0;z<u;z++,q+=4){var V=z/(u-1),H=t.clips[S];w(A,q,H.start*(1-V)+H.end*V)}else for(var st=0,vt=0;st<u;st++,vt+=4)w(0,vt,st/(u-1));return _}var Zi=function(t){function n(u){t.call(this,u,au),this._updateColorRamp()}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n.prototype.createBucket=function(u){return new Hl(u)},n.prototype._handleSpecialPaintPropertyUpdate=function(u){"heatmap-color"===u&&this._updateColorRamp()},n.prototype._updateColorRamp=function(){this.colorRamp=Ri({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null},n.prototype.resize=function(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)},n.prototype.queryRadius=function(){return 0},n.prototype.queryIntersectsFeature=function(){return!1},n.prototype.hasOffscreenPass=function(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility},n}(hn),ji={paint:new Sa({"hillshade-illumination-direction":new Dr(Dt.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Dr(Dt.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Dr(Dt.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Dr(Dt.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Dr(Dt.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Dr(Dt.paint_hillshade["hillshade-accent-color"])})},Xi=function(t){function n(u){t.call(this,u,ji)}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n.prototype.hasOffscreenPass=function(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility},n}(hn),Yi=yo([{name:"a_pos",components:2,type:"Int16"}],4).members,Ti=Si,Ji=Si;function Si(t,n,u){u=u||2;var g,_,w,S,A,z,q,V=n&&n.length,H=V?n[0]*u:t.length,st=Fi(t,0,H,u,!0),vt=[];if(!st||st.next===st.prev)return vt;if(V&&(st=function(Vt,he,re,we){var Pe,Re,ze,rr=[];for(Pe=0,Re=he.length;Pe<Re;Pe++)(ze=Fi(Vt,he[Pe]*we,Pe<Re-1?he[Pe+1]*we:Vt.length,we,!1))===ze.next&&(ze.steiner=!0),rr.push(ro(ze));for(rr.sort(Qi),Pe=0;Pe<rr.length;Pe++)to(rr[Pe],re),re=di(re,re.next);return re}(t,n,st,u)),t.length>80*u){g=w=t[0],_=S=t[1];for(var Rt=u;Rt<H;Rt+=u)(A=t[Rt])<g&&(g=A),(z=t[Rt+1])<_&&(_=z),A>w&&(w=A),z>S&&(S=z);q=0!==(q=Math.max(w-g,S-_))?1/q:0}return Ei(st,vt,u,g,_,q),vt}function Fi(t,n,u,g,_){var w,S;if(_===np(t,n,u,g)>0)for(w=n;w<u;w+=g)S=Th(w,t[w],t[w+1],S);else for(w=u-g;w>=n;w-=g)S=Th(w,t[w],t[w+1],S);return S&&Ci(S,S.next)&&(dc(S),S=S.next),S}function di(t,n){if(!t)return t;n||(n=t);var u,g=t;do{if(u=!1,g.steiner||!Ci(g,g.next)&&0!==In(g.prev,g,g.next))g=g.next;else{if(dc(g),(g=n=g.prev)===g.next)break;u=!0}}while(u||g!==n);return n}function Ei(t,n,u,g,_,w,S){if(t){!S&&w&&function(V,H,st,vt){var Rt=V;do{null===Rt.z&&(Rt.z=Ai(Rt.x,Rt.y,H,st,vt)),Rt.prevZ=Rt.prev,Rt.nextZ=Rt.next,Rt=Rt.next}while(Rt!==V);Rt.prevZ.nextZ=null,Rt.prevZ=null,function(Vt){var he,re,we,Pe,Re,ze,rr,yr,Mr=1;do{for(re=Vt,Vt=null,Re=null,ze=0;re;){for(ze++,we=re,rr=0,he=0;he<Mr&&(rr++,we=we.nextZ);he++);for(yr=Mr;rr>0||yr>0&&we;)0!==rr&&(0===yr||!we||re.z<=we.z)?(Pe=re,re=re.nextZ,rr--):(Pe=we,we=we.nextZ,yr--),Re?Re.nextZ=Pe:Vt=Pe,Pe.prevZ=Re,Re=Pe;re=we}Re.nextZ=null,Mr*=2}while(ze>1)}(Rt)}(t,g,_,w);for(var A,z,q=t;t.prev!==t.next;)if(A=t.prev,z=t.next,w?Wi(t,g,_,w):Hi(t))n.push(A.i/u),n.push(t.i/u),n.push(z.i/u),dc(t),t=z.next,q=z.next;else if((t=z)===q){S?1===S?Ei(t=Ki(di(t),n,u),n,u,g,_,w,2):2===S&&$i(t,n,u,g,_,w):Ei(di(t),n,u,g,_,w,1);break}}}function Hi(t){var n=t.prev,u=t,g=t.next;if(In(n,u,g)>=0)return!1;for(var _=t.next.next;_!==t.prev;){if(yi(n.x,n.y,u.x,u.y,g.x,g.y,_.x,_.y)&&In(_.prev,_,_.next)>=0)return!1;_=_.next}return!0}function Wi(t,n,u,g){var _=t.prev,w=t,S=t.next;if(In(_,w,S)>=0)return!1;for(var A=_.x>w.x?_.x>S.x?_.x:S.x:w.x>S.x?w.x:S.x,z=_.y>w.y?_.y>S.y?_.y:S.y:w.y>S.y?w.y:S.y,q=Ai(_.x<w.x?_.x<S.x?_.x:S.x:w.x<S.x?w.x:S.x,_.y<w.y?_.y<S.y?_.y:S.y:w.y<S.y?w.y:S.y,n,u,g),V=Ai(A,z,n,u,g),H=t.prevZ,st=t.nextZ;H&&H.z>=q&&st&&st.z<=V;){if(H!==t.prev&&H!==t.next&&yi(_.x,_.y,w.x,w.y,S.x,S.y,H.x,H.y)&&In(H.prev,H,H.next)>=0||(H=H.prevZ,st!==t.prev&&st!==t.next&&yi(_.x,_.y,w.x,w.y,S.x,S.y,st.x,st.y)&&In(st.prev,st,st.next)>=0))return!1;st=st.nextZ}for(;H&&H.z>=q;){if(H!==t.prev&&H!==t.next&&yi(_.x,_.y,w.x,w.y,S.x,S.y,H.x,H.y)&&In(H.prev,H,H.next)>=0)return!1;H=H.prevZ}for(;st&&st.z<=V;){if(st!==t.prev&&st!==t.next&&yi(_.x,_.y,w.x,w.y,S.x,S.y,st.x,st.y)&&In(st.prev,st,st.next)>=0)return!1;st=st.nextZ}return!0}function Ki(t,n,u){var g=t;do{var _=g.prev,w=g.next.next;!Ci(_,w)&&Ph(_,g,g.next,w)&&fc(_,w)&&fc(w,_)&&(n.push(_.i/u),n.push(g.i/u),n.push(w.i/u),dc(g),dc(g.next),g=t=w),g=g.next}while(g!==t);return di(g)}function $i(t,n,u,g,_,w){var S=t;do{for(var A=S.next.next;A!==S.prev;){if(S.i!==A.i&&no(S,A)){var z=Mh(S,A);return S=di(S,S.next),z=di(z,z.next),Ei(S,n,u,g,_,w),void Ei(z,n,u,g,_,w)}A=A.next}S=S.next}while(S!==t)}function Qi(t,n){return t.x-n.x}function to(t,n){if(n=function(g,_){var w,S=_,A=g.x,z=g.y,q=-1/0;do{if(z<=S.y&&z>=S.next.y&&S.next.y!==S.y){var V=S.x+(z-S.y)*(S.next.x-S.x)/(S.next.y-S.y);if(V<=A&&V>q){if(q=V,V===A){if(z===S.y)return S;if(z===S.next.y)return S.next}w=S.x<S.next.x?S:S.next}}S=S.next}while(S!==_);if(!w)return null;if(A===q)return w;var H,st=w,vt=w.x,Rt=w.y,Vt=1/0;S=w;do{A>=S.x&&S.x>=vt&&A!==S.x&&yi(z<Rt?A:q,z,vt,Rt,z<Rt?q:A,z,S.x,S.y)&&(H=Math.abs(z-S.y)/(A-S.x),fc(S,g)&&(H<Vt||H===Vt&&(S.x>w.x||S.x===w.x&&eo(w,S)))&&(w=S,Vt=H)),S=S.next}while(S!==st);return w}(t,n)){var u=Mh(n,t);di(n,n.next),di(u,u.next)}}function eo(t,n){return In(t.prev,t,n.prev)<0&&In(n.next,t,t.next)<0}function Ai(t,n,u,g,_){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-u)*_)|t<<8))|t<<4))|t<<2))|t<<1))|(n=1431655765&((n=858993459&((n=252645135&((n=16711935&((n=32767*(n-g)*_)|n<<8))|n<<4))|n<<2))|n<<1))<<1}function ro(t){var n=t,u=t;do{(n.x<u.x||n.x===u.x&&n.y<u.y)&&(u=n),n=n.next}while(n!==t);return u}function yi(t,n,u,g,_,w,S,A){return(_-S)*(n-A)-(t-S)*(w-A)>=0&&(t-S)*(g-A)-(u-S)*(n-A)>=0&&(u-S)*(w-A)-(_-S)*(g-A)>=0}function no(t,n){return t.next.i!==n.i&&t.prev.i!==n.i&&!function(u,g){var _=u;do{if(_.i!==u.i&&_.next.i!==u.i&&_.i!==g.i&&_.next.i!==g.i&&Ph(_,_.next,u,g))return!0;_=_.next}while(_!==u);return!1}(t,n)&&(fc(t,n)&&fc(n,t)&&function(u,g){var _=u,w=!1,S=(u.x+g.x)/2,A=(u.y+g.y)/2;do{_.y>A!=_.next.y>A&&_.next.y!==_.y&&S<(_.next.x-_.x)*(A-_.y)/(_.next.y-_.y)+_.x&&(w=!w),_=_.next}while(_!==u);return w}(t,n)&&(In(t.prev,t,n.prev)||In(t,n.prev,n))||Ci(t,n)&&In(t.prev,t,t.next)>0&&In(n.prev,n,n.next)>0)}function In(t,n,u){return(n.y-t.y)*(u.x-n.x)-(n.x-t.x)*(u.y-n.y)}function Ci(t,n){return t.x===n.x&&t.y===n.y}function Ph(t,n,u,g){var _=Tc(In(t,n,u)),w=Tc(In(t,n,g)),S=Tc(In(u,g,t)),A=Tc(In(u,g,n));return _!==w&&S!==A||!(0!==_||!Mc(t,u,n))||!(0!==w||!Mc(t,g,n))||!(0!==S||!Mc(u,t,g))||!(0!==A||!Mc(u,n,g))}function Mc(t,n,u){return n.x<=Math.max(t.x,u.x)&&n.x>=Math.min(t.x,u.x)&&n.y<=Math.max(t.y,u.y)&&n.y>=Math.min(t.y,u.y)}function Tc(t){return t>0?1:t<0?-1:0}function fc(t,n){return In(t.prev,t,t.next)<0?In(t,n,t.next)>=0&&In(t,t.prev,n)>=0:In(t,n,t.prev)<0||In(t,t.next,n)<0}function Mh(t,n){var u=new $c(t.i,t.x,t.y),g=new $c(n.i,n.x,n.y),_=t.next,w=n.prev;return t.next=n,n.prev=t,u.next=_,_.prev=u,g.next=u,u.prev=g,w.next=g,g.prev=w,g}function Th(t,n,u,g){var _=new $c(t,n,u);return g?(_.next=g.next,_.prev=g,g.next.prev=_,g.next=_):(_.prev=_,_.next=_),_}function dc(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function $c(t,n,u){this.i=t,this.x=n,this.y=u,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function np(t,n,u,g){for(var _=0,w=n,S=u-g;w<u;w+=g)_+=(t[S]-t[w])*(t[w+1]+t[S+1]),S=w;return _}function Wf(t,n,u,g,_){!function w(S,A,z,q,V){for(;q>z;){if(q-z>600){var H=q-z+1,st=A-z+1,vt=Math.log(H),Rt=.5*Math.exp(2*vt/3),Vt=.5*Math.sqrt(vt*Rt*(H-Rt)/H)*(st-H/2<0?-1:1);w(S,A,Math.max(z,Math.floor(A-st*Rt/H+Vt)),Math.min(q,Math.floor(A+(H-st)*Rt/H+Vt)),V)}var he=S[A],re=z,we=q;for(Qc(S,z,A),V(S[q],he)>0&&Qc(S,z,q);re<we;){for(Qc(S,re,we),re++,we--;V(S[re],he)<0;)re++;for(;V(S[we],he)>0;)we--}0===V(S[z],he)?Qc(S,z,we):Qc(S,++we,q),we<=A&&(z=we+1),A<=we&&(q=we-1)}}(t,n,u||0,g||t.length-1,_||Kf)}function Qc(t,n,u){var g=t[n];t[n]=t[u],t[u]=g}function Kf(t,n){return t<n?-1:t>n?1:0}function ip(t,n){var u=t.length;if(u<=1)return[t];for(var g,_,w=[],S=0;S<u;S++){var A=dt(t[S]);0!==A&&(t[S].area=Math.abs(A),void 0===_&&(_=A<0),_===A<0?(g&&w.push(g),g=[t[S]]):g.push(t[S]))}if(g&&w.push(g),n>1)for(var z=0;z<w.length;z++)w[z].length<=n||(Wf(w[z],n,1,w[z].length-1,$f),w[z]=w[z].slice(0,n));return w}function $f(t,n){return n.area-t.area}function op(t,n,u){for(var g=u.patternDependencies,_=!1,w=0,S=n;w<S.length;w+=1){var A=S[w].paint.get(t+"-pattern");A.isConstant()||(_=!0);var z=A.constantOr(null);z&&(_=!0,g[z.to]=!0,g[z.from]=!0)}return _}function ap(t,n,u,g,_){for(var w=_.patternDependencies,S=0,A=n;S<A.length;S+=1){var z=A[S],q=z.paint.get(t+"-pattern").value;if("constant"!==q.kind){var V=q.evaluate({zoom:g-1},u,{},_.availableImages),H=q.evaluate({zoom:g},u,{},_.availableImages),st=q.evaluate({zoom:g+1},u,{},_.availableImages);H=H&&H.name?H.name:H,st=st&&st.name?st.name:st,w[V=V&&V.name?V.name:V]=!0,w[H]=!0,w[st]=!0,u.patterns[z.id]={min:V,mid:H,max:st}}}return u}Si.deviation=function(t,n,u,g){var _=n&&n.length,w=Math.abs(np(t,0,_?n[0]*u:t.length,u));if(_)for(var S=0,A=n.length;S<A;S++)w-=Math.abs(np(t,n[S]*u,S<A-1?n[S+1]*u:t.length,u));var z=0;for(S=0;S<g.length;S+=3){var q=g[S]*u,V=g[S+1]*u,H=g[S+2]*u;z+=Math.abs((t[q]-t[H])*(t[V+1]-t[q+1])-(t[q]-t[V])*(t[H+1]-t[q+1]))}return 0===w&&0===z?0:Math.abs((z-w)/w)},Si.flatten=function(t){for(var n=t[0][0].length,u={vertices:[],holes:[],dimensions:n},g=0,_=0;_<t.length;_++){for(var w=0;w<t[_].length;w++)for(var S=0;S<n;S++)u.vertices.push(t[_][w][S]);_>0&&u.holes.push(g+=t[_-1].length)}return u},Ti.default=Ji;var dl=function(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(n){return n.id}),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new fs,this.indexArray=new te,this.indexArray2=new an,this.programConfigurations=new Mo(t.layers,t.zoom),this.segments=new _t,this.segments2=new _t,this.stateDependentLayerIds=this.layers.filter(function(n){return n.isStateDependent()}).map(function(n){return n.id})};dl.prototype.populate=function(t,n,u){this.hasPattern=op("fill",this.layers,n);for(var g=this.layers[0].layout.get("fill-sort-key"),_=!g.isConstant(),w=[],S=0,A=t;S<A.length;S+=1){var z=A[S],q=z.feature,V=z.id,H=z.index,st=z.sourceLayerIndex,vt=this.layers[0]._featureFilter.needGeometry,Rt=iu(q,vt);if(this.layers[0]._featureFilter.filter(new so(this.zoom),Rt,u)){var Vt=_?g.evaluate(Rt,{},u,n.availableImages):void 0,he={id:V,properties:q.properties,type:q.type,sourceLayerIndex:st,index:H,geometry:vt?Rt.geometry:Ia(q),patterns:{},sortKey:Vt};w.push(he)}}_&&w.sort(function(Mr,Wr){return Mr.sortKey-Wr.sortKey});for(var re=0,we=w;re<we.length;re+=1){var Pe=we[re],Re=Pe.geometry,ze=Pe.index,rr=Pe.sourceLayerIndex;if(this.hasPattern){var yr=ap("fill",this.layers,Pe,this.zoom,n);this.patternFeatures.push(yr)}else this.addFeature(Pe,Re,ze,u,{});n.featureIndex.insert(t[ze].feature,Re,ze,rr,this.index)}},dl.prototype.update=function(t,n,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,n,this.stateDependentLayers,u)},dl.prototype.addFeatures=function(t,n,u){for(var g=0,_=this.patternFeatures;g<_.length;g+=1){var w=_[g];this.addFeature(w,w.geometry,w.index,n,u)}},dl.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},dl.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},dl.prototype.upload=function(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Yi),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.indexBuffer2=t.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(t),this.uploaded=!0},dl.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())},dl.prototype.addFeature=function(t,n,u,g,_){for(var w=0,S=ip(n,500);w<S.length;w+=1){for(var A=S[w],z=0,q=0,V=A;q<V.length;q+=1)z+=V[q].length;for(var H=this.segments.prepareSegment(z,this.layoutVertexArray,this.indexArray),st=H.vertexLength,vt=[],Rt=[],Vt=0,he=A;Vt<he.length;Vt+=1){var re=he[Vt];if(0!==re.length){re!==A[0]&&Rt.push(vt.length/2);var we=this.segments2.prepareSegment(re.length,this.layoutVertexArray,this.indexArray2),Pe=we.vertexLength;this.layoutVertexArray.emplaceBack(re[0].x,re[0].y),this.indexArray2.emplaceBack(Pe+re.length-1,Pe),vt.push(re[0].x),vt.push(re[0].y);for(var Re=1;Re<re.length;Re++)this.layoutVertexArray.emplaceBack(re[Re].x,re[Re].y),this.indexArray2.emplaceBack(Pe+Re-1,Pe+Re),vt.push(re[Re].x),vt.push(re[Re].y);we.vertexLength+=re.length,we.primitiveLength+=re.length}}for(var ze=Ti(vt,Rt),rr=0;rr<ze.length;rr+=3)this.indexArray.emplaceBack(st+ze[rr],st+ze[rr+1],st+ze[rr+2]);H.vertexLength+=z,H.primitiveLength+=ze.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,u,_,g)},_r("FillBucket",dl,{omit:["layers","patternFeatures"]});var Qf=new Sa({"fill-sort-key":new cn(Dt.layout_fill["fill-sort-key"])}),td={paint:new Sa({"fill-antialias":new Dr(Dt.paint_fill["fill-antialias"]),"fill-opacity":new cn(Dt.paint_fill["fill-opacity"]),"fill-color":new cn(Dt.paint_fill["fill-color"]),"fill-outline-color":new cn(Dt.paint_fill["fill-outline-color"]),"fill-translate":new Dr(Dt.paint_fill["fill-translate"]),"fill-translate-anchor":new Dr(Dt.paint_fill["fill-translate-anchor"]),"fill-pattern":new Ea(Dt.paint_fill["fill-pattern"])}),layout:Qf},ed=function(t){function n(u){t.call(this,u,td)}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n.prototype.recalculate=function(u,g){t.prototype.recalculate.call(this,u,g);var _=this.paint._values["fill-outline-color"];"constant"===_.value.kind&&void 0===_.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])},n.prototype.createBucket=function(u){return new dl(u)},n.prototype.queryRadius=function(){return fl(this.paint.get("fill-translate"))},n.prototype.queryIntersectsFeature=function(u,g,_,w,S,A,z){return Iu(Ku(u,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),A.angle,z),w)},n.prototype.isTileClipped=function(){return!0},n}(hn),rd=yo([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4).members,Wp=Ac;function Ac(t,n,u,g,_){this.properties={},this.extent=u,this.type=0,this._pbf=t,this._geometry=-1,this._keys=g,this._values=_,t.readFields(nd,this,n)}function nd(t,n,u){1==t?n.id=u.readVarint():2==t?function(g,_){for(var w=g.readVarint()+g.pos;g.pos<w;){var S=_._keys[g.readVarint()],A=_._values[g.readVarint()];_.properties[S]=A}}(u,n):3==t?n.type=u.readVarint():4==t&&(n._geometry=u.pos)}function id(t){for(var n,u,g=0,_=0,w=t.length,S=w-1;_<w;S=_++)g+=((u=t[S]).x-(n=t[_]).x)*(n.y+u.y);return g}Ac.types=["Unknown","Point","LineString","Polygon"],Ac.prototype.loadGeometry=function(){var t=this._pbf;t.pos=this._geometry;for(var n,u=t.readVarint()+t.pos,g=1,_=0,w=0,S=0,A=[];t.pos<u;){if(_<=0){var z=t.readVarint();g=7&z,_=z>>3}if(_--,1===g||2===g)w+=t.readSVarint(),S+=t.readSVarint(),1===g&&(n&&A.push(n),n=[]),n.push(new Ft(w,S));else{if(7!==g)throw new Error("unknown command "+g);n&&n.push(n[0].clone())}}return n&&A.push(n),A},Ac.prototype.bbox=function(){var t=this._pbf;t.pos=this._geometry;for(var n=t.readVarint()+t.pos,u=1,g=0,_=0,w=0,S=1/0,A=-1/0,z=1/0,q=-1/0;t.pos<n;){if(g<=0){var V=t.readVarint();u=7&V,g=V>>3}if(g--,1===u||2===u)(_+=t.readSVarint())<S&&(S=_),_>A&&(A=_),(w+=t.readSVarint())<z&&(z=w),w>q&&(q=w);else if(7!==u)throw new Error("unknown command "+u)}return[S,z,A,q]},Ac.prototype.toGeoJSON=function(t,n,u){var g,_,w=this.extent*Math.pow(2,u),S=this.extent*t,A=this.extent*n,z=this.loadGeometry(),q=Ac.types[this.type];function V(vt){for(var Rt=0;Rt<vt.length;Rt++){var Vt=vt[Rt];vt[Rt]=[360*(Vt.x+S)/w-180,360/Math.PI*Math.atan(Math.exp((180-360*(Vt.y+A)/w)*Math.PI/180))-90]}}switch(this.type){case 1:var H=[];for(g=0;g<z.length;g++)H[g]=z[g][0];V(z=H);break;case 2:for(g=0;g<z.length;g++)V(z[g]);break;case 3:for(z=function(vt){var Rt=vt.length;if(Rt<=1)return[vt];for(var Vt,he,re=[],we=0;we<Rt;we++){var Pe=id(vt[we]);0!==Pe&&(void 0===he&&(he=Pe<0),he===Pe<0?(Vt&&re.push(Vt),Vt=[vt[we]]):Vt.push(vt[we]))}return Vt&&re.push(Vt),re}(z),g=0;g<z.length;g++)for(_=0;_<z[g].length;_++)V(z[g][_])}1===z.length?z=z[0]:q="Multi"+q;var st={type:"Feature",geometry:{type:q,coordinates:z},properties:this.properties};return"id"in this&&(st.id=this.id),st};var Kp=$p;function $p(t,n){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=t,this._keys=[],this._values=[],this._features=[],t.readFields(od,this,n),this.length=this._features.length}function od(t,n,u){15===t?n.version=u.readVarint():1===t?n.name=u.readString():5===t?n.extent=u.readVarint():2===t?n._features.push(u.pos):3===t?n._keys.push(u.readString()):4===t&&n._values.push(function(g){for(var _=null,w=g.readVarint()+g.pos;g.pos<w;){var S=g.readVarint()>>3;_=1===S?g.readString():2===S?g.readFloat():3===S?g.readDouble():4===S?g.readVarint64():5===S?g.readVarint():6===S?g.readSVarint():7===S?g.readBoolean():null}return _}(u))}function ad(t,n,u){if(3===t){var g=new Kp(u,u.readVarint()+u.pos);g.length&&(n[g.name]=g)}}$p.prototype.feature=function(t){if(t<0||t>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[t];var n=this._pbf.readVarint()+this._pbf.pos;return new Wp(this._pbf,n,this.extent,this._keys,this._values)};var Lc={VectorTile:function(t,n){this.layers=t.readFields(ad,{},n)},VectorTileFeature:Wp,VectorTileLayer:Kp},sd=Lc.VectorTileFeature.types,sp=Math.pow(2,13);function th(t,n,u,g,_,w,S,A){t.emplaceBack(n,u,2*Math.floor(g*sp)+S,_*sp*2,w*sp*2,Math.round(A))}var gl=function(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(n){return n.id}),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new Js,this.indexArray=new te,this.programConfigurations=new Mo(t.layers,t.zoom),this.segments=new _t,this.stateDependentLayerIds=this.layers.filter(function(n){return n.isStateDependent()}).map(function(n){return n.id})};function ud(t,n){return t.x===n.x&&(t.x<0||t.x>8192)||t.y===n.y&&(t.y<0||t.y>8192)}gl.prototype.populate=function(t,n,u){this.features=[],this.hasPattern=op("fill-extrusion",this.layers,n);for(var g=0,_=t;g<_.length;g+=1){var w=_[g],S=w.feature,A=w.id,z=w.index,q=w.sourceLayerIndex,V=this.layers[0]._featureFilter.needGeometry,H=iu(S,V);if(this.layers[0]._featureFilter.filter(new so(this.zoom),H,u)){var st={id:A,sourceLayerIndex:q,index:z,geometry:V?H.geometry:Ia(S),properties:S.properties,type:S.type,patterns:{}};this.hasPattern?this.features.push(ap("fill-extrusion",this.layers,st,this.zoom,n)):this.addFeature(st,st.geometry,z,u,{}),n.featureIndex.insert(S,st.geometry,z,q,this.index,!0)}}},gl.prototype.addFeatures=function(t,n,u){for(var g=0,_=this.features;g<_.length;g+=1){var w=_[g];this.addFeature(w,w.geometry,w.index,n,u)}},gl.prototype.update=function(t,n,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,n,this.stateDependentLayers,u)},gl.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},gl.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},gl.prototype.upload=function(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,rd),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0},gl.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},gl.prototype.addFeature=function(t,n,u,g,_){for(var w=0,S=ip(n,500);w<S.length;w+=1){for(var A=S[w],z=0,q=0,V=A;q<V.length;q+=1)z+=V[q].length;for(var H=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),st=0,vt=A;st<vt.length;st+=1){var Rt=vt[st];if(0!==Rt.length&&!((fi=Rt).every(function(Xn){return Xn.x<0})||fi.every(function(Xn){return Xn.x>8192})||fi.every(function(Xn){return Xn.y<0})||fi.every(function(Xn){return Xn.y>8192})))for(var Vt=0,he=0;he<Rt.length;he++){var re=Rt[he];if(he>=1){var we=Rt[he-1];if(!ud(re,we)){H.vertexLength+4>_t.MAX_VERTEX_ARRAY_LENGTH&&(H=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));var Pe=re.sub(we)._perp()._unit(),Re=we.dist(re);Vt+Re>32768&&(Vt=0),th(this.layoutVertexArray,re.x,re.y,Pe.x,Pe.y,0,0,Vt),th(this.layoutVertexArray,re.x,re.y,Pe.x,Pe.y,0,1,Vt),th(this.layoutVertexArray,we.x,we.y,Pe.x,Pe.y,0,0,Vt+=Re),th(this.layoutVertexArray,we.x,we.y,Pe.x,Pe.y,0,1,Vt);var ze=H.vertexLength;this.indexArray.emplaceBack(ze,ze+2,ze+1),this.indexArray.emplaceBack(ze+1,ze+2,ze+3),H.vertexLength+=4,H.primitiveLength+=2}}}}if(H.vertexLength+z>_t.MAX_VERTEX_ARRAY_LENGTH&&(H=this.segments.prepareSegment(z,this.layoutVertexArray,this.indexArray)),"Polygon"===sd[t.type]){for(var rr=[],yr=[],Mr=H.vertexLength,Wr=0,Tr=A;Wr<Tr.length;Wr+=1){var ln=Tr[Wr];if(0!==ln.length){ln!==A[0]&&yr.push(rr.length/2);for(var Fr=0;Fr<ln.length;Fr++){var ii=ln[Fr];th(this.layoutVertexArray,ii.x,ii.y,0,0,1,1,0),rr.push(ii.x),rr.push(ii.y)}}}for(var Pn=Ti(rr,yr),Jr=0;Jr<Pn.length;Jr+=3)this.indexArray.emplaceBack(Mr+Pn[Jr],Mr+Pn[Jr+2],Mr+Pn[Jr+1]);H.primitiveLength+=Pn.length/3,H.vertexLength+=z}}var fi;this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,u,_,g)},_r("FillExtrusionBucket",gl,{omit:["layers","features"]});var ld={paint:new Sa({"fill-extrusion-opacity":new Dr(Dt["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new cn(Dt["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Dr(Dt["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Dr(Dt["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Ea(Dt["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new cn(Dt["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new cn(Dt["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Dr(Dt["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})},cd=function(t){function n(u){t.call(this,u,ld)}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n.prototype.createBucket=function(u){return new gl(u)},n.prototype.queryRadius=function(){return fl(this.paint.get("fill-extrusion-translate"))},n.prototype.is3D=function(){return!0},n.prototype.queryIntersectsFeature=function(u,g,_,w,S,A,z,q){var V=Ku(u,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),A.angle,z),H=this.paint.get("fill-extrusion-height").evaluate(g,_),st=this.paint.get("fill-extrusion-base").evaluate(g,_),vt=function(Vt,he,re,we){for(var Pe=[],Re=0,ze=Vt;Re<ze.length;Re+=1){var rr=ze[Re],yr=[rr.x,rr.y,0,1];Kc(yr,yr,he),Pe.push(new Ft(yr[0]/yr[3],yr[1]/yr[3]))}return Pe}(V,q),Rt=function(Vt,he,re,we){for(var Pe=[],Re=[],ze=we[8]*he,rr=we[9]*he,yr=we[10]*he,Mr=we[11]*he,Wr=we[8]*re,Tr=we[9]*re,ln=we[10]*re,Fr=we[11]*re,ii=0,Pn=Vt;ii<Pn.length;ii+=1){for(var Jr=[],fi=[],Xn=0,Ii=Pn[ii];Xn<Ii.length;Xn+=1){var pn=Ii[Xn],uo=pn.x,Qo=pn.y,Pa=we[0]*uo+we[4]*Qo+we[12],Ma=we[1]*uo+we[5]*Qo+we[13],la=we[2]*uo+we[6]*Qo+we[14],ya=we[3]*uo+we[7]*Qo+we[15],is=la+yr,os=ya+Mr,uu=Pa+Wr,Cs=Ma+Tr,Ns=la+ln,Ja=ya+Fr,Rs=new Ft((Pa+ze)/os,(Ma+rr)/os);Rs.z=is/os,Jr.push(Rs);var vi=new Ft(uu/Ja,Cs/Ja);vi.z=Ns/Ja,fi.push(vi)}Pe.push(Jr),Re.push(fi)}return[Pe,Re]}(w,st,H,q);return function(Vt,he,re){var we=1/0;Iu(re,he)&&(we=Qp(re,he[0]));for(var Pe=0;Pe<he.length;Pe++)for(var Re=he[Pe],ze=Vt[Pe],rr=0;rr<Re.length-1;rr++){var yr=Re[rr],Mr=[yr,Re[rr+1],ze[rr+1],ze[rr],yr];yu(re,Mr)&&(we=Math.min(we,Qp(re,Mr)))}return we!==1/0&&we}(Rt[0],Rt[1],vt)},n}(hn);function eh(t,n){return t.x*n.x+t.y*n.y}function Qp(t,n){if(1===t.length){for(var u,g=0,_=n[g++];!u||_.equals(u);)if(!(u=n[g++]))return 1/0;for(;g<n.length;g++){var w=n[g],S=t[0],A=u.sub(_),z=w.sub(_),q=S.sub(_),V=eh(A,A),H=eh(A,z),st=eh(z,z),vt=eh(q,A),Rt=eh(q,z),Vt=V*st-H*H,he=(st*vt-H*Rt)/Vt,re=(V*Rt-H*vt)/Vt,we=_.z*(1-he-re)+u.z*he+w.z*re;if(isFinite(we))return we}return 1/0}for(var Pe=1/0,Re=0,ze=n;Re<ze.length;Re+=1)Pe=Math.min(Pe,ze[Re].z);return Pe}var hd=yo([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4).members,tn=yo([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]).members,Kr=Lc.VectorTileFeature.types,Dn=Math.cos(Math.PI/180*37.5),yn=Math.pow(2,14)/.5,un=function(t){var n=this;this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(u){return u.id}),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(function(u){n.gradients[u.id]={}}),this.layoutVertexArray=new ll,this.layoutVertexArray2=new e,this.indexArray=new te,this.programConfigurations=new Mo(t.layers,t.zoom),this.segments=new _t,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(function(u){return u.isStateDependent()}).map(function(u){return u.id})};un.prototype.populate=function(t,n,u){this.hasPattern=op("line",this.layers,n);for(var g=this.layers[0].layout.get("line-sort-key"),_=!g.isConstant(),w=[],S=0,A=t;S<A.length;S+=1){var z=A[S],q=z.feature,V=z.id,H=z.index,st=z.sourceLayerIndex,vt=this.layers[0]._featureFilter.needGeometry,Rt=iu(q,vt);if(this.layers[0]._featureFilter.filter(new so(this.zoom),Rt,u)){var Vt=_?g.evaluate(Rt,{},u):void 0,he={id:V,properties:q.properties,type:q.type,sourceLayerIndex:st,index:H,geometry:vt?Rt.geometry:Ia(q),patterns:{},sortKey:Vt};w.push(he)}}_&&w.sort(function(Mr,Wr){return Mr.sortKey-Wr.sortKey});for(var re=0,we=w;re<we.length;re+=1){var Pe=we[re],Re=Pe.geometry,ze=Pe.index,rr=Pe.sourceLayerIndex;if(this.hasPattern){var yr=ap("line",this.layers,Pe,this.zoom,n);this.patternFeatures.push(yr)}else this.addFeature(Pe,Re,ze,u,{});n.featureIndex.insert(t[ze].feature,Re,ze,rr,this.index)}},un.prototype.update=function(t,n,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,n,this.stateDependentLayers,u)},un.prototype.addFeatures=function(t,n,u){for(var g=0,_=this.patternFeatures;g<_.length;g+=1){var w=_[g];this.addFeature(w,w.geometry,w.index,n,u)}},un.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},un.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},un.prototype.upload=function(t){this.uploaded||(0!==this.layoutVertexArray2.length&&(this.layoutVertexBuffer2=t.createVertexBuffer(this.layoutVertexArray2,tn)),this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,hd),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0},un.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},un.prototype.lineFeatureClips=function(t){if(t.properties&&t.properties.hasOwnProperty("mapbox_clip_start")&&t.properties.hasOwnProperty("mapbox_clip_end"))return{start:+t.properties.mapbox_clip_start,end:+t.properties.mapbox_clip_end}},un.prototype.addFeature=function(t,n,u,g,_){var w=this.layers[0].layout,S=w.get("line-join").evaluate(t,{}),A=w.get("line-cap"),z=w.get("line-miter-limit"),q=w.get("line-round-limit");this.lineClips=this.lineFeatureClips(t);for(var V=0,H=n;V<H.length;V+=1)this.addLine(H[V],t,S,A,z,q);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,u,_,g)},un.prototype.addLine=function(t,n,u,g,_,w){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(var S=0;S<t.length-1;S++)this.totalDistance+=t[S].dist(t[S+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}for(var A="Polygon"===Kr[n.type],z=t.length;z>=2&&t[z-1].equals(t[z-2]);)z--;for(var q=0;q<z-1&&t[q].equals(t[q+1]);)q++;if(!(z<(A?3:2))){"bevel"===u&&(_=1.05);var V,H=this.overscaling<=16?122880/(512*this.overscaling):0,st=this.segments.prepareSegment(10*z,this.layoutVertexArray,this.indexArray),vt=void 0,Rt=void 0,Vt=void 0,he=void 0;this.e1=this.e2=-1,A&&(he=t[q].sub(V=t[z-2])._unit()._perp());for(var re=q;re<z;re++)if(!(Rt=re===z-1?A?t[q+1]:void 0:t[re+1])||!t[re].equals(Rt)){he&&(Vt=he),V&&(vt=V),V=t[re],he=Rt?Rt.sub(V)._unit()._perp():Vt;var we=(Vt=Vt||he).add(he);0===we.x&&0===we.y||we._unit();var Pe=Vt.x*he.x+Vt.y*he.y,Re=we.x*he.x+we.y*he.y,ze=0!==Re?1/Re:1/0,rr=2*Math.sqrt(2-2*Re),yr=Re<Dn&&vt&&Rt,Mr=Vt.x*he.y-Vt.y*he.x>0;if(yr&&re>q){var Wr=V.dist(vt);if(Wr>2*H){var Tr=V.sub(V.sub(vt)._mult(H/Wr)._round());this.updateDistance(vt,Tr),this.addCurrentVertex(Tr,Vt,0,0,st),vt=Tr}}var ln=vt&&Rt,Fr=ln?u:A?"butt":g;if(ln&&"round"===Fr&&(ze<w?Fr="miter":ze<=2&&(Fr="fakeround")),"miter"===Fr&&ze>_&&(Fr="bevel"),"bevel"===Fr&&(ze>2&&(Fr="flipbevel"),ze<_&&(Fr="miter")),vt&&this.updateDistance(vt,V),"miter"===Fr)we._mult(ze),this.addCurrentVertex(V,we,0,0,st);else if("flipbevel"===Fr){if(ze>100)we=he.mult(-1);else{var ii=ze*Vt.add(he).mag()/Vt.sub(he).mag();we._perp()._mult(ii*(Mr?-1:1))}this.addCurrentVertex(V,we,0,0,st),this.addCurrentVertex(V,we.mult(-1),0,0,st)}else if("bevel"===Fr||"fakeround"===Fr){var Pn=-Math.sqrt(ze*ze-1),Jr=Mr?Pn:0,fi=Mr?0:Pn;if(vt&&this.addCurrentVertex(V,Vt,Jr,fi,st),"fakeround"===Fr)for(var Xn=Math.round(180*rr/Math.PI/20),Ii=1;Ii<Xn;Ii++){var pn=Ii/Xn;if(.5!==pn){var uo=pn-.5;pn+=pn*uo*(pn-1)*((1.0904+Pe*(Pe*(3.55645-1.43519*Pe)-3.2452))*uo*uo+(.848013+Pe*(.215638*Pe-1.06021)))}var Qo=he.sub(Vt)._mult(pn)._add(Vt)._unit()._mult(Mr?-1:1);this.addHalfVertex(V,Qo.x,Qo.y,!1,Mr,0,st)}Rt&&this.addCurrentVertex(V,he,-Jr,-fi,st)}else if("butt"===Fr)this.addCurrentVertex(V,we,0,0,st);else if("square"===Fr){var Pa=vt?1:-1;this.addCurrentVertex(V,we,Pa,Pa,st)}else"round"===Fr&&(vt&&(this.addCurrentVertex(V,Vt,0,0,st),this.addCurrentVertex(V,Vt,1,1,st,!0)),Rt&&(this.addCurrentVertex(V,he,-1,-1,st,!0),this.addCurrentVertex(V,he,0,0,st)));if(yr&&re<z-1){var Ma=V.dist(Rt);if(Ma>2*H){var la=V.add(Rt.sub(V)._mult(H/Ma)._round());this.updateDistance(V,la),this.addCurrentVertex(la,he,0,0,st),V=la}}}}},un.prototype.addCurrentVertex=function(t,n,u,g,_,w){void 0===w&&(w=!1);var S=n.y*g-n.x,A=-n.y-n.x*g;this.addHalfVertex(t,n.x+n.y*u,n.y-n.x*u,w,!1,u,_),this.addHalfVertex(t,S,A,w,!0,-g,_),this.distance>yn/2&&0===this.totalDistance&&(this.distance=0,this.addCurrentVertex(t,n,u,g,_,w))},un.prototype.addHalfVertex=function(t,n,u,g,_,w,S){var A=.5*(this.lineClips?this.scaledDistance*(yn-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((t.x<<1)+(g?1:0),(t.y<<1)+(_?1:0),Math.round(63*n)+128,Math.round(63*u)+128,1+(0===w?0:w<0?-1:1)|(63&A)<<2,A>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);var z=S.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,z),S.primitiveLength++),_?this.e2=z:this.e1=z},un.prototype.updateScaledDistance=function(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance},un.prototype.updateDistance=function(t,n){this.distance+=t.dist(n),this.updateScaledDistance()},_r("LineBucket",un,{omit:["layers","patternFeatures"]});var qn=new Sa({"line-cap":new Dr(Dt.layout_line["line-cap"]),"line-join":new cn(Dt.layout_line["line-join"]),"line-miter-limit":new Dr(Dt.layout_line["line-miter-limit"]),"line-round-limit":new Dr(Dt.layout_line["line-round-limit"]),"line-sort-key":new cn(Dt.layout_line["line-sort-key"])}),zi={paint:new Sa({"line-opacity":new cn(Dt.paint_line["line-opacity"]),"line-color":new cn(Dt.paint_line["line-color"]),"line-translate":new Dr(Dt.paint_line["line-translate"]),"line-translate-anchor":new Dr(Dt.paint_line["line-translate-anchor"]),"line-width":new cn(Dt.paint_line["line-width"]),"line-gap-width":new cn(Dt.paint_line["line-gap-width"]),"line-offset":new cn(Dt.paint_line["line-offset"]),"line-blur":new cn(Dt.paint_line["line-blur"]),"line-dasharray":new Os(Dt.paint_line["line-dasharray"]),"line-pattern":new Ea(Dt.paint_line["line-pattern"]),"line-gradient":new Ys(Dt.paint_line["line-gradient"])}),layout:qn},io=new(function(t){function n(){t.apply(this,arguments)}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n.prototype.possiblyEvaluate=function(u,g){return g=new so(Math.floor(g.zoom),{now:g.now,fadeDuration:g.fadeDuration,zoomHistory:g.zoomHistory,transition:g.transition}),t.prototype.possiblyEvaluate.call(this,u,g)},n.prototype.evaluate=function(u,g,_,w){return g=j({},g,{zoom:Math.floor(g.zoom)}),t.prototype.evaluate.call(this,u,g,_,w)},n}(cn))(zi.paint.properties["line-width"].specification);io.useIntegerZoom=!0;var Zr=function(t){function n(u){t.call(this,u,zi),this.gradientVersion=0}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n.prototype._handleSpecialPaintPropertyUpdate=function(u){"line-gradient"===u&&(this.stepInterpolant=this._transitionablePaint._values["line-gradient"].value.expression._styleExpression.expression instanceof Uo,this.gradientVersion=(this.gradientVersion+1)%_e)},n.prototype.gradientExpression=function(){return this._transitionablePaint._values["line-gradient"].value.expression},n.prototype.recalculate=function(u,g){t.prototype.recalculate.call(this,u,g),this.paint._values["line-floorwidth"]=io.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,u)},n.prototype.createBucket=function(u){return new un(u)},n.prototype.queryRadius=function(u){var g=u,_=pt(Xa("line-width",this,g),Xa("line-gap-width",this,g)),w=Xa("line-offset",this,g);return _/2+Math.abs(w)+fl(this.paint.get("line-translate"))},n.prototype.queryIntersectsFeature=function(u,g,_,w,S,A,z){var q=Ku(u,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),A.angle,z),V=z/2*pt(this.paint.get("line-width").evaluate(g,_),this.paint.get("line-gap-width").evaluate(g,_)),H=this.paint.get("line-offset").evaluate(g,_);return H&&(w=function(st,vt){for(var Rt=[],Vt=new Ft(0,0),he=0;he<st.length;he++){for(var re=st[he],we=[],Pe=0;Pe<re.length;Pe++){var Re=re[Pe],ze=re[Pe+1],rr=0===Pe?Vt:Re.sub(re[Pe-1])._unit()._perp(),yr=Pe===re.length-1?Vt:ze.sub(Re)._unit()._perp(),Mr=rr._add(yr)._unit();Mr._mult(1/(Mr.x*yr.x+Mr.y*yr.y)),we.push(Mr._mult(vt)._add(Re))}Rt.push(we)}return Rt}(w,H*z)),function(st,vt,Rt){for(var Vt=0;Vt<vt.length;Vt++){var he=vt[Vt];if(st.length>=3)for(var re=0;re<he.length;re++)if(pl(st,he[re]))return!0;if(Sh(st,he,Rt))return!0}return!1}(q,w,V)},n.prototype.isTileClipped=function(){return!0},n}(hn);function pt(t,n){return n>0?n+2*t:t}var up=yo([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),pd=yo([{name:"a_projected_pos",components:3,type:"Float32"}],4),fd=(yo([{name:"a_fade_opacity",components:1,type:"Uint32"}],4),yo([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}])),tf=(yo([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]),yo([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4)),dd=yo([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function gd(t,n,u){return t.sections.forEach(function(g){var _,S,A;g.text=(_=g.text,S=u,"uppercase"===(A=n.layout.get("text-transform").evaluate(S,{}))?_=_.toLocaleUpperCase():"lowercase"===A&&(_=_.toLocaleLowerCase()),ui.applyArabicShaping&&(_=ui.applyArabicShaping(_)),_)}),t}yo([{name:"triangle",components:3,type:"Uint16"}]),yo([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),yo([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),yo([{type:"Float32",name:"offsetX"}]),yo([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);var rh={"!":"\ufe15","#":"\uff03",$:"\uff04","%":"\uff05","&":"\uff06","(":"\ufe35",")":"\ufe36","*":"\uff0a","+":"\uff0b",",":"\ufe10","-":"\ufe32",".":"\u30fb","/":"\uff0f",":":"\ufe13",";":"\ufe14","<":"\ufe3f","=":"\uff1d",">":"\ufe40","?":"\ufe16","@":"\uff20","[":"\ufe47","\\":"\uff3c","]":"\ufe48","^":"\uff3e",_:"\ufe33","`":"\uff40","{":"\ufe37","|":"\u2015","}":"\ufe38","~":"\uff5e","\xa2":"\uffe0","\xa3":"\uffe1","\xa5":"\uffe5","\xa6":"\uffe4","\xac":"\uffe2","\xaf":"\uffe3","\u2013":"\ufe32","\u2014":"\ufe31","\u2018":"\ufe43","\u2019":"\ufe44","\u201c":"\ufe41","\u201d":"\ufe42","\u2026":"\ufe19","\u2027":"\u30fb","\u20a9":"\uffe6","\u3001":"\ufe11","\u3002":"\ufe12","\u3008":"\ufe3f","\u3009":"\ufe40","\u300a":"\ufe3d","\u300b":"\ufe3e","\u300c":"\ufe41","\u300d":"\ufe42","\u300e":"\ufe43","\u300f":"\ufe44","\u3010":"\ufe3b","\u3011":"\ufe3c","\u3014":"\ufe39","\u3015":"\ufe3a","\u3016":"\ufe17","\u3017":"\ufe18","\uff01":"\ufe15","\uff08":"\ufe35","\uff09":"\ufe36","\uff0c":"\ufe10","\uff0d":"\ufe32","\uff0e":"\u30fb","\uff1a":"\ufe13","\uff1b":"\ufe14","\uff1c":"\ufe3f","\uff1e":"\ufe40","\uff1f":"\ufe16","\uff3b":"\ufe47","\uff3d":"\ufe48","\uff3f":"\ufe33","\uff5b":"\ufe37","\uff5c":"\u2015","\uff5d":"\ufe38","\uff5f":"\ufe35","\uff60":"\ufe36","\uff61":"\ufe12","\uff62":"\ufe41","\uff63":"\ufe42"},ef=function(t,n,u,g,_){var w,S,A=8*_-g-1,z=(1<<A)-1,q=z>>1,V=-7,H=u?_-1:0,st=u?-1:1,vt=t[n+H];for(H+=st,w=vt&(1<<-V)-1,vt>>=-V,V+=A;V>0;w=256*w+t[n+H],H+=st,V-=8);for(S=w&(1<<-V)-1,w>>=-V,V+=g;V>0;S=256*S+t[n+H],H+=st,V-=8);if(0===w)w=1-q;else{if(w===z)return S?NaN:1/0*(vt?-1:1);S+=Math.pow(2,g),w-=q}return(vt?-1:1)*S*Math.pow(2,w-g)},md=function(t,n,u,g,_,w){var S,A,z,q=8*w-_-1,V=(1<<q)-1,H=V>>1,st=23===_?Math.pow(2,-24)-Math.pow(2,-77):0,vt=g?0:w-1,Rt=g?1:-1,Vt=n<0||0===n&&1/n<0?1:0;for(n=Math.abs(n),isNaN(n)||n===1/0?(A=isNaN(n)?1:0,S=V):(S=Math.floor(Math.log(n)/Math.LN2),n*(z=Math.pow(2,-S))<1&&(S--,z*=2),(n+=S+H>=1?st/z:st*Math.pow(2,1-H))*z>=2&&(S++,z/=2),S+H>=V?(A=0,S=V):S+H>=1?(A=(n*z-1)*Math.pow(2,_),S+=H):(A=n*Math.pow(2,H-1)*Math.pow(2,_),S=0));_>=8;t[u+vt]=255&A,vt+=Rt,A/=256,_-=8);for(S=S<<_|A,q+=_;q>0;t[u+vt]=255&S,vt+=Rt,S/=256,q-=8);t[u+vt-Rt]|=128*Vt},Ah=jo;function jo(t){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(t)?t:new Uint8Array(t||0),this.pos=0,this.type=0,this.length=this.buf.length}jo.Varint=0,jo.Fixed64=1,jo.Bytes=2,jo.Fixed32=5;var rf=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function Rl(t){return t.type===jo.Bytes?t.readVarint()+t.pos:t.pos+1}function nf(t,n,u){var g=n<=16383?1:n<=2097151?2:n<=268435455?3:Math.floor(Math.log(n)/(7*Math.LN2));u.realloc(g);for(var _=u.pos-1;_>=t;_--)u.buf[_+g]=u.buf[_]}function cg(t,n){for(var u=0;u<t.length;u++)n.writeVarint(t[u])}function hg(t,n){for(var u=0;u<t.length;u++)n.writeSVarint(t[u])}function pg(t,n){for(var u=0;u<t.length;u++)n.writeFloat(t[u])}function fg(t,n){for(var u=0;u<t.length;u++)n.writeDouble(t[u])}function of(t,n){for(var u=0;u<t.length;u++)n.writeBoolean(t[u])}function yd(t,n){for(var u=0;u<t.length;u++)n.writeFixed32(t[u])}function dg(t,n){for(var u=0;u<t.length;u++)n.writeSFixed32(t[u])}function gg(t,n){for(var u=0;u<t.length;u++)n.writeFixed64(t[u])}function mg(t,n){for(var u=0;u<t.length;u++)n.writeSFixed64(t[u])}function gc(t,n){return(t[n]|t[n+1]<<8|t[n+2]<<16)+16777216*t[n+3]}function Wl(t,n,u){t[u]=n,t[u+1]=n>>>8,t[u+2]=n>>>16,t[u+3]=n>>>24}function af(t,n){return(t[n]|t[n+1]<<8|t[n+2]<<16)+(t[n+3]<<24)}function vd(t,n,u){1===t&&u.readMessage(_d,n)}function _d(t,n,u){if(3===t){var g=u.readMessage(xd,{}),_=g.width,w=g.height,S=g.left,A=g.top,z=g.advance;n.push({id:g.id,bitmap:new ou({width:_+6,height:w+6},g.bitmap),metrics:{width:_,height:w,left:S,top:A,advance:z}})}}function xd(t,n,u){1===t?n.id=u.readVarint():2===t?n.bitmap=u.readBytes():3===t?n.width=u.readVarint():4===t?n.height=u.readVarint():5===t?n.left=u.readSVarint():6===t?n.top=u.readSVarint():7===t&&(n.advance=u.readVarint())}function sf(t){for(var n=0,u=0,g=0,_=t;g<_.length;g+=1){var w=_[g];n+=w.w*w.h,u=Math.max(u,w.w)}t.sort(function(Vt,he){return he.h-Vt.h});for(var S=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(n/.95)),u),h:1/0}],A=0,z=0,q=0,V=t;q<V.length;q+=1)for(var H=V[q],st=S.length-1;st>=0;st--){var vt=S[st];if(!(H.w>vt.w||H.h>vt.h)){if(H.x=vt.x,H.y=vt.y,z=Math.max(z,H.y+H.h),A=Math.max(A,H.x+H.w),H.w===vt.w&&H.h===vt.h){var Rt=S.pop();st<S.length&&(S[st]=Rt)}else H.h===vt.h?(vt.x+=H.w,vt.w-=H.w):H.w===vt.w?(vt.y+=H.h,vt.h-=H.h):(S.push({x:vt.x+H.w,y:vt.y,w:vt.w-H.w,h:H.h}),vt.y+=H.h,vt.h-=H.h);break}}return{w:A,h:z,fill:n/(A*z)||0}}jo.prototype={destroy:function(){this.buf=null},readFields:function(t,n,u){for(u=u||this.length;this.pos<u;){var g=this.readVarint(),_=g>>3,w=this.pos;this.type=7&g,t(_,n,this),this.pos===w&&this.skip(g)}return n},readMessage:function(t,n){return this.readFields(t,n,this.readVarint()+this.pos)},readFixed32:function(){var t=gc(this.buf,this.pos);return this.pos+=4,t},readSFixed32:function(){var t=af(this.buf,this.pos);return this.pos+=4,t},readFixed64:function(){var t=gc(this.buf,this.pos)+4294967296*gc(this.buf,this.pos+4);return this.pos+=8,t},readSFixed64:function(){var t=gc(this.buf,this.pos)+4294967296*af(this.buf,this.pos+4);return this.pos+=8,t},readFloat:function(){var t=ef(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=ef(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(t){var n,u,g=this.buf;return n=127&(u=g[this.pos++]),u<128?n:(n|=(127&(u=g[this.pos++]))<<7,u<128?n:(n|=(127&(u=g[this.pos++]))<<14,u<128?n:(n|=(127&(u=g[this.pos++]))<<21,u<128?n:function(_,w,S){var A,z,q=S.buf;if(A=(112&(z=q[S.pos++]))>>4,z<128||(A|=(127&(z=q[S.pos++]))<<3,z<128)||(A|=(127&(z=q[S.pos++]))<<10,z<128)||(A|=(127&(z=q[S.pos++]))<<17,z<128)||(A|=(127&(z=q[S.pos++]))<<24,z<128)||(A|=(1&(z=q[S.pos++]))<<31,z<128))return function Dc(t,n,u){return u?4294967296*n+(t>>>0):4294967296*(n>>>0)+(t>>>0)}(_,A,w);throw new Error("Expected varint not more than 10 bytes")}(n|=(15&(u=g[this.pos]))<<28,t,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var t=this.readVarint();return t%2==1?(t+1)/-2:t/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var t=this.readVarint()+this.pos,n=this.pos;return this.pos=t,t-n>=12&&rf?rf.decode(this.buf.subarray(n,t)):function(u,g,_){for(var w="",S=g;S<_;){var A,z,q,V=u[S],H=null,st=V>239?4:V>223?3:V>191?2:1;if(S+st>_)break;1===st?V<128&&(H=V):2===st?128==(192&(A=u[S+1]))&&(H=(31&V)<<6|63&A)<=127&&(H=null):3===st?(z=u[S+2],128==(192&(A=u[S+1]))&&128==(192&z)&&((H=(15&V)<<12|(63&A)<<6|63&z)<=2047||H>=55296&&H<=57343)&&(H=null)):4===st&&(z=u[S+2],q=u[S+3],128==(192&(A=u[S+1]))&&128==(192&z)&&128==(192&q)&&((H=(15&V)<<18|(63&A)<<12|(63&z)<<6|63&q)<=65535||H>=1114112)&&(H=null)),null===H?(H=65533,st=1):H>65535&&(H-=65536,w+=String.fromCharCode(H>>>10&1023|55296),H=56320|1023&H),w+=String.fromCharCode(H),S+=st}return w}(this.buf,n,t)},readBytes:function(){var t=this.readVarint()+this.pos,n=this.buf.subarray(this.pos,t);return this.pos=t,n},readPackedVarint:function(t,n){if(this.type!==jo.Bytes)return t.push(this.readVarint(n));var u=Rl(this);for(t=t||[];this.pos<u;)t.push(this.readVarint(n));return t},readPackedSVarint:function(t){if(this.type!==jo.Bytes)return t.push(this.readSVarint());var n=Rl(this);for(t=t||[];this.pos<n;)t.push(this.readSVarint());return t},readPackedBoolean:function(t){if(this.type!==jo.Bytes)return t.push(this.readBoolean());var n=Rl(this);for(t=t||[];this.pos<n;)t.push(this.readBoolean());return t},readPackedFloat:function(t){if(this.type!==jo.Bytes)return t.push(this.readFloat());var n=Rl(this);for(t=t||[];this.pos<n;)t.push(this.readFloat());return t},readPackedDouble:function(t){if(this.type!==jo.Bytes)return t.push(this.readDouble());var n=Rl(this);for(t=t||[];this.pos<n;)t.push(this.readDouble());return t},readPackedFixed32:function(t){if(this.type!==jo.Bytes)return t.push(this.readFixed32());var n=Rl(this);for(t=t||[];this.pos<n;)t.push(this.readFixed32());return t},readPackedSFixed32:function(t){if(this.type!==jo.Bytes)return t.push(this.readSFixed32());var n=Rl(this);for(t=t||[];this.pos<n;)t.push(this.readSFixed32());return t},readPackedFixed64:function(t){if(this.type!==jo.Bytes)return t.push(this.readFixed64());var n=Rl(this);for(t=t||[];this.pos<n;)t.push(this.readFixed64());return t},readPackedSFixed64:function(t){if(this.type!==jo.Bytes)return t.push(this.readSFixed64());var n=Rl(this);for(t=t||[];this.pos<n;)t.push(this.readSFixed64());return t},skip:function(t){var n=7&t;if(n===jo.Varint)for(;this.buf[this.pos++]>127;);else if(n===jo.Bytes)this.pos=this.readVarint()+this.pos;else if(n===jo.Fixed32)this.pos+=4;else{if(n!==jo.Fixed64)throw new Error("Unimplemented type: "+n);this.pos+=8}},writeTag:function(t,n){this.writeVarint(t<<3|n)},realloc:function(t){for(var n=this.length||16;n<this.pos+t;)n*=2;if(n!==this.length){var u=new Uint8Array(n);u.set(this.buf),this.buf=u,this.length=n}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(t){this.realloc(4),Wl(this.buf,t,this.pos),this.pos+=4},writeSFixed32:function(t){this.realloc(4),Wl(this.buf,t,this.pos),this.pos+=4},writeFixed64:function(t){this.realloc(8),Wl(this.buf,-1&t,this.pos),Wl(this.buf,Math.floor(t*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(t){this.realloc(8),Wl(this.buf,-1&t,this.pos),Wl(this.buf,Math.floor(t*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(t){(t=+t||0)>268435455||t<0?function(n,u){var g,_,w,A;if(n>=0?(g=n%4294967296|0,_=n/4294967296|0):(_=~(-n/4294967296),4294967295^(g=~(-n%4294967296))?g=g+1|0:(g=0,_=_+1|0)),n>=0x10000000000000000||n<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");u.realloc(10),w=g,(A=u).buf[A.pos++]=127&w|128,w>>>=7,A.buf[A.pos++]=127&w|128,w>>>=7,A.buf[A.pos++]=127&w|128,w>>>=7,A.buf[A.pos++]=127&w|128,A.buf[A.pos]=127&(w>>>=7),function(w,S){var A=(7&w)<<4;S.buf[S.pos++]|=A|((w>>>=3)?128:0),w&&(S.buf[S.pos++]=127&w|((w>>>=7)?128:0),w&&(S.buf[S.pos++]=127&w|((w>>>=7)?128:0),w&&(S.buf[S.pos++]=127&w|((w>>>=7)?128:0),w&&(S.buf[S.pos++]=127&w|((w>>>=7)?128:0),w&&(S.buf[S.pos++]=127&w)))))}(_,u)}(t,this):(this.realloc(4),this.buf[this.pos++]=127&t|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=t>>>7&127))))},writeSVarint:function(t){this.writeVarint(t<0?2*-t-1:2*t)},writeBoolean:function(t){this.writeVarint(Boolean(t))},writeString:function(t){t=String(t),this.realloc(4*t.length),this.pos++;var n=this.pos;this.pos=function(g,_,w){for(var S,A,z=0;z<_.length;z++){if((S=_.charCodeAt(z))>55295&&S<57344){if(!A){S>56319||z+1===_.length?(g[w++]=239,g[w++]=191,g[w++]=189):A=S;continue}if(S<56320){g[w++]=239,g[w++]=191,g[w++]=189,A=S;continue}S=A-55296<<10|S-56320|65536,A=null}else A&&(g[w++]=239,g[w++]=191,g[w++]=189,A=null);S<128?g[w++]=S:(S<2048?g[w++]=S>>6|192:(S<65536?g[w++]=S>>12|224:(g[w++]=S>>18|240,g[w++]=S>>12&63|128),g[w++]=S>>6&63|128),g[w++]=63&S|128)}return w}(this.buf,t,this.pos);var u=this.pos-n;u>=128&&nf(n,u,this),this.pos=n-1,this.writeVarint(u),this.pos+=u},writeFloat:function(t){this.realloc(4),md(this.buf,t,this.pos,!0,23,4),this.pos+=4},writeDouble:function(t){this.realloc(8),md(this.buf,t,this.pos,!0,52,8),this.pos+=8},writeBytes:function(t){var n=t.length;this.writeVarint(n),this.realloc(n);for(var u=0;u<n;u++)this.buf[this.pos++]=t[u]},writeRawMessage:function(t,n){this.pos++;var u=this.pos;t(n,this);var g=this.pos-u;g>=128&&nf(u,g,this),this.pos=u-1,this.writeVarint(g),this.pos+=g},writeMessage:function(t,n,u){this.writeTag(t,jo.Bytes),this.writeRawMessage(n,u)},writePackedVarint:function(t,n){n.length&&this.writeMessage(t,cg,n)},writePackedSVarint:function(t,n){n.length&&this.writeMessage(t,hg,n)},writePackedBoolean:function(t,n){n.length&&this.writeMessage(t,of,n)},writePackedFloat:function(t,n){n.length&&this.writeMessage(t,pg,n)},writePackedDouble:function(t,n){n.length&&this.writeMessage(t,fg,n)},writePackedFixed32:function(t,n){n.length&&this.writeMessage(t,yd,n)},writePackedSFixed32:function(t,n){n.length&&this.writeMessage(t,dg,n)},writePackedFixed64:function(t,n){n.length&&this.writeMessage(t,gg,n)},writePackedSFixed64:function(t,n){n.length&&this.writeMessage(t,mg,n)},writeBytesField:function(t,n){this.writeTag(t,jo.Bytes),this.writeBytes(n)},writeFixed32Field:function(t,n){this.writeTag(t,jo.Fixed32),this.writeFixed32(n)},writeSFixed32Field:function(t,n){this.writeTag(t,jo.Fixed32),this.writeSFixed32(n)},writeFixed64Field:function(t,n){this.writeTag(t,jo.Fixed64),this.writeFixed64(n)},writeSFixed64Field:function(t,n){this.writeTag(t,jo.Fixed64),this.writeSFixed64(n)},writeVarintField:function(t,n){this.writeTag(t,jo.Varint),this.writeVarint(n)},writeSVarintField:function(t,n){this.writeTag(t,jo.Varint),this.writeSVarint(n)},writeStringField:function(t,n){this.writeTag(t,jo.Bytes),this.writeString(n)},writeFloatField:function(t,n){this.writeTag(t,jo.Fixed32),this.writeFloat(n)},writeDoubleField:function(t,n){this.writeTag(t,jo.Fixed64),this.writeDouble(n)},writeBooleanField:function(t,n){this.writeVarintField(t,Boolean(n))}};var Lh=function(t,n){var u=n.pixelRatio,g=n.version,_=n.stretchX,w=n.stretchY,S=n.content;this.paddedRect=t,this.pixelRatio=u,this.stretchX=_,this.stretchY=w,this.content=S,this.version=g},Dh={tl:{configurable:!0},br:{configurable:!0},tlbr:{configurable:!0},displaySize:{configurable:!0}};Dh.tl.get=function(){return[this.paddedRect.x+1,this.paddedRect.y+1]},Dh.br.get=function(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]},Dh.tlbr.get=function(){return this.tl.concat(this.br)},Dh.displaySize.get=function(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]},Object.defineProperties(Lh.prototype,Dh);var Oc=function(t,n){var u={},g={};this.haveRenderCallbacks=[];var _=[];this.addImages(t,u,_),this.addImages(n,g,_);var w=sf(_),S=new To({width:w.w||1,height:w.h||1});for(var A in t){var z=t[A],q=u[A].paddedRect;To.copy(z.data,S,{x:0,y:0},{x:q.x+1,y:q.y+1},z.data)}for(var V in n){var H=n[V],st=g[V].paddedRect,vt=st.x+1,Rt=st.y+1,Vt=H.data.width,he=H.data.height;To.copy(H.data,S,{x:0,y:0},{x:vt,y:Rt},H.data),To.copy(H.data,S,{x:0,y:he-1},{x:vt,y:Rt-1},{width:Vt,height:1}),To.copy(H.data,S,{x:0,y:0},{x:vt,y:Rt+he},{width:Vt,height:1}),To.copy(H.data,S,{x:Vt-1,y:0},{x:vt-1,y:Rt},{width:1,height:he}),To.copy(H.data,S,{x:0,y:0},{x:vt+Vt,y:Rt},{width:1,height:he})}this.image=S,this.iconPositions=u,this.patternPositions=g};Oc.prototype.addImages=function(t,n,u){for(var g in t){var _=t[g],w={x:0,y:0,w:_.data.width+2,h:_.data.height+2};u.push(w),n[g]=new Lh(w,_),_.hasRenderCallback&&this.haveRenderCallbacks.push(g)}},Oc.prototype.patchUpdatedImages=function(t,n){for(var u in t.dispatchRenderCallbacks(this.haveRenderCallbacks),t.updatedImages)this.patchUpdatedImage(this.iconPositions[u],t.getImage(u),n),this.patchUpdatedImage(this.patternPositions[u],t.getImage(u),n)},Oc.prototype.patchUpdatedImage=function(t,n,u){if(t&&n&&t.version!==n.version){t.version=n.version;var g=t.tl;u.update(n.data,void 0,{x:g[0],y:g[1]})}},_r("ImagePosition",Lh),_r("ImageAtlas",Oc);var qu={horizontal:1,vertical:2,horizontalOnly:3},nh=function(){this.scale=1,this.fontStack="",this.imageName=null};nh.forText=function(t,n){var u=new nh;return u.scale=t||1,u.fontStack=n,u},nh.forImage=function(t){var n=new nh;return n.imageName=t,n};var su=function(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null};function kc(t,n,u,g,_,w,S,A,z,q,V,H,st,vt,Rt,Vt){var he,re=su.fromFeature(t,_);H===qu.vertical&&re.verticalizePunctuation();var we=ui.processBidirectionalText,Pe=ui.processStyledBidirectionalText;if(we&&1===re.sections.length){he=[];for(var Re=0,ze=we(re.toString(),lp(re,q,w,n,g,vt,Rt));Re<ze.length;Re+=1){var rr=ze[Re],yr=new su;yr.text=rr,yr.sections=re.sections;for(var Mr=0;Mr<rr.length;Mr++)yr.sectionIndex.push(0);he.push(yr)}}else if(Pe){he=[];for(var Wr=0,Tr=Pe(re.text,re.sectionIndex,lp(re,q,w,n,g,vt,Rt));Wr<Tr.length;Wr+=1){var ln=Tr[Wr],Fr=new su;Fr.text=ln[0],Fr.sectionIndex=ln[1],Fr.sections=re.sections,he.push(Fr)}}else he=function(Jr,fi){for(var Xn=[],Ii=Jr.text,pn=0,uo=0,Qo=fi;uo<Qo.length;uo+=1){var Pa=Qo[uo];Xn.push(Jr.substring(pn,Pa)),pn=Pa}return pn<Ii.length&&Xn.push(Jr.substring(pn,Ii.length)),Xn}(re,lp(re,q,w,n,g,vt,Rt));var ii=[],Pn={positionedLines:ii,text:re.toString(),top:V[1],bottom:V[1],left:V[0],right:V[0],writingMode:H,iconsInText:!1,verticalizable:!1};return function(Jr,fi,Xn,Ii,pn,uo,Qo,Pa,Ma,la,ya,is){for(var os=0,uu=-17,Cs=0,Ns=0,Ja="right"===Pa?1:"left"===Pa?0:.5,Rs=0,vi=0,Oo=pn;vi<Oo.length;vi+=1){var vo=Oo[vi];vo.trim();var Li=vo.getMaxScale(),_u=24*(Li-1),Fs={positionedGlyphs:[],lineOffset:0};Jr.positionedLines[Rs]=Fs;var ia=Fs.positionedGlyphs,Ha=0;if(vo.length()){for(var lu=0;lu<vo.length();lu++){var oo=vo.getSection(lu),ml=vo.getSectionIndex(lu),Gu=vo.getCharCode(lu),Ul=0,Wa=null,ql=null,yl=null,hh=24,Vu=!(Ma===qu.horizontal||!ya&&!jl(Gu)||ya&&(Oh[Gu]||(Zu=Gu,Ir.Arabic(Zu)||Ir["Arabic Supplement"](Zu)||Ir["Arabic Extended-A"](Zu)||Ir["Arabic Presentation Forms-A"](Zu)||Ir["Arabic Presentation Forms-B"](Zu))));if(oo.imageName){var Gl=Ii[oo.imageName];if(!Gl)continue;yl=oo.imageName,Jr.iconsInText=Jr.iconsInText||!0,ql=Gl.paddedRect;var ol=Gl.displaySize;oo.scale=24*oo.scale/is,Ul=_u+(24-ol[1]*oo.scale),hh=(Wa={width:ol[0],height:ol[1],left:1,top:-3,advance:Vu?ol[1]:ol[0]}).advance;var wc=Vu?ol[0]*oo.scale-24*Li:ol[1]*oo.scale-24*Li;wc>0&&wc>Ha&&(Ha=wc)}else{var ds=Xn[oo.fontStack],ph=ds&&ds[Gu];if(ph&&ph.rect)ql=ph.rect,Wa=ph.metrics;else{var va=fi[oo.fontStack],xu=va&&va[Gu];if(!xu)continue;Wa=xu.metrics}Ul=24*(Li-oo.scale)}Vu?(Jr.verticalizable=!0,ia.push({glyph:Gu,imageName:yl,x:os,y:uu+Ul,vertical:Vu,scale:oo.scale,fontStack:oo.fontStack,sectionIndex:ml,metrics:Wa,rect:ql}),os+=hh*oo.scale+la):(ia.push({glyph:Gu,imageName:yl,x:os,y:uu+Ul,vertical:Vu,scale:oo.scale,fontStack:oo.fontStack,sectionIndex:ml,metrics:Wa,rect:ql}),os+=Wa.advance*oo.scale+la)}0!==ia.length&&(Cs=Math.max(os-la,Cs),bd(ia,0,ia.length-1,Ja,Ha)),os=0;var Ec=uo*Li+Ha;Fs.lineOffset=Math.max(Ha,_u),uu+=Ec,Ns=Math.max(Ec,Ns),++Rs}else uu+=uo,++Rs}var Zu,Sc=uu- -17,ta=cp(Qo),Is=ta.horizontalAlign,Ml=ta.verticalAlign;(function(Vl,_o,Vh,Uc,Sp,qc,Zh,Pi,Cp){var ju,fh=(_o-Vh)*Sp;ju=qc!==Zh?-Pi*Uc- -17:(-Uc*Cp+.5)*Zh;for(var Gc=0,Tl=Vl;Gc<Tl.length;Gc+=1)for(var Vc=0,_a=Tl[Gc].positionedGlyphs;Vc<_a.length;Vc+=1){var Zl=_a[Vc];Zl.x+=fh,Zl.y+=ju}})(Jr.positionedLines,Ja,Is,Ml,Cs,Ns,uo,Sc,pn.length),Jr.top+=-Ml*Sc,Jr.bottom=Jr.top+Sc,Jr.left+=-Is*Cs,Jr.right=Jr.left+Cs}(Pn,n,u,g,he,S,A,z,H,q,st,Vt),!function(Jr){for(var fi=0,Xn=Jr;fi<Xn.length;fi+=1)if(0!==Xn[fi].positionedGlyphs.length)return!1;return!0}(ii)&&Pn}su.fromFeature=function(t,n){for(var u=new su,g=0;g<t.sections.length;g++){var _=t.sections[g];_.image?u.addImageSection(_):u.addTextSection(_,n)}return u},su.prototype.length=function(){return this.text.length},su.prototype.getSection=function(t){return this.sections[this.sectionIndex[t]]},su.prototype.getSectionIndex=function(t){return this.sectionIndex[t]},su.prototype.getCharCode=function(t){return this.text.charCodeAt(t)},su.prototype.verticalizePunctuation=function(){this.text=function(t){for(var n="",u=0;u<t.length;u++){var g=t.charCodeAt(u+1)||null,_=t.charCodeAt(u-1)||null;n+=g&&eu(g)&&!rh[t[u+1]]||_&&eu(_)&&!rh[t[u-1]]||!rh[t[u]]?t[u]:rh[t[u]]}return n}(this.text)},su.prototype.trim=function(){for(var t=0,n=0;n<this.text.length&&Oh[this.text.charCodeAt(n)];n++)t++;for(var u=this.text.length,g=this.text.length-1;g>=0&&g>=t&&Oh[this.text.charCodeAt(g)];g--)u--;this.text=this.text.substring(t,u),this.sectionIndex=this.sectionIndex.slice(t,u)},su.prototype.substring=function(t,n){var u=new su;return u.text=this.text.substring(t,n),u.sectionIndex=this.sectionIndex.slice(t,n),u.sections=this.sections,u},su.prototype.toString=function(){return this.text},su.prototype.getMaxScale=function(){var t=this;return this.sectionIndex.reduce(function(n,u){return Math.max(n,t.sections[u].scale)},0)},su.prototype.addTextSection=function(t,n){this.text+=t.text,this.sections.push(nh.forText(t.scale,t.fontStack||n));for(var u=this.sections.length-1,g=0;g<t.text.length;++g)this.sectionIndex.push(u)},su.prototype.addImageSection=function(t){var n=t.image?t.image.name:"";if(0!==n.length){var u=this.getNextImageSectionCharCode();u?(this.text+=String.fromCharCode(u),this.sections.push(nh.forImage(n)),this.sectionIndex.push(this.sections.length-1)):St("Reached maximum number of images 6401")}else St("Can't add FormattedSection with an empty image.")},su.prototype.getNextImageSectionCharCode=function(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)};var Oh={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},Pu={};function uf(t,n,u,g,_,w){if(n.imageName){var S=g[n.imageName];return S?S.displaySize[0]*n.scale*24/w+_:0}var A=u[n.fontStack],z=A&&A[t];return z?z.metrics.advance*n.scale+_:0}function lf(t,n,u,g){var _=Math.pow(t-n,2);return g?t<n?_/2:2*_:_+Math.abs(u)*u}function cf(t,n,u){var g=0;return 10===t&&(g-=1e4),u&&(g+=150),40!==t&&65288!==t||(g+=50),41!==n&&65289!==n||(g+=50),g}function hf(t,n,u,g,_,w){for(var S=null,A=lf(n,u,_,w),z=0,q=g;z<q.length;z+=1){var V=q[z],H=lf(n-V.x,u,_,w)+V.badness;H<=A&&(S=V,A=H)}return{index:t,x:n,priorBreak:S,badness:A}}function lp(t,n,u,g,_,w,S){if("point"!==w)return[];if(!t)return[];for(var A,z=[],q=function(he,re,we,Pe,Re,ze){for(var rr=0,yr=0;yr<he.length();yr++){var Mr=he.getSection(yr);rr+=uf(he.getCharCode(yr),Mr,Pe,Re,re,ze)}return rr/Math.max(1,Math.ceil(rr/we))}(t,n,u,g,_,S),V=t.text.indexOf("\u200b")>=0,H=0,st=0;st<t.length();st++){var vt=t.getSection(st),Rt=t.getCharCode(st);if(Oh[Rt]||(H+=uf(Rt,vt,g,_,n,S)),st<t.length()-1){var Vt=!((A=Rt)<11904||!(Ir["Bopomofo Extended"](A)||Ir.Bopomofo(A)||Ir["CJK Compatibility Forms"](A)||Ir["CJK Compatibility Ideographs"](A)||Ir["CJK Compatibility"](A)||Ir["CJK Radicals Supplement"](A)||Ir["CJK Strokes"](A)||Ir["CJK Symbols and Punctuation"](A)||Ir["CJK Unified Ideographs Extension A"](A)||Ir["CJK Unified Ideographs"](A)||Ir["Enclosed CJK Letters and Months"](A)||Ir["Halfwidth and Fullwidth Forms"](A)||Ir.Hiragana(A)||Ir["Ideographic Description Characters"](A)||Ir["Kangxi Radicals"](A)||Ir["Katakana Phonetic Extensions"](A)||Ir.Katakana(A)||Ir["Vertical Forms"](A)||Ir["Yi Radicals"](A)||Ir["Yi Syllables"](A)));(Pu[Rt]||Vt||vt.imageName)&&z.push(hf(st+1,H,q,z,cf(Rt,t.getCharCode(st+1),Vt&&V),!1))}}return function he(re){return re?he(re.priorBreak).concat(re.index):[]}(hf(t.length(),H,q,z,0,!0))}function cp(t){var n=.5,u=.5;switch(t){case"right":case"top-right":case"bottom-right":n=1;break;case"left":case"top-left":case"bottom-left":n=0}switch(t){case"bottom":case"bottom-right":case"bottom-left":u=1;break;case"top":case"top-right":case"top-left":u=0}return{horizontalAlign:n,verticalAlign:u}}function bd(t,n,u,g,_){if(g||_)for(var w=t[u],S=(t[u].x+w.metrics.advance*w.scale)*g,A=n;A<=u;A++)t[A].x-=S,t[A].y+=_}function pf(t,n,u,g,_,w){var S,A=t.image;if(A.content){var z=A.content,q=A.pixelRatio||1;S=[z[0]/q,z[1]/q,A.displaySize[0]-z[2]/q,A.displaySize[1]-z[3]/q]}var V,H,st,vt,Rt=n.left*w,Vt=n.right*w;"width"===u||"both"===u?(vt=_[0]+Rt-g[3],H=_[0]+Vt+g[1]):H=(vt=_[0]+(Rt+Vt-A.displaySize[0])/2)+A.displaySize[0];var he=n.top*w,re=n.bottom*w;return"height"===u||"both"===u?(V=_[1]+he-g[0],st=_[1]+re+g[2]):st=(V=_[1]+(he+re-A.displaySize[1])/2)+A.displaySize[1],{image:A,top:V,right:H,bottom:st,left:vt,collisionPadding:S}}Pu[10]=!0,Pu[32]=!0,Pu[38]=!0,Pu[40]=!0,Pu[41]=!0,Pu[43]=!0,Pu[45]=!0,Pu[47]=!0,Pu[173]=!0,Pu[183]=!0,Pu[8203]=!0,Pu[8208]=!0,Pu[8211]=!0,Pu[8231]=!0;var ih=function(t){function n(u,g,_,w){t.call(this,u,g),this.angle=_,void 0!==w&&(this.segment=w)}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n.prototype.clone=function(){return new n(this.x,this.y,this.angle,this.segment)},n}(Ft);function ff(t,n){var u=n.expression;if("constant"===u.kind)return{kind:"constant",layoutSize:u.evaluate(new so(t+1))};if("source"===u.kind)return{kind:"source"};for(var g=u.zoomStops,_=u.interpolationType,w=0;w<g.length&&g[w]<=t;)w++;for(var S=w=Math.max(0,w-1);S<g.length&&g[S]<t+1;)S++;S=Math.min(g.length-1,S);var A=g[w],z=g[S];return"composite"===u.kind?{kind:"composite",minZoom:A,maxZoom:z,interpolationType:_}:{kind:"camera",minZoom:A,maxZoom:z,minSize:u.evaluate(new so(A)),maxSize:u.evaluate(new so(z)),interpolationType:_}}function wd(t,n,u){var g=n.uSize,_=u.lowerSize;return"source"===t.kind?_/128:"composite"===t.kind?ho(_/128,u.upperSize/128,n.uSizeT):g}function Ed(t,n){var u=0,g=0;if("constant"===t.kind)g=t.layoutSize;else if("source"!==t.kind){var _=t.interpolationType,w=_?Jt(gi.interpolationFactor(_,n,t.minZoom,t.maxZoom),0,1):0;"camera"===t.kind?g=ho(t.minSize,t.maxSize,w):u=w}return{uSizeT:u,uSize:g}}_r("Anchor",ih);var Sd=Object.freeze({__proto__:null,getSizeData:ff,evaluateSizeForFeature:wd,evaluateSizeForZoom:Ed,SIZE_PACK_FACTOR:128});function hp(t,n,u,g,_){if(void 0===n.segment)return!0;for(var w=n,S=n.segment+1,A=0;A>-u/2;){if(--S<0)return!1;A-=t[S].dist(w),w=t[S]}A+=t[S].dist(t[S+1]),S++;for(var z=[],q=0;A<u/2;){var V=t[S],H=t[S+1];if(!H)return!1;var st=t[S-1].angleTo(V)-V.angleTo(H);for(st=Math.abs((st+3*Math.PI)%(2*Math.PI)-Math.PI),z.push({distance:A,angleDelta:st}),q+=st;A-z[0].distance>g;)q-=z.shift().angleDelta;if(q>_)return!1;S++,A+=V.dist(H)}return!0}function df(t){for(var n=0,u=0;u<t.length-1;u++)n+=t[u].dist(t[u+1]);return n}function pp(t,n,u){return t?.6*n*u:0}function gf(t,n){return Math.max(t?t.right-t.left:0,n?n.right-n.left:0)}function Cd(t,n,u,g,_,w){for(var S=pp(u,_,w),A=gf(u,g)*w,z=0,q=df(t)/2,V=0;V<t.length-1;V++){var H=t[V],st=t[V+1],vt=H.dist(st);if(z+vt>q){var Rt=(q-z)/vt,Vt=ho(H.x,st.x,Rt),he=ho(H.y,st.y,Rt),re=new ih(Vt,he,st.angleTo(H),V);return re._round(),!S||hp(t,re,A,S,n)?re:void 0}z+=vt}}function Id(t,n,u,g,_,w,S,A,z){var q=pp(g,w,S),V=gf(g,_),H=V*S,st=0===t[0].x||t[0].x===z||0===t[0].y||t[0].y===z;return n-H<n/4&&(n=H+n/4),function vt(Rt,Vt,he,re,we,Pe,Re,ze,rr){for(var yr=Pe/2,Mr=df(Rt),Wr=0,Tr=Vt-he,ln=[],Fr=0;Fr<Rt.length-1;Fr++){for(var ii=Rt[Fr],Pn=Rt[Fr+1],Jr=ii.dist(Pn),fi=Pn.angleTo(ii);Tr+he<Wr+Jr;){var Xn=((Tr+=he)-Wr)/Jr,Ii=ho(ii.x,Pn.x,Xn),pn=ho(ii.y,Pn.y,Xn);if(Ii>=0&&Ii<rr&&pn>=0&&pn<rr&&Tr-yr>=0&&Tr+yr<=Mr){var uo=new ih(Ii,pn,fi,Fr);uo._round(),re&&!hp(Rt,uo,Pe,re,we)||ln.push(uo)}}Wr+=Jr}return ze||ln.length||Re||(ln=vt(Rt,Wr/2,he,re,we,Pe,Re,!0,rr)),ln}(t,st?n/2*A%n:(V/2+2*w)*S*A%n,n,q,u,H,st,!1,z)}function Pd(t,n,u,g,_){for(var w=[],S=0;S<t.length;S++)for(var A=t[S],z=void 0,q=0;q<A.length-1;q++){var V=A[q],H=A[q+1];V.x<n&&H.x<n||(V.x<n?V=new Ft(n,V.y+(n-V.x)/(H.x-V.x)*(H.y-V.y))._round():H.x<n&&(H=new Ft(n,V.y+(n-V.x)/(H.x-V.x)*(H.y-V.y))._round()),V.y<u&&H.y<u||(V.y<u?V=new Ft(V.x+(u-V.y)/(H.y-V.y)*(H.x-V.x),u)._round():H.y<u&&(H=new Ft(V.x+(u-V.y)/(H.y-V.y)*(H.x-V.x),u)._round()),V.x>=g&&H.x>=g||(V.x>=g?V=new Ft(g,V.y+(g-V.x)/(H.x-V.x)*(H.y-V.y))._round():H.x>=g&&(H=new Ft(g,V.y+(g-V.x)/(H.x-V.x)*(H.y-V.y))._round()),V.y>=_&&H.y>=_||(V.y>=_?V=new Ft(V.x+(_-V.y)/(H.y-V.y)*(H.x-V.x),_)._round():H.y>=_&&(H=new Ft(V.x+(_-V.y)/(H.y-V.y)*(H.x-V.x),_)._round()),z&&V.equals(z[z.length-1])||w.push(z=[V]),z.push(H)))))}return w}function Md(t,n,u,g){var _=[],w=t.image,S=w.pixelRatio,A=w.paddedRect.w-2,z=w.paddedRect.h-2,q=t.right-t.left,V=t.bottom-t.top,H=w.stretchX||[[0,A]],st=w.stretchY||[[0,z]],vt=function(Ii,pn){return Ii+pn[1]-pn[0]},Rt=H.reduce(vt,0),Vt=st.reduce(vt,0),he=A-Rt,re=z-Vt,we=0,Pe=Rt,Re=0,ze=Vt,rr=0,yr=he,Mr=0,Wr=re;if(w.content&&g){var Tr=w.content;we=kh(H,0,Tr[0]),Re=kh(st,0,Tr[1]),Pe=kh(H,Tr[0],Tr[2]),ze=kh(st,Tr[1],Tr[3]),rr=Tr[0]-we,Mr=Tr[1]-Re,yr=Tr[2]-Tr[0]-Pe,Wr=Tr[3]-Tr[1]-ze}var ln=function(Ii,pn,uo,Qo){var Pa=Nh(Ii.stretch-we,Pe,q,t.left),Ma=Rh(Ii.fixed-rr,yr,Ii.stretch,Rt),la=Nh(pn.stretch-Re,ze,V,t.top),ya=Rh(pn.fixed-Mr,Wr,pn.stretch,Vt),is=Nh(uo.stretch-we,Pe,q,t.left),os=Rh(uo.fixed-rr,yr,uo.stretch,Rt),uu=Nh(Qo.stretch-Re,ze,V,t.top),Cs=Rh(Qo.fixed-Mr,Wr,Qo.stretch,Vt),Ns=new Ft(Pa,la),Ja=new Ft(is,la),Rs=new Ft(is,uu),vi=new Ft(Pa,uu),Oo=new Ft(Ma/S,ya/S),vo=new Ft(os/S,Cs/S),Li=n*Math.PI/180;if(Li){var _u=Math.sin(Li),Fs=Math.cos(Li),ia=[Fs,-_u,_u,Fs];Ns._matMult(ia),Ja._matMult(ia),vi._matMult(ia),Rs._matMult(ia)}var Ha=Ii.stretch+Ii.fixed,lu=pn.stretch+pn.fixed;return{tl:Ns,tr:Ja,bl:vi,br:Rs,tex:{x:w.paddedRect.x+1+Ha,y:w.paddedRect.y+1+lu,w:uo.stretch+uo.fixed-Ha,h:Qo.stretch+Qo.fixed-lu},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Oo,pixelOffsetBR:vo,minFontScaleX:yr/S/q,minFontScaleY:Wr/S/V,isSDF:u}};if(g&&(w.stretchX||w.stretchY))for(var Fr=mf(H,he,Rt),ii=mf(st,re,Vt),Pn=0;Pn<Fr.length-1;Pn++)for(var Jr=Fr[Pn],fi=Fr[Pn+1],Xn=0;Xn<ii.length-1;Xn++)_.push(ln(Jr,ii[Xn],fi,ii[Xn+1]));else _.push(ln({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:A+1},{fixed:0,stretch:z+1}));return _}function kh(t,n,u){for(var g=0,_=0,w=t;_<w.length;_+=1){var S=w[_];g+=Math.max(n,Math.min(u,S[1]))-Math.max(n,Math.min(u,S[0]))}return g}function mf(t,n,u){for(var g=[{fixed:-1,stretch:0}],_=0,w=t;_<w.length;_+=1){var S=w[_],A=S[0],z=S[1],q=g[g.length-1];g.push({fixed:A-q.stretch,stretch:q.stretch}),g.push({fixed:A-q.stretch,stretch:q.stretch+(z-A)})}return g.push({fixed:n+1,stretch:u}),g}function Nh(t,n,u,g){return t/n*u+g}function Rh(t,n,u,g){return t-n*u/g}var Fh=function(t,n,u,g,_,w,S,A,z,q){if(this.boxStartIndex=t.length,z){var V=w.top,H=w.bottom,st=w.collisionPadding;st&&(V-=st[1],H+=st[3]);var vt=H-V;vt>0&&(vt=Math.max(10,vt),this.circleDiameter=vt)}else{var Rt=w.top*S-A,Vt=w.bottom*S+A,he=w.left*S-A,re=w.right*S+A,we=w.collisionPadding;if(we&&(he-=we[0]*S,Rt-=we[1]*S,re+=we[2]*S,Vt+=we[3]*S),q){var Pe=new Ft(he,Rt),Re=new Ft(re,Rt),ze=new Ft(he,Vt),rr=new Ft(re,Vt),yr=q*Math.PI/180;Pe._rotate(yr),Re._rotate(yr),ze._rotate(yr),rr._rotate(yr),he=Math.min(Pe.x,Re.x,ze.x,rr.x),re=Math.max(Pe.x,Re.x,ze.x,rr.x),Rt=Math.min(Pe.y,Re.y,ze.y,rr.y),Vt=Math.max(Pe.y,Re.y,ze.y,rr.y)}t.emplaceBack(n.x,n.y,he,Rt,re,Vt,u,g,_)}this.boxEndIndex=t.length},Nc=function(t,n){if(void 0===t&&(t=[]),void 0===n&&(n=Td),this.data=t,this.length=this.data.length,this.compare=n,this.length>0)for(var u=(this.length>>1)-1;u>=0;u--)this._down(u)};function Td(t,n){return t<n?-1:t>n?1:0}function yf(t,n,u){void 0===n&&(n=1),void 0===u&&(u=!1);for(var g=1/0,_=1/0,w=-1/0,S=-1/0,A=t[0],z=0;z<A.length;z++){var q=A[z];(!z||q.x<g)&&(g=q.x),(!z||q.y<_)&&(_=q.y),(!z||q.x>w)&&(w=q.x),(!z||q.y>S)&&(S=q.y)}var V=Math.min(w-g,S-_),H=V/2,st=new Nc([],fp);if(0===V)return new Ft(g,_);for(var vt=g;vt<w;vt+=V)for(var Rt=_;Rt<S;Rt+=V)st.push(new Rc(vt+H,Rt+H,H,t));for(var Vt=function(we){for(var Pe=0,Re=0,ze=0,rr=we[0],yr=0,Mr=rr.length,Wr=Mr-1;yr<Mr;Wr=yr++){var Tr=rr[yr],ln=rr[Wr],Fr=Tr.x*ln.y-ln.x*Tr.y;Re+=(Tr.x+ln.x)*Fr,ze+=(Tr.y+ln.y)*Fr,Pe+=3*Fr}return new Rc(Re/Pe,ze/Pe,0,we)}(t),he=st.length;st.length;){var re=st.pop();(re.d>Vt.d||!Vt.d)&&(Vt=re,u&&console.log("found best %d after %d probes",Math.round(1e4*re.d)/1e4,he)),re.max-Vt.d<=n||(st.push(new Rc(re.p.x-(H=re.h/2),re.p.y-H,H,t)),st.push(new Rc(re.p.x+H,re.p.y-H,H,t)),st.push(new Rc(re.p.x-H,re.p.y+H,H,t)),st.push(new Rc(re.p.x+H,re.p.y+H,H,t)),he+=4)}return u&&(console.log("num probes: "+he),console.log("best distance: "+Vt.d)),Vt.p}function fp(t,n){return n.max-t.max}function Rc(t,n,u,g){this.p=new Ft(t,n),this.h=u,this.d=function(_,w){for(var S=!1,A=1/0,z=0;z<w.length;z++)for(var q=w[z],V=0,H=q.length,st=H-1;V<H;st=V++){var vt=q[V],Rt=q[st];vt.y>_.y!=Rt.y>_.y&&_.x<(Rt.x-vt.x)*(_.y-vt.y)/(Rt.y-vt.y)+vt.x&&(S=!S),A=Math.min(A,Ic(_,vt,Rt))}return(S?1:-1)*Math.sqrt(A)}(this.p,g),this.max=this.d+this.h*Math.SQRT2}Nc.prototype.push=function(t){this.data.push(t),this.length++,this._up(this.length-1)},Nc.prototype.pop=function(){if(0!==this.length){var t=this.data[0],n=this.data.pop();return this.length--,this.length>0&&(this.data[0]=n,this._down(0)),t}},Nc.prototype.peek=function(){return this.data[0]},Nc.prototype._up=function(t){for(var n=this.data,u=this.compare,g=n[t];t>0;){var _=t-1>>1,w=n[_];if(u(g,w)>=0)break;n[t]=w,t=_}n[t]=g},Nc.prototype._down=function(t){for(var n=this.data,u=this.compare,g=this.length>>1,_=n[t];t<g;){var w=1+(t<<1),S=n[w],A=w+1;if(A<this.length&&u(n[A],S)<0&&(w=A,S=n[A]),u(S,_)>=0)break;n[t]=S,t=w}n[t]=_};var vf=Number.POSITIVE_INFINITY;function dp(t,n){return n[1]!==vf?function(u,g,_){var w=0,S=0;switch(g=Math.abs(g),_=Math.abs(_),u){case"top-right":case"top-left":case"top":S=_-7;break;case"bottom-right":case"bottom-left":case"bottom":S=7-_}switch(u){case"top-right":case"bottom-right":case"right":w=-g;break;case"top-left":case"bottom-left":case"left":w=g}return[w,S]}(t,n[0],n[1]):function(u,g){var _=0,w=0;g<0&&(g=0);var S=g/Math.sqrt(2);switch(u){case"top-right":case"top-left":w=S-7;break;case"bottom-right":case"bottom-left":w=7-S;break;case"bottom":w=7-g;break;case"top":w=g-7}switch(u){case"top-right":case"bottom-right":_=-S;break;case"top-left":case"bottom-left":_=S;break;case"left":_=g;break;case"right":_=-g}return[_,w]}(t,n[0])}function gp(t){switch(t){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function mp(t,n,u,g,_,w,S,A,z,q,V,H,st,vt,Rt){var Vt=function(Re,ze,rr,yr,Mr,Wr,Tr,ln){for(var Fr=yr.layout.get("text-rotate").evaluate(Wr,{})*Math.PI/180,ii=[],Pn=0,Jr=ze.positionedLines;Pn<Jr.length;Pn+=1)for(var fi=Jr[Pn],Xn=0,Ii=fi.positionedGlyphs;Xn<Ii.length;Xn+=1){var pn=Ii[Xn];if(pn.rect){var uo=pn.rect||{},Qo=4,Pa=!0,Ma=1,la=0,ya=(Mr||ln)&&pn.vertical,is=pn.metrics.advance*pn.scale/2;if(ln&&ze.verticalizable&&(la=fi.lineOffset/2-(pn.imageName?-(24-pn.metrics.width*pn.scale)/2:24*(pn.scale-1))),pn.imageName){var os=Tr[pn.imageName];Pa=os.sdf,Qo=1/(Ma=os.pixelRatio)}var uu=Mr?[pn.x+is,pn.y]:[0,0],Cs=Mr?[0,0]:[pn.x+is+rr[0],pn.y+rr[1]-la],Ns=[0,0];ya&&(Ns=Cs,Cs=[0,0]);var Ja=(pn.metrics.left-Qo)*pn.scale-is+Cs[0],Rs=(-pn.metrics.top-Qo)*pn.scale+Cs[1],vi=Ja+uo.w*pn.scale/Ma,Oo=Rs+uo.h*pn.scale/Ma,vo=new Ft(Ja,Rs),Li=new Ft(vi,Rs),_u=new Ft(Ja,Oo),Fs=new Ft(vi,Oo);if(ya){var ia=new Ft(-is,is- -17),Ha=-Math.PI/2,lu=12-is,oo=new Ft(22-lu,-(pn.imageName?lu:0)),ml=new(Function.prototype.bind.apply(Ft,[null].concat(Ns)));vo._rotateAround(Ha,ia)._add(oo)._add(ml),Li._rotateAround(Ha,ia)._add(oo)._add(ml),_u._rotateAround(Ha,ia)._add(oo)._add(ml),Fs._rotateAround(Ha,ia)._add(oo)._add(ml)}if(Fr){var Gu=Math.sin(Fr),Ul=Math.cos(Fr),Wa=[Ul,-Gu,Gu,Ul];vo._matMult(Wa),Li._matMult(Wa),_u._matMult(Wa),Fs._matMult(Wa)}var ql=new Ft(0,0),yl=new Ft(0,0);ii.push({tl:vo,tr:Li,bl:_u,br:Fs,tex:uo,writingMode:ze.writingMode,glyphOffset:uu,sectionIndex:pn.sectionIndex,isSDF:Pa,pixelOffsetTL:ql,pixelOffsetBR:yl,minFontScaleX:0,minFontScaleY:0})}}return ii}(0,u,A,_,w,S,g,t.allowVerticalPlacement),he=t.textSizeData,re=null;"source"===he.kind?(re=[128*_.layout.get("text-size").evaluate(S,{})])[0]>32640&&St(t.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'):"composite"===he.kind&&((re=[128*vt.compositeTextSizes[0].evaluate(S,{},Rt),128*vt.compositeTextSizes[1].evaluate(S,{},Rt)])[0]>32640||re[1]>32640)&&St(t.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'),t.addSymbols(t.text,Vt,re,A,w,S,q,n,z.lineStartIndex,z.lineLength,st,Rt);for(var we=0,Pe=V;we<Pe.length;we+=1)H[Pe[we]]=t.text.placedSymbolArray.length-1;return 4*Vt.length}function yp(t){for(var n in t)return t[n];return null}function _f(t,n,u,g){var _=t.compareText;if(n in _){for(var w=_[n],S=w.length-1;S>=0;S--)if(g.dist(w[S])<u)return!0}else _[n]=[];return _[n].push(g),!1}var yg=Lc.VectorTileFeature.types,vg=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function vp(t,n,u,g,_,w,S,A,z,q,V,H,st){var vt=A?Math.min(32640,Math.round(A[0])):0,Rt=A?Math.min(32640,Math.round(A[1])):0;t.emplaceBack(n,u,Math.round(32*g),Math.round(32*_),w,S,(vt<<1)+(z?1:0),Rt,16*q,16*V,256*H,256*st)}function xf(t,n,u){t.emplaceBack(n.x,n.y,u),t.emplaceBack(n.x,n.y,u),t.emplaceBack(n.x,n.y,u),t.emplaceBack(n.x,n.y,u)}function _g(t){for(var n=0,u=t.sections;n<u.length;n+=1)if(lc(u[n].text))return!0;return!1}var oh=function(t){this.layoutVertexArray=new h,this.indexArray=new te,this.programConfigurations=t,this.segments=new _t,this.dynamicLayoutVertexArray=new d,this.opacityVertexArray=new x,this.placedSymbolArray=new E};oh.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length&&0===this.indexArray.length&&0===this.dynamicLayoutVertexArray.length&&0===this.opacityVertexArray.length},oh.prototype.upload=function(t,n,u,g){this.isEmpty()||(u&&(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,up.members),this.indexBuffer=t.createIndexBuffer(this.indexArray,n),this.dynamicLayoutVertexBuffer=t.createVertexBuffer(this.dynamicLayoutVertexArray,pd.members,!0),this.opacityVertexBuffer=t.createVertexBuffer(this.opacityVertexArray,vg,!0),this.opacityVertexBuffer.itemSize=1),(u||g)&&this.programConfigurations.upload(t))},oh.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())},_r("SymbolBuffers",oh);var zh=function(t,n,u){this.layoutVertexArray=new t,this.layoutAttributes=n,this.indexArray=new u,this.segments=new _t,this.collisionVertexArray=new Ct};zh.prototype.upload=function(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=t.createVertexBuffer(this.collisionVertexArray,fd.members,!0)},zh.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())},_r("CollisionBuffers",zh);var Lo=function(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(w){return w.id}),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=vu([]),this.placementViewportMatrix=vu([]);var n=this.layers[0]._unevaluatedLayout._values;this.textSizeData=ff(this.zoom,n["text-size"]),this.iconSizeData=ff(this.zoom,n["icon-size"]);var u=this.layers[0].layout,g=u.get("symbol-sort-key"),_=u.get("symbol-z-order");this.canOverlap=u.get("text-allow-overlap")||u.get("icon-allow-overlap")||u.get("text-ignore-placement")||u.get("icon-ignore-placement"),this.sortFeaturesByKey="viewport-y"!==_&&!g.isConstant(),this.sortFeaturesByY=("viewport-y"===_||"auto"===_&&!this.sortFeaturesByKey)&&this.canOverlap,"point"===u.get("symbol-placement")&&(this.writingModes=u.get("text-writing-mode").map(function(w){return qu[w]})),this.stateDependentLayerIds=this.layers.filter(function(w){return w.isStateDependent()}).map(function(w){return w.id}),this.sourceID=t.sourceID};Lo.prototype.createArrays=function(){this.text=new oh(new Mo(this.layers,this.zoom,function(t){return/^text/.test(t)})),this.icon=new oh(new Mo(this.layers,this.zoom,function(t){return/^icon/.test(t)})),this.glyphOffsetArray=new N,this.lineVertexArray=new G,this.symbolInstances=new T},Lo.prototype.calculateGlyphDependencies=function(t,n,u,g,_){for(var w=0;w<t.length;w++)if(n[t.charCodeAt(w)]=!0,(u||g)&&_){var S=rh[t.charAt(w)];S&&(n[S.charCodeAt(0)]=!0)}},Lo.prototype.populate=function(t,n,u){var g=this.layers[0],_=g.layout,w=_.get("text-font"),S=_.get("text-field"),A=_.get("icon-image"),z=("constant"!==S.value.kind||S.value.value instanceof No&&!S.value.value.isEmpty()||S.value.value.toString().length>0)&&("constant"!==w.value.kind||w.value.value.length>0),q="constant"!==A.value.kind||!!A.value.value||Object.keys(A.parameters).length>0,V=_.get("symbol-sort-key");if(this.features=[],z||q){for(var H=n.iconDependencies,st=n.glyphDependencies,vt=n.availableImages,Rt=new so(this.zoom),Vt=0,he=t;Vt<he.length;Vt+=1){var re=he[Vt],we=re.feature,Pe=re.id,Re=re.index,ze=re.sourceLayerIndex,rr=g._featureFilter.needGeometry,yr=iu(we,rr);if(g._featureFilter.filter(Rt,yr,u)){rr||(yr.geometry=Ia(we));var Mr=void 0;if(z){var Wr=g.getValueAndResolveTokens("text-field",yr,u,vt),Tr=No.factory(Wr);_g(Tr)&&(this.hasRTLText=!0),(!this.hasRTLText||"unavailable"===Xs()||this.hasRTLText&&ui.isParsed())&&(Mr=gd(Tr,g,yr))}var ln=void 0;if(q){var Fr=g.getValueAndResolveTokens("icon-image",yr,u,vt);ln=Fr instanceof Wn?Fr:Wn.fromString(Fr)}if(Mr||ln){var ii=this.sortFeaturesByKey?V.evaluate(yr,{},u):void 0;if(this.features.push({id:Pe,text:Mr,icon:ln,index:Re,sourceLayerIndex:ze,geometry:yr.geometry,properties:we.properties,type:yg[we.type],sortKey:ii}),ln&&(H[ln.name]=!0),Mr){var Pn=w.evaluate(yr,{},u).join(","),Jr="map"===_.get("text-rotation-alignment")&&"point"!==_.get("symbol-placement");this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(qu.vertical)>=0;for(var fi=0,Xn=Mr.sections;fi<Xn.length;fi+=1){var Ii=Xn[fi];if(Ii.image)H[Ii.image.name]=!0;else{var pn=Vo(Mr.toString()),uo=Ii.fontStack||Pn,Qo=st[uo]=st[uo]||{};this.calculateGlyphDependencies(Ii.text,Qo,Jr,this.allowVerticalPlacement,pn)}}}}}}"line"===_.get("symbol-placement")&&(this.features=function(Pa){var Ma={},la={},ya=[],is=0;function os(ia){ya.push(Pa[ia]),is++}function uu(ia,Ha,lu){var oo=la[ia];return delete la[ia],la[Ha]=oo,ya[oo].geometry[0].pop(),ya[oo].geometry[0]=ya[oo].geometry[0].concat(lu[0]),oo}function Cs(ia,Ha,lu){var oo=Ma[Ha];return delete Ma[Ha],Ma[ia]=oo,ya[oo].geometry[0].shift(),ya[oo].geometry[0]=lu[0].concat(ya[oo].geometry[0]),oo}function Ns(ia,Ha,lu){var oo=lu?Ha[0][Ha[0].length-1]:Ha[0][0];return ia+":"+oo.x+":"+oo.y}for(var Ja=0;Ja<Pa.length;Ja++){var Rs=Pa[Ja],vi=Rs.geometry,Oo=Rs.text?Rs.text.toString():null;if(Oo){var vo=Ns(Oo,vi),Li=Ns(Oo,vi,!0);if(vo in la&&Li in Ma&&la[vo]!==Ma[Li]){var _u=Cs(vo,Li,vi),Fs=uu(vo,Li,ya[_u].geometry);delete Ma[vo],delete la[Li],la[Ns(Oo,ya[Fs].geometry,!0)]=Fs,ya[_u].geometry=null}else vo in la?uu(vo,Li,vi):Li in Ma?Cs(vo,Li,vi):(os(Ja),Ma[vo]=is-1,la[Li]=is-1)}else os(Ja)}return ya.filter(function(ia){return ia.geometry})}(this.features)),this.sortFeaturesByKey&&this.features.sort(function(Pa,Ma){return Pa.sortKey-Ma.sortKey})}},Lo.prototype.update=function(t,n,u){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(t,n,this.layers,u),this.icon.programConfigurations.updatePaintArrays(t,n,this.layers,u))},Lo.prototype.isEmpty=function(){return 0===this.symbolInstances.length&&!this.hasRTLText},Lo.prototype.uploadPending=function(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload},Lo.prototype.upload=function(t){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(t),this.iconCollisionBox.upload(t)),this.text.upload(t,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(t,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0},Lo.prototype.destroyDebugData=function(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()},Lo.prototype.destroy=function(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()},Lo.prototype.addToLineVertexArray=function(t,n){var u=this.lineVertexArray.length;if(void 0!==t.segment){for(var g=t.dist(n[t.segment+1]),_=t.dist(n[t.segment]),w={},S=t.segment+1;S<n.length;S++)w[S]={x:n[S].x,y:n[S].y,tileUnitDistanceFromAnchor:g},S<n.length-1&&(g+=n[S+1].dist(n[S]));for(var A=t.segment||0;A>=0;A--)w[A]={x:n[A].x,y:n[A].y,tileUnitDistanceFromAnchor:_},A>0&&(_+=n[A-1].dist(n[A]));for(var z=0;z<n.length;z++){var q=w[z];this.lineVertexArray.emplaceBack(q.x,q.y,q.tileUnitDistanceFromAnchor)}}return{lineStartIndex:u,lineLength:this.lineVertexArray.length-u}},Lo.prototype.addSymbols=function(t,n,u,g,_,w,S,A,z,q,V,H){for(var st=t.indexArray,vt=t.layoutVertexArray,Rt=t.segments.prepareSegment(4*n.length,vt,st,this.canOverlap?w.sortKey:void 0),Vt=this.glyphOffsetArray.length,he=Rt.vertexLength,re=this.allowVerticalPlacement&&S===qu.vertical?Math.PI/2:0,we=w.text&&w.text.sections,Pe=0;Pe<n.length;Pe++){var Re=n[Pe],ze=Re.tl,rr=Re.tr,yr=Re.bl,Mr=Re.br,Wr=Re.tex,Tr=Re.pixelOffsetTL,ln=Re.pixelOffsetBR,Fr=Re.minFontScaleX,ii=Re.minFontScaleY,Pn=Re.glyphOffset,Jr=Re.isSDF,fi=Re.sectionIndex,Xn=Rt.vertexLength,Ii=Pn[1];vp(vt,A.x,A.y,ze.x,Ii+ze.y,Wr.x,Wr.y,u,Jr,Tr.x,Tr.y,Fr,ii),vp(vt,A.x,A.y,rr.x,Ii+rr.y,Wr.x+Wr.w,Wr.y,u,Jr,ln.x,Tr.y,Fr,ii),vp(vt,A.x,A.y,yr.x,Ii+yr.y,Wr.x,Wr.y+Wr.h,u,Jr,Tr.x,ln.y,Fr,ii),vp(vt,A.x,A.y,Mr.x,Ii+Mr.y,Wr.x+Wr.w,Wr.y+Wr.h,u,Jr,ln.x,ln.y,Fr,ii),xf(t.dynamicLayoutVertexArray,A,re),st.emplaceBack(Xn,Xn+1,Xn+2),st.emplaceBack(Xn+1,Xn+2,Xn+3),Rt.vertexLength+=4,Rt.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Pn[0]),Pe!==n.length-1&&fi===n[Pe+1].sectionIndex||t.programConfigurations.populatePaintArrays(vt.length,w,w.index,{},H,we&&we[fi])}t.placedSymbolArray.emplaceBack(A.x,A.y,Vt,this.glyphOffsetArray.length-Vt,he,z,q,A.segment,u?u[0]:0,u?u[1]:0,g[0],g[1],S,0,!1,0,V)},Lo.prototype._addCollisionDebugVertex=function(t,n,u,g,_,w){return n.emplaceBack(0,0),t.emplaceBack(u.x,u.y,g,_,Math.round(w.x),Math.round(w.y))},Lo.prototype.addCollisionDebugVertices=function(t,n,u,g,_,w,S){var A=_.segments.prepareSegment(4,_.layoutVertexArray,_.indexArray),z=A.vertexLength,q=_.layoutVertexArray,V=_.collisionVertexArray,H=S.anchorX,st=S.anchorY;this._addCollisionDebugVertex(q,V,w,H,st,new Ft(t,n)),this._addCollisionDebugVertex(q,V,w,H,st,new Ft(u,n)),this._addCollisionDebugVertex(q,V,w,H,st,new Ft(u,g)),this._addCollisionDebugVertex(q,V,w,H,st,new Ft(t,g)),A.vertexLength+=4;var vt=_.indexArray;vt.emplaceBack(z,z+1),vt.emplaceBack(z+1,z+2),vt.emplaceBack(z+2,z+3),vt.emplaceBack(z+3,z),A.primitiveLength+=4},Lo.prototype.addDebugCollisionBoxes=function(t,n,u,g){for(var _=t;_<n;_++){var w=this.collisionBoxArray.get(_);this.addCollisionDebugVertices(w.x1,w.y1,w.x2,w.y2,g?this.textCollisionBox:this.iconCollisionBox,w.anchorPoint,u)}},Lo.prototype.generateCollisionDebugBuffers=function(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new zh(F,tf.members,an),this.iconCollisionBox=new zh(F,tf.members,an);for(var t=0;t<this.symbolInstances.length;t++){var n=this.symbolInstances.get(t);this.addDebugCollisionBoxes(n.textBoxStartIndex,n.textBoxEndIndex,n,!0),this.addDebugCollisionBoxes(n.verticalTextBoxStartIndex,n.verticalTextBoxEndIndex,n,!0),this.addDebugCollisionBoxes(n.iconBoxStartIndex,n.iconBoxEndIndex,n,!1),this.addDebugCollisionBoxes(n.verticalIconBoxStartIndex,n.verticalIconBoxEndIndex,n,!1)}},Lo.prototype._deserializeCollisionBoxesForSymbol=function(t,n,u,g,_,w,S,A,z){for(var q={},V=n;V<u;V++){var H=t.get(V);q.textBox={x1:H.x1,y1:H.y1,x2:H.x2,y2:H.y2,anchorPointX:H.anchorPointX,anchorPointY:H.anchorPointY},q.textFeatureIndex=H.featureIndex;break}for(var st=g;st<_;st++){var vt=t.get(st);q.verticalTextBox={x1:vt.x1,y1:vt.y1,x2:vt.x2,y2:vt.y2,anchorPointX:vt.anchorPointX,anchorPointY:vt.anchorPointY},q.verticalTextFeatureIndex=vt.featureIndex;break}for(var Rt=w;Rt<S;Rt++){var Vt=t.get(Rt);q.iconBox={x1:Vt.x1,y1:Vt.y1,x2:Vt.x2,y2:Vt.y2,anchorPointX:Vt.anchorPointX,anchorPointY:Vt.anchorPointY},q.iconFeatureIndex=Vt.featureIndex;break}for(var he=A;he<z;he++){var re=t.get(he);q.verticalIconBox={x1:re.x1,y1:re.y1,x2:re.x2,y2:re.y2,anchorPointX:re.anchorPointX,anchorPointY:re.anchorPointY},q.verticalIconFeatureIndex=re.featureIndex;break}return q},Lo.prototype.deserializeCollisionBoxes=function(t){this.collisionArrays=[];for(var n=0;n<this.symbolInstances.length;n++){var u=this.symbolInstances.get(n);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(t,u.textBoxStartIndex,u.textBoxEndIndex,u.verticalTextBoxStartIndex,u.verticalTextBoxEndIndex,u.iconBoxStartIndex,u.iconBoxEndIndex,u.verticalIconBoxStartIndex,u.verticalIconBoxEndIndex))}},Lo.prototype.hasTextData=function(){return this.text.segments.get().length>0},Lo.prototype.hasIconData=function(){return this.icon.segments.get().length>0},Lo.prototype.hasDebugData=function(){return this.textCollisionBox&&this.iconCollisionBox},Lo.prototype.hasTextCollisionBoxData=function(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0},Lo.prototype.hasIconCollisionBoxData=function(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0},Lo.prototype.addIndicesForPlacedSymbol=function(t,n){for(var u=t.placedSymbolArray.get(n),g=u.vertexStartIndex+4*u.numGlyphs,_=u.vertexStartIndex;_<g;_+=4)t.indexArray.emplaceBack(_,_+1,_+2),t.indexArray.emplaceBack(_+1,_+2,_+3)},Lo.prototype.getSortedSymbolIndexes=function(t){if(this.sortedAngle===t&&void 0!==this.symbolInstanceIndexes)return this.symbolInstanceIndexes;for(var n=Math.sin(t),u=Math.cos(t),g=[],_=[],w=[],S=0;S<this.symbolInstances.length;++S){w.push(S);var A=this.symbolInstances.get(S);g.push(0|Math.round(n*A.anchorX+u*A.anchorY)),_.push(A.featureIndex)}return w.sort(function(z,q){return g[z]-g[q]||_[q]-_[z]}),w},Lo.prototype.addToSortKeyRanges=function(t,n){var u=this.sortKeyRanges[this.sortKeyRanges.length-1];u&&u.sortKey===n?u.symbolInstanceEnd=t+1:this.sortKeyRanges.push({sortKey:n,symbolInstanceStart:t,symbolInstanceEnd:t+1})},Lo.prototype.sortFeatures=function(t){var n=this;if(this.sortFeaturesByY&&this.sortedAngle!==t&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(t),this.sortedAngle=t,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(var u=0,g=this.symbolInstanceIndexes;u<g.length;u+=1){var _=this.symbolInstances.get(g[u]);this.featureSortOrder.push(_.featureIndex),[_.rightJustifiedTextSymbolIndex,_.centerJustifiedTextSymbolIndex,_.leftJustifiedTextSymbolIndex].forEach(function(w,S,A){w>=0&&A.indexOf(w)===S&&n.addIndicesForPlacedSymbol(n.text,w)}),_.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,_.verticalPlacedTextSymbolIndex),_.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,_.placedIconSymbolIndex),_.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,_.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}},_r("SymbolBucket",Lo,{omit:["layers","collisionBoxArray","features","compareText"]}),Lo.MAX_GLYPHS=65535,Lo.addDynamicAttributes=xf;var xg=new Sa({"symbol-placement":new Dr(Dt.layout_symbol["symbol-placement"]),"symbol-spacing":new Dr(Dt.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Dr(Dt.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new cn(Dt.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Dr(Dt.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Dr(Dt.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new Dr(Dt.layout_symbol["icon-ignore-placement"]),"icon-optional":new Dr(Dt.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Dr(Dt.layout_symbol["icon-rotation-alignment"]),"icon-size":new cn(Dt.layout_symbol["icon-size"]),"icon-text-fit":new Dr(Dt.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Dr(Dt.layout_symbol["icon-text-fit-padding"]),"icon-image":new cn(Dt.layout_symbol["icon-image"]),"icon-rotate":new cn(Dt.layout_symbol["icon-rotate"]),"icon-padding":new Dr(Dt.layout_symbol["icon-padding"]),"icon-keep-upright":new Dr(Dt.layout_symbol["icon-keep-upright"]),"icon-offset":new cn(Dt.layout_symbol["icon-offset"]),"icon-anchor":new cn(Dt.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Dr(Dt.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Dr(Dt.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Dr(Dt.layout_symbol["text-rotation-alignment"]),"text-field":new cn(Dt.layout_symbol["text-field"]),"text-font":new cn(Dt.layout_symbol["text-font"]),"text-size":new cn(Dt.layout_symbol["text-size"]),"text-max-width":new cn(Dt.layout_symbol["text-max-width"]),"text-line-height":new Dr(Dt.layout_symbol["text-line-height"]),"text-letter-spacing":new cn(Dt.layout_symbol["text-letter-spacing"]),"text-justify":new cn(Dt.layout_symbol["text-justify"]),"text-radial-offset":new cn(Dt.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Dr(Dt.layout_symbol["text-variable-anchor"]),"text-anchor":new cn(Dt.layout_symbol["text-anchor"]),"text-max-angle":new Dr(Dt.layout_symbol["text-max-angle"]),"text-writing-mode":new Dr(Dt.layout_symbol["text-writing-mode"]),"text-rotate":new cn(Dt.layout_symbol["text-rotate"]),"text-padding":new Dr(Dt.layout_symbol["text-padding"]),"text-keep-upright":new Dr(Dt.layout_symbol["text-keep-upright"]),"text-transform":new cn(Dt.layout_symbol["text-transform"]),"text-offset":new cn(Dt.layout_symbol["text-offset"]),"text-allow-overlap":new Dr(Dt.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new Dr(Dt.layout_symbol["text-ignore-placement"]),"text-optional":new Dr(Dt.layout_symbol["text-optional"])}),bf={paint:new Sa({"icon-opacity":new cn(Dt.paint_symbol["icon-opacity"]),"icon-color":new cn(Dt.paint_symbol["icon-color"]),"icon-halo-color":new cn(Dt.paint_symbol["icon-halo-color"]),"icon-halo-width":new cn(Dt.paint_symbol["icon-halo-width"]),"icon-halo-blur":new cn(Dt.paint_symbol["icon-halo-blur"]),"icon-translate":new Dr(Dt.paint_symbol["icon-translate"]),"icon-translate-anchor":new Dr(Dt.paint_symbol["icon-translate-anchor"]),"text-opacity":new cn(Dt.paint_symbol["text-opacity"]),"text-color":new cn(Dt.paint_symbol["text-color"],{runtimeType:bn,getOverride:function(t){return t.textColor},hasOverride:function(t){return!!t.textColor}}),"text-halo-color":new cn(Dt.paint_symbol["text-halo-color"]),"text-halo-width":new cn(Dt.paint_symbol["text-halo-width"]),"text-halo-blur":new cn(Dt.paint_symbol["text-halo-blur"]),"text-translate":new Dr(Dt.paint_symbol["text-translate"]),"text-translate-anchor":new Dr(Dt.paint_symbol["text-translate-anchor"])}),layout:xg},ah=function(t){this.type=t.property.overrides?t.property.overrides.runtimeType:Ar,this.defaultValue=t};ah.prototype.evaluate=function(t){if(t.formattedSection){var n=this.defaultValue.property.overrides;if(n&&n.hasOverride(t.formattedSection))return n.getOverride(t.formattedSection)}return t.feature&&t.featureState?this.defaultValue.evaluate(t.feature,t.featureState):this.defaultValue.property.specification.default},ah.prototype.eachChild=function(t){this.defaultValue.isConstant()||t(this.defaultValue.value._styleExpression.expression)},ah.prototype.outputDefined=function(){return!1},ah.prototype.serialize=function(){return null},_r("FormatSectionOverride",ah,{omit:["defaultValue"]});var bg=function(t){function n(u){t.call(this,u,bf)}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n.prototype.recalculate=function(u,g){if(t.prototype.recalculate.call(this,u,g),"auto"===this.layout.get("icon-rotation-alignment")&&(this.layout._values["icon-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-rotation-alignment")&&(this.layout._values["text-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),"point"===this.layout.get("symbol-placement")){var _=this.layout.get("text-writing-mode");if(_){for(var w=[],S=0,A=_;S<A.length;S+=1){var z=A[S];w.indexOf(z)<0&&w.push(z)}this.layout._values["text-writing-mode"]=w}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()},n.prototype.getValueAndResolveTokens=function(u,g,_,w){var z,S=this.layout.get(u).evaluate(g,{},_,w),A=this._unevaluatedLayout._values[u];return A.isDataDriven()||ms(A.value)||!S?S:(z=g.properties,S.replace(/{([^{}]+)}/g,function(V,H){return H in z?String(z[H]):""}))},n.prototype.createBucket=function(u){return new Lo(u)},n.prototype.queryRadius=function(){return 0},n.prototype.queryIntersectsFeature=function(){return!1},n.prototype._setPaintOverrides=function(){for(var u=0,g=bf.paint.overridableProperties;u<g.length;u+=1){var _=g[u];if(n.hasPaintOverride(this.layout,_)){var w,S=this.paint.get(_),A=new ah(S),z=new Ko(A,S.property.specification);w="constant"===S.value.kind||"source"===S.value.kind?new be("source",z):new Ye("composite",z,S.value.zoomStops,S.value._interpolationType),this.paint._values[_]=new ps(S.property,w,S.parameters)}}},n.prototype._handleOverridablePaintPropertyUpdate=function(u,g,_){return!(!this.layout||g.isDataDriven()||_.isDataDriven())&&n.hasPaintOverride(this.layout,u)},n.hasPaintOverride=function(u,g){var _=u.get("text-field"),w=bf.paint.properties[g],S=!1,A=function(V){for(var H=0,st=V;H<st.length;H+=1)if(w.overrides&&w.overrides.hasOverride(st[H]))return void(S=!0)};if("constant"===_.value.kind&&_.value.value instanceof No)A(_.value.value.sections);else if("source"===_.value.kind){var z=function(V){S||(V instanceof Bn&&aa(V.value)===Nr?A(V.value.sections):V instanceof wn?A(V.sections):V.eachChild(z))},q=_.value;q._styleExpression&&z(q._styleExpression.expression)}return S},n}(hn),wg={paint:new Sa({"background-color":new Dr(Dt.paint_background["background-color"]),"background-pattern":new Os(Dt.paint_background["background-pattern"]),"background-opacity":new Dr(Dt.paint_background["background-opacity"])})},Ad=function(t){function n(u){t.call(this,u,wg)}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n}(hn),wf={paint:new Sa({"raster-opacity":new Dr(Dt.paint_raster["raster-opacity"]),"raster-hue-rotate":new Dr(Dt.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Dr(Dt.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Dr(Dt.paint_raster["raster-brightness-max"]),"raster-saturation":new Dr(Dt.paint_raster["raster-saturation"]),"raster-contrast":new Dr(Dt.paint_raster["raster-contrast"]),"raster-resampling":new Dr(Dt.paint_raster["raster-resampling"]),"raster-fade-duration":new Dr(Dt.paint_raster["raster-fade-duration"])})},Eg=function(t){function n(u){t.call(this,u,wf)}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n}(hn),Ef=function(t){function n(u){t.call(this,u,{}),this.implementation=u}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n.prototype.is3D=function(){return"3d"===this.implementation.renderingMode},n.prototype.hasOffscreenPass=function(){return void 0!==this.implementation.prerender},n.prototype.recalculate=function(){},n.prototype.updateTransitions=function(){},n.prototype.hasTransition=function(){},n.prototype.serialize=function(){},n.prototype.onAdd=function(u){this.implementation.onAdd&&this.implementation.onAdd(u,u.painter.context.gl)},n.prototype.onRemove=function(u){this.implementation.onRemove&&this.implementation.onRemove(u,u.painter.context.gl)},n}(hn),Ld={circle:Pc,heatmap:Zi,hillshade:Xi,fill:ed,"fill-extrusion":cd,line:Zr,symbol:bg,background:Ad,raster:Eg},sh=qt.HTMLImageElement,mc=qt.HTMLCanvasElement,uh=qt.HTMLVideoElement,_p=qt.ImageData,xp=qt.ImageBitmap,yc=function(t,n,u,g){this.context=t,this.format=u,this.texture=t.gl.createTexture(),this.update(n,g)};yc.prototype.update=function(t,n,u){var g=t.width,_=t.height,w=!(this.size&&this.size[0]===g&&this.size[1]===_||u),S=this.context,A=S.gl;if(this.useMipmap=Boolean(n&&n.useMipmap),A.bindTexture(A.TEXTURE_2D,this.texture),S.pixelStoreUnpackFlipY.set(!1),S.pixelStoreUnpack.set(1),S.pixelStoreUnpackPremultiplyAlpha.set(this.format===A.RGBA&&(!n||!1!==n.premultiply)),w)this.size=[g,_],t instanceof sh||t instanceof mc||t instanceof uh||t instanceof _p||xp&&t instanceof xp?A.texImage2D(A.TEXTURE_2D,0,this.format,this.format,A.UNSIGNED_BYTE,t):A.texImage2D(A.TEXTURE_2D,0,this.format,g,_,0,this.format,A.UNSIGNED_BYTE,t.data);else{var z=u||{x:0,y:0},q=z.x,V=z.y;t instanceof sh||t instanceof mc||t instanceof uh||t instanceof _p||xp&&t instanceof xp?A.texSubImage2D(A.TEXTURE_2D,0,q,V,A.RGBA,A.UNSIGNED_BYTE,t):A.texSubImage2D(A.TEXTURE_2D,0,q,V,g,_,A.RGBA,A.UNSIGNED_BYTE,t.data)}this.useMipmap&&this.isSizePowerOfTwo()&&A.generateMipmap(A.TEXTURE_2D)},yc.prototype.bind=function(t,n,u){var g=this.context.gl;g.bindTexture(g.TEXTURE_2D,this.texture),u!==g.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(u=g.LINEAR),t!==this.filter&&(g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MAG_FILTER,t),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MIN_FILTER,u||t),this.filter=t),n!==this.wrap&&(g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_S,n),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_T,n),this.wrap=n)},yc.prototype.isSizePowerOfTwo=function(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0},yc.prototype.destroy=function(){this.context.gl.deleteTexture(this.texture),this.texture=null};var Sf=function(t){var n=this;this._callback=t,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=function(){n._triggered=!1,n._callback()})};Sf.prototype.trigger=function(){var t=this;this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(function(){t._triggered=!1,t._callback()},0))},Sf.prototype.remove=function(){delete this._channel,this._callback=function(){}};var Kl=function(t,n,u){this.target=t,this.parent=n,this.mapId=u,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},nt(["receive","process"],this),this.invoker=new Sf(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=je()?t:qt};function lh(t,n,u){var g=2*Math.PI*6378137/256/Math.pow(2,u);return[t*g-2*Math.PI*6378137/2,n*g-2*Math.PI*6378137/2]}Kl.prototype.send=function(t,n,u,g,_){var w=this;void 0===_&&(_=!1);var S=Math.round(1e18*Math.random()).toString(36).substring(0,10);u&&(this.callbacks[S]=u);var A=pe(this.globalScope)?void 0:[];return this.target.postMessage({id:S,type:t,hasCallback:!!u,targetMapId:g,mustQueue:_,sourceMapId:this.mapId,data:na(n,A)},A),{cancel:function(){u&&delete w.callbacks[S],w.target.postMessage({id:S,type:"<cancel>",targetMapId:g,sourceMapId:w.mapId})}}},Kl.prototype.receive=function(t){var n=t.data,u=n.id;if(u&&(!n.targetMapId||this.mapId===n.targetMapId))if("<cancel>"===n.type){delete this.tasks[u];var g=this.cancelCallbacks[u];delete this.cancelCallbacks[u],g&&g()}else je()||n.mustQueue?(this.tasks[u]=n,this.taskQueue.push(u),this.invoker.trigger()):this.processTask(u,n)},Kl.prototype.process=function(){if(this.taskQueue.length){var t=this.taskQueue.shift(),n=this.tasks[t];delete this.tasks[t],this.taskQueue.length&&this.invoker.trigger(),n&&this.processTask(t,n)}},Kl.prototype.processTask=function(t,n){var u=this;if("<response>"===n.type){var g=this.callbacks[t];delete this.callbacks[t],g&&(n.error?g(Lu(n.error)):g(null,Lu(n.data)))}else{var _=!1,w=pe(this.globalScope)?void 0:[],S=n.hasCallback?function(V,H){_=!0,delete u.cancelCallbacks[t],u.target.postMessage({id:t,type:"<response>",sourceMapId:u.mapId,error:V?na(V):null,data:na(H,w)},w)}:function(V){_=!0},A=null,z=Lu(n.data);if(this.parent[n.type])A=this.parent[n.type](n.sourceMapId,z,S);else if(this.parent.getWorkerSource){var q=n.type.split(".");A=this.parent.getWorkerSource(n.sourceMapId,q[0],z.source)[q[1]](z,S)}else S(new Error("Could not find function "+n.type));!_&&A&&A.cancel&&(this.cancelCallbacks[t]=A.cancel)}},Kl.prototype.remove=function(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)};var ma=function(t,n){t&&(n?this.setSouthWest(t).setNorthEast(n):4===t.length?this.setSouthWest([t[0],t[1]]).setNorthEast([t[2],t[3]]):this.setSouthWest(t[0]).setNorthEast(t[1]))};ma.prototype.setNorthEast=function(t){return this._ne=t instanceof Do?new Do(t.lng,t.lat):Do.convert(t),this},ma.prototype.setSouthWest=function(t){return this._sw=t instanceof Do?new Do(t.lng,t.lat):Do.convert(t),this},ma.prototype.extend=function(t){var n,u,g=this._sw,_=this._ne;if(t instanceof Do)n=t,u=t;else{if(!(t instanceof ma))return Array.isArray(t)?4===t.length||t.every(Array.isArray)?this.extend(ma.convert(t)):this.extend(Do.convert(t)):this;if(u=t._ne,!(n=t._sw)||!u)return this}return g||_?(g.lng=Math.min(n.lng,g.lng),g.lat=Math.min(n.lat,g.lat),_.lng=Math.max(u.lng,_.lng),_.lat=Math.max(u.lat,_.lat)):(this._sw=new Do(n.lng,n.lat),this._ne=new Do(u.lng,u.lat)),this},ma.prototype.getCenter=function(){return new Do((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)},ma.prototype.getSouthWest=function(){return this._sw},ma.prototype.getNorthEast=function(){return this._ne},ma.prototype.getNorthWest=function(){return new Do(this.getWest(),this.getNorth())},ma.prototype.getSouthEast=function(){return new Do(this.getEast(),this.getSouth())},ma.prototype.getWest=function(){return this._sw.lng},ma.prototype.getSouth=function(){return this._sw.lat},ma.prototype.getEast=function(){return this._ne.lng},ma.prototype.getNorth=function(){return this._ne.lat},ma.prototype.toArray=function(){return[this._sw.toArray(),this._ne.toArray()]},ma.prototype.toString=function(){return"LngLatBounds("+this._sw.toString()+", "+this._ne.toString()+")"},ma.prototype.isEmpty=function(){return!(this._sw&&this._ne)},ma.prototype.contains=function(t){var n=Do.convert(t),u=n.lng,g=n.lat,_=this._sw.lng<=u&&u<=this._ne.lng;return this._sw.lng>this._ne.lng&&(_=this._sw.lng>=u&&u>=this._ne.lng),this._sw.lat<=g&&g<=this._ne.lat&&_},ma.convert=function(t){return!t||t instanceof ma?t:new ma(t)};var Do=function(t,n){if(isNaN(t)||isNaN(n))throw new Error("Invalid LngLat object: ("+t+", "+n+")");if(this.lng=+t,this.lat=+n,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")};Do.prototype.wrap=function(){return new Do(ye(this.lng,-180,180),this.lat)},Do.prototype.toArray=function(){return[this.lng,this.lat]},Do.prototype.toString=function(){return"LngLat("+this.lng+", "+this.lat+")"},Do.prototype.distanceTo=function(t){var n=Math.PI/180,u=this.lat*n,g=t.lat*n,_=Math.sin(u)*Math.sin(g)+Math.cos(u)*Math.cos(g)*Math.cos((t.lng-this.lng)*n);return 6371008.8*Math.acos(Math.min(_,1))},Do.prototype.toBounds=function(t){void 0===t&&(t=0);var n=360*t/40075017,u=n/Math.cos(Math.PI/180*this.lat);return new ma(new Do(this.lng-u,this.lat-n),new Do(this.lng+u,this.lat+n))},Do.convert=function(t){if(t instanceof Do)return t;if(Array.isArray(t)&&(2===t.length||3===t.length))return new Do(Number(t[0]),Number(t[1]));if(!Array.isArray(t)&&"object"==typeof t&&null!==t)return new Do(Number("lng"in t?t.lng:t.lon),Number(t.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")};var bp=2*Math.PI*6371008.8;function wp(t){return bp*Math.cos(t*Math.PI/180)}function Fc(t){return(180+t)/360}function zc(t){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t*Math.PI/360)))/360}function ch(t,n){return t/wp(n)}function Ep(t){return 360/Math.PI*Math.atan(Math.exp((180-360*t)*Math.PI/180))-90}var vc=function(t,n,u){void 0===u&&(u=0),this.x=+t,this.y=+n,this.z=+u};vc.fromLngLat=function(t,n){void 0===n&&(n=0);var u=Do.convert(t);return new vc(Fc(u.lng),zc(u.lat),ch(n,u.lat))},vc.prototype.toLngLat=function(){return new Do(360*this.x-180,Ep(this.y))},vc.prototype.toAltitude=function(){return this.z*wp(Ep(this.y))},vc.prototype.meterInMercatorCoordinateUnits=function(){return 1/bp*(t=Ep(this.y),1/Math.cos(t*Math.PI/180));var t};var _c=function(t,n,u){this.z=t,this.x=n,this.y=u,this.key=Bc(0,t,t,n,u)};_c.prototype.equals=function(t){return this.z===t.z&&this.x===t.x&&this.y===t.y},_c.prototype.url=function(t,n){var u,g,_,w,S,A=(g=this.y,_=this.z,w=lh(256*(u=this.x),256*(g=Math.pow(2,_)-g-1),_),S=lh(256*(u+1),256*(g+1),_),w[0]+","+w[1]+","+S[0]+","+S[1]),z=function(q,V,H){for(var st,vt="",Rt=q;Rt>0;Rt--)vt+=(V&(st=1<<Rt-1)?1:0)+(H&st?2:0);return vt}(this.z,this.x,this.y);return t[(this.x+this.y)%t.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String("tms"===n?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",z).replace("{bbox-epsg-3857}",A)},_c.prototype.getTilePoint=function(t){var n=Math.pow(2,this.z);return new Ft(8192*(t.x*n-this.x),8192*(t.y*n-this.y))},_c.prototype.toString=function(){return this.z+"/"+this.x+"/"+this.y};var Cf=function(t,n){this.wrap=t,this.canonical=n,this.key=Bc(t,n.z,n.z,n.x,n.y)},ns=function(t,n,u,g,_){this.overscaledZ=t,this.wrap=n,this.canonical=new _c(u,+g,+_),this.key=Bc(n,t,u,g,_)};function Bc(t,n,u,g,_){(t*=2)<0&&(t=-1*t-1);var w=1<<u;return(w*w*t+w*_+g).toString(36)+u.toString(36)+n.toString(36)}ns.prototype.equals=function(t){return this.overscaledZ===t.overscaledZ&&this.wrap===t.wrap&&this.canonical.equals(t.canonical)},ns.prototype.scaledTo=function(t){var n=this.canonical.z-t;return t>this.canonical.z?new ns(t,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new ns(t,this.wrap,t,this.canonical.x>>n,this.canonical.y>>n)},ns.prototype.calculateScaledKey=function(t,n){var u=this.canonical.z-t;return t>this.canonical.z?Bc(this.wrap*+n,t,this.canonical.z,this.canonical.x,this.canonical.y):Bc(this.wrap*+n,t,t,this.canonical.x>>u,this.canonical.y>>u)},ns.prototype.isChildOf=function(t){if(t.wrap!==this.wrap)return!1;var n=this.canonical.z-t.canonical.z;return 0===t.overscaledZ||t.overscaledZ<this.overscaledZ&&t.canonical.x===this.canonical.x>>n&&t.canonical.y===this.canonical.y>>n},ns.prototype.children=function(t){if(this.overscaledZ>=t)return[new ns(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];var n=this.canonical.z+1,u=2*this.canonical.x,g=2*this.canonical.y;return[new ns(n,this.wrap,n,u,g),new ns(n,this.wrap,n,u+1,g),new ns(n,this.wrap,n,u,g+1),new ns(n,this.wrap,n,u+1,g+1)]},ns.prototype.isLessThan=function(t){return this.wrap<t.wrap||!(this.wrap>t.wrap)&&(this.overscaledZ<t.overscaledZ||!(this.overscaledZ>t.overscaledZ)&&(this.canonical.x<t.canonical.x||!(this.canonical.x>t.canonical.x)&&this.canonical.y<t.canonical.y))},ns.prototype.wrapped=function(){return new ns(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)},ns.prototype.unwrapTo=function(t){return new ns(this.overscaledZ,t,this.canonical.z,this.canonical.x,this.canonical.y)},ns.prototype.overscaleFactor=function(){return Math.pow(2,this.overscaledZ-this.canonical.z)},ns.prototype.toUnwrapped=function(){return new Cf(this.wrap,this.canonical)},ns.prototype.toString=function(){return this.overscaledZ+"/"+this.canonical.x+"/"+this.canonical.y},ns.prototype.getTilePoint=function(t){return this.canonical.getTilePoint(new vc(t.x-this.wrap,t.y))},_r("CanonicalTileID",_c),_r("OverscaledTileID",ns,{omit:["posMatrix"]});var Fl=function(t,n,u){if(this.uid=t,n.height!==n.width)throw new RangeError("DEM tiles must be square");if(u&&"mapbox"!==u&&"terrarium"!==u)return St('"'+u+'" is not a valid encoding type. Valid types include "mapbox" and "terrarium".');this.stride=n.height;var g=this.dim=n.height-2;this.data=new Uint32Array(n.data.buffer),this.encoding=u||"mapbox";for(var _=0;_<g;_++)this.data[this._idx(-1,_)]=this.data[this._idx(0,_)],this.data[this._idx(g,_)]=this.data[this._idx(g-1,_)],this.data[this._idx(_,-1)]=this.data[this._idx(_,0)],this.data[this._idx(_,g)]=this.data[this._idx(_,g-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(g,-1)]=this.data[this._idx(g-1,0)],this.data[this._idx(-1,g)]=this.data[this._idx(0,g-1)],this.data[this._idx(g,g)]=this.data[this._idx(g-1,g-1)]};Fl.prototype.get=function(t,n){var u=new Uint8Array(this.data.buffer),g=4*this._idx(t,n);return("terrarium"===this.encoding?this._unpackTerrarium:this._unpackMapbox)(u[g],u[g+1],u[g+2])},Fl.prototype.getUnpackVector=function(){return"terrarium"===this.encoding?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]},Fl.prototype._idx=function(t,n){if(t<-1||t>=this.dim+1||n<-1||n>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(n+1)*this.stride+(t+1)},Fl.prototype._unpackMapbox=function(t,n,u){return(256*t*256+256*n+u)/10-1e4},Fl.prototype._unpackTerrarium=function(t,n,u){return 256*t+n+u/256-32768},Fl.prototype.getPixels=function(){return new To({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))},Fl.prototype.backfillBorder=function(t,n,u){if(this.dim!==t.dim)throw new Error("dem dimension mismatch");var g=n*this.dim,_=n*this.dim+this.dim,w=u*this.dim,S=u*this.dim+this.dim;switch(n){case-1:g=_-1;break;case 1:_=g+1}switch(u){case-1:w=S-1;break;case 1:S=w+1}for(var A=-n*this.dim,z=-u*this.dim,q=w;q<S;q++)for(var V=g;V<_;V++)this.data[this._idx(V,q)]=t.data[this._idx(V+A,q+z)]},_r("DEMData",Fl);var Bh=function(t){this._stringToNumber={},this._numberToString=[];for(var n=0;n<t.length;n++){var u=t[n];this._stringToNumber[u]=n,this._numberToString[n]=u}};Bh.prototype.encode=function(t){return this._stringToNumber[t]},Bh.prototype.decode=function(t){return this._numberToString[t]};var Uh=function(t,n,u,g,_){this.type="Feature",this._vectorTileFeature=t,t._z=n,t._x=u,t._y=g,this.properties=t.properties,this.id=_},qh={geometry:{configurable:!0}};qh.geometry.get=function(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry},qh.geometry.set=function(t){this._geometry=t},Uh.prototype.toJSON=function(){var t={geometry:this.geometry};for(var n in this)"_geometry"!==n&&"_vectorTileFeature"!==n&&(t[n]=this[n]);return t},Object.defineProperties(Uh.prototype,qh);var $l=function(){this.state={},this.stateChanges={},this.deletedStates={}};$l.prototype.updateState=function(t,n,u){var g=String(n);if(this.stateChanges[t]=this.stateChanges[t]||{},this.stateChanges[t][g]=this.stateChanges[t][g]||{},j(this.stateChanges[t][g],u),null===this.deletedStates[t])for(var _ in this.deletedStates[t]={},this.state[t])_!==g&&(this.deletedStates[t][_]=null);else if(this.deletedStates[t]&&null===this.deletedStates[t][g])for(var w in this.deletedStates[t][g]={},this.state[t][g])u[w]||(this.deletedStates[t][g][w]=null);else for(var S in u)this.deletedStates[t]&&this.deletedStates[t][g]&&null===this.deletedStates[t][g][S]&&delete this.deletedStates[t][g][S]},$l.prototype.removeFeatureState=function(t,n,u){if(null!==this.deletedStates[t]){var g=String(n);if(this.deletedStates[t]=this.deletedStates[t]||{},u&&void 0!==n)null!==this.deletedStates[t][g]&&(this.deletedStates[t][g]=this.deletedStates[t][g]||{},this.deletedStates[t][g][u]=null);else if(void 0!==n)if(this.stateChanges[t]&&this.stateChanges[t][g])for(u in this.deletedStates[t][g]={},this.stateChanges[t][g])this.deletedStates[t][g][u]=null;else this.deletedStates[t][g]=null;else this.deletedStates[t]=null}},$l.prototype.getState=function(t,n){var u=String(n),g=j({},(this.state[t]||{})[u],(this.stateChanges[t]||{})[u]);if(null===this.deletedStates[t])return{};if(this.deletedStates[t]){var _=this.deletedStates[t][n];if(null===_)return{};for(var w in _)delete g[w]}return g},$l.prototype.initializeTileState=function(t,n){t.setFeatureState(this.state,n)},$l.prototype.coalesceChanges=function(t,n){var u={};for(var g in this.stateChanges){this.state[g]=this.state[g]||{};var _={};for(var w in this.stateChanges[g])this.state[g][w]||(this.state[g][w]={}),j(this.state[g][w],this.stateChanges[g][w]),_[w]=this.state[g][w];u[g]=_}for(var S in this.deletedStates){this.state[S]=this.state[S]||{};var A={};if(null===this.deletedStates[S])for(var z in this.state[S])A[z]={},this.state[S][z]={};else for(var q in this.deletedStates[S]){if(null===this.deletedStates[S][q])this.state[S][q]={};else for(var V=0,H=Object.keys(this.deletedStates[S][q]);V<H.length;V+=1)delete this.state[S][q][H[V]];A[q]=this.state[S][q]}u[S]=u[S]||{},j(u[S],A)}if(this.stateChanges={},this.deletedStates={},0!==Object.keys(u).length)for(var st in t)t[st].setFeatureState(u,n)};var zl=function(t,n){this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=new ao(8192,16,0),this.grid3D=new ao(8192,16,0),this.featureIndexArray=new yt,this.promoteId=n};function xc(t,n,u,g,_){return et(t,function(w,S){var A=n instanceof mu?n.get(S):null;return A&&A.evaluate?A.evaluate(u,g,_):A})}function bc(t){for(var n=1/0,u=1/0,g=-1/0,_=-1/0,w=0,S=t;w<S.length;w+=1){var A=S[w];n=Math.min(n,A.x),u=Math.min(u,A.y),g=Math.max(g,A.x),_=Math.max(_,A.y)}return{minX:n,minY:u,maxX:g,maxY:_}}function If(t,n){return n-t}zl.prototype.insert=function(t,n,u,g,_,w){var S=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(u,g,_);for(var A=w?this.grid3D:this.grid,z=0;z<n.length;z++){for(var q=n[z],V=[1/0,1/0,-1/0,-1/0],H=0;H<q.length;H++){var st=q[H];V[0]=Math.min(V[0],st.x),V[1]=Math.min(V[1],st.y),V[2]=Math.max(V[2],st.x),V[3]=Math.max(V[3],st.y)}V[0]<8192&&V[1]<8192&&V[2]>=0&&V[3]>=0&&A.insert(S,V[0],V[1],V[2],V[3])}},zl.prototype.loadVTLayers=function(){return this.vtLayers||(this.vtLayers=new Lc.VectorTile(new Ah(this.rawTileData)).layers,this.sourceLayerCoder=new Bh(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers},zl.prototype.query=function(t,n,u,g){var _=this;this.loadVTLayers();for(var w=t.params||{},S=8192/t.tileSize/t.scale,A=Qa(w.filter),z=t.queryGeometry,q=t.queryPadding*S,V=bc(z),H=this.grid.query(V.minX-q,V.minY-q,V.maxX+q,V.maxY+q),st=bc(t.cameraQueryGeometry),Rt=0,Vt=this.grid3D.query(st.minX-q,st.minY-q,st.maxX+q,st.maxY+q,function(Re,ze,rr,yr){return function(Mr,Wr,Tr,ln,Fr){for(var ii=0,Pn=Mr;ii<Pn.length;ii+=1){var Jr=Pn[ii];if(Wr<=Jr.x&&Tr<=Jr.y&&ln>=Jr.x&&Fr>=Jr.y)return!0}var fi=[new Ft(Wr,Tr),new Ft(Wr,Fr),new Ft(ln,Fr),new Ft(ln,Tr)];if(Mr.length>2)for(var Xn=0,Ii=fi;Xn<Ii.length;Xn+=1)if(pl(Mr,Ii[Xn]))return!0;for(var pn=0;pn<Mr.length-1;pn++)if(hc(Mr[pn],Mr[pn+1],fi))return!0;return!1}(t.cameraQueryGeometry,Re-q,ze-q,rr+q,yr+q)});Rt<Vt.length;Rt+=1)H.push(Vt[Rt]);H.sort(If);for(var he,re={},we=function(Re){var ze=H[Re];if(ze!==he){he=ze;var rr=_.featureIndexArray.get(ze),yr=null;_.loadMatchingFeature(re,rr.bucketIndex,rr.sourceLayerIndex,rr.featureIndex,A,w.layers,w.availableImages,n,u,g,function(Mr,Wr,Tr){return yr||(yr=Ia(Mr)),Wr.queryIntersectsFeature(z,Mr,Tr,yr,_.z,t.transform,S,t.pixelPosMatrix)})}},Pe=0;Pe<H.length;Pe++)we(Pe);return re},zl.prototype.loadMatchingFeature=function(t,n,u,g,_,w,S,A,z,q,V){var H=this.bucketLayerIDs[n];if(!w||function(Mr,Wr){for(var Tr=0;Tr<Mr.length;Tr++)if(Wr.indexOf(Mr[Tr])>=0)return!0;return!1}(w,H)){var st=this.sourceLayerCoder.decode(u),vt=this.vtLayers[st].feature(g);if(_.needGeometry){var Rt=iu(vt,!0);if(!_.filter(new so(this.tileID.overscaledZ),Rt,this.tileID.canonical))return}else if(!_.filter(new so(this.tileID.overscaledZ),vt))return;for(var Vt=this.getId(vt,st),he=0;he<H.length;he++){var re=H[he];if(!(w&&w.indexOf(re)<0)){var we=A[re];if(we){var Pe={};void 0!==Vt&&q&&(Pe=q.getState(we.sourceLayer||"_geojsonTileLayer",Vt));var Re=j({},z[re]);Re.paint=xc(Re.paint,we.paint,vt,Pe,S),Re.layout=xc(Re.layout,we.layout,vt,Pe,S);var ze=!V||V(vt,we,Pe);if(ze){var rr=new Uh(vt,this.z,this.x,this.y,Vt);rr.layer=Re;var yr=t[re];void 0===yr&&(yr=t[re]=[]),yr.push({featureIndex:g,feature:rr,intersectionZ:ze})}}}}}},zl.prototype.lookupSymbolFeatures=function(t,n,u,g,_,w,S,A){var z={};this.loadVTLayers();for(var q=Qa(_),V=0,H=t;V<H.length;V+=1)this.loadMatchingFeature(z,u,g,H[V],q,w,S,A,n);return z},zl.prototype.hasLayer=function(t){for(var n=0,u=this.bucketLayerIDs;n<u.length;n+=1)for(var g=0,_=u[n];g<_.length;g+=1)if(t===_[g])return!0;return!1},zl.prototype.getId=function(t,n){var u=t.id;return this.promoteId&&"boolean"==typeof(u=t.properties["string"==typeof this.promoteId?this.promoteId:this.promoteId[n]])&&(u=Number(u)),u},_r("FeatureIndex",zl,{omit:["rawTileData","sourceLayerCoder"]});var Ss=function(t,n){this.tileID=t,this.uid=K(),this.uses=0,this.tileSize=n,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.expiredRequestCount=0,this.state="loading"};Ss.prototype.registerFadeDuration=function(t){var n=t+this.timeAdded;n<Sr.now()||this.fadeEndTime&&n<this.fadeEndTime||(this.fadeEndTime=n)},Ss.prototype.wasRequested=function(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state},Ss.prototype.loadVectorData=function(t,n,u){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",t){for(var g in t.featureIndex&&(this.latestFeatureIndex=t.featureIndex,t.rawTileData?(this.latestRawTileData=t.rawTileData,this.latestFeatureIndex.rawTileData=t.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=t.collisionBoxArray,this.buckets=function(q,V){var H={};if(!V)return H;for(var st=function(){var Vt=Rt[vt],he=Vt.layerIds.map(function(Pe){return V.getLayer(Pe)}).filter(Boolean);if(0!==he.length){Vt.layers=he,Vt.stateDependentLayerIds&&(Vt.stateDependentLayers=Vt.stateDependentLayerIds.map(function(Pe){return he.filter(function(Re){return Re.id===Pe})[0]}));for(var re=0,we=he;re<we.length;re+=1)H[we[re].id]=Vt}},vt=0,Rt=q;vt<Rt.length;vt+=1)st();return H}(t.buckets,n.style),this.hasSymbolBuckets=!1,this.buckets){var _=this.buckets[g];if(_ instanceof Lo){if(this.hasSymbolBuckets=!0,!u)break;_.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(var w in this.buckets){var S=this.buckets[w];if(S instanceof Lo&&S.hasRTLText){this.hasRTLText=!0,ui.isLoading()||ui.isLoaded()||"deferred"!==Xs()||Xl();break}}for(var A in this.queryPadding=0,this.buckets){var z=this.buckets[A];this.queryPadding=Math.max(this.queryPadding,n.style.getLayer(A).queryRadius(z))}t.imageAtlas&&(this.imageAtlas=t.imageAtlas),t.glyphAtlasImage&&(this.glyphAtlasImage=t.glyphAtlasImage)}else this.collisionBoxArray=new c},Ss.prototype.unloadVectorData=function(){for(var t in this.buckets)this.buckets[t].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"},Ss.prototype.getBucket=function(t){return this.buckets[t.id]},Ss.prototype.upload=function(t){for(var n in this.buckets){var u=this.buckets[n];u.uploadPending()&&u.upload(t)}var g=t.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new yc(t,this.imageAtlas.image,g.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new yc(t,this.glyphAtlasImage,g.ALPHA),this.glyphAtlasImage=null)},Ss.prototype.prepare=function(t){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(t,this.imageAtlasTexture)},Ss.prototype.queryRenderedFeatures=function(t,n,u,g,_,w,S,A,z,q){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:g,cameraQueryGeometry:_,scale:w,tileSize:this.tileSize,pixelPosMatrix:q,transform:A,params:S,queryPadding:this.queryPadding*z},t,n,u):{}},Ss.prototype.querySourceFeatures=function(t,n){var u=this.latestFeatureIndex;if(u&&u.rawTileData){var g=u.loadVTLayers(),_=n?n.sourceLayer:"",w=g._geojsonTileLayer||g[_];if(w)for(var S=Qa(n&&n.filter),A=this.tileID.canonical,z=A.z,q=A.x,V=A.y,H={z,x:q,y:V},st=0;st<w.length;st++){var vt=w.feature(st);if(S.needGeometry){var Rt=iu(vt,!0);if(!S.filter(new so(this.tileID.overscaledZ),Rt,this.tileID.canonical))continue}else if(!S.filter(new so(this.tileID.overscaledZ),vt))continue;var Vt=u.getId(vt,_),he=new Uh(vt,z,q,V,Vt);he.tile=H,t.push(he)}}},Ss.prototype.hasData=function(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state},Ss.prototype.patternsLoaded=function(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length},Ss.prototype.setExpiryData=function(t){var n=this.expirationTime;if(t.cacheControl){var u=Ce(t.cacheControl);u["max-age"]&&(this.expirationTime=Date.now()+1e3*u["max-age"])}else t.expires&&(this.expirationTime=new Date(t.expires).getTime());if(this.expirationTime){var g=Date.now(),_=!1;if(this.expirationTime>g)_=!1;else if(n)if(this.expirationTime<n)_=!0;else{var w=this.expirationTime-n;w?this.expirationTime=g+Math.max(w,3e4):_=!0}else _=!0;_?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}},Ss.prototype.getExpiryTimeout=function(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)},Ss.prototype.setFeatureState=function(t,n){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&0!==Object.keys(t).length){var u=this.latestFeatureIndex.loadVTLayers();for(var g in this.buckets)if(n.style.hasLayer(g)){var _=this.buckets[g],w=_.layers[0].sourceLayer||"_geojsonTileLayer",S=u[w],A=t[w];if(S&&A&&0!==Object.keys(A).length){_.update(A,S,this.imageAtlas&&this.imageAtlas.patternPositions||{});var z=n&&n.style&&n.style.getLayer(g);z&&(this.queryPadding=Math.max(this.queryPadding,z.queryRadius(_)))}}}},Ss.prototype.holdingForFade=function(){return void 0!==this.symbolFadeHoldUntil},Ss.prototype.symbolFadeFinished=function(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<Sr.now()},Ss.prototype.clearFadeHold=function(){this.symbolFadeHoldUntil=void 0},Ss.prototype.setHoldDuration=function(t){this.symbolFadeHoldUntil=Sr.now()+t},Ss.prototype.setDependencies=function(t,n){for(var u={},g=0,_=n;g<_.length;g+=1)u[_[g]]=!0;this.dependencies[t]=u},Ss.prototype.hasDependency=function(t,n){for(var u=0,g=t;u<g.length;u+=1){var _=this.dependencies[g[u]];if(_)for(var w=0,S=n;w<S.length;w+=1)if(_[S[w]])return!0}return!1};var Bl=qt.performance,Gh=function(t){this._marks={start:[t.url,"start"].join("#"),end:[t.url,"end"].join("#"),measure:t.url.toString()},Bl.mark(this._marks.start)};Gh.prototype.finish=function(){Bl.mark(this._marks.end);var t=Bl.getEntriesByName(this._marks.measure);return 0===t.length&&(Bl.measure(this._marks.measure,this._marks.start,this._marks.end),t=Bl.getEntriesByName(this._marks.measure),Bl.clearMarks(this._marks.start),Bl.clearMarks(this._marks.end),Bl.clearMeasures(this._marks.measure)),t},s.Actor=Kl,s.AlphaImage=ou,s.CanonicalTileID=_c,s.CollisionBoxArray=c,s.Color=Hn,s.DEMData=Fl,s.DataConstantProperty=Dr,s.DictionaryCoder=Bh,s.EXTENT=8192,s.ErrorEvent=me,s.EvaluationParameters=so,s.Event=ae,s.Evented=ue,s.FeatureIndex=zl,s.FillBucket=dl,s.FillExtrusionBucket=gl,s.ImageAtlas=Oc,s.ImagePosition=Lh,s.LineBucket=un,s.LngLat=Do,s.LngLatBounds=ma,s.MercatorCoordinate=vc,s.ONE_EM=24,s.OverscaledTileID=ns,s.Point=Ft,s.Point$1=Ft,s.Properties=Sa,s.Protobuf=Ah,s.RGBAImage=To,s.RequestManager=_n,s.RequestPerformance=Gh,s.ResourceType=Xo,s.SegmentVector=_t,s.SourceFeatureState=$l,s.StructArrayLayout1ui2=Mi,s.StructArrayLayout2f1f2i16=$,s.StructArrayLayout2i4=fs,s.StructArrayLayout3ui6=te,s.StructArrayLayout4i8=Io,s.SymbolBucket=Lo,s.Texture=yc,s.Tile=Ss,s.Transitionable=Ds,s.Uniform1f=fr,s.Uniform1i=br,s.Uniform2f=zr,s.Uniform3f=nn,s.Uniform4f=sn,s.UniformColor=on,s.UniformMatrix4f=Gr,s.UnwrappedTileID=Cf,s.ValidationError=Ht,s.WritingMode=qu,s.ZoomHistory=So,s.add=function(t,n,u){return t[0]=n[0]+u[0],t[1]=n[1]+u[1],t[2]=n[2]+u[2],t},s.addDynamicAttributes=xf,s.asyncAll=function(t,n,u){if(!t.length)return u(null,[]);var g=t.length,_=new Array(t.length),w=null;t.forEach(function(S,A){n(S,function(z,q){z&&(w=z),_[A]=q,0==--g&&u(w,_)})})},s.bezier=mt,s.bindAll=nt,s.browser=Sr,s.cacheEntryPossiblyAdded=function(t){++ri>gn&&(t.getActor().send("enforceCacheSizeLimit",hr),ri=0)},s.clamp=Jt,s.clearTileCache=function(t){var n=qt.caches.delete("mapbox-tiles");t&&n.catch(t).then(function(){return t()})},s.clipLine=Pd,s.clone=function(t){var n=new Na(16);return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[4]=t[4],n[5]=t[5],n[6]=t[6],n[7]=t[7],n[8]=t[8],n[9]=t[9],n[10]=t[10],n[11]=t[11],n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15],n},s.clone$1=Z,s.clone$2=function(t){var n=new Na(3);return n[0]=t[0],n[1]=t[1],n[2]=t[2],n},s.collisionCircleLayout=dd,s.config=mr,s.create=function(){var t=new Na(16);return Na!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t},s.create$1=function(){var t=new Na(9);return Na!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t},s.create$2=function(){var t=new Na(4);return Na!=Float32Array&&(t[1]=0,t[2]=0),t[0]=1,t[3]=1,t},s.createCommonjsModule=lt,s.createExpression=Gs,s.createLayout=yo,s.createStyleLayer=function(t){return"custom"===t.type?new Ef(t):new Ld[t.type](t)},s.cross=function(t,n,u){var g=n[0],_=n[1],w=n[2],S=u[0],A=u[1],z=u[2];return t[0]=_*z-w*A,t[1]=w*S-g*z,t[2]=g*A-_*S,t},s.deepEqual=function t(n,u){if(Array.isArray(n)){if(!Array.isArray(u)||n.length!==u.length)return!1;for(var g=0;g<n.length;g++)if(!t(n[g],u[g]))return!1;return!0}if("object"==typeof n&&null!==n&&null!==u){if("object"!=typeof u||Object.keys(n).length!==Object.keys(u).length)return!1;for(var _ in n)if(!t(n[_],u[_]))return!1;return!0}return n===u},s.dot=function(t,n){return t[0]*n[0]+t[1]*n[1]+t[2]*n[2]},s.dot$1=function(t,n){return t[0]*n[0]+t[1]*n[1]+t[2]*n[2]+t[3]*n[3]},s.ease=xt,s.emitValidationErrors=_s,s.endsWith=J,s.enforceCacheSizeLimit=function(t){Yn(),le&&le.then(function(n){n.keys().then(function(u){for(var g=0;g<u.length-t;g++)n.delete(u[g])})})},s.evaluateSizeForFeature=wd,s.evaluateSizeForZoom=Ed,s.evaluateVariableOffset=dp,s.evented=rs,s.extend=j,s.featureFilter=Qa,s.filterObject=at,s.fromRotation=function(t,n){var u=Math.sin(n),g=Math.cos(n);return t[0]=g,t[1]=u,t[2]=0,t[3]=-u,t[4]=g,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},s.getAnchorAlignment=cp,s.getAnchorJustification=gp,s.getArrayBuffer=oi,s.getImage=ft,s.getJSON=function(t,n){return cr(j(t,{type:"json"}),n)},s.getRTLTextPluginStatus=Xs,s.getReferrer=Yo,s.getVideo=function(t,n){var u,g,_=qt.document.createElement("video");_.muted=!0,_.onloadstart=function(){n(null,_)};for(var w=0;w<t.length;w++){var S=qt.document.createElement("source");u=t[w],g=void 0,(g=qt.document.createElement("a")).href=u,(g.protocol!==qt.document.location.protocol||g.host!==qt.document.location.host)&&(_.crossOrigin="Anonymous"),S.src=t[w],_.appendChild(S)}return{cancel:function(){}}},s.identity=vu,s.invert=function(t,n){var u=n[0],g=n[1],_=n[2],w=n[3],S=n[4],A=n[5],z=n[6],q=n[7],V=n[8],H=n[9],st=n[10],vt=n[11],Rt=n[12],Vt=n[13],he=n[14],re=n[15],we=u*A-g*S,Pe=u*z-_*S,Re=u*q-w*S,ze=g*z-_*A,rr=g*q-w*A,yr=_*q-w*z,Mr=V*Vt-H*Rt,Wr=V*he-st*Rt,Tr=V*re-vt*Rt,ln=H*he-st*Vt,Fr=H*re-vt*Vt,ii=st*re-vt*he,Pn=we*ii-Pe*Fr+Re*ln+ze*Tr-rr*Wr+yr*Mr;return Pn?(t[0]=(A*ii-z*Fr+q*ln)*(Pn=1/Pn),t[1]=(_*Fr-g*ii-w*ln)*Pn,t[2]=(Vt*yr-he*rr+re*ze)*Pn,t[3]=(st*rr-H*yr-vt*ze)*Pn,t[4]=(z*Tr-S*ii-q*Wr)*Pn,t[5]=(u*ii-_*Tr+w*Wr)*Pn,t[6]=(he*Re-Rt*yr-re*Pe)*Pn,t[7]=(V*yr-st*Re+vt*Pe)*Pn,t[8]=(S*Fr-A*Tr+q*Mr)*Pn,t[9]=(g*Tr-u*Fr-w*Mr)*Pn,t[10]=(Rt*rr-Vt*Re+re*we)*Pn,t[11]=(H*Re-V*rr-vt*we)*Pn,t[12]=(A*Wr-S*ln-z*Mr)*Pn,t[13]=(u*ln-g*Wr+_*Mr)*Pn,t[14]=(Vt*Pe-Rt*ze-he*we)*Pn,t[15]=(V*ze-H*Pe+st*we)*Pn,t):null},s.isChar=Ir,s.isMapboxURL=zn,s.keysDifference=function(t,n){var u=[];for(var g in t)g in n||u.push(g);return u},s.makeRequest=cr,s.mapObject=et,s.mercatorXfromLng=Fc,s.mercatorYfromLat=zc,s.mercatorZfromAltitude=ch,s.mul=Ch,s.multiply=Pl,s.mvt=Lc,s.nextPowerOfTwo=function(t){return t<=1?1:Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))},s.normalize=function(t,n){var u=n[0],g=n[1],_=n[2],w=u*u+g*g+_*_;return w>0&&(w=1/Math.sqrt(w)),t[0]=n[0]*w,t[1]=n[1]*w,t[2]=n[2]*w,t},s.number=ho,s.offscreenCanvasSupported=Br,s.ortho=function(t,n,u,g,_,w,S){var A=1/(n-u),z=1/(g-_),q=1/(w-S);return t[0]=-2*A,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*z,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*q,t[11]=0,t[12]=(n+u)*A,t[13]=(_+g)*z,t[14]=(S+w)*q,t[15]=1,t},s.parseGlyphPBF=function(t){return new Ah(t).readFields(vd,[])},s.pbf=Ah,s.performSymbolLayout=function(t,n,u,g,_,w,S){t.createArrays(),t.tilePixelRatio=8192/(512*t.overscaling),t.compareText={},t.iconsNeedLinear=!1;var A=t.layers[0].layout,z=t.layers[0]._unevaluatedLayout._values,q={};if("composite"===t.textSizeData.kind){var V=t.textSizeData,H=V.maxZoom;q.compositeTextSizes=[z["text-size"].possiblyEvaluate(new so(V.minZoom),S),z["text-size"].possiblyEvaluate(new so(H),S)]}if("composite"===t.iconSizeData.kind){var st=t.iconSizeData,vt=st.maxZoom;q.compositeIconSizes=[z["icon-size"].possiblyEvaluate(new so(st.minZoom),S),z["icon-size"].possiblyEvaluate(new so(vt),S)]}q.layoutTextSize=z["text-size"].possiblyEvaluate(new so(t.zoom+1),S),q.layoutIconSize=z["icon-size"].possiblyEvaluate(new so(t.zoom+1),S),q.textMaxSize=z["text-size"].possiblyEvaluate(new so(18));for(var Rt=24*A.get("text-line-height"),Vt="map"===A.get("text-rotation-alignment")&&"point"!==A.get("symbol-placement"),he=A.get("text-keep-upright"),re=A.get("text-size"),we=function(){var ze=Re[Pe],rr=A.get("text-font").evaluate(ze,{},S).join(","),yr=re.evaluate(ze,{},S),Mr=q.layoutTextSize.evaluate(ze,{},S),Wr=q.layoutIconSize.evaluate(ze,{},S),Tr={horizontal:{},vertical:void 0},ln=ze.text,Fr=[0,0];if(ln){var ii=ln.toString(),Pn=24*A.get("text-letter-spacing").evaluate(ze,{},S),Jr=function(vi){for(var Oo=0,vo=vi;Oo<vo.length;Oo+=1)if(Li=vo[Oo].charCodeAt(0),Ir.Arabic(Li)||Ir["Arabic Supplement"](Li)||Ir["Arabic Extended-A"](Li)||Ir["Arabic Presentation Forms-A"](Li)||Ir["Arabic Presentation Forms-B"](Li))return!1;var Li;return!0}(ii)?Pn:0,fi=A.get("text-anchor").evaluate(ze,{},S),Xn=A.get("text-variable-anchor");if(!Xn){var Ii=A.get("text-radial-offset").evaluate(ze,{},S);Fr=Ii?dp(fi,[24*Ii,vf]):A.get("text-offset").evaluate(ze,{},S).map(function(vi){return 24*vi})}var pn=Vt?"center":A.get("text-justify").evaluate(ze,{},S),uo=A.get("symbol-placement"),Qo="point"===uo?24*A.get("text-max-width").evaluate(ze,{},S):0,Pa=function(){t.allowVerticalPlacement&&Vo(ii)&&(Tr.vertical=kc(ln,n,u,_,rr,Qo,Rt,fi,"left",Jr,Fr,qu.vertical,!0,uo,Mr,yr))};if(!Vt&&Xn){for(var Ma="auto"===pn?Xn.map(function(vi){return gp(vi)}):[pn],la=!1,ya=0;ya<Ma.length;ya++){var is=Ma[ya];if(!Tr.horizontal[is])if(la)Tr.horizontal[is]=Tr.horizontal[0];else{var os=kc(ln,n,u,_,rr,Qo,Rt,"center",is,Jr,Fr,qu.horizontal,!1,uo,Mr,yr);os&&(Tr.horizontal[is]=os,la=1===os.positionedLines.length)}}Pa()}else{"auto"===pn&&(pn=gp(fi));var uu=kc(ln,n,u,_,rr,Qo,Rt,fi,pn,Jr,Fr,qu.horizontal,!1,uo,Mr,yr);uu&&(Tr.horizontal[pn]=uu),Pa(),Vo(ii)&&Vt&&he&&(Tr.vertical=kc(ln,n,u,_,rr,Qo,Rt,fi,pn,Jr,Fr,qu.vertical,!1,uo,Mr,yr))}}var vi,Oo,Li,_u,Fs,Cs=void 0,Ns=!1;if(ze.icon&&ze.icon.name){var Ja=g[ze.icon.name];Ja&&(vi=_[ze.icon.name],Oo=A.get("icon-offset").evaluate(ze,{},S),Li=cp(A.get("icon-anchor").evaluate(ze,{},S)),Cs={image:vi,top:Fs=Oo[1]-vi.displaySize[1]*Li.verticalAlign,bottom:Fs+vi.displaySize[1],left:_u=Oo[0]-vi.displaySize[0]*Li.horizontalAlign,right:_u+vi.displaySize[0]},Ns=Ja.sdf,void 0===t.sdfIcons?t.sdfIcons=Ja.sdf:t.sdfIcons!==Ja.sdf&&St("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Ja.pixelRatio!==t.pixelRatio||0!==A.get("icon-rotate").constantOr(1))&&(t.iconsNeedLinear=!0))}var Rs=yp(Tr.horizontal)||Tr.vertical;t.iconsInText=!!Rs&&Rs.iconsInText,(Rs||Cs)&&function(vi,Oo,vo,Li,_u,Fs,ia,Ha,lu,oo,ml){var Gu=Fs.textMaxSize.evaluate(Oo,{});void 0===Gu&&(Gu=ia);var Ul,Wa=vi.layers[0].layout,ql=Wa.get("icon-offset").evaluate(Oo,{},ml),yl=yp(vo.horizontal),hh=ia/24,Vu=vi.tilePixelRatio*hh,Gl=vi.tilePixelRatio*Gu/24,ol=vi.tilePixelRatio*Ha,wc=vi.tilePixelRatio*Wa.get("symbol-spacing"),ds=Wa.get("text-padding")*vi.tilePixelRatio,ph=Wa.get("icon-padding")*vi.tilePixelRatio,va=Wa.get("text-max-angle")/180*Math.PI,xu="map"===Wa.get("text-rotation-alignment")&&"point"!==Wa.get("symbol-placement"),Ec="map"===Wa.get("icon-rotation-alignment")&&"point"!==Wa.get("symbol-placement"),Zu=Wa.get("symbol-placement"),Sc=wc/2,ta=Wa.get("icon-text-fit");Li&&"none"!==ta&&(vi.allowVerticalPlacement&&vo.vertical&&(Ul=pf(Li,vo.vertical,ta,Wa.get("icon-text-fit-padding"),ql,hh)),yl&&(Li=pf(Li,yl,ta,Wa.get("icon-text-fit-padding"),ql,hh)));var Is=function(Xh,Ql){Ql.x<0||Ql.x>=8192||Ql.y<0||Ql.y>=8192||function(Ta,al,Tp,Al,gh,vl,Yh,Ll,Jh,Zc,Ap,Hh,mh,Dd,tc,Od,kd,Wh,as,Xu,Ao,Ou,ec,_l,Pf){var Cc,xl,tl,Yu,Ju,rc=Ta.addToLineVertexArray(al,Tp),Lp=0,Dp=0,Op=0,kp=0,Np=-1,Rp=-1,Ps={},Mf=ne(""),Kh=0,Tf=0;if(void 0===Ll._unevaluatedLayout.getValue("text-radial-offset")?(Kh=(Cc=Ll.layout.get("text-offset").evaluate(Ao,{},_l).map(function(Hc){return 24*Hc}))[0],Tf=Cc[1]):(Kh=24*Ll.layout.get("text-radial-offset").evaluate(Ao,{},_l),Tf=vf),Ta.allowVerticalPlacement&&Al.vertical){var jc=Ll.layout.get("text-rotate").evaluate(Ao,{},_l)+90;Yu=new Fh(Jh,al,Zc,Ap,Hh,Al.vertical,mh,Dd,tc,jc),Yh&&(Ju=new Fh(Jh,al,Zc,Ap,Hh,Yh,kd,Wh,tc,jc))}if(gh){var Xc=Ll.layout.get("icon-rotate").evaluate(Ao,{}),yh="none"!==Ll.layout.get("icon-text-fit"),vh=Md(gh,Xc,ec,yh),Yc=Yh?Md(Yh,Xc,ec,yh):void 0;tl=new Fh(Jh,al,Zc,Ap,Hh,gh,kd,Wh,!1,Xc),Lp=4*vh.length;var _h=Ta.iconSizeData,nc=null;"source"===_h.kind?(nc=[128*Ll.layout.get("icon-size").evaluate(Ao,{})])[0]>32640&&St(Ta.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'):"composite"===_h.kind&&((nc=[128*Ou.compositeIconSizes[0].evaluate(Ao,{},_l),128*Ou.compositeIconSizes[1].evaluate(Ao,{},_l)])[0]>32640||nc[1]>32640)&&St(Ta.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'),Ta.addSymbols(Ta.icon,vh,nc,Xu,as,Ao,!1,al,rc.lineStartIndex,rc.lineLength,-1,_l),Np=Ta.icon.placedSymbolArray.length-1,Yc&&(Dp=4*Yc.length,Ta.addSymbols(Ta.icon,Yc,nc,Xu,as,Ao,qu.vertical,al,rc.lineStartIndex,rc.lineLength,-1,_l),Rp=Ta.icon.placedSymbolArray.length-1)}for(var xh in Al.horizontal){var Jc=Al.horizontal[xh];if(!xl){Mf=ne(Jc.text);var Fp=Ll.layout.get("text-rotate").evaluate(Ao,{},_l);xl=new Fh(Jh,al,Zc,Ap,Hh,Jc,mh,Dd,tc,Fp)}var $h=1===Jc.positionedLines.length;if(Op+=mp(Ta,al,Jc,vl,Ll,tc,Ao,Od,rc,Al.vertical?qu.horizontal:qu.horizontalOnly,$h?Object.keys(Al.horizontal):[xh],Ps,Np,Ou,_l),$h)break}Al.vertical&&(kp+=mp(Ta,al,Al.vertical,vl,Ll,tc,Ao,Od,rc,qu.vertical,["vertical"],Ps,Rp,Ou,_l));var Af=xl?xl.boxStartIndex:Ta.collisionBoxArray.length,Lf=xl?xl.boxEndIndex:Ta.collisionBoxArray.length,ku=Yu?Yu.boxStartIndex:Ta.collisionBoxArray.length,Nu=Yu?Yu.boxEndIndex:Ta.collisionBoxArray.length,Ru=tl?tl.boxStartIndex:Ta.collisionBoxArray.length,bl=tl?tl.boxEndIndex:Ta.collisionBoxArray.length,zp=Ju?Ju.boxStartIndex:Ta.collisionBoxArray.length,bh=Ju?Ju.boxEndIndex:Ta.collisionBoxArray.length,wl=-1,Qh=function(Hc,Of){return Hc&&Hc.circleDiameter?Math.max(Hc.circleDiameter,Of):Of};wl=Qh(xl,wl),wl=Qh(Yu,wl),wl=Qh(tl,wl);var Df=(wl=Qh(Ju,wl))>-1?1:0;Df&&(wl*=Pf/24),Ta.glyphOffsetArray.length>=Lo.MAX_GLYPHS&&St("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),void 0!==Ao.sortKey&&Ta.addToSortKeyRanges(Ta.symbolInstances.length,Ao.sortKey),Ta.symbolInstances.emplaceBack(al.x,al.y,Ps.right>=0?Ps.right:-1,Ps.center>=0?Ps.center:-1,Ps.left>=0?Ps.left:-1,Ps.vertical||-1,Np,Rp,Mf,Af,Lf,ku,Nu,Ru,bl,zp,bh,Zc,Op,kp,Lp,Dp,Df,0,mh,Kh,Tf,wl)}(vi,Ql,Xh,vo,Li,_u,Ul,vi.layers[0],vi.collisionBoxArray,Oo.index,Oo.sourceLayerIndex,vi.index,Vu,ds,xu,lu,ol,ph,Ec,ql,Oo,Fs,oo,ml,ia)};if("line"===Zu)for(var Ml=0,Vl=Pd(Oo.geometry,0,0,8192,8192);Ml<Vl.length;Ml+=1)for(var _o=Vl[Ml],Vh=0,Uc=Id(_o,wc,va,vo.vertical||yl,Li,24,Gl,vi.overscaling,8192);Vh<Uc.length;Vh+=1){var Sp=Uc[Vh];yl&&_f(vi,yl.text,Sc,Sp)||Is(_o,Sp)}else if("line-center"===Zu)for(var qc=0,Zh=Oo.geometry;qc<Zh.length;qc+=1){var Pi=Zh[qc];if(Pi.length>1){var Cp=Cd(Pi,va,vo.vertical||yl,Li,24,Gl);Cp&&Is(Pi,Cp)}}else if("Polygon"===Oo.type)for(var ju=0,fh=ip(Oo.geometry,0);ju<fh.length;ju+=1){var Gc=fh[ju],Tl=yf(Gc,16);Is(Gc[0],new ih(Tl.x,Tl.y,0))}else if("LineString"===Oo.type)for(var Vc=0,_a=Oo.geometry;Vc<_a.length;Vc+=1){var Zl=_a[Vc];Is(Zl,new ih(Zl[0].x,Zl[0].y,0))}else if("Point"===Oo.type)for(var jh=0,Ip=Oo.geometry;jh<Ip.length;jh+=1)for(var dh=0,Pp=Ip[jh];dh<Pp.length;dh+=1){var Mp=Pp[dh];Is([Mp],new ih(Mp.x,Mp.y,0))}}(t,ze,Tr,Cs,g,q,Mr,Wr,Fr,Ns,S)},Pe=0,Re=t.features;Pe<Re.length;Pe+=1)we();w&&t.generateCollisionDebugBuffers()},s.perspective=function(t,n,u,g,_){var w,S=1/Math.tan(n/2);return t[0]=S/u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=S,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=_&&_!==1/0?(t[10]=(_+g)*(w=1/(g-_)),t[14]=2*_*g*w):(t[10]=-1,t[14]=-2*g),t},s.pick=function(t,n){for(var u={},g=0;g<n.length;g++){var _=n[g];_ in t&&(u[_]=t[_])}return u},s.plugin=ui,s.polygonIntersectsPolygon=yu,s.postMapLoadEvent=en,s.postTurnstileEvent=Ge,s.potpack=sf,s.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],s.register=_r,s.registerForPluginStateChange=function(t){return t({pluginStatus:ga,pluginURL:Zo}),rs.on("pluginStateChange",t),t},s.renderColorRamp=Ri,s.rotate=function(t,n,u){var g=n[0],_=n[1],w=n[2],S=n[3],A=Math.sin(u),z=Math.cos(u);return t[0]=g*z+w*A,t[1]=_*z+S*A,t[2]=g*-A+w*z,t[3]=_*-A+S*z,t},s.rotateX=function(t,n,u){var g=Math.sin(u),_=Math.cos(u),w=n[4],S=n[5],A=n[6],z=n[7],q=n[8],V=n[9],H=n[10],st=n[11];return n!==t&&(t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15]),t[4]=w*_+q*g,t[5]=S*_+V*g,t[6]=A*_+H*g,t[7]=z*_+st*g,t[8]=q*_-w*g,t[9]=V*_-S*g,t[10]=H*_-A*g,t[11]=st*_-z*g,t},s.rotateZ=function(t,n,u){var g=Math.sin(u),_=Math.cos(u),w=n[0],S=n[1],A=n[2],z=n[3],q=n[4],V=n[5],H=n[6],st=n[7];return n!==t&&(t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15]),t[0]=w*_+q*g,t[1]=S*_+V*g,t[2]=A*_+H*g,t[3]=z*_+st*g,t[4]=q*_-w*g,t[5]=V*_-S*g,t[6]=H*_-A*g,t[7]=st*_-z*g,t},s.scale=function(t,n,u){var g=u[0],_=u[1],w=u[2];return t[0]=n[0]*g,t[1]=n[1]*g,t[2]=n[2]*g,t[3]=n[3]*g,t[4]=n[4]*_,t[5]=n[5]*_,t[6]=n[6]*_,t[7]=n[7]*_,t[8]=n[8]*w,t[9]=n[9]*w,t[10]=n[10]*w,t[11]=n[11]*w,t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],t},s.scale$1=function(t,n,u){return t[0]=n[0]*u,t[1]=n[1]*u,t[2]=n[2]*u,t[3]=n[3]*u,t},s.scale$2=function(t,n,u){return t[0]=n[0]*u,t[1]=n[1]*u,t[2]=n[2]*u,t},s.setCacheLimits=function(t,n){hr=t,gn=n},s.setRTLTextPlugin=function(t,n,u){if(void 0===u&&(u=!1),"deferred"===ga||"loading"===ga||"loaded"===ga)throw new Error("setRTLTextPlugin cannot be called multiple times.");Zo=Sr.resolveURL(t),ga="deferred",nl=n,ul(),u||Xl()},s.sphericalToCartesian=function(t){var n=t[0],u=t[1],g=t[2];return u+=90,u*=Math.PI/180,g*=Math.PI/180,{x:n*Math.cos(u)*Math.sin(g),y:n*Math.sin(u)*Math.sin(g),z:n*Math.cos(g)}},s.sqrLen=function(t){var n=t[0],u=t[1];return n*n+u*u},s.styleSpec=Dt,s.sub=function(t,n,u){return t[0]=n[0]-u[0],t[1]=n[1]-u[1],t[2]=n[2]-u[2],t},s.symbolSize=Sd,s.transformMat3=function(t,n,u){var g=n[0],_=n[1],w=n[2];return t[0]=g*u[0]+_*u[3]+w*u[6],t[1]=g*u[1]+_*u[4]+w*u[7],t[2]=g*u[2]+_*u[5]+w*u[8],t},s.transformMat4=Kc,s.translate=function(t,n,u){var g,_,w,S,A,z,q,V,H,st,vt,Rt,Vt=u[0],he=u[1],re=u[2];return n===t?(t[12]=n[0]*Vt+n[4]*he+n[8]*re+n[12],t[13]=n[1]*Vt+n[5]*he+n[9]*re+n[13],t[14]=n[2]*Vt+n[6]*he+n[10]*re+n[14],t[15]=n[3]*Vt+n[7]*he+n[11]*re+n[15]):(_=n[1],w=n[2],S=n[3],A=n[4],z=n[5],q=n[6],V=n[7],H=n[8],st=n[9],vt=n[10],Rt=n[11],t[0]=g=n[0],t[1]=_,t[2]=w,t[3]=S,t[4]=A,t[5]=z,t[6]=q,t[7]=V,t[8]=H,t[9]=st,t[10]=vt,t[11]=Rt,t[12]=g*Vt+A*he+H*re+n[12],t[13]=_*Vt+z*he+st*re+n[13],t[14]=w*Vt+q*he+vt*re+n[14],t[15]=S*Vt+V*he+Rt*re+n[15]),t},s.triggerPluginCompletionEvent=ja,s.uniqueId=K,s.validateCustomStyleLayer=function(t){var n=[],u=t.id;return void 0===u&&n.push({message:"layers."+u+': missing required property "id"'}),void 0===t.render&&n.push({message:"layers."+u+': missing required method "render"'}),t.renderingMode&&"2d"!==t.renderingMode&&"3d"!==t.renderingMode&&n.push({message:"layers."+u+': property "renderingMode" must be either "2d" or "3d"'}),n},s.validateLight=hs,s.validateStyle=ts,s.values=function(t){var n=[];for(var u in t)n.push(t[u]);return n},s.vectorTile=Lc,s.version="1.15.3",s.warnOnce=St,s.webpSupported=Ur,s.window=qt,s.wrap=ye}),Pt(0,function(s){function lt(Y){var W=typeof Y;if("number"===W||"boolean"===W||"string"===W||null==Y)return JSON.stringify(Y);if(Array.isArray(Y)){for(var ft="[",bt=0,zt=Y;bt<zt.length;bt+=1)ft+=lt(zt[bt])+",";return ft+"]"}for(var ae=Object.keys(Y).sort(),me="{",ue=0;ue<ae.length;ue++)me+=JSON.stringify(ae[ue])+":"+lt(Y[ae[ue]])+",";return me+"}"}function ht(Y){for(var W="",ft=0,bt=s.refProperties;ft<bt.length;ft+=1)W+="/"+lt(Y[bt[ft]]);return W}var Lt=function(Y){this.keyCache={},Y&&this.replace(Y)};Lt.prototype.replace=function(Y){this._layerConfigs={},this._layers={},this.update(Y,[])},Lt.prototype.update=function(Y,W){for(var ft=this,bt=0,zt=Y;bt<zt.length;bt+=1){var ae=zt[bt];this._layerConfigs[ae.id]=ae;var me=this._layers[ae.id]=s.createStyleLayer(ae);me._featureFilter=s.featureFilter(me.filter),this.keyCache[ae.id]&&delete this.keyCache[ae.id]}for(var ue=0,Dt=W;ue<Dt.length;ue+=1){var Ht=Dt[ue];delete this.keyCache[Ht],delete this._layerConfigs[Ht],delete this._layers[Ht]}this.familiesBySource={};for(var nr=0,xr=function(vr,Ke){for(var bn={},$r=0;$r<vr.length;$r++){var Lr=Ke&&Ke[vr[$r].id]||ht(vr[$r]);Ke&&(Ke[vr[$r].id]=Lr);var Mn=bn[Lr];Mn||(Mn=bn[Lr]=[]),Mn.push(vr[$r])}var Nr=[];for(var Oi in bn)Nr.push(bn[Oi]);return Nr}(s.values(this._layerConfigs),this.keyCache);nr<xr.length;nr+=1){var Me=xr[nr].map(function(vr){return ft._layers[vr.id]}),qe=Me[0];if("none"!==qe.visibility){var pr=qe.source||"",wr=this.familiesBySource[pr];wr||(wr=this.familiesBySource[pr]={});var Ar=qe.sourceLayer||"_geojsonTileLayer",Xe=wr[Ar];Xe||(Xe=wr[Ar]=[]),Xe.push(Me)}}};var Ft=function(Y){var W={},ft=[];for(var bt in Y){var zt=Y[bt],ae=W[bt]={};for(var me in zt){var ue=zt[+me];if(ue&&0!==ue.bitmap.width&&0!==ue.bitmap.height){var Dt={x:0,y:0,w:ue.bitmap.width+2,h:ue.bitmap.height+2};ft.push(Dt),ae[me]={rect:Dt,metrics:ue.metrics}}}}var Ht=s.potpack(ft),nr=new s.AlphaImage({width:Ht.w||1,height:Ht.h||1});for(var xr in Y){var Me=Y[xr];for(var qe in Me){var pr=Me[+qe];if(pr&&0!==pr.bitmap.width&&0!==pr.bitmap.height){var wr=W[xr][qe].rect;s.AlphaImage.copy(pr.bitmap,nr,{x:0,y:0},{x:wr.x+1,y:wr.y+1},pr.bitmap)}}}this.image=nr,this.positions=W};s.register("GlyphAtlas",Ft);var Qt=function(Y){this.tileID=new s.OverscaledTileID(Y.tileID.overscaledZ,Y.tileID.wrap,Y.tileID.canonical.z,Y.tileID.canonical.x,Y.tileID.canonical.y),this.uid=Y.uid,this.zoom=Y.zoom,this.pixelRatio=Y.pixelRatio,this.tileSize=Y.tileSize,this.source=Y.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=Y.showCollisionBoxes,this.collectResourceTiming=!!Y.collectResourceTiming,this.returnDependencies=!!Y.returnDependencies,this.promoteId=Y.promoteId};function qt(Y,W,ft){for(var bt=new s.EvaluationParameters(W),zt=0,ae=Y;zt<ae.length;zt+=1)ae[zt].recalculate(bt,ft)}function _e(Y,W){var ft=s.getArrayBuffer(Y.request,function(bt,zt,ae,me){bt?W(bt):zt&&W(null,{vectorTile:new s.vectorTile.VectorTile(new s.pbf(zt)),rawData:zt,cacheControl:ae,expires:me})});return function(){ft.cancel(),W()}}Qt.prototype.parse=function(Y,W,ft,bt,zt){var ae=this;this.status="parsing",this.data=Y,this.collisionBoxArray=new s.CollisionBoxArray;var me=new s.DictionaryCoder(Object.keys(Y.layers).sort()),ue=new s.FeatureIndex(this.tileID,this.promoteId);ue.bucketLayerIDs=[];var Dt,Ht,nr,xr,Me={},qe={featureIndex:ue,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:ft},pr=W.familiesBySource[this.source];for(var wr in pr){var Ar=Y.layers[wr];if(Ar){1===Ar.version&&s.warnOnce('Vector tile source "'+this.source+'" layer "'+wr+'" does not use vector tile spec v2 and therefore may have some rendering errors.');for(var Xe=me.encode(wr),vr=[],Ke=0;Ke<Ar.length;Ke++){var bn=Ar.feature(Ke),$r=ue.getId(bn,wr);vr.push({feature:bn,id:$r,index:Ke,sourceLayerIndex:Xe})}for(var Lr=0,Mn=pr[wr];Lr<Mn.length;Lr+=1){var Nr=Mn[Lr],Oi=Nr[0];Oi.minzoom&&this.zoom<Math.floor(Oi.minzoom)||Oi.maxzoom&&this.zoom>=Oi.maxzoom||"none"!==Oi.visibility&&(qt(Nr,this.zoom,ft),(Me[Oi.id]=Oi.createBucket({index:ue.bucketLayerIDs.length,layers:Nr,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Xe,sourceID:this.source})).populate(vr,qe,this.tileID.canonical),ue.bucketLayerIDs.push(Nr.map(function(ni){return ni.id})))}}}var ai=s.mapObject(qe.glyphDependencies,function(ni){return Object.keys(ni).map(Number)});Object.keys(ai).length?bt.send("getGlyphs",{uid:this.uid,stacks:ai},function(ni,Xr){Dt||(Dt=ni,Ht=Xr,co.call(ae))}):Ht={};var kn=Object.keys(qe.iconDependencies);kn.length?bt.send("getImages",{icons:kn,source:this.source,tileID:this.tileID,type:"icons"},function(ni,Xr){Dt||(Dt=ni,nr=Xr,co.call(ae))}):nr={};var Tn=Object.keys(qe.patternDependencies);function co(){if(Dt)return zt(Dt);if(Ht&&nr&&xr){var ni=new Ft(Ht),Xr=new s.ImageAtlas(nr,xr);for(var ca in Me){var Hn=Me[ca];Hn instanceof s.SymbolBucket?(qt(Hn.layers,this.zoom,ft),s.performSymbolLayout(Hn,Ht,ni.positions,nr,Xr.iconPositions,this.showCollisionBoxes,this.tileID.canonical)):Hn.hasPattern&&(Hn instanceof s.LineBucket||Hn instanceof s.FillBucket||Hn instanceof s.FillExtrusionBucket)&&(qt(Hn.layers,this.zoom,ft),Hn.addFeatures(qe,this.tileID.canonical,Xr.patternPositions))}this.status="done",zt(null,{buckets:s.values(Me).filter(function(Fa){return!Fa.isEmpty()}),featureIndex:ue,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:ni.image,imageAtlas:Xr,glyphMap:this.returnDependencies?Ht:null,iconMap:this.returnDependencies?nr:null,glyphPositions:this.returnDependencies?ni.positions:null})}}Tn.length?bt.send("getImages",{icons:Tn,source:this.source,tileID:this.tileID,type:"patterns"},function(ni,Xr){Dt||(Dt=ni,xr=Xr,co.call(ae))}):xr={},co.call(this)};var mt=function(Y,W,ft,bt){this.actor=Y,this.layerIndex=W,this.availableImages=ft,this.loadVectorData=bt||_e,this.loading={},this.loaded={}};mt.prototype.loadTile=function(Y,W){var ft=this,bt=Y.uid;this.loading||(this.loading={});var zt=!!(Y&&Y.request&&Y.request.collectResourceTiming)&&new s.RequestPerformance(Y.request),ae=this.loading[bt]=new Qt(Y);ae.abort=this.loadVectorData(Y,function(me,ue){if(delete ft.loading[bt],me||!ue)return ae.status="done",ft.loaded[bt]=ae,W(me);var Dt=ue.rawData,Ht={};ue.expires&&(Ht.expires=ue.expires),ue.cacheControl&&(Ht.cacheControl=ue.cacheControl);var nr={};if(zt){var xr=zt.finish();xr&&(nr.resourceTiming=JSON.parse(JSON.stringify(xr)))}ae.vectorTile=ue.vectorTile,ae.parse(ue.vectorTile,ft.layerIndex,ft.availableImages,ft.actor,function(Me,qe){if(Me||!qe)return W(Me);W(null,s.extend({rawTileData:Dt.slice(0)},qe,Ht,nr))}),ft.loaded=ft.loaded||{},ft.loaded[bt]=ae})},mt.prototype.reloadTile=function(Y,W){var ft=this,bt=this.loaded,zt=Y.uid,ae=this;if(bt&&bt[zt]){var me=bt[zt];me.showCollisionBoxes=Y.showCollisionBoxes;var ue=function(Dt,Ht){var nr=me.reloadCallback;nr&&(delete me.reloadCallback,me.parse(me.vectorTile,ae.layerIndex,ft.availableImages,ae.actor,nr)),W(Dt,Ht)};"parsing"===me.status?me.reloadCallback=ue:"done"===me.status&&(me.vectorTile?me.parse(me.vectorTile,this.layerIndex,this.availableImages,this.actor,ue):ue())}},mt.prototype.abortTile=function(Y,W){var ft=this.loading,bt=Y.uid;ft&&ft[bt]&&ft[bt].abort&&(ft[bt].abort(),delete ft[bt]),W()},mt.prototype.removeTile=function(Y,W){var ft=this.loaded,bt=Y.uid;ft&&ft[bt]&&delete ft[bt],W()};var xt=s.window.ImageBitmap,Jt=function(){this.loaded={}};function ye(Y,W){if(0!==Y.length){j(Y[0],W);for(var ft=1;ft<Y.length;ft++)j(Y[ft],!W)}}function j(Y,W){for(var ft=0,bt=0,zt=Y.length,ae=zt-1;bt<zt;ae=bt++)ft+=(Y[bt][0]-Y[ae][0])*(Y[ae][1]+Y[bt][1]);ft>=0!=!!W&&Y.reverse()}Jt.prototype.loadTile=function(Y,W){var ft=Y.uid,bt=Y.encoding,zt=Y.rawImageData,ae=xt&&zt instanceof xt?this.getImageData(zt):zt,me=new s.DEMData(ft,ae,bt);this.loaded=this.loaded||{},this.loaded[ft]=me,W(null,me)},Jt.prototype.getImageData=function(Y){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(Y.width,Y.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=Y.width,this.offscreenCanvas.height=Y.height,this.offscreenCanvasContext.drawImage(Y,0,0,Y.width,Y.height);var W=this.offscreenCanvasContext.getImageData(-1,-1,Y.width+2,Y.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new s.RGBAImage({width:W.width,height:W.height},W.data)},Jt.prototype.removeTile=function(Y){var W=this.loaded,ft=Y.uid;W&&W[ft]&&delete W[ft]};var it=s.vectorTile.VectorTileFeature.prototype.toGeoJSON,K=function(Y){this._feature=Y,this.extent=s.EXTENT,this.type=Y.type,this.properties=Y.tags,"id"in Y&&!isNaN(Y.id)&&(this.id=parseInt(Y.id,10))};K.prototype.loadGeometry=function(){if(1===this._feature.type){for(var Y=[],W=0,ft=this._feature.geometry;W<ft.length;W+=1){var bt=ft[W];Y.push([new s.Point$1(bt[0],bt[1])])}return Y}for(var zt=[],ae=0,me=this._feature.geometry;ae<me.length;ae+=1){for(var ue=[],Dt=0,Ht=me[ae];Dt<Ht.length;Dt+=1){var nr=Ht[Dt];ue.push(new s.Point$1(nr[0],nr[1]))}zt.push(ue)}return zt},K.prototype.toGeoJSON=function(Y,W,ft){return it.call(this,Y,W,ft)};var tt=function(Y){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=s.EXTENT,this.length=Y.length,this._features=Y};tt.prototype.feature=function(Y){return new K(this._features[Y])};var X=s.vectorTile.VectorTileFeature,nt=J;function J(Y,W){this.options=W||{},this.features=Y,this.length=Y.length}function et(Y,W){this.id="number"==typeof Y.id?Y.id:void 0,this.type=Y.type,this.rawGeometry=1===Y.type?[Y.geometry]:Y.geometry,this.properties=Y.tags,this.extent=W||4096}J.prototype.feature=function(Y){return new et(this.features[Y],this.options.extent)},et.prototype.loadGeometry=function(){var Y=this.rawGeometry;this.geometry=[];for(var W=0;W<Y.length;W++){for(var ft=Y[W],bt=[],zt=0;zt<ft.length;zt++)bt.push(new s.Point$1(ft[zt][0],ft[zt][1]));this.geometry.push(bt)}return this.geometry},et.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var Y=this.geometry,W=1/0,ft=-1/0,bt=1/0,zt=-1/0,ae=0;ae<Y.length;ae++)for(var me=Y[ae],ue=0;ue<me.length;ue++){var Dt=me[ue];W=Math.min(W,Dt.x),ft=Math.max(ft,Dt.x),bt=Math.min(bt,Dt.y),zt=Math.max(zt,Dt.y)}return[W,bt,ft,zt]},et.prototype.toGeoJSON=X.prototype.toGeoJSON;var at=Wt,Z=nt;function Wt(Y){var W=new s.pbf;return function(ft,bt){for(var zt in ft.layers)bt.writeMessage(3,St,ft.layers[zt])}(Y,W),W.finish()}function St(Y,W){var ft;W.writeVarintField(15,Y.version||1),W.writeStringField(1,Y.name||""),W.writeVarintField(5,Y.extent||4096);var bt={keys:[],values:[],keycache:{},valuecache:{}};for(ft=0;ft<Y.length;ft++)bt.feature=Y.feature(ft),W.writeMessage(2,kt,bt);var zt=bt.keys;for(ft=0;ft<zt.length;ft++)W.writeStringField(3,zt[ft]);var ae=bt.values;for(ft=0;ft<ae.length;ft++)W.writeMessage(4,pe,ae[ft])}function kt(Y,W){var ft=Y.feature;void 0!==ft.id&&W.writeVarintField(1,ft.id),W.writeMessage(2,dt,Y),W.writeVarintField(3,ft.type),W.writeMessage(4,Mt,ft)}function dt(Y,W){var ft=Y.feature,bt=Y.keys,zt=Y.values,ae=Y.keycache,me=Y.valuecache;for(var ue in ft.properties){var Dt=ae[ue];void 0===Dt&&(bt.push(ue),ae[ue]=Dt=bt.length-1),W.writeVarint(Dt);var Ht=ft.properties[ue],nr=typeof Ht;"string"!==nr&&"boolean"!==nr&&"number"!==nr&&(Ht=JSON.stringify(Ht));var xr=nr+":"+Ht,Me=me[xr];void 0===Me&&(zt.push(Ht),me[xr]=Me=zt.length-1),W.writeVarint(Me)}}function je(Y,W){return(W<<3)+(7&Y)}function Ce(Y){return Y<<1^Y>>31}function Mt(Y,W){for(var ft=Y.loadGeometry(),bt=Y.type,zt=0,ae=0,me=ft.length,ue=0;ue<me;ue++){var Dt=ft[ue],Ht=1;1===bt&&(Ht=Dt.length),W.writeVarint(je(1,Ht));for(var nr=3===bt?Dt.length-1:Dt.length,xr=0;xr<nr;xr++){1===xr&&1!==bt&&W.writeVarint(je(2,nr-1));var Me=Dt[xr].x-zt,qe=Dt[xr].y-ae;W.writeVarint(Ce(Me)),W.writeVarint(Ce(qe)),zt+=Me,ae+=qe}3===bt&&W.writeVarint(je(7,1))}}function pe(Y,W){var ft=typeof Y;"string"===ft?W.writeStringField(1,Y):"boolean"===ft?W.writeBooleanField(7,Y):"number"===ft&&(Y%1!=0?W.writeDoubleField(3,Y):Y<0?W.writeSVarintField(6,Y):W.writeVarintField(5,Y))}function At(Y,W,ft,bt){$t(Y,ft,bt),$t(W,2*ft,2*bt),$t(W,2*ft+1,2*bt+1)}function $t(Y,W,ft){var bt=Y[W];Y[W]=Y[ft],Y[ft]=bt}function fe(Y,W,ft,bt){var zt=Y-ft,ae=W-bt;return zt*zt+ae*ae}at.fromVectorTileJs=Wt,at.fromGeojsonVt=function(Y,W){W=W||{};var ft={};for(var bt in Y)ft[bt]=new nt(Y[bt].features,W),ft[bt].name=bt,ft[bt].version=W.version,ft[bt].extent=W.extent;return Wt({layers:ft})},at.GeoJSONWrapper=Z;var Ot=function(Y){return Y[0]},Be=function(Y){return Y[1]},De=function(Y,W,ft,bt,zt){void 0===W&&(W=Ot),void 0===ft&&(ft=Be),void 0===bt&&(bt=64),void 0===zt&&(zt=Float64Array),this.nodeSize=bt,this.points=Y;for(var ae=Y.length<65536?Uint16Array:Uint32Array,me=this.ids=new ae(Y.length),ue=this.coords=new zt(2*Y.length),Dt=0;Dt<Y.length;Dt++)me[Dt]=Dt,ue[2*Dt]=W(Y[Dt]),ue[2*Dt+1]=ft(Y[Dt]);!function Ht(nr,xr,Me,qe,pr,wr){if(!(pr-qe<=Me)){var Ar=qe+pr>>1;(function Xe(vr,Ke,bn,$r,Lr,Mn){for(;Lr>$r;){if(Lr-$r>600){var Nr=Lr-$r+1,Oi=bn-$r+1,ai=Math.log(Nr),kn=.5*Math.exp(2*ai/3),Tn=.5*Math.sqrt(ai*kn*(Nr-kn)/Nr)*(Oi-Nr/2<0?-1:1);Xe(vr,Ke,bn,Math.max($r,Math.floor(bn-Oi*kn/Nr+Tn)),Math.min(Lr,Math.floor(bn+(Nr-Oi)*kn/Nr+Tn)),Mn)}var co=Ke[2*bn+Mn],ni=$r,Xr=Lr;for(At(vr,Ke,$r,bn),Ke[2*Lr+Mn]>co&&At(vr,Ke,$r,Lr);ni<Xr;){for(At(vr,Ke,ni,Xr),ni++,Xr--;Ke[2*ni+Mn]<co;)ni++;for(;Ke[2*Xr+Mn]>co;)Xr--}Ke[2*$r+Mn]===co?At(vr,Ke,$r,Xr):At(vr,Ke,++Xr,Lr),Xr<=bn&&($r=Xr+1),bn<=Xr&&(Lr=Xr-1)}})(nr,xr,Ar,qe,pr,wr%2),Ht(nr,xr,Me,qe,Ar-1,wr+1),Ht(nr,xr,Me,Ar+1,pr,wr+1)}}(me,ue,bt,0,me.length-1,0)};De.prototype.range=function(Y,W,ft,bt){return function(zt,ae,me,ue,Dt,Ht,nr){for(var xr,Me,qe=[0,zt.length-1,0],pr=[];qe.length;){var wr=qe.pop(),Ar=qe.pop(),Xe=qe.pop();if(Ar-Xe<=nr)for(var vr=Xe;vr<=Ar;vr++)Me=ae[2*vr+1],(xr=ae[2*vr])>=me&&xr<=Dt&&Me>=ue&&Me<=Ht&&pr.push(zt[vr]);else{var Ke=Math.floor((Xe+Ar)/2);Me=ae[2*Ke+1],(xr=ae[2*Ke])>=me&&xr<=Dt&&Me>=ue&&Me<=Ht&&pr.push(zt[Ke]);var bn=(wr+1)%2;(0===wr?me<=xr:ue<=Me)&&(qe.push(Xe),qe.push(Ke-1),qe.push(bn)),(0===wr?Dt>=xr:Ht>=Me)&&(qe.push(Ke+1),qe.push(Ar),qe.push(bn))}}return pr}(this.ids,this.coords,Y,W,ft,bt,this.nodeSize)},De.prototype.within=function(Y,W,ft){return function(bt,zt,ae,me,ue,Dt){for(var Ht=[0,bt.length-1,0],nr=[],xr=ue*ue;Ht.length;){var Me=Ht.pop(),qe=Ht.pop(),pr=Ht.pop();if(qe-pr<=Dt)for(var wr=pr;wr<=qe;wr++)fe(zt[2*wr],zt[2*wr+1],ae,me)<=xr&&nr.push(bt[wr]);else{var Ar=Math.floor((pr+qe)/2),Xe=zt[2*Ar],vr=zt[2*Ar+1];fe(Xe,vr,ae,me)<=xr&&nr.push(bt[Ar]);var Ke=(Me+1)%2;(0===Me?ae-ue<=Xe:me-ue<=vr)&&(Ht.push(pr),Ht.push(Ar-1),Ht.push(Ke)),(0===Me?ae+ue>=Xe:me+ue>=vr)&&(Ht.push(Ar+1),Ht.push(qe),Ht.push(Ke))}}return nr}(this.ids,this.coords,Y,W,ft,this.nodeSize)};var sr={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(Y){return Y}},Ie=function(Y){this.options=ei(Object.create(sr),Y),this.trees=new Array(this.options.maxZoom+1)};function Sr(Y,W,ft,bt,zt){return{x:Y,y:W,zoom:1/0,id:ft,parentId:-1,numPoints:bt,properties:zt}}function mr(Y,W){var ft=Y.geometry.coordinates,bt=ft[1];return{x:Er(ft[0]),y:He(bt),zoom:1/0,index:W,parentId:-1}}function Ur(Y){return{type:"Feature",id:Y.id,properties:jr(Y),geometry:{type:"Point",coordinates:[(bt=Y.x,360*(bt-.5)),(W=Y.y,ft=(180-360*W)*Math.PI/180,360*Math.atan(Math.exp(ft))/Math.PI-90)]}};var W,ft,bt}function jr(Y){var W=Y.numPoints,ft=W>=1e4?Math.round(W/1e3)+"k":W>=1e3?Math.round(W/100)/10+"k":W;return ei(ei({},Y.properties),{cluster:!0,cluster_id:Y.id,point_count:W,point_count_abbreviated:ft})}function Er(Y){return Y/360+.5}function He(Y){var W=Math.sin(Y*Math.PI/180),ft=.5-.25*Math.log((1+W)/(1-W))/Math.PI;return ft<0?0:ft>1?1:ft}function ei(Y,W){for(var ft in W)Y[ft]=W[ft];return Y}function _n(Y){return Y.x}function zn(Y){return Y.y}function se(Y,W,ft,bt,zt,ae){var me=zt-ft,ue=ae-bt;if(0!==me||0!==ue){var Dt=((Y-ft)*me+(W-bt)*ue)/(me*me+ue*ue);Dt>1?(ft=zt,bt=ae):Dt>0&&(ft+=me*Dt,bt+=ue*Dt)}return(me=Y-ft)*me+(ue=W-bt)*ue}function Ze(Y,W,ft,bt){var zt={id:void 0===Y?null:Y,type:W,geometry:ft,tags:bt,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(ae){var me=ae.geometry,ue=ae.type;if("Point"===ue||"MultiPoint"===ue||"LineString"===ue)Kt(ae,me);else if("Polygon"===ue||"MultiLineString"===ue)for(var Dt=0;Dt<me.length;Dt++)Kt(ae,me[Dt]);else if("MultiPolygon"===ue)for(Dt=0;Dt<me.length;Dt++)for(var Ht=0;Ht<me[Dt].length;Ht++)Kt(ae,me[Dt][Ht])}(zt),zt}function Kt(Y,W){for(var ft=0;ft<W.length;ft+=3)Y.minX=Math.min(Y.minX,W[ft]),Y.minY=Math.min(Y.minY,W[ft+1]),Y.maxX=Math.max(Y.maxX,W[ft]),Y.maxY=Math.max(Y.maxY,W[ft+1])}function ut(Y,W,ft,bt){if(W.geometry){var zt=W.geometry.coordinates,ae=W.geometry.type,me=Math.pow(ft.tolerance/((1<<ft.maxZoom)*ft.extent),2),ue=[],Dt=W.id;if(ft.promoteId?Dt=W.properties[ft.promoteId]:ft.generateId&&(Dt=bt||0),"Point"===ae)rt(zt,ue);else if("MultiPoint"===ae)for(var Ht=0;Ht<zt.length;Ht++)rt(zt[Ht],ue);else if("LineString"===ae)ot(zt,ue,me,!1);else if("MultiLineString"===ae){if(ft.lineMetrics){for(Ht=0;Ht<zt.length;Ht++)ot(zt[Ht],ue=[],me,!1),Y.push(Ze(Dt,"LineString",ue,W.properties));return}Nt(zt,ue,me,!1)}else if("Polygon"===ae)Nt(zt,ue,me,!0);else{if("MultiPolygon"!==ae){if("GeometryCollection"===ae){for(Ht=0;Ht<W.geometry.geometries.length;Ht++)ut(Y,{id:Dt,geometry:W.geometry.geometries[Ht],properties:W.properties},ft,bt);return}throw new Error("Input data is not a valid GeoJSON object.")}for(Ht=0;Ht<zt.length;Ht++){var nr=[];Nt(zt[Ht],nr,me,!0),ue.push(nr)}}Y.push(Ze(Dt,ae,ue,W.properties))}}function rt(Y,W){W.push(le(Y[0])),W.push(Oe(Y[1])),W.push(0)}function ot(Y,W,ft,bt){for(var zt,ae,me=0,ue=0;ue<Y.length;ue++){var Dt=le(Y[ue][0]),Ht=Oe(Y[ue][1]);W.push(Dt),W.push(Ht),W.push(0),ue>0&&(me+=bt?(zt*Ht-Dt*ae)/2:Math.sqrt(Math.pow(Dt-zt,2)+Math.pow(Ht-ae,2))),zt=Dt,ae=Ht}var nr=W.length-3;W[2]=1,function xr(Me,qe,pr,wr){for(var Ar,Xe=wr,vr=pr-qe>>1,Ke=pr-qe,bn=Me[qe],$r=Me[qe+1],Lr=Me[pr],Mn=Me[pr+1],Nr=qe+3;Nr<pr;Nr+=3){var Oi=se(Me[Nr],Me[Nr+1],bn,$r,Lr,Mn);if(Oi>Xe)Ar=Nr,Xe=Oi;else if(Oi===Xe){var ai=Math.abs(Nr-vr);ai<Ke&&(Ar=Nr,Ke=ai)}}Xe>wr&&(Ar-qe>3&&xr(Me,qe,Ar,wr),Me[Ar+2]=Xe,pr-Ar>3&&xr(Me,Ar,pr,wr))}(W,0,nr,ft),W[nr+2]=1,W.size=Math.abs(me),W.start=0,W.end=W.size}function Nt(Y,W,ft,bt){for(var zt=0;zt<Y.length;zt++){var ae=[];ot(Y[zt],ae,ft,bt),W.push(ae)}}function le(Y){return Y/360+.5}function Oe(Y){var W=Math.sin(Y*Math.PI/180),ft=.5-.25*Math.log((1+W)/(1-W))/Math.PI;return ft<0?0:ft>1?1:ft}function Qe(Y,W,ft,bt,zt,ae,me,ue){if(bt/=W,ae>=(ft/=W)&&me<bt)return Y;if(me<ft||ae>=bt)return null;for(var Dt=[],Ht=0;Ht<Y.length;Ht++){var nr=Y[Ht],xr=nr.geometry,Me=nr.type,qe=0===zt?nr.minX:nr.minY,pr=0===zt?nr.maxX:nr.maxY;if(qe>=ft&&pr<bt)Dt.push(nr);else if(!(pr<ft||qe>=bt)){var wr=[];if("Point"===Me||"MultiPoint"===Me)ir(xr,wr,ft,bt,zt);else if("LineString"===Me)Ge(xr,wr,ft,bt,zt,!1,ue.lineMetrics);else if("MultiLineString"===Me)en(xr,wr,ft,bt,zt,!1);else if("Polygon"===Me)en(xr,wr,ft,bt,zt,!0);else if("MultiPolygon"===Me)for(var Ar=0;Ar<xr.length;Ar++){var Xe=[];en(xr[Ar],Xe,ft,bt,zt,!0),Xe.length&&wr.push(Xe)}if(wr.length){if(ue.lineMetrics&&"LineString"===Me){for(Ar=0;Ar<wr.length;Ar++)Dt.push(Ze(nr.id,Me,wr[Ar],nr.tags));continue}"LineString"!==Me&&"MultiLineString"!==Me||(1===wr.length?(Me="LineString",wr=wr[0]):Me="MultiLineString"),"Point"!==Me&&"MultiPoint"!==Me||(Me=3===wr.length?"Point":"MultiPoint"),Dt.push(Ze(nr.id,Me,wr,nr.tags))}}}return Dt.length?Dt:null}function ir(Y,W,ft,bt,zt){for(var ae=0;ae<Y.length;ae+=3){var me=Y[ae+zt];me>=ft&&me<=bt&&(W.push(Y[ae]),W.push(Y[ae+1]),W.push(Y[ae+2]))}}function Ge(Y,W,ft,bt,zt,ae,me){for(var ue,Dt,Ht=fn(Y),nr=0===zt?gn:Yn,xr=Y.start,Me=0;Me<Y.length-3;Me+=3){var qe=Y[Me],pr=Y[Me+1],wr=Y[Me+2],Ar=Y[Me+3],Xe=Y[Me+4],vr=0===zt?qe:pr,Ke=0===zt?Ar:Xe,bn=!1;me&&(ue=Math.sqrt(Math.pow(qe-Ar,2)+Math.pow(pr-Xe,2))),vr<ft?Ke>ft&&(Dt=nr(Ht,qe,pr,Ar,Xe,ft),me&&(Ht.start=xr+ue*Dt)):vr>bt?Ke<bt&&(Dt=nr(Ht,qe,pr,Ar,Xe,bt),me&&(Ht.start=xr+ue*Dt)):hr(Ht,qe,pr,wr),Ke<ft&&vr>=ft&&(Dt=nr(Ht,qe,pr,Ar,Xe,ft),bn=!0),Ke>bt&&vr<=bt&&(Dt=nr(Ht,qe,pr,Ar,Xe,bt),bn=!0),!ae&&bn&&(me&&(Ht.end=xr+ue*Dt),W.push(Ht),Ht=fn(Y)),me&&(xr+=ue)}var $r=Y.length-3;qe=Y[$r],pr=Y[$r+1],wr=Y[$r+2],(vr=0===zt?qe:pr)>=ft&&vr<=bt&&hr(Ht,qe,pr,wr),$r=Ht.length-3,ae&&$r>=3&&(Ht[$r]!==Ht[0]||Ht[$r+1]!==Ht[1])&&hr(Ht,Ht[0],Ht[1],Ht[2]),Ht.length&&W.push(Ht)}function fn(Y){var W=[];return W.size=Y.size,W.start=Y.start,W.end=Y.end,W}function en(Y,W,ft,bt,zt,ae){for(var me=0;me<Y.length;me++)Ge(Y[me],W,ft,bt,zt,ae,!1)}function hr(Y,W,ft,bt){Y.push(W),Y.push(ft),Y.push(bt)}function gn(Y,W,ft,bt,zt,ae){var me=(ae-W)/(bt-W);return Y.push(ae),Y.push(ft+(zt-ft)*me),Y.push(1),me}function Yn(Y,W,ft,bt,zt,ae){var me=(ae-ft)/(zt-ft);return Y.push(W+(bt-W)*me),Y.push(ae),Y.push(1),me}function Jn(Y,W){for(var ft=[],bt=0;bt<Y.length;bt++){var zt,ae=Y[bt],me=ae.type;if("Point"===me||"MultiPoint"===me||"LineString"===me)zt=Sn(ae.geometry,W);else if("MultiLineString"===me||"Polygon"===me){zt=[];for(var ue=0;ue<ae.geometry.length;ue++)zt.push(Sn(ae.geometry[ue],W))}else if("MultiPolygon"===me)for(zt=[],ue=0;ue<ae.geometry.length;ue++){for(var Dt=[],Ht=0;Ht<ae.geometry[ue].length;Ht++)Dt.push(Sn(ae.geometry[ue][Ht],W));zt.push(Dt)}ft.push(Ze(ae.id,me,zt,ae.tags))}return ft}function Sn(Y,W){var ft=[];ft.size=Y.size,void 0!==Y.start&&(ft.start=Y.start,ft.end=Y.end);for(var bt=0;bt<Y.length;bt+=3)ft.push(Y[bt]+W,Y[bt+1],Y[bt+2]);return ft}function ri(Y,W){if(Y.transformed)return Y;var ft,bt,zt,ae=1<<Y.z,me=Y.x,ue=Y.y;for(ft=0;ft<Y.features.length;ft++){var Dt=Y.features[ft],Ht=Dt.geometry,nr=Dt.type;if(Dt.geometry=[],1===nr)for(bt=0;bt<Ht.length;bt+=2)Dt.geometry.push(Br(Ht[bt],Ht[bt+1],W,ae,me,ue));else for(bt=0;bt<Ht.length;bt++){var xr=[];for(zt=0;zt<Ht[bt].length;zt+=2)xr.push(Br(Ht[bt][zt],Ht[bt][zt+1],W,ae,me,ue));Dt.geometry.push(xr)}}return Y.transformed=!0,Y}function Br(Y,W,ft,bt,zt,ae){return[Math.round(ft*(Y*bt-zt)),Math.round(ft*(W*bt-ae))]}function Xo(Y,W,ft,bt,zt){for(var ae=W===zt.maxZoom?0:zt.tolerance/((1<<W)*zt.extent),me={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:ft,y:bt,z:W,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},ue=0;ue<Y.length;ue++){me.numFeatures++,zo(me,Y[ue],ae,zt);var Dt=Y[ue].minX,Ht=Y[ue].minY,nr=Y[ue].maxX,xr=Y[ue].maxY;Dt<me.minX&&(me.minX=Dt),Ht<me.minY&&(me.minY=Ht),nr>me.maxX&&(me.maxX=nr),xr>me.maxY&&(me.maxY=xr)}return me}function zo(Y,W,ft,bt){var zt=W.geometry,ae=W.type,me=[];if("Point"===ae||"MultiPoint"===ae)for(var ue=0;ue<zt.length;ue+=3)me.push(zt[ue]),me.push(zt[ue+1]),Y.numPoints++,Y.numSimplified++;else if("LineString"===ae)Yo(me,zt,Y,ft,!1,!1);else if("MultiLineString"===ae||"Polygon"===ae)for(ue=0;ue<zt.length;ue++)Yo(me,zt[ue],Y,ft,"Polygon"===ae,0===ue);else if("MultiPolygon"===ae)for(var Dt=0;Dt<zt.length;Dt++){var Ht=zt[Dt];for(ue=0;ue<Ht.length;ue++)Yo(me,Ht[ue],Y,ft,!0,0===ue)}if(me.length){var nr=W.tags||null;if("LineString"===ae&&bt.lineMetrics){for(var xr in nr={},W.tags)nr[xr]=W.tags[xr];nr.mapbox_clip_start=zt.start/zt.size,nr.mapbox_clip_end=zt.end/zt.size}var Me={geometry:me,type:"Polygon"===ae||"MultiPolygon"===ae?3:"LineString"===ae||"MultiLineString"===ae?2:1,tags:nr};null!==W.id&&(Me.id=W.id),Y.features.push(Me)}}function Yo(Y,W,ft,bt,zt,ae){var me=bt*bt;if(bt>0&&W.size<(zt?me:bt))ft.numPoints+=W.length/3;else{for(var ue=[],Dt=0;Dt<W.length;Dt+=3)(0===bt||W[Dt+2]>me)&&(ft.numSimplified++,ue.push(W[Dt]),ue.push(W[Dt+1])),ft.numPoints++;zt&&function(Ht,nr){for(var xr=0,Me=0,qe=Ht.length,pr=qe-2;Me<qe;pr=Me,Me+=2)xr+=(Ht[Me]-Ht[pr])*(Ht[Me+1]+Ht[pr+1]);if(xr>0===nr)for(Me=0,qe=Ht.length;Me<qe/2;Me+=2){var wr=Ht[Me],Ar=Ht[Me+1];Ht[Me]=Ht[qe-2-Me],Ht[Me+1]=Ht[qe-1-Me],Ht[qe-2-Me]=wr,Ht[qe-1-Me]=Ar}}(ue,ae),Y.push(ue)}}function Gn(Y,W){var ft=(W=this.options=function(zt,ae){for(var me in ae)zt[me]=ae[me];return zt}(Object.create(this.options),W)).debug;if(ft&&console.time("preprocess data"),W.maxZoom<0||W.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(W.promoteId&&W.generateId)throw new Error("promoteId and generateId cannot be used together.");var zt,ae,me,ue,Dt,Ht,bt=function(zt,ae){var me=[];if("FeatureCollection"===zt.type)for(var ue=0;ue<zt.features.length;ue++)ut(me,zt.features[ue],ae,ue);else ut(me,"Feature"===zt.type?zt:{geometry:zt},ae);return me}(Y,W);this.tiles={},this.tileCoords=[],ft&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",W.indexMaxZoom,W.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(zt=bt,ae=W,me=ae.buffer/ae.extent,ue=zt,Dt=Qe(zt,1,-1-me,me,0,-1,2,ae),Ht=Qe(zt,1,1-me,2+me,0,-1,2,ae),(Dt||Ht)&&(ue=Qe(zt,1,-me,1+me,0,-1,2,ae)||[],Dt&&(ue=Jn(Dt,1).concat(ue)),Ht&&(ue=ue.concat(Jn(Ht,-1)))),bt=ue).length&&this.splitTile(bt,0,0,0),ft&&(bt.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function xa(Y,W,ft){return 32*((1<<Y)*ft+W)+Y}function xn(Y,W){var ft=Y.tileID.canonical;if(!this._geoJSONIndex)return W(null,null);var bt=this._geoJSONIndex.getTile(ft.z,ft.x,ft.y);if(!bt)return W(null,null);var zt=new tt(bt.features),ae=at(zt);0===ae.byteOffset&&ae.byteLength===ae.buffer.byteLength||(ae=new Uint8Array(ae)),W(null,{vectorTile:zt,rawData:ae.buffer})}Ie.prototype.load=function(Y){var W=this.options,ft=W.log,bt=W.minZoom,zt=W.maxZoom,ae=W.nodeSize;ft&&console.time("total time");var me="prepare "+Y.length+" points";ft&&console.time(me),this.points=Y;for(var ue=[],Dt=0;Dt<Y.length;Dt++)Y[Dt].geometry&&ue.push(mr(Y[Dt],Dt));this.trees[zt+1]=new De(ue,_n,zn,ae,Float32Array),ft&&console.timeEnd(me);for(var Ht=zt;Ht>=bt;Ht--){var nr=+Date.now();ue=this._cluster(ue,Ht),this.trees[Ht]=new De(ue,_n,zn,ae,Float32Array),ft&&console.log("z%d: %d clusters in %dms",Ht,ue.length,+Date.now()-nr)}return ft&&console.timeEnd("total time"),this},Ie.prototype.getClusters=function(Y,W){var ft=((Y[0]+180)%360+360)%360-180,bt=Math.max(-90,Math.min(90,Y[1])),zt=180===Y[2]?180:((Y[2]+180)%360+360)%360-180,ae=Math.max(-90,Math.min(90,Y[3]));if(Y[2]-Y[0]>=360)ft=-180,zt=180;else if(ft>zt){var me=this.getClusters([ft,bt,180,ae],W),ue=this.getClusters([-180,bt,zt,ae],W);return me.concat(ue)}for(var Dt=this.trees[this._limitZoom(W)],Ht=[],nr=0,xr=Dt.range(Er(ft),He(ae),Er(zt),He(bt));nr<xr.length;nr+=1){var Me=Dt.points[xr[nr]];Ht.push(Me.numPoints?Ur(Me):this.points[Me.index])}return Ht},Ie.prototype.getChildren=function(Y){var W=this._getOriginId(Y),ft=this._getOriginZoom(Y),bt="No cluster with the specified id.",zt=this.trees[ft];if(!zt)throw new Error(bt);var ae=zt.points[W];if(!ae)throw new Error(bt);for(var me=this.options.radius/(this.options.extent*Math.pow(2,ft-1)),ue=[],Dt=0,Ht=zt.within(ae.x,ae.y,me);Dt<Ht.length;Dt+=1){var nr=zt.points[Ht[Dt]];nr.parentId===Y&&ue.push(nr.numPoints?Ur(nr):this.points[nr.index])}if(0===ue.length)throw new Error(bt);return ue},Ie.prototype.getLeaves=function(Y,W,ft){var bt=[];return this._appendLeaves(bt,Y,W=W||10,ft=ft||0,0),bt},Ie.prototype.getTile=function(Y,W,ft){var bt=this.trees[this._limitZoom(Y)],zt=Math.pow(2,Y),ae=this.options,me=ae.radius/ae.extent,ue=(ft-me)/zt,Dt=(ft+1+me)/zt,Ht={features:[]};return this._addTileFeatures(bt.range((W-me)/zt,ue,(W+1+me)/zt,Dt),bt.points,W,ft,zt,Ht),0===W&&this._addTileFeatures(bt.range(1-me/zt,ue,1,Dt),bt.points,zt,ft,zt,Ht),W===zt-1&&this._addTileFeatures(bt.range(0,ue,me/zt,Dt),bt.points,-1,ft,zt,Ht),Ht.features.length?Ht:null},Ie.prototype.getClusterExpansionZoom=function(Y){for(var W=this._getOriginZoom(Y)-1;W<=this.options.maxZoom;){var ft=this.getChildren(Y);if(W++,1!==ft.length)break;Y=ft[0].properties.cluster_id}return W},Ie.prototype._appendLeaves=function(Y,W,ft,bt,zt){for(var ae=0,me=this.getChildren(W);ae<me.length;ae+=1){var ue=me[ae],Dt=ue.properties;if(Dt&&Dt.cluster?zt+Dt.point_count<=bt?zt+=Dt.point_count:zt=this._appendLeaves(Y,Dt.cluster_id,ft,bt,zt):zt<bt?zt++:Y.push(ue),Y.length===ft)break}return zt},Ie.prototype._addTileFeatures=function(Y,W,ft,bt,zt,ae){for(var me=0,ue=Y;me<ue.length;me+=1){var Dt=W[ue[me]],Ht=Dt.numPoints,nr={type:1,geometry:[[Math.round(this.options.extent*(Dt.x*zt-ft)),Math.round(this.options.extent*(Dt.y*zt-bt))]],tags:Ht?jr(Dt):this.points[Dt.index].properties},xr=void 0;Ht?xr=Dt.id:this.options.generateId?xr=Dt.index:this.points[Dt.index].id&&(xr=this.points[Dt.index].id),void 0!==xr&&(nr.id=xr),ae.features.push(nr)}},Ie.prototype._limitZoom=function(Y){return Math.max(this.options.minZoom,Math.min(+Y,this.options.maxZoom+1))},Ie.prototype._cluster=function(Y,W){for(var ft=[],bt=this.options,zt=bt.reduce,ae=bt.minPoints,me=bt.radius/(bt.extent*Math.pow(2,W)),ue=0;ue<Y.length;ue++){var Dt=Y[ue];if(!(Dt.zoom<=W)){Dt.zoom=W;for(var Ht=this.trees[W+1],nr=Ht.within(Dt.x,Dt.y,me),xr=Dt.numPoints||1,Me=xr,qe=0,pr=nr;qe<pr.length;qe+=1){var wr=Ht.points[pr[qe]];wr.zoom>W&&(Me+=wr.numPoints||1)}if(Me>=ae){for(var Ar=Dt.x*xr,Xe=Dt.y*xr,vr=zt&&xr>1?this._map(Dt,!0):null,Ke=(ue<<5)+(W+1)+this.points.length,bn=0,$r=nr;bn<$r.length;bn+=1){var Lr=Ht.points[$r[bn]];if(!(Lr.zoom<=W)){Lr.zoom=W;var Mn=Lr.numPoints||1;Ar+=Lr.x*Mn,Xe+=Lr.y*Mn,Lr.parentId=Ke,zt&&(vr||(vr=this._map(Dt,!0)),zt(vr,this._map(Lr)))}}Dt.parentId=Ke,ft.push(Sr(Ar/Me,Xe/Me,Ke,Me,vr))}else if(ft.push(Dt),Me>1)for(var Nr=0,Oi=nr;Nr<Oi.length;Nr+=1){var ai=Ht.points[Oi[Nr]];ai.zoom<=W||(ai.zoom=W,ft.push(ai))}}}return ft},Ie.prototype._getOriginId=function(Y){return Y-this.points.length>>5},Ie.prototype._getOriginZoom=function(Y){return(Y-this.points.length)%32},Ie.prototype._map=function(Y,W){if(Y.numPoints)return W?ei({},Y.properties):Y.properties;var ft=this.points[Y.index].properties,bt=this.options.map(ft);return W&&bt===ft?ei({},bt):bt},Gn.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Gn.prototype.splitTile=function(Y,W,ft,bt,zt,ae,me){for(var ue=[Y,W,ft,bt],Dt=this.options,Ht=Dt.debug;ue.length;){bt=ue.pop(),ft=ue.pop(),W=ue.pop(),Y=ue.pop();var nr=1<<W,xr=xa(W,ft,bt),Me=this.tiles[xr];if(!Me&&(Ht>1&&console.time("creation"),Me=this.tiles[xr]=Xo(Y,W,ft,bt,Dt),this.tileCoords.push({z:W,x:ft,y:bt}),Ht)){Ht>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",W,ft,bt,Me.numFeatures,Me.numPoints,Me.numSimplified),console.timeEnd("creation"));var qe="z"+W;this.stats[qe]=(this.stats[qe]||0)+1,this.total++}if(Me.source=Y,zt){if(W===Dt.maxZoom||W===zt)continue;var pr=1<<zt-W;if(ft!==Math.floor(ae/pr)||bt!==Math.floor(me/pr))continue}else if(W===Dt.indexMaxZoom||Me.numPoints<=Dt.indexMaxPoints)continue;if(Me.source=null,0!==Y.length){Ht>1&&console.time("clipping");var wr,Ar,Xe,vr,Ke,bn,$r=.5*Dt.buffer/Dt.extent,Lr=.5-$r,Mn=.5+$r,Nr=1+$r;wr=Ar=Xe=vr=null,Ke=Qe(Y,nr,ft-$r,ft+Mn,0,Me.minX,Me.maxX,Dt),bn=Qe(Y,nr,ft+Lr,ft+Nr,0,Me.minX,Me.maxX,Dt),Y=null,Ke&&(wr=Qe(Ke,nr,bt-$r,bt+Mn,1,Me.minY,Me.maxY,Dt),Ar=Qe(Ke,nr,bt+Lr,bt+Nr,1,Me.minY,Me.maxY,Dt),Ke=null),bn&&(Xe=Qe(bn,nr,bt-$r,bt+Mn,1,Me.minY,Me.maxY,Dt),vr=Qe(bn,nr,bt+Lr,bt+Nr,1,Me.minY,Me.maxY,Dt),bn=null),Ht>1&&console.timeEnd("clipping"),ue.push(wr||[],W+1,2*ft,2*bt),ue.push(Ar||[],W+1,2*ft,2*bt+1),ue.push(Xe||[],W+1,2*ft+1,2*bt),ue.push(vr||[],W+1,2*ft+1,2*bt+1)}}},Gn.prototype.getTile=function(Y,W,ft){var bt=this.options,zt=bt.extent,ae=bt.debug;if(Y<0||Y>24)return null;var me=1<<Y,ue=xa(Y,W=(W%me+me)%me,ft);if(this.tiles[ue])return ri(this.tiles[ue],zt);ae>1&&console.log("drilling down to z%d-%d-%d",Y,W,ft);for(var Dt,Ht=Y,nr=W,xr=ft;!Dt&&Ht>0;)Ht--,nr=Math.floor(nr/2),xr=Math.floor(xr/2),Dt=this.tiles[xa(Ht,nr,xr)];return Dt&&Dt.source?(ae>1&&console.log("found parent tile z%d-%d-%d",Ht,nr,xr),ae>1&&console.time("drilling down"),this.splitTile(Dt.source,Ht,nr,xr,Y,W,ft),ae>1&&console.timeEnd("drilling down"),this.tiles[ue]?ri(this.tiles[ue],zt):null):null};var cr=function(Y){function W(ft,bt,zt,ae){Y.call(this,ft,bt,zt,xn),ae&&(this.loadGeoJSON=ae)}return Y&&(W.__proto__=Y),(W.prototype=Object.create(Y&&Y.prototype)).constructor=W,W.prototype.loadData=function(ft,bt){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),this._pendingCallback=bt,this._pendingLoadDataParams=ft,this._state&&"Idle"!==this._state?this._state="NeedsLoadData":(this._state="Coalescing",this._loadData())},W.prototype._loadData=function(){var ft=this;if(this._pendingCallback&&this._pendingLoadDataParams){var bt=this._pendingCallback,zt=this._pendingLoadDataParams;delete this._pendingCallback,delete this._pendingLoadDataParams;var ae=!!(zt&&zt.request&&zt.request.collectResourceTiming)&&new s.RequestPerformance(zt.request);this.loadGeoJSON(zt,function(me,ue){if(me||!ue)return bt(me);if("object"!=typeof ue)return bt(new Error("Input data given to '"+zt.source+"' is not a valid GeoJSON object."));!function Me(qe,pr){var wr,Ar=qe&&qe.type;if("FeatureCollection"===Ar)for(wr=0;wr<qe.features.length;wr++)Me(qe.features[wr],pr);else if("GeometryCollection"===Ar)for(wr=0;wr<qe.geometries.length;wr++)Me(qe.geometries[wr],pr);else if("Feature"===Ar)Me(qe.geometry,pr);else if("Polygon"===Ar)ye(qe.coordinates,pr);else if("MultiPolygon"===Ar)for(wr=0;wr<qe.coordinates.length;wr++)ye(qe.coordinates[wr],pr);return qe}(ue,!0);try{if(zt.filter){var Dt=s.createExpression(zt.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if("error"===Dt.result)throw new Error(Dt.value.map(function(Me){return Me.key+": "+Me.message}).join(", "));var Ht=ue.features.filter(function(Me){return Dt.value.evaluate({zoom:0},Me)});ue={type:"FeatureCollection",features:Ht}}ft._geoJSONIndex=zt.cluster?new Ie(function(Me){var qe=Me.superclusterOptions,pr=Me.clusterProperties;if(!pr||!qe)return qe;for(var wr={},Ar={},Xe={accumulated:null,zoom:0},vr={properties:null},Ke=Object.keys(pr),bn=0,$r=Ke;bn<$r.length;bn+=1){var Lr=$r[bn],Mn=pr[Lr],Nr=Mn[0],Oi=s.createExpression(Mn[1]),ai=s.createExpression("string"==typeof Nr?[Nr,["accumulated"],["get",Lr]]:Nr);wr[Lr]=Oi.value,Ar[Lr]=ai.value}return qe.map=function(kn){vr.properties=kn;for(var Tn={},co=0,ni=Ke;co<ni.length;co+=1){var Xr=ni[co];Tn[Xr]=wr[Xr].evaluate(Xe,vr)}return Tn},qe.reduce=function(kn,Tn){vr.properties=Tn;for(var co=0,ni=Ke;co<ni.length;co+=1){var Xr=ni[co];Xe.accumulated=kn[Xr],kn[Xr]=Ar[Xr].evaluate(Xe,vr)}},qe}(zt)).load(ue.features):new Gn(Me=ue,zt.geojsonVtOptions)}catch(Me){return bt(Me)}var Me;ft.loaded={};var nr={};if(ae){var xr=ae.finish();xr&&(nr.resourceTiming={},nr.resourceTiming[zt.source]=JSON.parse(JSON.stringify(xr)))}bt(null,nr)})}},W.prototype.coalesce=function(){"Coalescing"===this._state?this._state="Idle":"NeedsLoadData"===this._state&&(this._state="Coalescing",this._loadData())},W.prototype.reloadTile=function(ft,bt){var zt=this.loaded;return zt&&zt[ft.uid]?Y.prototype.reloadTile.call(this,ft,bt):this.loadTile(ft,bt)},W.prototype.loadGeoJSON=function(ft,bt){if(ft.request)s.getJSON(ft.request,bt);else{if("string"!=typeof ft.data)return bt(new Error("Input data given to '"+ft.source+"' is not a valid GeoJSON object."));try{return bt(null,JSON.parse(ft.data))}catch{return bt(new Error("Input data given to '"+ft.source+"' is not a valid GeoJSON object."))}}},W.prototype.removeSource=function(ft,bt){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),bt()},W.prototype.getClusterExpansionZoom=function(ft,bt){try{bt(null,this._geoJSONIndex.getClusterExpansionZoom(ft.clusterId))}catch(zt){bt(zt)}},W.prototype.getClusterChildren=function(ft,bt){try{bt(null,this._geoJSONIndex.getChildren(ft.clusterId))}catch(zt){bt(zt)}},W.prototype.getClusterLeaves=function(ft,bt){try{bt(null,this._geoJSONIndex.getLeaves(ft.clusterId,ft.limit,ft.offset))}catch(zt){bt(zt)}},W}(mt),oi=function(Y){var W=this;this.self=Y,this.actor=new s.Actor(Y,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:mt,geojson:cr},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=function(ft,bt){if(W.workerSourceTypes[ft])throw new Error('Worker source with name "'+ft+'" already registered.');W.workerSourceTypes[ft]=bt},this.self.registerRTLTextPlugin=function(ft){if(s.plugin.isParsed())throw new Error("RTL text plugin already registered.");s.plugin.applyArabicShaping=ft.applyArabicShaping,s.plugin.processBidirectionalText=ft.processBidirectionalText,s.plugin.processStyledBidirectionalText=ft.processStyledBidirectionalText}};return oi.prototype.setReferrer=function(Y,W){this.referrer=W},oi.prototype.setImages=function(Y,W,ft){for(var bt in this.availableImages[Y]=W,this.workerSources[Y]){var zt=this.workerSources[Y][bt];for(var ae in zt)zt[ae].availableImages=W}ft()},oi.prototype.setLayers=function(Y,W,ft){this.getLayerIndex(Y).replace(W),ft()},oi.prototype.updateLayers=function(Y,W,ft){this.getLayerIndex(Y).update(W.layers,W.removedIds),ft()},oi.prototype.loadTile=function(Y,W,ft){this.getWorkerSource(Y,W.type,W.source).loadTile(W,ft)},oi.prototype.loadDEMTile=function(Y,W,ft){this.getDEMWorkerSource(Y,W.source).loadTile(W,ft)},oi.prototype.reloadTile=function(Y,W,ft){this.getWorkerSource(Y,W.type,W.source).reloadTile(W,ft)},oi.prototype.abortTile=function(Y,W,ft){this.getWorkerSource(Y,W.type,W.source).abortTile(W,ft)},oi.prototype.removeTile=function(Y,W,ft){this.getWorkerSource(Y,W.type,W.source).removeTile(W,ft)},oi.prototype.removeDEMTile=function(Y,W){this.getDEMWorkerSource(Y,W.source).removeTile(W)},oi.prototype.removeSource=function(Y,W,ft){if(this.workerSources[Y]&&this.workerSources[Y][W.type]&&this.workerSources[Y][W.type][W.source]){var bt=this.workerSources[Y][W.type][W.source];delete this.workerSources[Y][W.type][W.source],void 0!==bt.removeSource?bt.removeSource(W,ft):ft()}},oi.prototype.loadWorkerSource=function(Y,W,ft){try{this.self.importScripts(W.url),ft()}catch(bt){ft(bt.toString())}},oi.prototype.syncRTLPluginState=function(Y,W,ft){try{s.plugin.setState(W);var bt=s.plugin.getPluginURL();if(s.plugin.isLoaded()&&!s.plugin.isParsed()&&null!=bt){this.self.importScripts(bt);var zt=s.plugin.isParsed();ft(zt?void 0:new Error("RTL Text Plugin failed to import scripts from "+bt),zt)}}catch(ae){ft(ae.toString())}},oi.prototype.getAvailableImages=function(Y){var W=this.availableImages[Y];return W||(W=[]),W},oi.prototype.getLayerIndex=function(Y){var W=this.layerIndexes[Y];return W||(W=this.layerIndexes[Y]=new Lt),W},oi.prototype.getWorkerSource=function(Y,W,ft){var bt=this;return this.workerSources[Y]||(this.workerSources[Y]={}),this.workerSources[Y][W]||(this.workerSources[Y][W]={}),this.workerSources[Y][W][ft]||(this.workerSources[Y][W][ft]=new this.workerSourceTypes[W]({send:function(zt,ae,me){bt.actor.send(zt,ae,me,Y)}},this.getLayerIndex(Y),this.getAvailableImages(Y))),this.workerSources[Y][W][ft]},oi.prototype.getDEMWorkerSource=function(Y,W){return this.demWorkerSources[Y]||(this.demWorkerSources[Y]={}),this.demWorkerSources[Y][W]||(this.demWorkerSources[Y][W]=new Jt),this.demWorkerSources[Y][W]},oi.prototype.enforceCacheSizeLimit=function(Y,W){s.enforceCacheSizeLimit(W)},typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new oi(self)),oi}),Pt(0,function(s){var lt=s.createCommonjsModule(function(l){function f(E){return!c(E)}function c(E){return typeof window>"u"||typeof document>"u"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var T,N,G=new Blob([""],{type:"text/javascript"}),Q=URL.createObjectURL(G);try{N=new Worker(Q),T=!0}catch{T=!1}return N&&N.terminate(),URL.revokeObjectURL(Q),T}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var T=document.createElement("canvas");T.width=T.height=1;var N=T.getContext("2d");if(!N)return!1;var G=N.getImageData(0,0,1,1);return G&&G.width===T.width}()?(void 0===m[M=E&&E.failIfMajorPerformanceCaveat]&&(m[M]=function(T){var Q,yt,Et,N=(Q=T,yt=document.createElement("canvas"),(Et=Object.create(f.webGLContextAttributes)).failIfMajorPerformanceCaveat=Q,yt.probablySupportsContext?yt.probablySupportsContext("webgl",Et)||yt.probablySupportsContext("experimental-webgl",Et):yt.supportsContext?yt.supportsContext("webgl",Et)||yt.supportsContext("experimental-webgl",Et):yt.getContext("webgl",Et)||yt.getContext("experimental-webgl",Et));if(!N)return!1;var G=N.createShader(N.VERTEX_SHADER);return!(!G||N.isContextLost())&&(N.shaderSource(G,"void main() {}"),N.compileShader(G),!0===N.getShaderParameter(G,N.COMPILE_STATUS))}(M)),m[M]?void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var M}l.exports?l.exports=f:window&&(window.mapboxgl=window.mapboxgl||{},window.mapboxgl.supported=f,window.mapboxgl.notSupportedReason=c);var m={};f.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0}}),ht={create:function(l,f,c){var m=s.window.document.createElement(l);return void 0!==f&&(m.className=f),c&&c.appendChild(m),m},createNS:function(l,f){return s.window.document.createElementNS(l,f)}},Lt=s.window.document&&s.window.document.documentElement.style;function Ft(l){if(!Lt)return l[0];for(var f=0;f<l.length;f++)if(l[f]in Lt)return l[f];return l[0]}var Qt,qt=Ft(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]);ht.disableDrag=function(){Lt&&qt&&(Qt=Lt[qt],Lt[qt]="none")},ht.enableDrag=function(){Lt&&qt&&(Lt[qt]=Qt)};var _e=Ft(["transform","WebkitTransform"]);ht.setTransform=function(l,f){l.style[_e]=f};var mt=!1;try{var xt=Object.defineProperty({},"passive",{get:function(){mt=!0}});s.window.addEventListener("test",xt,xt),s.window.removeEventListener("test",xt,xt)}catch{mt=!1}ht.addEventListener=function(l,f,c,m){void 0===m&&(m={}),l.addEventListener(f,c,"passive"in m&&mt?m:m.capture)},ht.removeEventListener=function(l,f,c,m){void 0===m&&(m={}),l.removeEventListener(f,c,"passive"in m&&mt?m:m.capture)};var Jt=function(l){l.preventDefault(),l.stopPropagation(),s.window.removeEventListener("click",Jt,!0)};function ye(l){var f=l.userImage;return!!(f&&f.render&&f.render())&&(l.data.replace(new Uint8Array(f.data.buffer)),!0)}ht.suppressClick=function(){s.window.addEventListener("click",Jt,!0),s.window.setTimeout(function(){s.window.removeEventListener("click",Jt,!0)},0)},ht.mousePos=function(l,f){var c=l.getBoundingClientRect();return new s.Point(f.clientX-c.left-l.clientLeft,f.clientY-c.top-l.clientTop)},ht.touchPos=function(l,f){for(var c=l.getBoundingClientRect(),m=[],E=0;E<f.length;E++)m.push(new s.Point(f[E].clientX-c.left-l.clientLeft,f[E].clientY-c.top-l.clientTop));return m},ht.mouseButton=function(l){return void 0!==s.window.InstallTrigger&&2===l.button&&l.ctrlKey&&s.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:l.button},ht.remove=function(l){l.parentNode&&l.parentNode.removeChild(l)};var j=function(l){function f(){l.call(this),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new s.RGBAImage({width:1,height:1}),this.dirty=!0}return l&&(f.__proto__=l),(f.prototype=Object.create(l&&l.prototype)).constructor=f,f.prototype.isLoaded=function(){return this.loaded},f.prototype.setLoaded=function(c){if(this.loaded!==c&&(this.loaded=c,c)){for(var m=0,E=this.requestors;m<E.length;m+=1){var M=E[m];this._notify(M.ids,M.callback)}this.requestors=[]}},f.prototype.getImage=function(c){return this.images[c]},f.prototype.addImage=function(c,m){this._validate(c,m)&&(this.images[c]=m)},f.prototype._validate=function(c,m){var E=!0;return this._validateStretch(m.stretchX,m.data&&m.data.width)||(this.fire(new s.ErrorEvent(new Error('Image "'+c+'" has invalid "stretchX" value'))),E=!1),this._validateStretch(m.stretchY,m.data&&m.data.height)||(this.fire(new s.ErrorEvent(new Error('Image "'+c+'" has invalid "stretchY" value'))),E=!1),this._validateContent(m.content,m)||(this.fire(new s.ErrorEvent(new Error('Image "'+c+'" has invalid "content" value'))),E=!1),E},f.prototype._validateStretch=function(c,m){if(!c)return!0;for(var E=0,M=0,T=c;M<T.length;M+=1){var N=T[M];if(N[0]<E||N[1]<N[0]||m<N[1])return!1;E=N[1]}return!0},f.prototype._validateContent=function(c,m){return!(c&&(4!==c.length||c[0]<0||m.data.width<c[0]||c[1]<0||m.data.height<c[1]||c[2]<0||m.data.width<c[2]||c[3]<0||m.data.height<c[3]||c[2]<c[0]||c[3]<c[1]))},f.prototype.updateImage=function(c,m){m.version=this.images[c].version+1,this.images[c]=m,this.updatedImages[c]=!0},f.prototype.removeImage=function(c){var m=this.images[c];delete this.images[c],delete this.patterns[c],m.userImage&&m.userImage.onRemove&&m.userImage.onRemove()},f.prototype.listImages=function(){return Object.keys(this.images)},f.prototype.getImages=function(c,m){var E=!0;if(!this.isLoaded())for(var M=0,T=c;M<T.length;M+=1)this.images[T[M]]||(E=!1);this.isLoaded()||E?this._notify(c,m):this.requestors.push({ids:c,callback:m})},f.prototype._notify=function(c,m){for(var E={},M=0,T=c;M<T.length;M+=1){var N=T[M];this.images[N]||this.fire(new s.Event("styleimagemissing",{id:N}));var G=this.images[N];G?E[N]={data:G.data.clone(),pixelRatio:G.pixelRatio,sdf:G.sdf,version:G.version,stretchX:G.stretchX,stretchY:G.stretchY,content:G.content,hasRenderCallback:Boolean(G.userImage&&G.userImage.render)}:s.warnOnce('Image "'+N+'" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.')}m(null,E)},f.prototype.getPixelSize=function(){var c=this.atlasImage;return{width:c.width,height:c.height}},f.prototype.getPattern=function(c){var m=this.patterns[c],E=this.getImage(c);if(!E)return null;if(m&&m.position.version===E.version)return m.position;if(m)m.position.version=E.version;else{var M={w:E.data.width+2,h:E.data.height+2,x:0,y:0},T=new s.ImagePosition(M,E);this.patterns[c]={bin:M,position:T}}return this._updatePatternAtlas(),this.patterns[c].position},f.prototype.bind=function(c){var m=c.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new s.Texture(c,this.atlasImage,m.RGBA),this.atlasTexture.bind(m.LINEAR,m.CLAMP_TO_EDGE)},f.prototype._updatePatternAtlas=function(){var c=[];for(var m in this.patterns)c.push(this.patterns[m].bin);var E=s.potpack(c),M=E.w,T=E.h,N=this.atlasImage;for(var G in N.resize({width:M||1,height:T||1}),this.patterns){var Q=this.patterns[G].bin,yt=Q.x+1,Et=Q.y+1,_t=this.images[G].data,Xt=_t.width,Gt=_t.height;s.RGBAImage.copy(_t,N,{x:0,y:0},{x:yt,y:Et},{width:Xt,height:Gt}),s.RGBAImage.copy(_t,N,{x:0,y:Gt-1},{x:yt,y:Et-1},{width:Xt,height:1}),s.RGBAImage.copy(_t,N,{x:0,y:0},{x:yt,y:Et+Gt},{width:Xt,height:1}),s.RGBAImage.copy(_t,N,{x:Xt-1,y:0},{x:yt-1,y:Et},{width:1,height:Gt}),s.RGBAImage.copy(_t,N,{x:0,y:0},{x:yt+Xt,y:Et},{width:1,height:Gt})}this.dirty=!0},f.prototype.beginFrame=function(){this.callbackDispatchedThisFrame={}},f.prototype.dispatchRenderCallbacks=function(c){for(var m=0,E=c;m<E.length;m+=1){var M=E[m];if(!this.callbackDispatchedThisFrame[M]){this.callbackDispatchedThisFrame[M]=!0;var T=this.images[M];ye(T)&&this.updateImage(M,T)}}},f}(s.Evented),it=X,K=X,tt=1e20;function X(l,f,c,m,E,M){this.fontSize=l||24,this.buffer=void 0===f?3:f,this.cutoff=m||.25,this.fontFamily=E||"sans-serif",this.fontWeight=M||"normal",this.radius=c||8;var T=this.size=this.fontSize+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=T,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(T*T),this.gridInner=new Float64Array(T*T),this.f=new Float64Array(T),this.d=new Float64Array(T),this.z=new Float64Array(T+1),this.v=new Int16Array(T),this.middle=Math.round(T/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function nt(l,f,c,m,E,M,T){for(var N=0;N<f;N++){for(var G=0;G<c;G++)m[G]=l[G*f+N];for(J(m,E,M,T,c),G=0;G<c;G++)l[G*f+N]=E[G]}for(G=0;G<c;G++){for(N=0;N<f;N++)m[N]=l[G*f+N];for(J(m,E,M,T,f),N=0;N<f;N++)l[G*f+N]=Math.sqrt(E[N])}}function J(l,f,c,m,E){c[0]=0,m[0]=-tt,m[1]=+tt;for(var M=1,T=0;M<E;M++){for(var N=(l[M]+M*M-(l[c[T]]+c[T]*c[T]))/(2*M-2*c[T]);N<=m[T];)T--,N=(l[M]+M*M-(l[c[T]]+c[T]*c[T]))/(2*M-2*c[T]);c[++T]=M,m[T]=N,m[T+1]=+tt}for(M=0,T=0;M<E;M++){for(;m[T+1]<M;)T++;f[M]=(M-c[T])*(M-c[T])+l[c[T]]}}X.prototype.draw=function(l){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(l,this.buffer,this.middle);for(var f=this.ctx.getImageData(0,0,this.size,this.size),c=new Uint8ClampedArray(this.size*this.size),m=0;m<this.size*this.size;m++){var E=f.data[4*m+3]/255;this.gridOuter[m]=1===E?0:0===E?tt:Math.pow(Math.max(0,.5-E),2),this.gridInner[m]=1===E?tt:0===E?0:Math.pow(Math.max(0,E-.5),2)}for(nt(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),nt(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),m=0;m<this.size*this.size;m++)c[m]=Math.max(0,Math.min(255,Math.round(255-255*((this.gridOuter[m]-this.gridInner[m])/this.radius+this.cutoff))));return c},it.default=K;var et=function(l,f){this.requestManager=l,this.localIdeographFontFamily=f,this.entries={}};et.prototype.setURL=function(l){this.url=l},et.prototype.getGlyphs=function(l,f){var c=this,m=[];for(var E in l)for(var M=0,T=l[E];M<T.length;M+=1)m.push({stack:E,id:T[M]});s.asyncAll(m,function(N,G){var Q=N.stack,yt=N.id,Et=c.entries[Q];Et||(Et=c.entries[Q]={glyphs:{},requests:{},ranges:{}});var _t=Et.glyphs[yt];if(void 0===_t){if(_t=c._tinySDF(Et,Q,yt))return Et.glyphs[yt]=_t,void G(null,{stack:Q,id:yt,glyph:_t});var Xt=Math.floor(yt/256);if(256*Xt>65535)G(new Error("glyphs > 65535 not supported"));else if(Et.ranges[Xt])G(null,{stack:Q,id:yt,glyph:_t});else{var Gt=Et.requests[Xt];Gt||(Gt=Et.requests[Xt]=[],et.loadGlyphRange(Q,Xt,c.url,c.requestManager,function(ie,Zt){if(Zt){for(var ne in Zt)c._doesCharSupportLocalGlyph(+ne)||(Et.glyphs[+ne]=Zt[+ne]);Et.ranges[Xt]=!0}for(var ge=0,Ee=Gt;ge<Ee.length;ge+=1)(0,Ee[ge])(ie,Zt);delete Et.requests[Xt]})),Gt.push(function(ie,Zt){ie?G(ie):Zt&&G(null,{stack:Q,id:yt,glyph:Zt[yt]||null})})}}else G(null,{stack:Q,id:yt,glyph:_t})},function(N,G){if(N)f(N);else if(G){for(var Q={},yt=0,Et=G;yt<Et.length;yt+=1){var _t=Et[yt],Xt=_t.stack,Gt=_t.id,ie=_t.glyph;(Q[Xt]||(Q[Xt]={}))[Gt]=ie&&{id:ie.id,bitmap:ie.bitmap.clone(),metrics:ie.metrics}}f(null,Q)}})},et.prototype._doesCharSupportLocalGlyph=function(l){return!!this.localIdeographFontFamily&&(s.isChar["CJK Unified Ideographs"](l)||s.isChar["Hangul Syllables"](l)||s.isChar.Hiragana(l)||s.isChar.Katakana(l))},et.prototype._tinySDF=function(l,f,c){var m=this.localIdeographFontFamily;if(m&&this._doesCharSupportLocalGlyph(c)){var E=l.tinySDF;if(!E){var M="400";/bold/i.test(f)?M="900":/medium/i.test(f)?M="500":/light/i.test(f)&&(M="200"),E=l.tinySDF=new et.TinySDF(24,3,8,.25,m,M)}return{id:c,bitmap:new s.AlphaImage({width:30,height:30},E.draw(String.fromCharCode(c))),metrics:{width:24,height:24,left:0,top:-8,advance:24}}}},et.loadGlyphRange=function(l,f,c,m,E){var M=256*f,T=M+255,N=m.transformRequest(m.normalizeGlyphsURL(c).replace("{fontstack}",l).replace("{range}",M+"-"+T),s.ResourceType.Glyphs);s.getArrayBuffer(N,function(G,Q){if(G)E(G);else if(Q){for(var yt={},Et=0,_t=s.parseGlyphPBF(Q);Et<_t.length;Et+=1){var Xt=_t[Et];yt[Xt.id]=Xt}E(null,yt)}})},et.TinySDF=it;var at=function(){this.specification=s.styleSpec.light.position};at.prototype.possiblyEvaluate=function(l,f){return s.sphericalToCartesian(l.expression.evaluate(f))},at.prototype.interpolate=function(l,f,c){return{x:s.number(l.x,f.x,c),y:s.number(l.y,f.y,c),z:s.number(l.z,f.z,c)}};var Z=new s.Properties({anchor:new s.DataConstantProperty(s.styleSpec.light.anchor),position:new at,color:new s.DataConstantProperty(s.styleSpec.light.color),intensity:new s.DataConstantProperty(s.styleSpec.light.intensity)}),Wt=function(l){function f(c){l.call(this),this._transitionable=new s.Transitionable(Z),this.setLight(c),this._transitioning=this._transitionable.untransitioned()}return l&&(f.__proto__=l),(f.prototype=Object.create(l&&l.prototype)).constructor=f,f.prototype.getLight=function(){return this._transitionable.serialize()},f.prototype.setLight=function(c,m){if(void 0===m&&(m={}),!this._validate(s.validateLight,c,m))for(var E in c){var M=c[E];s.endsWith(E,"-transition")?this._transitionable.setTransition(E.slice(0,-11),M):this._transitionable.setValue(E,M)}},f.prototype.updateTransitions=function(c){this._transitioning=this._transitionable.transitioned(c,this._transitioning)},f.prototype.hasTransition=function(){return this._transitioning.hasTransition()},f.prototype.recalculate=function(c){this.properties=this._transitioning.possiblyEvaluate(c)},f.prototype._validate=function(c,m,E){return(!E||!1!==E.validate)&&s.emitValidationErrors(this,c.call(s.validateStyle,s.extend({value:m,style:{glyphs:!0,sprite:!0},styleSpec:s.styleSpec})))},f}(s.Evented),St=function(l,f){this.width=l,this.height=f,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}};St.prototype.getDash=function(l,f){var c=l.join(",")+String(f);return this.dashEntry[c]||(this.dashEntry[c]=this.addDash(l,f)),this.dashEntry[c]},St.prototype.getDashRanges=function(l,f,c){var m=[],E=l.length%2==1?-l[l.length-1]*c:0,M=l[0]*c,T=!0;m.push({left:E,right:M,isDash:T,zeroLength:0===l[0]});for(var N=l[0],G=1;G<l.length;G++){var Q=l[G];m.push({left:E=N*c,right:M=(N+=Q)*c,isDash:T=!T,zeroLength:0===Q})}return m},St.prototype.addRoundDash=function(l,f,c){for(var m=f/2,E=-c;E<=c;E++)for(var M=this.width*(this.nextRow+c+E),T=0,N=l[T],G=0;G<this.width;G++){G/N.right>1&&(N=l[++T]);var Q=Math.abs(G-N.left),yt=Math.abs(G-N.right),Et=Math.min(Q,yt),_t=void 0,Xt=E/c*(m+1);if(N.isDash){var Gt=m-Math.abs(Xt);_t=Math.sqrt(Et*Et+Gt*Gt)}else _t=m-Math.sqrt(Et*Et+Xt*Xt);this.data[M+G]=Math.max(0,Math.min(255,_t+128))}},St.prototype.addRegularDash=function(l){for(var f=l.length-1;f>=0;--f){var c=l[f],m=l[f+1];c.zeroLength?l.splice(f,1):m&&m.isDash===c.isDash&&(m.left=c.left,l.splice(f,1))}var E=l[0],M=l[l.length-1];E.isDash===M.isDash&&(E.left=M.left-this.width,M.right=E.right+this.width);for(var T=this.width*this.nextRow,N=0,G=l[N],Q=0;Q<this.width;Q++){Q/G.right>1&&(G=l[++N]);var yt=Math.abs(Q-G.left),Et=Math.abs(Q-G.right),_t=Math.min(yt,Et);this.data[T+Q]=Math.max(0,Math.min(255,(G.isDash?_t:-_t)+128))}},St.prototype.addDash=function(l,f){var c=f?7:0,m=2*c+1;if(this.nextRow+m>this.height)return s.warnOnce("LineAtlas out of space"),null;for(var E=0,M=0;M<l.length;M++)E+=l[M];if(0!==E){var T=this.width/E,N=this.getDashRanges(l,this.width,T);f?this.addRoundDash(N,T,c):this.addRegularDash(N)}var G={y:(this.nextRow+c+.5)/this.height,height:2*c/this.height,width:E};return this.nextRow+=m,this.dirty=!0,G},St.prototype.bind=function(l){var f=l.gl;this.texture?(f.bindTexture(f.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,f.texSubImage2D(f.TEXTURE_2D,0,0,0,this.width,this.height,f.ALPHA,f.UNSIGNED_BYTE,this.data))):(this.texture=f.createTexture(),f.bindTexture(f.TEXTURE_2D,this.texture),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_S,f.REPEAT),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_T,f.REPEAT),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MIN_FILTER,f.LINEAR),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MAG_FILTER,f.LINEAR),f.texImage2D(f.TEXTURE_2D,0,f.ALPHA,this.width,this.height,0,f.ALPHA,f.UNSIGNED_BYTE,this.data))};var kt=function l(f,c){this.workerPool=f,this.actors=[],this.currentActor=0,this.id=s.uniqueId();for(var m=this.workerPool.acquire(this.id),E=0;E<m.length;E++){var M=new l.Actor(m[E],c,this.id);M.name="Worker "+E,this.actors.push(M)}};function dt(l,f,c){var m=function(E,M){if(E)return c(E);if(M){var T=s.pick(s.extend(M,l),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);M.vector_layers&&(T.vectorLayers=M.vector_layers,T.vectorLayerIds=T.vectorLayers.map(function(N){return N.id})),T.tiles=f.canonicalizeTileset(T,l.url),c(null,T)}};return l.url?s.getJSON(f.transformRequest(f.normalizeSourceURL(l.url),s.ResourceType.Source),m):s.browser.frame(function(){return m(null,l)})}kt.prototype.broadcast=function(l,f,c){s.asyncAll(this.actors,function(m,E){m.send(l,f,E)},c=c||function(){})},kt.prototype.getActor=function(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]},kt.prototype.remove=function(){this.actors.forEach(function(l){l.remove()}),this.actors=[],this.workerPool.release(this.id)},kt.Actor=s.Actor;var je=function(l,f,c){this.bounds=s.LngLatBounds.convert(this.validateBounds(l)),this.minzoom=f||0,this.maxzoom=c||24};je.prototype.validateBounds=function(l){return Array.isArray(l)&&4===l.length?[Math.max(-180,l[0]),Math.max(-90,l[1]),Math.min(180,l[2]),Math.min(90,l[3])]:[-180,-90,180,90]},je.prototype.contains=function(l){var f=Math.pow(2,l.z),c=Math.floor(s.mercatorXfromLng(this.bounds.getWest())*f),m=Math.floor(s.mercatorYfromLat(this.bounds.getNorth())*f),E=Math.ceil(s.mercatorXfromLng(this.bounds.getEast())*f),M=Math.ceil(s.mercatorYfromLat(this.bounds.getSouth())*f);return l.x>=c&&l.x<E&&l.y>=m&&l.y<M};var Ce=function(l){function f(c,m,E,M){if(l.call(this),this.id=c,this.dispatcher=E,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,s.extend(this,s.pick(m,["url","scheme","tileSize","promoteId"])),this._options=s.extend({type:"vector"},m),this._collectResourceTiming=m.collectResourceTiming,512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(M)}return l&&(f.__proto__=l),(f.prototype=Object.create(l&&l.prototype)).constructor=f,f.prototype.load=function(){var c=this;this._loaded=!1,this.fire(new s.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=dt(this._options,this.map._requestManager,function(m,E){c._tileJSONRequest=null,c._loaded=!0,m?c.fire(new s.ErrorEvent(m)):E&&(s.extend(c,E),E.bounds&&(c.tileBounds=new je(E.bounds,c.minzoom,c.maxzoom)),s.postTurnstileEvent(E.tiles,c.map._requestManager._customAccessToken),s.postMapLoadEvent(E.tiles,c.map._getMapId(),c.map._requestManager._skuToken,c.map._requestManager._customAccessToken),c.fire(new s.Event("data",{dataType:"source",sourceDataType:"metadata"})),c.fire(new s.Event("data",{dataType:"source",sourceDataType:"content"})))})},f.prototype.loaded=function(){return this._loaded},f.prototype.hasTile=function(c){return!this.tileBounds||this.tileBounds.contains(c.canonical)},f.prototype.onAdd=function(c){this.map=c,this.load()},f.prototype.setSourceProperty=function(c){this._tileJSONRequest&&this._tileJSONRequest.cancel(),c(),this.map.style.sourceCaches[this.id].clearTiles(),this.load()},f.prototype.setTiles=function(c){var m=this;return this.setSourceProperty(function(){m._options.tiles=c}),this},f.prototype.setUrl=function(c){var m=this;return this.setSourceProperty(function(){m.url=c,m._options.url=c}),this},f.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},f.prototype.serialize=function(){return s.extend({},this._options)},f.prototype.loadTile=function(c,m){var E=this.map._requestManager.normalizeTileURL(c.tileID.canonical.url(this.tiles,this.scheme)),M={request:this.map._requestManager.transformRequest(E,s.ResourceType.Tile),uid:c.uid,tileID:c.tileID,zoom:c.tileID.overscaledZ,tileSize:this.tileSize*c.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:s.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function T(N,G){return delete c.request,c.aborted?m(null):N&&404!==N.status?m(N):(G&&G.resourceTiming&&(c.resourceTiming=G.resourceTiming),this.map._refreshExpiredTiles&&G&&c.setExpiryData(G),c.loadVectorData(G,this.map.painter),s.cacheEntryPossiblyAdded(this.dispatcher),m(null),void(c.reloadCallback&&(this.loadTile(c,c.reloadCallback),c.reloadCallback=null)))}M.request.collectResourceTiming=this._collectResourceTiming,c.actor&&"expired"!==c.state?"loading"===c.state?c.reloadCallback=m:c.request=c.actor.send("reloadTile",M,T.bind(this)):(c.actor=this.dispatcher.getActor(),c.request=c.actor.send("loadTile",M,T.bind(this)))},f.prototype.abortTile=function(c){c.request&&(c.request.cancel(),delete c.request),c.actor&&c.actor.send("abortTile",{uid:c.uid,type:this.type,source:this.id},void 0)},f.prototype.unloadTile=function(c){c.unloadVectorData(),c.actor&&c.actor.send("removeTile",{uid:c.uid,type:this.type,source:this.id},void 0)},f.prototype.hasTransition=function(){return!1},f}(s.Evented),Mt=function(l){function f(c,m,E,M){l.call(this),this.id=c,this.dispatcher=E,this.setEventedParent(M),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=s.extend({type:"raster"},m),s.extend(this,s.pick(m,["url","scheme","tileSize"]))}return l&&(f.__proto__=l),(f.prototype=Object.create(l&&l.prototype)).constructor=f,f.prototype.load=function(){var c=this;this._loaded=!1,this.fire(new s.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=dt(this._options,this.map._requestManager,function(m,E){c._tileJSONRequest=null,c._loaded=!0,m?c.fire(new s.ErrorEvent(m)):E&&(s.extend(c,E),E.bounds&&(c.tileBounds=new je(E.bounds,c.minzoom,c.maxzoom)),s.postTurnstileEvent(E.tiles),s.postMapLoadEvent(E.tiles,c.map._getMapId(),c.map._requestManager._skuToken),c.fire(new s.Event("data",{dataType:"source",sourceDataType:"metadata"})),c.fire(new s.Event("data",{dataType:"source",sourceDataType:"content"})))})},f.prototype.loaded=function(){return this._loaded},f.prototype.onAdd=function(c){this.map=c,this.load()},f.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},f.prototype.serialize=function(){return s.extend({},this._options)},f.prototype.hasTile=function(c){return!this.tileBounds||this.tileBounds.contains(c.canonical)},f.prototype.loadTile=function(c,m){var E=this,M=this.map._requestManager.normalizeTileURL(c.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);c.request=s.getImage(this.map._requestManager.transformRequest(M,s.ResourceType.Tile),function(T,N){if(delete c.request,c.aborted)c.state="unloaded",m(null);else if(T)c.state="errored",m(T);else if(N){E.map._refreshExpiredTiles&&c.setExpiryData(N),delete N.cacheControl,delete N.expires;var G=E.map.painter.context,Q=G.gl;c.texture=E.map.painter.getTileTexture(N.width),c.texture?c.texture.update(N,{useMipmap:!0}):(c.texture=new s.Texture(G,N,Q.RGBA,{useMipmap:!0}),c.texture.bind(Q.LINEAR,Q.CLAMP_TO_EDGE,Q.LINEAR_MIPMAP_NEAREST),G.extTextureFilterAnisotropic&&Q.texParameterf(Q.TEXTURE_2D,G.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,G.extTextureFilterAnisotropicMax)),c.state="loaded",s.cacheEntryPossiblyAdded(E.dispatcher),m(null)}})},f.prototype.abortTile=function(c,m){c.request&&(c.request.cancel(),delete c.request),m()},f.prototype.unloadTile=function(c,m){c.texture&&this.map.painter.saveTileTexture(c.texture),m()},f.prototype.hasTransition=function(){return!1},f}(s.Evented),pe=function(l){function f(c,m,E,M){l.call(this,c,m,E,M),this.type="raster-dem",this.maxzoom=22,this._options=s.extend({type:"raster-dem"},m),this.encoding=m.encoding||"mapbox"}return l&&(f.__proto__=l),(f.prototype=Object.create(l&&l.prototype)).constructor=f,f.prototype.serialize=function(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}},f.prototype.loadTile=function(c,m){var E=this.map._requestManager.normalizeTileURL(c.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);function M(T,N){T&&(c.state="errored",m(T)),N&&(c.dem=N,c.needsHillshadePrepare=!0,c.state="loaded",m(null))}c.request=s.getImage(this.map._requestManager.transformRequest(E,s.ResourceType.Tile),function(T,N){if(delete c.request,c.aborted)c.state="unloaded",m(null);else if(T)c.state="errored",m(T);else if(N){this.map._refreshExpiredTiles&&c.setExpiryData(N),delete N.cacheControl,delete N.expires;var G=s.window.ImageBitmap&&N instanceof s.window.ImageBitmap&&s.offscreenCanvasSupported()?N:s.browser.getImageData(N,1),Q={uid:c.uid,coord:c.tileID,source:this.id,rawImageData:G,encoding:this.encoding};c.actor&&"expired"!==c.state||(c.actor=this.dispatcher.getActor(),c.actor.send("loadDEMTile",Q,M.bind(this)))}}.bind(this)),c.neighboringTiles=this._getNeighboringTiles(c.tileID)},f.prototype._getNeighboringTiles=function(c){var m=c.canonical,E=Math.pow(2,m.z),M=(m.x-1+E)%E,T=0===m.x?c.wrap-1:c.wrap,N=(m.x+1+E)%E,G=m.x+1===E?c.wrap+1:c.wrap,Q={};return Q[new s.OverscaledTileID(c.overscaledZ,T,m.z,M,m.y).key]={backfilled:!1},Q[new s.OverscaledTileID(c.overscaledZ,G,m.z,N,m.y).key]={backfilled:!1},m.y>0&&(Q[new s.OverscaledTileID(c.overscaledZ,T,m.z,M,m.y-1).key]={backfilled:!1},Q[new s.OverscaledTileID(c.overscaledZ,c.wrap,m.z,m.x,m.y-1).key]={backfilled:!1},Q[new s.OverscaledTileID(c.overscaledZ,G,m.z,N,m.y-1).key]={backfilled:!1}),m.y+1<E&&(Q[new s.OverscaledTileID(c.overscaledZ,T,m.z,M,m.y+1).key]={backfilled:!1},Q[new s.OverscaledTileID(c.overscaledZ,c.wrap,m.z,m.x,m.y+1).key]={backfilled:!1},Q[new s.OverscaledTileID(c.overscaledZ,G,m.z,N,m.y+1).key]={backfilled:!1}),Q},f.prototype.unloadTile=function(c){c.demTexture&&this.map.painter.saveTileTexture(c.demTexture),c.fbo&&(c.fbo.destroy(),delete c.fbo),c.dem&&delete c.dem,delete c.neighboringTiles,c.state="unloaded",c.actor&&c.actor.send("removeDEMTile",{uid:c.uid,source:this.id})},f}(Mt),At=function(l){function f(c,m,E,M){l.call(this),this.id=c,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._loaded=!1,this.actor=E.getActor(),this.setEventedParent(M),this._data=m.data,this._options=s.extend({},m),this._collectResourceTiming=m.collectResourceTiming,this._resourceTiming=[],void 0!==m.maxzoom&&(this.maxzoom=m.maxzoom),m.type&&(this.type=m.type),m.attribution&&(this.attribution=m.attribution),this.promoteId=m.promoteId;var T=s.EXTENT/this.tileSize;this.workerOptions=s.extend({source:this.id,cluster:m.cluster||!1,geojsonVtOptions:{buffer:(void 0!==m.buffer?m.buffer:128)*T,tolerance:(void 0!==m.tolerance?m.tolerance:.375)*T,extent:s.EXTENT,maxZoom:this.maxzoom,lineMetrics:m.lineMetrics||!1,generateId:m.generateId||!1},superclusterOptions:{maxZoom:void 0!==m.clusterMaxZoom?Math.min(m.clusterMaxZoom,this.maxzoom-1):this.maxzoom-1,minPoints:Math.max(2,m.clusterMinPoints||2),extent:s.EXTENT,radius:(m.clusterRadius||50)*T,log:!1,generateId:m.generateId||!1},clusterProperties:m.clusterProperties,filter:m.filter},m.workerOptions)}return l&&(f.__proto__=l),(f.prototype=Object.create(l&&l.prototype)).constructor=f,f.prototype.load=function(){var c=this;this.fire(new s.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(m){if(m)c.fire(new s.ErrorEvent(m));else{var E={dataType:"source",sourceDataType:"metadata"};c._collectResourceTiming&&c._resourceTiming&&c._resourceTiming.length>0&&(E.resourceTiming=c._resourceTiming,c._resourceTiming=[]),c.fire(new s.Event("data",E))}})},f.prototype.onAdd=function(c){this.map=c,this.load()},f.prototype.setData=function(c){var m=this;return this._data=c,this.fire(new s.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(E){if(E)m.fire(new s.ErrorEvent(E));else{var M={dataType:"source",sourceDataType:"content"};m._collectResourceTiming&&m._resourceTiming&&m._resourceTiming.length>0&&(M.resourceTiming=m._resourceTiming,m._resourceTiming=[]),m.fire(new s.Event("data",M))}}),this},f.prototype.getClusterExpansionZoom=function(c,m){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:c,source:this.id},m),this},f.prototype.getClusterChildren=function(c,m){return this.actor.send("geojson.getClusterChildren",{clusterId:c,source:this.id},m),this},f.prototype.getClusterLeaves=function(c,m,E,M){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:c,limit:m,offset:E},M),this},f.prototype._updateWorkerData=function(c){var m=this;this._loaded=!1;var E=s.extend({},this.workerOptions),M=this._data;"string"==typeof M?(E.request=this.map._requestManager.transformRequest(s.browser.resolveURL(M),s.ResourceType.Source),E.request.collectResourceTiming=this._collectResourceTiming):E.data=JSON.stringify(M),this.actor.send(this.type+".loadData",E,function(T,N){m._removed||N&&N.abandoned||(m._loaded=!0,N&&N.resourceTiming&&N.resourceTiming[m.id]&&(m._resourceTiming=N.resourceTiming[m.id].slice(0)),m.actor.send(m.type+".coalesce",{source:E.source},null),c(T))})},f.prototype.loaded=function(){return this._loaded},f.prototype.loadTile=function(c,m){var E=this,M=c.actor?"reloadTile":"loadTile";c.actor=this.actor,c.request=this.actor.send(M,{type:this.type,uid:c.uid,tileID:c.tileID,zoom:c.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:s.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},function(T,N){return delete c.request,c.unloadVectorData(),c.aborted?m(null):T?m(T):(c.loadVectorData(N,E.map.painter,"reloadTile"===M),m(null))})},f.prototype.abortTile=function(c){c.request&&(c.request.cancel(),delete c.request),c.aborted=!0},f.prototype.unloadTile=function(c){c.unloadVectorData(),this.actor.send("removeTile",{uid:c.uid,type:this.type,source:this.id})},f.prototype.onRemove=function(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})},f.prototype.serialize=function(){return s.extend({},this._options,{type:this.type,data:this._data})},f.prototype.hasTransition=function(){return!1},f}(s.Evented),$t=s.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),fe=function(l){function f(c,m,E,M){l.call(this),this.id=c,this.dispatcher=E,this.coordinates=m.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(M),this.options=m}return l&&(f.__proto__=l),(f.prototype=Object.create(l&&l.prototype)).constructor=f,f.prototype.load=function(c,m){var E=this;this._loaded=!1,this.fire(new s.Event("dataloading",{dataType:"source"})),this.url=this.options.url,s.getImage(this.map._requestManager.transformRequest(this.url,s.ResourceType.Image),function(M,T){E._loaded=!0,M?E.fire(new s.ErrorEvent(M)):T&&(E.image=T,c&&(E.coordinates=c),m&&m(),E._finishLoading())})},f.prototype.loaded=function(){return this._loaded},f.prototype.updateImage=function(c){var m=this;return this.image&&c.url?(this.options.url=c.url,this.load(c.coordinates,function(){m.texture=null}),this):this},f.prototype._finishLoading=function(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"metadata"})))},f.prototype.onAdd=function(c){this.map=c,this.load()},f.prototype.setCoordinates=function(c){var m=this;this.coordinates=c;var E=c.map(s.MercatorCoordinate.fromLngLat);this.tileID=function(T){for(var N=1/0,G=1/0,Q=-1/0,yt=-1/0,Et=0,_t=T;Et<_t.length;Et+=1){var Xt=_t[Et];N=Math.min(N,Xt.x),G=Math.min(G,Xt.y),Q=Math.max(Q,Xt.x),yt=Math.max(yt,Xt.y)}var Gt=Math.max(Q-N,yt-G),ie=Math.max(0,Math.floor(-Math.log(Gt)/Math.LN2)),Zt=Math.pow(2,ie);return new s.CanonicalTileID(ie,Math.floor((N+Q)/2*Zt),Math.floor((G+yt)/2*Zt))}(E),this.minzoom=this.maxzoom=this.tileID.z;var M=E.map(function(T){return m.tileID.getTilePoint(T)._round()});return this._boundsArray=new s.StructArrayLayout4i8,this._boundsArray.emplaceBack(M[0].x,M[0].y,0,0),this._boundsArray.emplaceBack(M[1].x,M[1].y,s.EXTENT,0),this._boundsArray.emplaceBack(M[3].x,M[3].y,0,s.EXTENT),this._boundsArray.emplaceBack(M[2].x,M[2].y,s.EXTENT,s.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"content"})),this},f.prototype.prepare=function(){if(0!==Object.keys(this.tiles).length&&this.image){var c=this.map.painter.context,m=c.gl;for(var E in this.boundsBuffer||(this.boundsBuffer=c.createVertexBuffer(this._boundsArray,$t.members)),this.boundsSegments||(this.boundsSegments=s.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new s.Texture(c,this.image,m.RGBA),this.texture.bind(m.LINEAR,m.CLAMP_TO_EDGE)),this.tiles){var M=this.tiles[E];"loaded"!==M.state&&(M.state="loaded",M.texture=this.texture)}}},f.prototype.loadTile=function(c,m){this.tileID&&this.tileID.equals(c.tileID.canonical)?(this.tiles[String(c.tileID.wrap)]=c,c.buckets={},m(null)):(c.state="errored",m(null))},f.prototype.serialize=function(){return{type:"image",url:this.options.url,coordinates:this.coordinates}},f.prototype.hasTransition=function(){return!1},f}(s.Evented),Ot=function(l){function f(c,m,E,M){l.call(this,c,m,E,M),this.roundZoom=!0,this.type="video",this.options=m}return l&&(f.__proto__=l),(f.prototype=Object.create(l&&l.prototype)).constructor=f,f.prototype.load=function(){var c=this;this._loaded=!1;var m=this.options;this.urls=[];for(var E=0,M=m.urls;E<M.length;E+=1)this.urls.push(this.map._requestManager.transformRequest(M[E],s.ResourceType.Source).url);s.getVideo(this.urls,function(T,N){c._loaded=!0,T?c.fire(new s.ErrorEvent(T)):N&&(c.video=N,c.video.loop=!0,c.video.addEventListener("playing",function(){c.map.triggerRepaint()}),c.map&&c.video.play(),c._finishLoading())})},f.prototype.pause=function(){this.video&&this.video.pause()},f.prototype.play=function(){this.video&&this.video.play()},f.prototype.seek=function(c){if(this.video){var m=this.video.seekable;c<m.start(0)||c>m.end(0)?this.fire(new s.ErrorEvent(new s.ValidationError("sources."+this.id,null,"Playback for this video can be set only between the "+m.start(0)+" and "+m.end(0)+"-second mark."))):this.video.currentTime=c}},f.prototype.getVideo=function(){return this.video},f.prototype.onAdd=function(c){this.map||(this.map=c,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))},f.prototype.prepare=function(){if(!(0===Object.keys(this.tiles).length||this.video.readyState<2)){var c=this.map.painter.context,m=c.gl;for(var E in this.boundsBuffer||(this.boundsBuffer=c.createVertexBuffer(this._boundsArray,$t.members)),this.boundsSegments||(this.boundsSegments=s.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(m.LINEAR,m.CLAMP_TO_EDGE),m.texSubImage2D(m.TEXTURE_2D,0,0,0,m.RGBA,m.UNSIGNED_BYTE,this.video)):(this.texture=new s.Texture(c,this.video,m.RGBA),this.texture.bind(m.LINEAR,m.CLAMP_TO_EDGE)),this.tiles){var M=this.tiles[E];"loaded"!==M.state&&(M.state="loaded",M.texture=this.texture)}}},f.prototype.serialize=function(){return{type:"video",urls:this.urls,coordinates:this.coordinates}},f.prototype.hasTransition=function(){return this.video&&!this.video.paused},f}(fe),Be=function(l){function f(c,m,E,M){l.call(this,c,m,E,M),m.coordinates?Array.isArray(m.coordinates)&&4===m.coordinates.length&&!m.coordinates.some(function(T){return!Array.isArray(T)||2!==T.length||T.some(function(N){return"number"!=typeof N})})||this.fire(new s.ErrorEvent(new s.ValidationError("sources."+c,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new s.ErrorEvent(new s.ValidationError("sources."+c,null,'missing required property "coordinates"'))),m.animate&&"boolean"!=typeof m.animate&&this.fire(new s.ErrorEvent(new s.ValidationError("sources."+c,null,'optional "animate" property must be a boolean value'))),m.canvas?"string"==typeof m.canvas||m.canvas instanceof s.window.HTMLCanvasElement||this.fire(new s.ErrorEvent(new s.ValidationError("sources."+c,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new s.ErrorEvent(new s.ValidationError("sources."+c,null,'missing required property "canvas"'))),this.options=m,this.animate=void 0===m.animate||m.animate}return l&&(f.__proto__=l),(f.prototype=Object.create(l&&l.prototype)).constructor=f,f.prototype.load=function(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof s.window.HTMLCanvasElement?this.options.canvas:s.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new s.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},f.prototype.getCanvas=function(){return this.canvas},f.prototype.onAdd=function(c){this.map=c,this.load(),this.canvas&&this.animate&&this.play()},f.prototype.onRemove=function(){this.pause()},f.prototype.prepare=function(){var c=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,c=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,c=!0),!this._hasInvalidDimensions()&&0!==Object.keys(this.tiles).length){var m=this.map.painter.context,E=m.gl;for(var M in this.boundsBuffer||(this.boundsBuffer=m.createVertexBuffer(this._boundsArray,$t.members)),this.boundsSegments||(this.boundsSegments=s.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(c||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new s.Texture(m,this.canvas,E.RGBA,{premultiply:!0}),this.tiles){var T=this.tiles[M];"loaded"!==T.state&&(T.state="loaded",T.texture=this.texture)}}},f.prototype.serialize=function(){return{type:"canvas",coordinates:this.coordinates}},f.prototype.hasTransition=function(){return this._playing},f.prototype._hasInvalidDimensions=function(){for(var c=0,m=[this.canvas.width,this.canvas.height];c<m.length;c+=1){var E=m[c];if(isNaN(E)||E<=0)return!0}return!1},f}(fe),De={vector:Ce,raster:Mt,"raster-dem":pe,geojson:At,video:Ot,image:fe,canvas:Be};function sr(l,f){var c=s.identity([]);return s.translate(c,c,[1,1,0]),s.scale(c,c,[.5*l.width,.5*l.height,1]),s.multiply(c,c,l.calculatePosMatrix(f.toUnwrapped()))}function Ie(l,f,c,m,E,M){var T=function(ie,Zt,ne){if(ie)for(var ge=0,Ee=ie;ge<Ee.length;ge+=1){var Ue=Zt[Ee[ge]];if(Ue&&Ue.source===ne&&"fill-extrusion"===Ue.type)return!0}else for(var Fe in Zt){var We=Zt[Fe];if(We.source===ne&&"fill-extrusion"===We.type)return!0}return!1}(E&&E.layers,f,l.id),N=M.maxPitchScaleFactor(),G=l.tilesIn(m,N,T);G.sort(Sr);for(var Q=[],yt=0,Et=G;yt<Et.length;yt+=1){var _t=Et[yt];Q.push({wrappedTileID:_t.tileID.wrapped().key,queryResults:_t.tile.queryRenderedFeatures(f,c,l._state,_t.queryGeometry,_t.cameraQueryGeometry,_t.scale,E,M,N,sr(l.transform,_t.tileID))})}var Xt=function(ie){for(var Zt={},ne={},ge=0,Ee=ie;ge<Ee.length;ge+=1){var Ue=Ee[ge],Fe=Ue.queryResults,We=Ue.wrappedTileID,er=ne[We]=ne[We]||{};for(var br in Fe)for(var fr=Fe[br],zr=er[br]=er[br]||{},nn=Zt[br]=Zt[br]||[],sn=0,on=fr;sn<on.length;sn+=1){var wi=on[sn];zr[wi.featureIndex]||(zr[wi.featureIndex]=!0,nn.push(wi))}}return Zt}(Q);for(var Gt in Xt)Xt[Gt].forEach(function(ie){var Zt=ie.feature,ne=l.getFeatureState(Zt.layer["source-layer"],Zt.id);Zt.source=Zt.layer.source,Zt.layer["source-layer"]&&(Zt.sourceLayer=Zt.layer["source-layer"]),Zt.state=ne});return Xt}function Sr(l,f){var c=l.tileID,m=f.tileID;return c.overscaledZ-m.overscaledZ||c.canonical.y-m.canonical.y||c.wrap-m.wrap||c.canonical.x-m.canonical.x}var mr=function(l,f){this.max=l,this.onRemove=f,this.reset()};mr.prototype.reset=function(){for(var l in this.data)for(var f=0,c=this.data[l];f<c.length;f+=1){var m=c[f];m.timeout&&clearTimeout(m.timeout),this.onRemove(m.value)}return this.data={},this.order=[],this},mr.prototype.add=function(l,f,c){var m=this,E=l.wrapped().key;void 0===this.data[E]&&(this.data[E]=[]);var M={value:f,timeout:void 0};if(void 0!==c&&(M.timeout=setTimeout(function(){m.remove(l,M)},c)),this.data[E].push(M),this.order.push(E),this.order.length>this.max){var T=this._getAndRemoveByKey(this.order[0]);T&&this.onRemove(T)}return this},mr.prototype.has=function(l){return l.wrapped().key in this.data},mr.prototype.getAndRemove=function(l){return this.has(l)?this._getAndRemoveByKey(l.wrapped().key):null},mr.prototype._getAndRemoveByKey=function(l){var f=this.data[l].shift();return f.timeout&&clearTimeout(f.timeout),0===this.data[l].length&&delete this.data[l],this.order.splice(this.order.indexOf(l),1),f.value},mr.prototype.getByKey=function(l){var f=this.data[l];return f?f[0].value:null},mr.prototype.get=function(l){return this.has(l)?this.data[l.wrapped().key][0].value:null},mr.prototype.remove=function(l,f){if(!this.has(l))return this;var c=l.wrapped().key,m=void 0===f?0:this.data[c].indexOf(f),E=this.data[c][m];return this.data[c].splice(m,1),E.timeout&&clearTimeout(E.timeout),0===this.data[c].length&&delete this.data[c],this.onRemove(E.value),this.order.splice(this.order.indexOf(c),1),this},mr.prototype.setMaxSize=function(l){for(this.max=l;this.order.length>this.max;){var f=this._getAndRemoveByKey(this.order[0]);f&&this.onRemove(f)}return this},mr.prototype.filter=function(l){var f=[];for(var c in this.data)for(var m=0,E=this.data[c];m<E.length;m+=1){var M=E[m];l(M.value)||f.push(M)}for(var T=0,N=f;T<N.length;T+=1){var G=N[T];this.remove(G.value.tileID,G)}};var Ur=function(l,f,c){this.context=l;var m=l.gl;this.buffer=m.createBuffer(),this.dynamicDraw=Boolean(c),this.context.unbindVAO(),l.bindElementBuffer.set(this.buffer),m.bufferData(m.ELEMENT_ARRAY_BUFFER,f.arrayBuffer,this.dynamicDraw?m.DYNAMIC_DRAW:m.STATIC_DRAW),this.dynamicDraw||delete f.arrayBuffer};Ur.prototype.bind=function(){this.context.bindElementBuffer.set(this.buffer)},Ur.prototype.updateData=function(l){var f=this.context.gl;this.context.unbindVAO(),this.bind(),f.bufferSubData(f.ELEMENT_ARRAY_BUFFER,0,l.arrayBuffer)},Ur.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var jr={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"},Er=function(l,f,c,m){this.length=f.length,this.attributes=c,this.itemSize=f.bytesPerElement,this.dynamicDraw=m,this.context=l;var E=l.gl;this.buffer=E.createBuffer(),l.bindVertexBuffer.set(this.buffer),E.bufferData(E.ARRAY_BUFFER,f.arrayBuffer,this.dynamicDraw?E.DYNAMIC_DRAW:E.STATIC_DRAW),this.dynamicDraw||delete f.arrayBuffer};Er.prototype.bind=function(){this.context.bindVertexBuffer.set(this.buffer)},Er.prototype.updateData=function(l){var f=this.context.gl;this.bind(),f.bufferSubData(f.ARRAY_BUFFER,0,l.arrayBuffer)},Er.prototype.enableAttributes=function(l,f){for(var c=0;c<this.attributes.length;c++){var m=f.attributes[this.attributes[c].name];void 0!==m&&l.enableVertexAttribArray(m)}},Er.prototype.setVertexAttribPointers=function(l,f,c){for(var m=0;m<this.attributes.length;m++){var E=this.attributes[m],M=f.attributes[E.name];void 0!==M&&l.vertexAttribPointer(M,E.components,l[jr[E.type]],!1,this.itemSize,E.offset+this.itemSize*(c||0))}},Er.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var He=function(l){this.gl=l.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1};He.prototype.get=function(){return this.current},He.prototype.set=function(l){},He.prototype.getDefault=function(){return this.default},He.prototype.setDefault=function(){this.set(this.default)};var ei=function(l){function f(){l.apply(this,arguments)}return l&&(f.__proto__=l),(f.prototype=Object.create(l&&l.prototype)).constructor=f,f.prototype.getDefault=function(){return s.Color.transparent},f.prototype.set=function(c){var m=this.current;(c.r!==m.r||c.g!==m.g||c.b!==m.b||c.a!==m.a||this.dirty)&&(this.gl.clearColor(c.r,c.g,c.b,c.a),this.current=c,this.dirty=!1)},f}(He),_n=function(l){function f(){l.apply(this,arguments)}return l&&(f.__proto__=l),(f.prototype=Object.create(l&&l.prototype)).constructor=f,f.prototype.getDefault=function(){return 1},f.prototype.set=function(c){(c!==this.current||this.dirty)&&(this.gl.clearDepth(c),this.current=c,this.dirty=!1)},f}(He),zn=function(l){function f(){l.apply(this,arguments)}return l&&(f.__proto__=l),(f.prototype=Object.create(l&&l.prototype)).constructor=f,f.prototype.getDefault=function(){return 0},f.prototype.set=function(c){(c!==this.current||this.dirty)&&(this.gl.clearStencil(c),this.current=c,this.dirty=!1)},f}(He),se=function(l){function f(){l.apply(this,arguments)}return l&&(f.__proto__=l),(f.prototype=Object.create(l&&l.prototype)).constructor=f,f.prototype.getDefault=function(){return[!0,!0,!0,!0]},f.prototype.set=function(c){var m=this.current;(c[0]!==m[0]||c[1]!==m[1]||c[2]!==m[2]||c[3]!==m[3]||this.dirty)&&(this.gl.colorMask(c[0],c[1],c[2],c[3]),this.current=c,this.dirty=!1)},f}(He),Ze=function(l){function f(){l.apply(this,arguments)}return l&&(f.__proto__=l),(f.prototype=Object.create(l&&l.prototype)).constructor=f,f.prototype.getDefault=function(){return!0},f.prototype.set=function(c){(c!==this.current||this.dirty)&&(this.gl.depthMask(c),this.current=c,this.dirty=!1)},f}(He),Kt=function(l){function f(){l.apply(this,arguments)}return l&&(f.__proto__=l),(f.prototype=Object.create(l&&l.prototype)).constructor=f,f.prototype.getDefault=function(){return 255},f.prototype.set=function(c){(c!==this.current||this.dirty)&&(this.gl.stencilMask(c),this.current=c,this.dirty=!1)},f}(He),ut=function(l){function f(){l.apply(this,arguments)}return l&&(f.__proto__=l),(f.prototype=Object.create(l&&l.prototype)).constructor=f,f.prototype.getDefault=function(){return{func:this.gl.ALWAYS,ref:0,mask:255}},f.prototype.set=function(c){var m=this.current;(c.func!==m.func||c.ref!==m.ref||c.mask!==m.mask||this.dirty)&&(this.gl.stencilFunc(c.func,c.ref,c.mask),this.current=c,this.dirty=!1)},f}(He),rt=function(l){function f(){l.apply(this,arguments)}return l&&(f.__proto__=l),(f.prototype=Object.create(l&&l.prototype)).constructor=f,f.prototype.getDefault=function(){var c=this.gl;return[c.KEEP,c.KEEP,c.KEEP]},f.prototype.set=function(c){var m=this.current;(c[0]!==m[0]||c[1]!==m[1]||c[2]!==m[2]||this.dirty)&&(this.gl.stencilOp(c[0],c[1],c[2]),this.current=c,this.dirty=!1)},f}(He),ot=function(l){function f(){l.apply(this,arguments)}return l&&(f.__proto__=l),(f.prototype=Object.create(l&&l.prototype)).constructor=f,f.prototype.getDefault=function(){return!1},f.prototype.set=function(c){if(c!==this.current||this.dirty){var m=this.gl;c?m.enable(m.STENCIL_TEST):m.disable(m.STENCIL_TEST),this.current=c,this.dirty=!1}},f}(He),Nt=function(l){function f(){l.apply(this,arguments)}return l&&(f.__proto__=l),(f.prototype=Object.create(l&&l.prototype)).constructor=f,f.prototype.getDefault=function(){return[0,1]},f.prototype.set=function(c){var m=this.current;(c[0]!==m[0]||c[1]!==m[1]||this.dirty)&&(this.gl.depthRange(c[0],c[1]),this.current=c,this.dirty=!1)},f}(He),le=function(l){function f(){l.apply(this,arguments)}return l&&(f.__proto__=l),(f.prototype=Object.create(l&&l.prototype)).constructor=f,f.prototype.getDefault=function(){return!1},f.prototype.set=function(c){if(c!==this.current||this.dirty){var m=this.gl;c?m.enable(m.DEPTH_TEST):m.disable(m.DEPTH_TEST),this.current=c,this.dirty=!1}},f}(He),Oe=function(l){function f(){l.apply(this,arguments)}return l&&(f.__proto__=l),(f.prototype=Object.create(l&&l.prototype)).constructor=f,f.prototype.getDefault=function(){return this.gl.LESS},f.prototype.set=function(c){(c!==this.current||this.dirty)&&(this.gl.depthFunc(c),this.current=c,this.dirty=!1)},f}(He),Qe=function(l){function f(){l.apply(this,arguments)}return l&&(f.__proto__=l),(f.prototype=Object.create(l&&l.prototype)).constructor=f,f.prototype.getDefault=function(){return!1},f.prototype.set=function(c){if(c!==this.current||this.dirty){var m=this.gl;c?m.enable(m.BLEND):m.disable(m.BLEND),this.current=c,this.dirty=!1}},f}(He),ir=function(l){function f(){l.apply(this,arguments)}return l&&(f.__proto__=l),(f.prototype=Object.create(l&&l.prototype)).constructor=f,f.prototype.getDefault=function(){var c=this.gl;return[c.ONE,c.ZERO]},f.prototype.set=function(c){var m=this.current;(c[0]!==m[0]||c[1]!==m[1]||this.dirty)&&(this.gl.blendFunc(c[0],c[1]),this.current=c,this.dirty=!1)},f}(He),Ge=function(l){function f(){l.apply(this,arguments)}return l&&(f.__proto__=l),(f.prototype=Object.create(l&&l.prototype)).constructor=f,f.prototype.getDefault=function(){return s.Color.transparent},f.prototype.set=function(c){var m=this.current;(c.r!==m.r||c.g!==m.g||c.b!==m.b||c.a!==m.a||this.dirty)&&(this.gl.blendColor(c.r,c.g,c.b,c.a),this.current=c,this.dirty=!1)},f}(He),fn=function(l){function f(){l.apply(this,arguments)}return l&&(f.__proto__=l),(f.prototype=Object.create(l&&l.prototype)).constructor=f,f.prototype.getDefault=function(){return this.gl.FUNC_ADD},f.prototype.set=function(c){(c!==this.current||this.dirty)&&(this.gl.blendEquation(c),this.current=c,this.dirty=!1)},f}(He),en=function(l){function f(){l.apply(this,arguments)}return l&&(f.__proto__=l),(f.prototype=Object.create(l&&l.prototype)).constructor=f,f.prototype.getDefault=function(){return!1},f.prototype.set=function(c){if(c!==this.current||this.dirty){var m=this.gl;c?m.enable(m.CULL_FACE):m.disable(m.CULL_FACE),this.current=c,this.dirty=!1}},f}(He),hr=function(l){function f(){l.apply(this,arguments)}return l&&(f.__proto__=l),(f.prototype=Object.create(l&&l.prototype)).constructor=f,f.prototype.getDefault=function(){return this.gl.BACK},f.prototype.set=function(c){(c!==this.current||this.dirty)&&(this.gl.cullFace(c),this.current=c,this.dirty=!1)},f}(He),gn=function(l){function f(){l.apply(this,arguments)}return l&&(f.__proto__=l),(f.prototype=Object.create(l&&l.prototype)).constructor=f,f.prototype.getDefault=function(){return this.gl.CCW},f.prototype.set=function(c){(c!==this.current||this.dirty)&&(this.gl.frontFace(c),this.current=c,this.dirty=!1)},f}(He),Yn=function(l){function f(){l.apply(this,arguments)}return l&&(f.__proto__=l),(f.prototype=Object.create(l&&l.prototype)).constructor=f,f.prototype.getDefault=function(){return null},f.prototype.set=function(c){(c!==this.current||this.dirty)&&(this.gl.useProgram(c),this.current=c,this.dirty=!1)},f}(He),Jn=function(l){function f(){l.apply(this,arguments)}return l&&(f.__proto__=l),(f.prototype=Object.create(l&&l.prototype)).constructor=f,f.prototype.getDefault=function(){return this.gl.TEXTURE0},f.prototype.set=function(c){(c!==this.current||this.dirty)&&(this.gl.activeTexture(c),this.current=c,this.dirty=!1)},f}(He),Sn=function(l){function f(){l.apply(this,arguments)}return l&&(f.__proto__=l),(f.prototype=Object.create(l&&l.prototype)).constructor=f,f.prototype.getDefault=function(){var c=this.gl;return[0,0,c.drawingBufferWidth,c.drawingBufferHeight]},f.prototype.set=function(c){var m=this.current;(c[0]!==m[0]||c[1]!==m[1]||c[2]!==m[2]||c[3]!==m[3]||this.dirty)&&(this.gl.viewport(c[0],c[1],c[2],c[3]),this.current=c,this.dirty=!1)},f}(He),ri=function(l){function f(){l.apply(this,arguments)}return l&&(f.__proto__=l),(f.prototype=Object.create(l&&l.prototype)).constructor=f,f.prototype.getDefault=function(){return null},f.prototype.set=function(c){if(c!==this.current||this.dirty){var m=this.gl;m.bindFramebuffer(m.FRAMEBUFFER,c),this.current=c,this.dirty=!1}},f}(He),Br=function(l){function f(){l.apply(this,arguments)}return l&&(f.__proto__=l),(f.prototype=Object.create(l&&l.prototype)).constructor=f,f.prototype.getDefault=function(){return null},f.prototype.set=function(c){if(c!==this.current||this.dirty){var m=this.gl;m.bindRenderbuffer(m.RENDERBUFFER,c),this.current=c,this.dirty=!1}},f}(He),Xo=function(l){function f(){l.apply(this,arguments)}return l&&(f.__proto__=l),(f.prototype=Object.create(l&&l.prototype)).constructor=f,f.prototype.getDefault=function(){return null},f.prototype.set=function(c){if(c!==this.current||this.dirty){var m=this.gl;m.bindTexture(m.TEXTURE_2D,c),this.current=c,this.dirty=!1}},f}(He),zo=function(l){function f(){l.apply(this,arguments)}return l&&(f.__proto__=l),(f.prototype=Object.create(l&&l.prototype)).constructor=f,f.prototype.getDefault=function(){return null},f.prototype.set=function(c){if(c!==this.current||this.dirty){var m=this.gl;m.bindBuffer(m.ARRAY_BUFFER,c),this.current=c,this.dirty=!1}},f}(He),Yo=function(l){function f(){l.apply(this,arguments)}return l&&(f.__proto__=l),(f.prototype=Object.create(l&&l.prototype)).constructor=f,f.prototype.getDefault=function(){return null},f.prototype.set=function(c){var m=this.gl;m.bindBuffer(m.ELEMENT_ARRAY_BUFFER,c),this.current=c,this.dirty=!1},f}(He),Gn=function(l){function f(c){l.call(this,c),this.vao=c.extVertexArrayObject}return l&&(f.__proto__=l),(f.prototype=Object.create(l&&l.prototype)).constructor=f,f.prototype.getDefault=function(){return null},f.prototype.set=function(c){this.vao&&(c!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(c),this.current=c,this.dirty=!1)},f}(He),xa=function(l){function f(){l.apply(this,arguments)}return l&&(f.__proto__=l),(f.prototype=Object.create(l&&l.prototype)).constructor=f,f.prototype.getDefault=function(){return 4},f.prototype.set=function(c){if(c!==this.current||this.dirty){var m=this.gl;m.pixelStorei(m.UNPACK_ALIGNMENT,c),this.current=c,this.dirty=!1}},f}(He),xn=function(l){function f(){l.apply(this,arguments)}return l&&(f.__proto__=l),(f.prototype=Object.create(l&&l.prototype)).constructor=f,f.prototype.getDefault=function(){return!1},f.prototype.set=function(c){if(c!==this.current||this.dirty){var m=this.gl;m.pixelStorei(m.UNPACK_PREMULTIPLY_ALPHA_WEBGL,c),this.current=c,this.dirty=!1}},f}(He),cr=function(l){function f(){l.apply(this,arguments)}return l&&(f.__proto__=l),(f.prototype=Object.create(l&&l.prototype)).constructor=f,f.prototype.getDefault=function(){return!1},f.prototype.set=function(c){if(c!==this.current||this.dirty){var m=this.gl;m.pixelStorei(m.UNPACK_FLIP_Y_WEBGL,c),this.current=c,this.dirty=!1}},f}(He),oi=function(l){function f(c,m){l.call(this,c),this.context=c,this.parent=m}return l&&(f.__proto__=l),(f.prototype=Object.create(l&&l.prototype)).constructor=f,f.prototype.getDefault=function(){return null},f}(He),Y=function(l){function f(){l.apply(this,arguments)}return l&&(f.__proto__=l),(f.prototype=Object.create(l&&l.prototype)).constructor=f,f.prototype.setDirty=function(){this.dirty=!0},f.prototype.set=function(c){if(c!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var m=this.gl;m.framebufferTexture2D(m.FRAMEBUFFER,m.COLOR_ATTACHMENT0,m.TEXTURE_2D,c,0),this.current=c,this.dirty=!1}},f}(oi),W=function(l){function f(){l.apply(this,arguments)}return l&&(f.__proto__=l),(f.prototype=Object.create(l&&l.prototype)).constructor=f,f.prototype.set=function(c){if(c!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var m=this.gl;m.framebufferRenderbuffer(m.FRAMEBUFFER,m.DEPTH_ATTACHMENT,m.RENDERBUFFER,c),this.current=c,this.dirty=!1}},f}(oi),ft=function(l,f,c,m){this.context=l,this.width=f,this.height=c;var E=this.framebuffer=l.gl.createFramebuffer();this.colorAttachment=new Y(l,E),m&&(this.depthAttachment=new W(l,E))};ft.prototype.destroy=function(){var l=this.context.gl,f=this.colorAttachment.get();if(f&&l.deleteTexture(f),this.depthAttachment){var c=this.depthAttachment.get();c&&l.deleteRenderbuffer(c)}l.deleteFramebuffer(this.framebuffer)};var bt=function(l,f,c){this.func=l,this.mask=f,this.range=c};bt.ReadOnly=!1,bt.ReadWrite=!0,bt.disabled=new bt(519,bt.ReadOnly,[0,1]);var zt=function(l,f,c,m,E,M){this.test=l,this.ref=f,this.mask=c,this.fail=m,this.depthFail=E,this.pass=M};zt.disabled=new zt({func:519,mask:0},0,0,7680,7680,7680);var ae=function(l,f,c){this.blendFunction=l,this.blendColor=f,this.mask=c};ae.disabled=new ae(ae.Replace=[1,0],s.Color.transparent,[!1,!1,!1,!1]),ae.unblended=new ae(ae.Replace,s.Color.transparent,[!0,!0,!0,!0]),ae.alphaBlended=new ae([1,771],s.Color.transparent,[!0,!0,!0,!0]);var me=function(l,f,c){this.enable=l,this.mode=f,this.frontFace=c};me.disabled=new me(!1,1029,2305),me.backCCW=new me(!0,1029,2305);var ue=function(l){this.gl=l,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new ei(this),this.clearDepth=new _n(this),this.clearStencil=new zn(this),this.colorMask=new se(this),this.depthMask=new Ze(this),this.stencilMask=new Kt(this),this.stencilFunc=new ut(this),this.stencilOp=new rt(this),this.stencilTest=new ot(this),this.depthRange=new Nt(this),this.depthTest=new le(this),this.depthFunc=new Oe(this),this.blend=new Qe(this),this.blendFunc=new ir(this),this.blendColor=new Ge(this),this.blendEquation=new fn(this),this.cullFace=new en(this),this.cullFaceSide=new hr(this),this.frontFace=new gn(this),this.program=new Yn(this),this.activeTexture=new Jn(this),this.viewport=new Sn(this),this.bindFramebuffer=new ri(this),this.bindRenderbuffer=new Br(this),this.bindTexture=new Xo(this),this.bindVertexBuffer=new zo(this),this.bindElementBuffer=new Yo(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new Gn(this),this.pixelStoreUnpack=new xa(this),this.pixelStoreUnpackPremultiplyAlpha=new xn(this),this.pixelStoreUnpackFlipY=new cr(this),this.extTextureFilterAnisotropic=l.getExtension("EXT_texture_filter_anisotropic")||l.getExtension("MOZ_EXT_texture_filter_anisotropic")||l.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=l.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=l.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(l.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=l.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=l.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=l.getParameter(l.MAX_TEXTURE_SIZE)};ue.prototype.setDefault=function(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()},ue.prototype.setDirty=function(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0},ue.prototype.createIndexBuffer=function(l,f){return new Ur(this,l,f)},ue.prototype.createVertexBuffer=function(l,f,c){return new Er(this,l,f,c)},ue.prototype.createRenderbuffer=function(l,f,c){var m=this.gl,E=m.createRenderbuffer();return this.bindRenderbuffer.set(E),m.renderbufferStorage(m.RENDERBUFFER,l,f,c),this.bindRenderbuffer.set(null),E},ue.prototype.createFramebuffer=function(l,f,c){return new ft(this,l,f,c)},ue.prototype.clear=function(l){var f=l.color,c=l.depth,m=this.gl,E=0;f&&(E|=m.COLOR_BUFFER_BIT,this.clearColor.set(f),this.colorMask.set([!0,!0,!0,!0])),void 0!==c&&(E|=m.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(c),this.depthMask.set(!0)),m.clear(E)},ue.prototype.setCullFace=function(l){!1===l.enable?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(l.mode),this.frontFace.set(l.frontFace))},ue.prototype.setDepthMode=function(l){l.func!==this.gl.ALWAYS||l.mask?(this.depthTest.set(!0),this.depthFunc.set(l.func),this.depthMask.set(l.mask),this.depthRange.set(l.range)):this.depthTest.set(!1)},ue.prototype.setStencilMode=function(l){l.test.func!==this.gl.ALWAYS||l.mask?(this.stencilTest.set(!0),this.stencilMask.set(l.mask),this.stencilOp.set([l.fail,l.depthFail,l.pass]),this.stencilFunc.set({func:l.test.func,ref:l.ref,mask:l.test.mask})):this.stencilTest.set(!1)},ue.prototype.setColorMode=function(l){s.deepEqual(l.blendFunction,ae.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(l.blendFunction),this.blendColor.set(l.blendColor)),this.colorMask.set(l.mask)},ue.prototype.unbindVAO=function(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)};var Dt=function(l){function f(c,m,E){var M=this;l.call(this),this.id=c,this.dispatcher=E,this.on("data",function(T){"source"===T.dataType&&"metadata"===T.sourceDataType&&(M._sourceLoaded=!0),M._sourceLoaded&&!M._paused&&"source"===T.dataType&&"content"===T.sourceDataType&&(M.reload(),M.transform&&M.update(M.transform))}),this.on("error",function(){M._sourceErrored=!0}),this._source=function(T,N,G,Q){var yt=new De[N.type](T,N,G,Q);if(yt.id!==T)throw new Error("Expected Source id to be "+T+" instead of "+yt.id);return s.bindAll(["load","abort","unload","serialize","prepare"],yt),yt}(c,m,E,this),this._tiles={},this._cache=new mr(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new s.SourceFeatureState}return l&&(f.__proto__=l),(f.prototype=Object.create(l&&l.prototype)).constructor=f,f.prototype.onAdd=function(c){this.map=c,this._maxTileCacheSize=c?c._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(c)},f.prototype.onRemove=function(c){this._source&&this._source.onRemove&&this._source.onRemove(c)},f.prototype.loaded=function(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(var c in this._tiles){var m=this._tiles[c];if("loaded"!==m.state&&"errored"!==m.state)return!1}return!0},f.prototype.getSource=function(){return this._source},f.prototype.pause=function(){this._paused=!0},f.prototype.resume=function(){if(this._paused){var c=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,c&&this.reload(),this.transform&&this.update(this.transform)}},f.prototype._loadTile=function(c,m){return this._source.loadTile(c,m)},f.prototype._unloadTile=function(c){if(this._source.unloadTile)return this._source.unloadTile(c,function(){})},f.prototype._abortTile=function(c){if(this._source.abortTile)return this._source.abortTile(c,function(){})},f.prototype.serialize=function(){return this._source.serialize()},f.prototype.prepare=function(c){for(var m in this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null),this._tiles){var E=this._tiles[m];E.upload(c),E.prepare(this.map.style.imageManager)}},f.prototype.getIds=function(){return s.values(this._tiles).map(function(c){return c.tileID}).sort(Ht).map(function(c){return c.key})},f.prototype.getRenderableIds=function(c){var m=this,E=[];for(var M in this._tiles)this._isIdRenderable(M,c)&&E.push(this._tiles[M]);return c?E.sort(function(T,N){var G=T.tileID,Q=N.tileID,yt=new s.Point(G.canonical.x,G.canonical.y)._rotate(m.transform.angle),Et=new s.Point(Q.canonical.x,Q.canonical.y)._rotate(m.transform.angle);return G.overscaledZ-Q.overscaledZ||Et.y-yt.y||Et.x-yt.x}).map(function(T){return T.tileID.key}):E.map(function(T){return T.tileID}).sort(Ht).map(function(T){return T.key})},f.prototype.hasRenderableParent=function(c){var m=this.findLoadedParent(c,0);return!!m&&this._isIdRenderable(m.tileID.key)},f.prototype._isIdRenderable=function(c,m){return this._tiles[c]&&this._tiles[c].hasData()&&!this._coveredTiles[c]&&(m||!this._tiles[c].holdingForFade())},f.prototype.reload=function(){if(this._paused)this._shouldReloadOnResume=!0;else for(var c in this._cache.reset(),this._tiles)"errored"!==this._tiles[c].state&&this._reloadTile(c,"reloading")},f.prototype._reloadTile=function(c,m){var E=this._tiles[c];E&&("loading"!==E.state&&(E.state=m),this._loadTile(E,this._tileLoaded.bind(this,E,c,m)))},f.prototype._tileLoaded=function(c,m,E,M){if(M)return c.state="errored",void(404!==M.status?this._source.fire(new s.ErrorEvent(M,{tile:c})):this.update(this.transform));c.timeAdded=s.browser.now(),"expired"===E&&(c.refreshedUponExpiration=!0),this._setTileReloadTimer(m,c),"raster-dem"===this.getSource().type&&c.dem&&this._backfillDEM(c),this._state.initializeTileState(c,this.map?this.map.painter:null),this._source.fire(new s.Event("data",{dataType:"source",tile:c,coord:c.tileID}))},f.prototype._backfillDEM=function(c){for(var m=this.getRenderableIds(),E=0;E<m.length;E++){var M=m[E];if(c.neighboringTiles&&c.neighboringTiles[M]){var T=this.getTileByID(M);N(c,T),N(T,c)}}function N(G,Q){G.needsHillshadePrepare=!0;var yt=Q.tileID.canonical.x-G.tileID.canonical.x,Et=Q.tileID.canonical.y-G.tileID.canonical.y,_t=Math.pow(2,G.tileID.canonical.z),Xt=Q.tileID.key;0===yt&&0===Et||Math.abs(Et)>1||(Math.abs(yt)>1&&(1===Math.abs(yt+_t)?yt+=_t:1===Math.abs(yt-_t)&&(yt-=_t)),Q.dem&&G.dem&&(G.dem.backfillBorder(Q.dem,yt,Et),G.neighboringTiles&&G.neighboringTiles[Xt]&&(G.neighboringTiles[Xt].backfilled=!0)))}},f.prototype.getTile=function(c){return this.getTileByID(c.key)},f.prototype.getTileByID=function(c){return this._tiles[c]},f.prototype._retainLoadedChildren=function(c,m,E,M){for(var T in this._tiles){var N=this._tiles[T];if(!(M[T]||!N.hasData()||N.tileID.overscaledZ<=m||N.tileID.overscaledZ>E)){for(var G=N.tileID;N&&N.tileID.overscaledZ>m+1;){var Q=N.tileID.scaledTo(N.tileID.overscaledZ-1);(N=this._tiles[Q.key])&&N.hasData()&&(G=Q)}for(var yt=G;yt.overscaledZ>m;)if(c[(yt=yt.scaledTo(yt.overscaledZ-1)).key]){M[G.key]=G;break}}}},f.prototype.findLoadedParent=function(c,m){if(c.key in this._loadedParentTiles){var E=this._loadedParentTiles[c.key];return E&&E.tileID.overscaledZ>=m?E:null}for(var M=c.overscaledZ-1;M>=m;M--){var T=c.scaledTo(M),N=this._getLoadedTile(T);if(N)return N}},f.prototype._getLoadedTile=function(c){var m=this._tiles[c.key];return m&&m.hasData()?m:this._cache.getByKey(c.wrapped().key)},f.prototype.updateCacheSize=function(c){var m=Math.ceil(c.width/this._source.tileSize)+1,E=Math.ceil(c.height/this._source.tileSize)+1,M=Math.floor(m*E*5),T="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,M):M;this._cache.setMaxSize(T)},f.prototype.handleWrapJump=function(c){var m=Math.round((c-(void 0===this._prevLng?c:this._prevLng))/360);if(this._prevLng=c,m){var E={};for(var M in this._tiles){var T=this._tiles[M];T.tileID=T.tileID.unwrapTo(T.tileID.wrap+m),E[T.tileID.key]=T}for(var N in this._tiles=E,this._timers)clearTimeout(this._timers[N]),delete this._timers[N];for(var G in this._tiles)this._setTileReloadTimer(G,this._tiles[G])}},f.prototype.update=function(c){var m=this;if(this.transform=c,this._sourceLoaded&&!this._paused){var E;this.updateCacheSize(c),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used?this._source.tileID?E=c.getVisibleUnwrappedCoordinates(this._source.tileID).map(function(er){return new s.OverscaledTileID(er.canonical.z,er.wrap,er.canonical.z,er.canonical.x,er.canonical.y)}):(E=c.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}),this._source.hasTile&&(E=E.filter(function(er){return m._source.hasTile(er)}))):E=[];var M=c.coveringZoomLevel(this._source),T=Math.max(M-f.maxOverzooming,this._source.minzoom),N=Math.max(M+f.maxUnderzooming,this._source.minzoom),G=this._updateRetainedTiles(E,M);if(nr(this._source.type)){for(var Q={},yt={},Et=0,_t=Object.keys(G);Et<_t.length;Et+=1){var Xt=_t[Et],Gt=G[Xt],ie=this._tiles[Xt];if(ie&&!(ie.fadeEndTime&&ie.fadeEndTime<=s.browser.now())){var Zt=this.findLoadedParent(Gt,T);Zt&&(this._addTile(Zt.tileID),Q[Zt.tileID.key]=Zt.tileID),yt[Xt]=Gt}}for(var ne in this._retainLoadedChildren(yt,M,N,G),Q)G[ne]||(this._coveredTiles[ne]=!0,G[ne]=Q[ne])}for(var ge in G)this._tiles[ge].clearFadeHold();for(var Ee=0,Ue=s.keysDifference(this._tiles,G);Ee<Ue.length;Ee+=1){var Fe=Ue[Ee],We=this._tiles[Fe];We.hasSymbolBuckets&&!We.holdingForFade()?We.setHoldDuration(this.map._fadeDuration):We.hasSymbolBuckets&&!We.symbolFadeFinished()||this._removeTile(Fe)}this._updateLoadedParentTileCache()}},f.prototype.releaseSymbolFadeTiles=function(){for(var c in this._tiles)this._tiles[c].holdingForFade()&&this._removeTile(c)},f.prototype._updateRetainedTiles=function(c,m){for(var E={},M={},T=Math.max(m-f.maxOverzooming,this._source.minzoom),N=Math.max(m+f.maxUnderzooming,this._source.minzoom),G={},Q=0,yt=c;Q<yt.length;Q+=1){var Et=yt[Q],_t=this._addTile(Et);E[Et.key]=Et,_t.hasData()||m<this._source.maxzoom&&(G[Et.key]=Et)}this._retainLoadedChildren(G,m,N,E);for(var Xt=0,Gt=c;Xt<Gt.length;Xt+=1){var ie=Gt[Xt],Zt=this._tiles[ie.key];if(!Zt.hasData()){if(m+1>this._source.maxzoom){var ne=ie.children(this._source.maxzoom)[0],ge=this.getTile(ne);if(ge&&ge.hasData()){E[ne.key]=ne;continue}}else{var Ee=ie.children(this._source.maxzoom);if(E[Ee[0].key]&&E[Ee[1].key]&&E[Ee[2].key]&&E[Ee[3].key])continue}for(var Ue=Zt.wasRequested(),Fe=ie.overscaledZ-1;Fe>=T;--Fe){var We=ie.scaledTo(Fe);if(M[We.key]||(M[We.key]=!0,!(Zt=this.getTile(We))&&Ue&&(Zt=this._addTile(We)),Zt&&(E[We.key]=We,Ue=Zt.wasRequested(),Zt.hasData())))break}}}return E},f.prototype._updateLoadedParentTileCache=function(){for(var c in this._loadedParentTiles={},this._tiles){for(var m=[],E=void 0,M=this._tiles[c].tileID;M.overscaledZ>0;){if(M.key in this._loadedParentTiles){E=this._loadedParentTiles[M.key];break}m.push(M.key);var T=M.scaledTo(M.overscaledZ-1);if(E=this._getLoadedTile(T))break;M=T}for(var N=0,G=m;N<G.length;N+=1)this._loadedParentTiles[G[N]]=E}},f.prototype._addTile=function(c){var m=this._tiles[c.key];if(m)return m;(m=this._cache.getAndRemove(c))&&(this._setTileReloadTimer(c.key,m),m.tileID=c,this._state.initializeTileState(m,this.map?this.map.painter:null),this._cacheTimers[c.key]&&(clearTimeout(this._cacheTimers[c.key]),delete this._cacheTimers[c.key],this._setTileReloadTimer(c.key,m)));var E=Boolean(m);return E||(m=new s.Tile(c,this._source.tileSize*c.overscaleFactor()),this._loadTile(m,this._tileLoaded.bind(this,m,c.key,m.state))),m?(m.uses++,this._tiles[c.key]=m,E||this._source.fire(new s.Event("dataloading",{tile:m,coord:m.tileID,dataType:"source"})),m):null},f.prototype._setTileReloadTimer=function(c,m){var E=this;c in this._timers&&(clearTimeout(this._timers[c]),delete this._timers[c]);var M=m.getExpiryTimeout();M&&(this._timers[c]=setTimeout(function(){E._reloadTile(c,"expired"),delete E._timers[c]},M))},f.prototype._removeTile=function(c){var m=this._tiles[c];m&&(m.uses--,delete this._tiles[c],this._timers[c]&&(clearTimeout(this._timers[c]),delete this._timers[c]),m.uses>0||(m.hasData()&&"reloading"!==m.state?this._cache.add(m.tileID,m,m.getExpiryTimeout()):(m.aborted=!0,this._abortTile(m),this._unloadTile(m))))},f.prototype.clearTiles=function(){for(var c in this._shouldReloadOnResume=!1,this._paused=!1,this._tiles)this._removeTile(c);this._cache.reset()},f.prototype.tilesIn=function(c,m,E){var M=this,T=[],N=this.transform;if(!N)return T;for(var G=E?N.getCameraQueryGeometry(c):c,Q=c.map(function(Fe){return N.pointCoordinate(Fe)}),yt=G.map(function(Fe){return N.pointCoordinate(Fe)}),Et=this.getIds(),_t=1/0,Xt=1/0,Gt=-1/0,ie=-1/0,Zt=0,ne=yt;Zt<ne.length;Zt+=1){var ge=ne[Zt];_t=Math.min(_t,ge.x),Xt=Math.min(Xt,ge.y),Gt=Math.max(Gt,ge.x),ie=Math.max(ie,ge.y)}for(var Ee=function(Fe){var We=M._tiles[Et[Fe]];if(!We.holdingForFade()){var er=We.tileID,br=Math.pow(2,N.zoom-We.tileID.overscaledZ),fr=m*We.queryPadding*s.EXTENT/We.tileSize/br,zr=[er.getTilePoint(new s.MercatorCoordinate(_t,Xt)),er.getTilePoint(new s.MercatorCoordinate(Gt,ie))];if(zr[0].x-fr<s.EXTENT&&zr[0].y-fr<s.EXTENT&&zr[1].x+fr>=0&&zr[1].y+fr>=0){var nn=Q.map(function(on){return er.getTilePoint(on)}),sn=yt.map(function(on){return er.getTilePoint(on)});T.push({tile:We,tileID:er,queryGeometry:nn,cameraQueryGeometry:sn,scale:br})}}},Ue=0;Ue<Et.length;Ue++)Ee(Ue);return T},f.prototype.getVisibleCoordinates=function(c){for(var m=this,E=this.getRenderableIds(c).map(function(G){return m._tiles[G].tileID}),M=0,T=E;M<T.length;M+=1){var N=T[M];N.posMatrix=this.transform.calculatePosMatrix(N.toUnwrapped())}return E},f.prototype.hasTransition=function(){if(this._source.hasTransition())return!0;if(nr(this._source.type))for(var c in this._tiles){var m=this._tiles[c];if(void 0!==m.fadeEndTime&&m.fadeEndTime>=s.browser.now())return!0}return!1},f.prototype.setFeatureState=function(c,m,E){this._state.updateState(c=c||"_geojsonTileLayer",m,E)},f.prototype.removeFeatureState=function(c,m,E){this._state.removeFeatureState(c=c||"_geojsonTileLayer",m,E)},f.prototype.getFeatureState=function(c,m){return this._state.getState(c=c||"_geojsonTileLayer",m)},f.prototype.setDependencies=function(c,m,E){var M=this._tiles[c];M&&M.setDependencies(m,E)},f.prototype.reloadTilesForDependencies=function(c,m){for(var E in this._tiles)this._tiles[E].hasDependency(c,m)&&this._reloadTile(E,"reloading");this._cache.filter(function(M){return!M.hasDependency(c,m)})},f}(s.Evented);function Ht(l,f){var c=Math.abs(2*l.wrap)-+(l.wrap<0),m=Math.abs(2*f.wrap)-+(f.wrap<0);return l.overscaledZ-f.overscaledZ||m-c||f.canonical.y-l.canonical.y||f.canonical.x-l.canonical.x}function nr(l){return"raster"===l||"image"===l||"video"===l}function xr(){return new s.window.Worker(Mi.workerUrl)}Dt.maxOverzooming=10,Dt.maxUnderzooming=3;var Me="mapboxgl_preloaded_worker_pool",qe=function(){this.active={}};qe.prototype.acquire=function(l){if(!this.workers)for(this.workers=[];this.workers.length<qe.workerCount;)this.workers.push(new xr);return this.active[l]=!0,this.workers.slice()},qe.prototype.release=function(l){delete this.active[l],0===this.numActive()&&(this.workers.forEach(function(f){f.terminate()}),this.workers=null)},qe.prototype.isPreloaded=function(){return!!this.active[Me]},qe.prototype.numActive=function(){return Object.keys(this.active).length};var pr,wr=Math.floor(s.browser.hardwareConcurrency/2);function Ar(){return pr||(pr=new qe),pr}function Xe(l,f){var c={};for(var m in l)"ref"!==m&&(c[m]=l[m]);return s.refProperties.forEach(function(E){E in f&&(c[E]=f[E])}),c}function vr(l){l=l.slice();for(var f=Object.create(null),c=0;c<l.length;c++)f[l[c].id]=l[c];for(var m=0;m<l.length;m++)"ref"in l[m]&&(l[m]=Xe(l[m],f[l[m].ref]));return l}qe.workerCount=Math.max(Math.min(wr,6),1);var Ke={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function bn(l,f,c){c.push({command:Ke.addSource,args:[l,f[l]]})}function $r(l,f,c){f.push({command:Ke.removeSource,args:[l]}),c[l]=!0}function Lr(l,f,c,m){$r(l,c,m),bn(l,f,c)}function Mn(l,f,c){var m;for(m in l[c])if(l[c].hasOwnProperty(m)&&"data"!==m&&!s.deepEqual(l[c][m],f[c][m]))return!1;for(m in f[c])if(f[c].hasOwnProperty(m)&&"data"!==m&&!s.deepEqual(l[c][m],f[c][m]))return!1;return!0}function Nr(l,f,c,m,E,M){var T;for(T in f=f||{},l=l||{})l.hasOwnProperty(T)&&(s.deepEqual(l[T],f[T])||c.push({command:M,args:[m,T,f[T],E]}));for(T in f)f.hasOwnProperty(T)&&!l.hasOwnProperty(T)&&(s.deepEqual(l[T],f[T])||c.push({command:M,args:[m,T,f[T],E]}))}function Oi(l){return l.id}function ai(l,f){return l[f.id]=f,l}var kn=function(l,f){this.reset(l,f)};kn.prototype.reset=function(l,f){this.points=l||[],this._distances=[0];for(var c=1;c<this.points.length;c++)this._distances[c]=this._distances[c-1]+this.points[c].dist(this.points[c-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(f||0,.5*this.length),this.paddedLength=this.length-2*this.padding},kn.prototype.lerp=function(l){if(1===this.points.length)return this.points[0];l=s.clamp(l,0,1);for(var f=1,c=this._distances[f],m=l*this.paddedLength+this.padding;c<m&&f<this._distances.length;)c=this._distances[++f];var E=f-1,M=this._distances[E],T=c-M,N=T>0?(m-M)/T:0;return this.points[E].mult(1-N).add(this.points[f].mult(N))};var Tn=function(l,f,c){var m=this.boxCells=[],E=this.circleCells=[];this.xCellCount=Math.ceil(l/c),this.yCellCount=Math.ceil(f/c);for(var M=0;M<this.xCellCount*this.yCellCount;M++)m.push([]),E.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=l,this.height=f,this.xScale=this.xCellCount/l,this.yScale=this.yCellCount/f,this.boxUid=0,this.circleUid=0};function co(l,f,c,m,E){var M=s.create();return f?(s.scale(M,M,[1/E,1/E,1]),c||s.rotateZ(M,M,m.angle)):s.multiply(M,m.labelPlaneMatrix,l),M}function ni(l,f,c,m,E){if(f){var M=s.clone(l);return s.scale(M,M,[E,E,1]),c||s.rotateZ(M,M,-m.angle),M}return m.glCoordMatrix}function Xr(l,f){var c=[l.x,l.y,0,1];Bn(c,c,f);var m=c[3];return{point:new s.Point(c[0]/m,c[1]/m),signedDistanceFromCamera:m}}function ca(l,f){return.5+l/f*.5}function Hn(l,f){var c=l[0]/l[3],m=l[1]/l[3];return c>=-f[0]&&c<=f[0]&&m>=-f[1]&&m<=f[1]}function Fa(l,f,c,m,E,M,T,N){var G=m?l.textSizeData:l.iconSizeData,Q=s.evaluateSizeForZoom(G,c.transform.zoom),yt=[256/c.width*2+1,256/c.height*2+1],Et=m?l.text.dynamicLayoutVertexArray:l.icon.dynamicLayoutVertexArray;Et.clear();for(var _t=l.lineVertexArray,Xt=m?l.text.placedSymbolArray:l.icon.placedSymbolArray,Gt=c.transform.width/c.transform.height,ie=!1,Zt=0;Zt<Xt.length;Zt++){var ne=Xt.get(Zt);if(ne.hidden||ne.writingMode===s.WritingMode.vertical&&!ie)ss(ne.numGlyphs,Et);else{ie=!1;var ge=[ne.anchorX,ne.anchorY,0,1];if(s.transformMat4(ge,ge,f),Hn(ge,yt)){var Ee=ca(c.transform.cameraToCenterDistance,ge[3]),Ue=s.evaluateSizeForFeature(G,Q,ne),Fe=T?Ue/Ee:Ue*Ee,We=new s.Point(ne.anchorX,ne.anchorY),er=Xr(We,E).point,br={},fr=Wn(ne,Fe,!1,N,f,E,M,l.glyphOffsetArray,_t,Et,er,We,br,Gt);ie=fr.useVertical,(fr.notEnoughRoom||ie||fr.needsFlipping&&Wn(ne,Fe,!0,N,f,E,M,l.glyphOffsetArray,_t,Et,er,We,br,Gt).notEnoughRoom)&&ss(ne.numGlyphs,Et)}else ss(ne.numGlyphs,Et)}}m?l.text.dynamicLayoutVertexBuffer.updateData(Et):l.icon.dynamicLayoutVertexBuffer.updateData(Et)}function za(l,f,c,m,E,M,T,N,G,Q,yt){var Et=N.glyphStartIndex+N.numGlyphs,_t=N.lineStartIndex,Xt=N.lineStartIndex+N.lineLength,Gt=f.getoffsetX(N.glyphStartIndex),ie=f.getoffsetX(Et-1),Zt=Aa(l*Gt,c,m,E,M,T,N.segment,_t,Xt,G,Q,yt);if(!Zt)return null;var ne=Aa(l*ie,c,m,E,M,T,N.segment,_t,Xt,G,Q,yt);return ne?{first:Zt,last:ne}:null}function No(l,f,c,m){return l===s.WritingMode.horizontal&&Math.abs(c.y-f.y)>Math.abs(c.x-f.x)*m?{useVertical:!0}:(l===s.WritingMode.vertical?f.y<c.y:f.x>c.x)?{needsFlipping:!0}:null}function Wn(l,f,c,m,E,M,T,N,G,Q,yt,Et,_t,Xt){var Gt,ie=f/24,Zt=l.lineOffsetX*ie,ne=l.lineOffsetY*ie;if(l.numGlyphs>1){var ge=l.glyphStartIndex+l.numGlyphs,Ee=l.lineStartIndex,Ue=l.lineStartIndex+l.lineLength,Fe=za(ie,N,Zt,ne,c,yt,Et,l,G,M,_t);if(!Fe)return{notEnoughRoom:!0};var We=Xr(Fe.first.point,T).point,er=Xr(Fe.last.point,T).point;if(m&&!c){var br=No(l.writingMode,We,er,Xt);if(br)return br}Gt=[Fe.first];for(var fr=l.glyphStartIndex+1;fr<ge-1;fr++)Gt.push(Aa(ie*N.getoffsetX(fr),Zt,ne,c,yt,Et,l.segment,Ee,Ue,G,M,_t));Gt.push(Fe.last)}else{if(m&&!c){var zr=Xr(Et,E).point,nn=l.lineStartIndex+l.segment+1,sn=new s.Point(G.getx(nn),G.gety(nn)),on=Xr(sn,E),wi=on.signedDistanceFromCamera>0?on.point:Ws(Et,sn,zr,1,E),Gr=No(l.writingMode,zr,wi,Xt);if(Gr)return Gr}var Vn=Aa(ie*N.getoffsetX(l.glyphStartIndex),Zt,ne,c,yt,Et,l.segment,l.lineStartIndex,l.lineStartIndex+l.lineLength,G,M,_t);if(!Vn)return{notEnoughRoom:!0};Gt=[Vn]}for(var ti=0,Zn=Gt;ti<Zn.length;ti+=1){var Nn=Zn[ti];s.addDynamicAttributes(Q,Nn.point,Nn.angle)}return{}}function Ws(l,f,c,m,E){var M=Xr(l.add(l.sub(f)._unit()),E).point,T=c.sub(M);return c.add(T._mult(m/T.mag()))}function Aa(l,f,c,m,E,M,T,N,G,Q,yt,Et){var _t=m?l-f:l+f,Xt=_t>0?1:-1,Gt=0;m&&(Xt*=-1,Gt=Math.PI),Xt<0&&(Gt+=Math.PI);for(var ie=Xt>0?N+T:N+T+1,Zt=E,ne=E,ge=0,Ee=0,Ue=Math.abs(_t),Fe=[];ge+Ee<=Ue;){if((ie+=Xt)<N||ie>=G)return null;if(ne=Zt,Fe.push(Zt),void 0===(Zt=Et[ie])){var We=new s.Point(Q.getx(ie),Q.gety(ie)),er=Xr(We,yt);if(er.signedDistanceFromCamera>0)Zt=Et[ie]=er.point;else{var br=ie-Xt;Zt=Ws(0===ge?M:new s.Point(Q.getx(br),Q.gety(br)),We,ne,Ue-ge+1,yt)}}ge+=Ee,Ee=ne.dist(Zt)}var fr=(Ue-ge)/Ee,zr=Zt.sub(ne),nn=zr.mult(fr)._add(ne);nn._add(zr._unit()._perp()._mult(c*Xt));var sn=Gt+Math.atan2(Zt.y-ne.y,Zt.x-ne.x);return Fe.push(nn),{point:nn,angle:sn,path:Fe}}Tn.prototype.keysLength=function(){return this.boxKeys.length+this.circleKeys.length},Tn.prototype.insert=function(l,f,c,m,E){this._forEachCell(f,c,m,E,this._insertBoxCell,this.boxUid++),this.boxKeys.push(l),this.bboxes.push(f),this.bboxes.push(c),this.bboxes.push(m),this.bboxes.push(E)},Tn.prototype.insertCircle=function(l,f,c,m){this._forEachCell(f-m,c-m,f+m,c+m,this._insertCircleCell,this.circleUid++),this.circleKeys.push(l),this.circles.push(f),this.circles.push(c),this.circles.push(m)},Tn.prototype._insertBoxCell=function(l,f,c,m,E,M){this.boxCells[E].push(M)},Tn.prototype._insertCircleCell=function(l,f,c,m,E,M){this.circleCells[E].push(M)},Tn.prototype._query=function(l,f,c,m,E,M){if(c<0||l>this.width||m<0||f>this.height)return!E&&[];var T=[];if(l<=0&&f<=0&&this.width<=c&&this.height<=m){if(E)return!0;for(var N=0;N<this.boxKeys.length;N++)T.push({key:this.boxKeys[N],x1:this.bboxes[4*N],y1:this.bboxes[4*N+1],x2:this.bboxes[4*N+2],y2:this.bboxes[4*N+3]});for(var G=0;G<this.circleKeys.length;G++){var Q=this.circles[3*G],yt=this.circles[3*G+1],Et=this.circles[3*G+2];T.push({key:this.circleKeys[G],x1:Q-Et,y1:yt-Et,x2:Q+Et,y2:yt+Et})}return M?T.filter(M):T}return this._forEachCell(l,f,c,m,this._queryCell,T,{hitTest:E,seenUids:{box:{},circle:{}}},M),E?T.length>0:T},Tn.prototype._queryCircle=function(l,f,c,m,E){var M=l-c,T=l+c,N=f-c,G=f+c;if(T<0||M>this.width||G<0||N>this.height)return!m&&[];var Q=[];return this._forEachCell(M,N,T,G,this._queryCellCircle,Q,{hitTest:m,circle:{x:l,y:f,radius:c},seenUids:{box:{},circle:{}}},E),m?Q.length>0:Q},Tn.prototype.query=function(l,f,c,m,E){return this._query(l,f,c,m,!1,E)},Tn.prototype.hitTest=function(l,f,c,m,E){return this._query(l,f,c,m,!0,E)},Tn.prototype.hitTestCircle=function(l,f,c,m){return this._queryCircle(l,f,c,!0,m)},Tn.prototype._queryCell=function(l,f,c,m,E,M,T,N){var G=T.seenUids,Q=this.boxCells[E];if(null!==Q)for(var yt=this.bboxes,Et=0,_t=Q;Et<_t.length;Et+=1){var Xt=_t[Et];if(!G.box[Xt]){G.box[Xt]=!0;var Gt=4*Xt;if(l<=yt[Gt+2]&&f<=yt[Gt+3]&&c>=yt[Gt+0]&&m>=yt[Gt+1]&&(!N||N(this.boxKeys[Xt]))){if(T.hitTest)return M.push(!0),!0;M.push({key:this.boxKeys[Xt],x1:yt[Gt],y1:yt[Gt+1],x2:yt[Gt+2],y2:yt[Gt+3]})}}}var ie=this.circleCells[E];if(null!==ie)for(var Zt=this.circles,ne=0,ge=ie;ne<ge.length;ne+=1){var Ee=ge[ne];if(!G.circle[Ee]){G.circle[Ee]=!0;var Ue=3*Ee;if(this._circleAndRectCollide(Zt[Ue],Zt[Ue+1],Zt[Ue+2],l,f,c,m)&&(!N||N(this.circleKeys[Ee]))){if(T.hitTest)return M.push(!0),!0;var Fe=Zt[Ue],We=Zt[Ue+1],er=Zt[Ue+2];M.push({key:this.circleKeys[Ee],x1:Fe-er,y1:We-er,x2:Fe+er,y2:We+er})}}}},Tn.prototype._queryCellCircle=function(l,f,c,m,E,M,T,N){var G=T.circle,Q=T.seenUids,yt=this.boxCells[E];if(null!==yt)for(var Et=this.bboxes,_t=0,Xt=yt;_t<Xt.length;_t+=1){var Gt=Xt[_t];if(!Q.box[Gt]){Q.box[Gt]=!0;var ie=4*Gt;if(this._circleAndRectCollide(G.x,G.y,G.radius,Et[ie+0],Et[ie+1],Et[ie+2],Et[ie+3])&&(!N||N(this.boxKeys[Gt])))return M.push(!0),!0}}var Zt=this.circleCells[E];if(null!==Zt)for(var ne=this.circles,ge=0,Ee=Zt;ge<Ee.length;ge+=1){var Ue=Ee[ge];if(!Q.circle[Ue]){Q.circle[Ue]=!0;var Fe=3*Ue;if(this._circlesCollide(ne[Fe],ne[Fe+1],ne[Fe+2],G.x,G.y,G.radius)&&(!N||N(this.circleKeys[Ue])))return M.push(!0),!0}}},Tn.prototype._forEachCell=function(l,f,c,m,E,M,T,N){for(var G=this._convertToXCellCoord(l),Q=this._convertToYCellCoord(f),yt=this._convertToXCellCoord(c),Et=this._convertToYCellCoord(m),_t=G;_t<=yt;_t++)for(var Xt=Q;Xt<=Et;Xt++)if(E.call(this,l,f,c,m,this.xCellCount*Xt+_t,M,T,N))return},Tn.prototype._convertToXCellCoord=function(l){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(l*this.xScale)))},Tn.prototype._convertToYCellCoord=function(l){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(l*this.yScale)))},Tn.prototype._circlesCollide=function(l,f,c,m,E,M){var T=m-l,N=E-f,G=c+M;return G*G>T*T+N*N},Tn.prototype._circleAndRectCollide=function(l,f,c,m,E,M,T){var N=(M-m)/2,G=Math.abs(l-(m+N));if(G>N+c)return!1;var Q=(T-E)/2,yt=Math.abs(f-(E+Q));if(yt>Q+c)return!1;if(G<=N||yt<=Q)return!0;var Et=G-N,_t=yt-Q;return Et*Et+_t*_t<=c*c};var aa=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function ss(l,f){for(var c=0;c<l;c++){var m=f.length;f.resize(m+4),f.float32.set(aa,3*m)}}function Bn(l,f,c){var m=f[0],E=f[1];return l[0]=c[0]*m+c[4]*E+c[12],l[1]=c[1]*m+c[5]*E+c[13],l[3]=c[3]*m+c[7]*E+c[15],l}var go=function(l,f,c){void 0===f&&(f=new Tn(l.width+200,l.height+200,25)),void 0===c&&(c=new Tn(l.width+200,l.height+200,25)),this.transform=l,this.grid=f,this.ignoredGrid=c,this.pitchfactor=Math.cos(l._pitch)*l.cameraToCenterDistance,this.screenRightBoundary=l.width+100,this.screenBottomBoundary=l.height+100,this.gridRightBoundary=l.width+200,this.gridBottomBoundary=l.height+200};function Bo(l,f,c){return f*(s.EXTENT/(l.tileSize*Math.pow(2,c-l.tileID.overscaledZ)))}go.prototype.placeCollisionBox=function(l,f,c,m,E){var M=this.projectAndGetPerspectiveRatio(m,l.anchorPointX,l.anchorPointY),T=c*M.perspectiveRatio,N=l.x1*T+M.point.x,G=l.y1*T+M.point.y,Q=l.x2*T+M.point.x,yt=l.y2*T+M.point.y;return!this.isInsideGrid(N,G,Q,yt)||!f&&this.grid.hitTest(N,G,Q,yt,E)?{box:[],offscreen:!1}:{box:[N,G,Q,yt],offscreen:this.isOffscreen(N,G,Q,yt)}},go.prototype.placeCollisionCircles=function(l,f,c,m,E,M,T,N,G,Q,yt,Et,_t){var Xt=[],Gt=new s.Point(f.anchorX,f.anchorY),ie=Xr(Gt,M),Zt=ca(this.transform.cameraToCenterDistance,ie.signedDistanceFromCamera),ne=(Q?E/Zt:E*Zt)/s.ONE_EM,ge=Xr(Gt,T).point,Ee=za(ne,m,f.lineOffsetX*ne,f.lineOffsetY*ne,!1,ge,Gt,f,c,T,{}),Ue=!1,Fe=!1,We=!0;if(Ee){for(var er=.5*Et*Zt+_t,br=new s.Point(-100,-100),fr=new s.Point(this.screenRightBoundary,this.screenBottomBoundary),zr=new kn,nn=Ee.first,sn=Ee.last,on=[],wi=nn.path.length-1;wi>=1;wi--)on.push(nn.path[wi]);for(var Gr=1;Gr<sn.path.length;Gr++)on.push(sn.path[Gr]);var Vn=2.5*er;if(N){var ti=on.map(function(Iu){return Xr(Iu,N)});on=ti.some(function(Iu){return Iu.signedDistanceFromCamera<=0})?[]:ti.map(function(Iu){return Iu.point})}var Zn=[];if(on.length>0){for(var Nn=on[0].clone(),On=on[0].clone(),An=1;An<on.length;An++)Nn.x=Math.min(Nn.x,on[An].x),Nn.y=Math.min(Nn.y,on[An].y),On.x=Math.max(On.x,on[An].x),On.y=Math.max(On.y,on[An].y);Zn=Nn.x>=br.x&&On.x<=fr.x&&Nn.y>=br.y&&On.y<=fr.y?[on]:On.x<br.x||Nn.x>fr.x||On.y<br.y||Nn.y>fr.y?[]:s.clipLine([on],br.x,br.y,fr.x,fr.y)}for(var mn=0,Mo=Zn;mn<Mo.length;mn+=1){var Ca;zr.reset(Mo[mn],.25*er),Ca=zr.length<=.5*er?1:Math.ceil(zr.paddedLength/Vn)+1;for(var nu=0;nu<Ca;nu++){var ws=nu/Math.max(Ca-1,1),Es=zr.lerp(ws),Ia=Es.x+100,iu=Es.y+100;Xt.push(Ia,iu,er,0);var cl=Ia-er,ks=iu-er,yu=Ia+er,hl=iu+er;if(We=We&&this.isOffscreen(cl,ks,yu,hl),Fe=Fe||this.isInsideGrid(cl,ks,yu,hl),!l&&this.grid.hitTestCircle(Ia,iu,er,yt)&&(Ue=!0,!G))return{circles:[],offscreen:!1,collisionDetected:Ue}}}}return{circles:!G&&Ue||!Fe?[]:Xt,offscreen:We,collisionDetected:Ue}},go.prototype.queryRenderedSymbols=function(l){if(0===l.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};for(var f=[],c=1/0,m=1/0,E=-1/0,M=-1/0,T=0,N=l;T<N.length;T+=1){var G=N[T],Q=new s.Point(G.x+100,G.y+100);c=Math.min(c,Q.x),m=Math.min(m,Q.y),E=Math.max(E,Q.x),M=Math.max(M,Q.y),f.push(Q)}for(var yt={},Et={},_t=0,Xt=this.grid.query(c,m,E,M).concat(this.ignoredGrid.query(c,m,E,M));_t<Xt.length;_t+=1){var Gt=Xt[_t],ie=Gt.key;if(void 0===yt[ie.bucketInstanceId]&&(yt[ie.bucketInstanceId]={}),!yt[ie.bucketInstanceId][ie.featureIndex]){var Zt=[new s.Point(Gt.x1,Gt.y1),new s.Point(Gt.x2,Gt.y1),new s.Point(Gt.x2,Gt.y2),new s.Point(Gt.x1,Gt.y2)];s.polygonIntersectsPolygon(f,Zt)&&(yt[ie.bucketInstanceId][ie.featureIndex]=!0,void 0===Et[ie.bucketInstanceId]&&(Et[ie.bucketInstanceId]=[]),Et[ie.bucketInstanceId].push(ie.featureIndex))}}return Et},go.prototype.insertCollisionBox=function(l,f,c,m,E){(f?this.ignoredGrid:this.grid).insert({bucketInstanceId:c,featureIndex:m,collisionGroupID:E},l[0],l[1],l[2],l[3])},go.prototype.insertCollisionCircles=function(l,f,c,m,E){for(var M=f?this.ignoredGrid:this.grid,T={bucketInstanceId:c,featureIndex:m,collisionGroupID:E},N=0;N<l.length;N+=4)M.insertCircle(T,l[N],l[N+1],l[N+2])},go.prototype.projectAndGetPerspectiveRatio=function(l,f,c){var m=[f,c,0,1];return Bn(m,m,l),{point:new s.Point((m[0]/m[3]+1)/2*this.transform.width+100,(-m[1]/m[3]+1)/2*this.transform.height+100),perspectiveRatio:.5+this.transform.cameraToCenterDistance/m[3]*.5}},go.prototype.isOffscreen=function(l,f,c,m){return c<100||l>=this.screenRightBoundary||m<100||f>this.screenBottomBoundary},go.prototype.isInsideGrid=function(l,f,c,m){return c>=0&&l<this.gridRightBoundary&&m>=0&&f<this.gridBottomBoundary},go.prototype.getViewportMatrix=function(){var l=s.identity([]);return s.translate(l,l,[-100,-100,0]),l};var La=function(l,f,c,m){this.opacity=l?Math.max(0,Math.min(1,l.opacity+(l.placed?f:-f))):m&&c?1:0,this.placed=c};La.prototype.isHidden=function(){return 0===this.opacity&&!this.placed};var wn=function(l,f,c,m,E){this.text=new La(l?l.text:null,f,c,E),this.icon=new La(l?l.icon:null,f,m,E)};wn.prototype.isHidden=function(){return this.text.isHidden()&&this.icon.isHidden()};var Tu=function(l,f,c){this.text=l,this.icon=f,this.skipFade=c},El=function(){this.invProjMatrix=s.create(),this.viewportMatrix=s.create(),this.circles=[]},L=function(l,f,c,m,E){this.bucketInstanceId=l,this.featureIndex=f,this.sourceLayerIndex=c,this.bucketIndex=m,this.tileID=E},U=function(l){this.crossSourceCollisions=l,this.maxGroupID=0,this.collisionGroups={}};function ct(l,f,c,m,E){var M=s.getAnchorAlignment(l),T=-(M.horizontalAlign-.5)*f,N=-(M.verticalAlign-.5)*c,G=s.evaluateVariableOffset(l,m);return new s.Point(T+G[0]*E,N+G[1]*E)}function oe(l,f,c,m,E,M){var T=l.x1,N=l.x2,G=l.y1,Q=l.y2,yt=l.anchorPointX,Et=l.anchorPointY,_t=new s.Point(f,c);return m&&_t._rotate(E?M:-M),{x1:T+_t.x,y1:G+_t.y,x2:N+_t.x,y2:Q+_t.y,anchorPointX:yt,anchorPointY:Et}}U.prototype.get=function(l){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[l]){var f=++this.maxGroupID;this.collisionGroups[l]={ID:f,predicate:function(c){return c.collisionGroupID===f}}}return this.collisionGroups[l]};var Se=function(l,f,c,m){this.transform=l.clone(),this.collisionIndex=new go(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=f,this.retainedQueryData={},this.collisionGroups=new U(c),this.collisionCircleArrays={},this.prevPlacement=m,m&&(m.prevPlacement=void 0),this.placedOrientations={}};function Bt(l,f,c,m,E){l.emplaceBack(f?1:0,c?1:0,m||0,E||0),l.emplaceBack(f?1:0,c?1:0,m||0,E||0),l.emplaceBack(f?1:0,c?1:0,m||0,E||0),l.emplaceBack(f?1:0,c?1:0,m||0,E||0)}Se.prototype.getBucketParts=function(l,f,c,m){var E=c.getBucket(f),M=c.latestFeatureIndex;if(E&&M&&f.id===E.layerIds[0]){var T=c.collisionBoxArray,N=E.layers[0].layout,G=Math.pow(2,this.transform.zoom-c.tileID.overscaledZ),Q=c.tileSize/s.EXTENT,yt=this.transform.calculatePosMatrix(c.tileID.toUnwrapped()),Et="map"===N.get("text-pitch-alignment"),_t="map"===N.get("text-rotation-alignment"),Xt=Bo(c,1,this.transform.zoom),Gt=co(yt,Et,_t,this.transform,Xt),ie=null;if(Et){var Zt=ni(yt,Et,_t,this.transform,Xt);ie=s.multiply([],this.transform.labelPlaneMatrix,Zt)}this.retainedQueryData[E.bucketInstanceId]=new L(E.bucketInstanceId,M,E.sourceLayerIndex,E.index,c.tileID);var ne={bucket:E,layout:N,posMatrix:yt,textLabelPlaneMatrix:Gt,labelToScreenMatrix:ie,scale:G,textPixelRatio:Q,holdingForFade:c.holdingForFade(),collisionBoxArray:T,partiallyEvaluatedTextSize:s.evaluateSizeForZoom(E.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(E.sourceID)};if(m)for(var ge=0,Ee=E.sortKeyRanges;ge<Ee.length;ge+=1){var Ue=Ee[ge];l.push({sortKey:Ue.sortKey,symbolInstanceStart:Ue.symbolInstanceStart,symbolInstanceEnd:Ue.symbolInstanceEnd,parameters:ne})}else l.push({symbolInstanceStart:0,symbolInstanceEnd:E.symbolInstances.length,parameters:ne})}},Se.prototype.attemptAnchorPlacement=function(l,f,c,m,E,M,T,N,G,Q,yt,Et,_t,Xt,Gt){var ie,Zt=[Et.textOffset0,Et.textOffset1],ne=ct(l,c,m,Zt,E),ge=this.collisionIndex.placeCollisionBox(oe(f,ne.x,ne.y,M,T,this.transform.angle),yt,N,G,Q.predicate);if(!Gt||0!==this.collisionIndex.placeCollisionBox(oe(Gt,ne.x,ne.y,M,T,this.transform.angle),yt,N,G,Q.predicate).box.length)return ge.box.length>0?(this.prevPlacement&&this.prevPlacement.variableOffsets[Et.crossTileID]&&this.prevPlacement.placements[Et.crossTileID]&&this.prevPlacement.placements[Et.crossTileID].text&&(ie=this.prevPlacement.variableOffsets[Et.crossTileID].anchor),this.variableOffsets[Et.crossTileID]={textOffset:Zt,width:c,height:m,anchor:l,textBoxScale:E,prevAnchor:ie},this.markUsedJustification(_t,l,Et,Xt),_t.allowVerticalPlacement&&(this.markUsedOrientation(_t,Xt,Et),this.placedOrientations[Et.crossTileID]=Xt),{shift:ne,placedGlyphBoxes:ge}):void 0},Se.prototype.placeLayerBucketPart=function(l,f,c){var m=this,E=l.parameters,M=E.bucket,T=E.layout,N=E.posMatrix,G=E.textLabelPlaneMatrix,Q=E.labelToScreenMatrix,yt=E.textPixelRatio,Et=E.holdingForFade,_t=E.collisionBoxArray,Xt=E.partiallyEvaluatedTextSize,Gt=E.collisionGroup,ie=T.get("text-optional"),Zt=T.get("icon-optional"),ne=T.get("text-allow-overlap"),ge=T.get("icon-allow-overlap"),Ee="map"===T.get("text-rotation-alignment"),Ue="map"===T.get("text-pitch-alignment"),Fe="none"!==T.get("icon-text-fit"),We="viewport-y"===T.get("symbol-z-order"),er=ne&&(ge||!M.hasIconData()||Zt),br=ge&&(ne||!M.hasTextData()||ie);!M.collisionArrays&&_t&&M.deserializeCollisionBoxes(_t);var fr=function(Gr,Vn){if(!f[Gr.crossTileID])if(Et)m.placements[Gr.crossTileID]=new Tu(!1,!1,!1);else{var ti,Zn=!1,Nn=!1,On=!0,An=null,mn={box:null,offscreen:null},Mo={box:null,offscreen:null},Ca=null,nu=null,ws=0,Es=0,Ia=0;Vn.textFeatureIndex?ws=Vn.textFeatureIndex:Gr.useRuntimeCollisionCircles&&(ws=Gr.featureIndex),Vn.verticalTextFeatureIndex&&(Es=Vn.verticalTextFeatureIndex);var iu=Vn.textBox;if(iu){var cl=function(Ya){var Na=s.WritingMode.horizontal;if(M.allowVerticalPlacement&&!Ya&&m.prevPlacement){var vu=m.prevPlacement.placedOrientations[Gr.crossTileID];vu&&(m.placedOrientations[Gr.crossTileID]=vu,m.markUsedOrientation(M,Na=vu,Gr))}return Na},ks=function(Ya,Na){if(M.allowVerticalPlacement&&Gr.numVerticalGlyphVertices>0&&Vn.verticalTextBox)for(var vu=0,Pl=M.writingModes;vu<Pl.length&&(Pl[vu]===s.WritingMode.vertical?(mn=Na(),Mo=mn):mn=Ya(),!(mn&&mn.box&&mn.box.length));vu+=1);else mn=Ya()};if(T.get("text-variable-anchor")){var yu=T.get("text-variable-anchor");if(m.prevPlacement&&m.prevPlacement.variableOffsets[Gr.crossTileID]){var hl=m.prevPlacement.variableOffsets[Gr.crossTileID];yu.indexOf(hl.anchor)>0&&(yu=yu.filter(function(Ya){return Ya!==hl.anchor})).unshift(hl.anchor)}var Iu=function(Ya,Na,vu){for(var Pl=Ya.x2-Ya.x1,pc=Ya.y2-Ya.y1,Ch=Gr.textBoxScale,Kc=Fe&&!ge?Na:null,Pc={box:[],offscreen:!1},Ih=ne?2*yu.length:yu.length,Hl=0;Hl<Ih;++Hl){var Qu=m.attemptAnchorPlacement(yu[Hl%yu.length],Ya,Pl,pc,Ch,Ee,Ue,yt,N,Gt,Hl>=yu.length,Gr,M,vu,Kc);if(Qu&&(Pc=Qu.placedGlyphBoxes)&&Pc.box&&Pc.box.length){Zn=!0,An=Qu.shift;break}}return Pc};ks(function(){return Iu(iu,Vn.iconBox,s.WritingMode.horizontal)},function(){var Ya=Vn.verticalTextBox;return M.allowVerticalPlacement&&!(mn&&mn.box&&mn.box.length)&&Gr.numVerticalGlyphVertices>0&&Ya?Iu(Ya,Vn.verticalIconBox,s.WritingMode.vertical):{box:null,offscreen:null}}),mn&&(Zn=mn.box,On=mn.offscreen);var Sh=cl(mn&&mn.box);if(!Zn&&m.prevPlacement){var kl=m.prevPlacement.variableOffsets[Gr.crossTileID];kl&&(m.variableOffsets[Gr.crossTileID]=kl,m.markUsedJustification(M,kl.anchor,Gr,Sh))}}else{var Nl=function(Ya,Na){var vu=m.collisionIndex.placeCollisionBox(Ya,ne,yt,N,Gt.predicate);return vu&&vu.box&&vu.box.length&&(m.markUsedOrientation(M,Na,Gr),m.placedOrientations[Gr.crossTileID]=Na),vu};ks(function(){return Nl(iu,s.WritingMode.horizontal)},function(){var Ya=Vn.verticalTextBox;return M.allowVerticalPlacement&&Gr.numVerticalGlyphVertices>0&&Ya?Nl(Ya,s.WritingMode.vertical):{box:null,offscreen:null}}),cl(mn&&mn.box&&mn.box.length)}}if(Zn=(ti=mn)&&ti.box&&ti.box.length>0,On=ti&&ti.offscreen,Gr.useRuntimeCollisionCircles){var Yl=M.text.placedSymbolArray.get(Gr.centerJustifiedTextSymbolIndex),Ic=s.evaluateSizeForFeature(M.textSizeData,Xt,Yl),Jl=T.get("text-padding");Ca=m.collisionIndex.placeCollisionCircles(ne,Yl,M.lineVertexArray,M.glyphOffsetArray,Ic,N,G,Q,c,Ue,Gt.predicate,Gr.collisionCircleDiameter,Jl),Zn=ne||Ca.circles.length>0&&!Ca.collisionDetected,On=On&&Ca.offscreen}if(Vn.iconFeatureIndex&&(Ia=Vn.iconFeatureIndex),Vn.iconBox){var pl=function(Ya){var Na=Fe&&An?oe(Ya,An.x,An.y,Ee,Ue,m.transform.angle):Ya;return m.collisionIndex.placeCollisionBox(Na,ge,yt,N,Gt.predicate)};Nn=Mo&&Mo.box&&Mo.box.length&&Vn.verticalIconBox?(nu=pl(Vn.verticalIconBox)).box.length>0:(nu=pl(Vn.iconBox)).box.length>0,On=On&&nu.offscreen}var hc=ie||0===Gr.numHorizontalGlyphVertices&&0===Gr.numVerticalGlyphVertices,Xa=Zt||0===Gr.numIconVertices;if(hc||Xa?Xa?hc||(Nn=Nn&&Zn):Zn=Nn&&Zn:Nn=Zn=Nn&&Zn,Zn&&ti&&ti.box&&m.collisionIndex.insertCollisionBox(ti.box,T.get("text-ignore-placement"),M.bucketInstanceId,Mo&&Mo.box&&Es?Es:ws,Gt.ID),Nn&&nu&&m.collisionIndex.insertCollisionBox(nu.box,T.get("icon-ignore-placement"),M.bucketInstanceId,Ia,Gt.ID),Ca&&(Zn&&m.collisionIndex.insertCollisionCircles(Ca.circles,T.get("text-ignore-placement"),M.bucketInstanceId,ws,Gt.ID),c)){var fl=M.bucketInstanceId,Ku=m.collisionCircleArrays[fl];void 0===Ku&&(Ku=m.collisionCircleArrays[fl]=new El);for(var $u=0;$u<Ca.circles.length;$u+=4)Ku.circles.push(Ca.circles[$u+0]),Ku.circles.push(Ca.circles[$u+1]),Ku.circles.push(Ca.circles[$u+2]),Ku.circles.push(Ca.collisionDetected?1:0)}m.placements[Gr.crossTileID]=new Tu(Zn||er,Nn||br,On||M.justReloaded),f[Gr.crossTileID]=!0}};if(We)for(var zr=M.getSortedSymbolIndexes(this.transform.angle),nn=zr.length-1;nn>=0;--nn){var sn=zr[nn];fr(M.symbolInstances.get(sn),M.collisionArrays[sn])}else for(var on=l.symbolInstanceStart;on<l.symbolInstanceEnd;on++)fr(M.symbolInstances.get(on),M.collisionArrays[on]);if(c&&M.bucketInstanceId in this.collisionCircleArrays){var wi=this.collisionCircleArrays[M.bucketInstanceId];s.invert(wi.invProjMatrix,N),wi.viewportMatrix=this.collisionIndex.getViewportMatrix()}M.justReloaded=!1},Se.prototype.markUsedJustification=function(l,f,c,m){var E;E=m===s.WritingMode.vertical?c.verticalPlacedTextSymbolIndex:{left:c.leftJustifiedTextSymbolIndex,center:c.centerJustifiedTextSymbolIndex,right:c.rightJustifiedTextSymbolIndex}[s.getAnchorJustification(f)];for(var M=0,T=[c.leftJustifiedTextSymbolIndex,c.centerJustifiedTextSymbolIndex,c.rightJustifiedTextSymbolIndex,c.verticalPlacedTextSymbolIndex];M<T.length;M+=1){var N=T[M];N>=0&&(l.text.placedSymbolArray.get(N).crossTileID=E>=0&&N!==E?0:c.crossTileID)}},Se.prototype.markUsedOrientation=function(l,f,c){for(var m=f===s.WritingMode.horizontal||f===s.WritingMode.horizontalOnly?f:0,E=f===s.WritingMode.vertical?f:0,M=0,T=[c.leftJustifiedTextSymbolIndex,c.centerJustifiedTextSymbolIndex,c.rightJustifiedTextSymbolIndex];M<T.length;M+=1)l.text.placedSymbolArray.get(T[M]).placedOrientation=m;c.verticalPlacedTextSymbolIndex&&(l.text.placedSymbolArray.get(c.verticalPlacedTextSymbolIndex).placedOrientation=E)},Se.prototype.commit=function(l){this.commitTime=l,this.zoomAtLastRecencyCheck=this.transform.zoom;var f=this.prevPlacement,c=!1;this.prevZoomAdjustment=f?f.zoomAdjustment(this.transform.zoom):0;var m=f?f.symbolFadeChange(l):1,E=f?f.opacities:{},M=f?f.variableOffsets:{},T=f?f.placedOrientations:{};for(var N in this.placements){var G=this.placements[N],Q=E[N];Q?(this.opacities[N]=new wn(Q,m,G.text,G.icon),c=c||G.text!==Q.text.placed||G.icon!==Q.icon.placed):(this.opacities[N]=new wn(null,m,G.text,G.icon,G.skipFade),c=c||G.text||G.icon)}for(var yt in E){var Et=E[yt];if(!this.opacities[yt]){var _t=new wn(Et,m,!1,!1);_t.isHidden()||(this.opacities[yt]=_t,c=c||Et.text.placed||Et.icon.placed)}}for(var Xt in M)this.variableOffsets[Xt]||!this.opacities[Xt]||this.opacities[Xt].isHidden()||(this.variableOffsets[Xt]=M[Xt]);for(var Gt in T)this.placedOrientations[Gt]||!this.opacities[Gt]||this.opacities[Gt].isHidden()||(this.placedOrientations[Gt]=T[Gt]);c?this.lastPlacementChangeTime=l:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=f?f.lastPlacementChangeTime:l)},Se.prototype.updateLayerOpacities=function(l,f){for(var c={},m=0,E=f;m<E.length;m+=1){var M=E[m],T=M.getBucket(l);T&&M.latestFeatureIndex&&l.id===T.layerIds[0]&&this.updateBucketOpacities(T,c,M.collisionBoxArray)}},Se.prototype.updateBucketOpacities=function(l,f,c){var m=this;l.hasTextData()&&l.text.opacityVertexArray.clear(),l.hasIconData()&&l.icon.opacityVertexArray.clear(),l.hasIconCollisionBoxData()&&l.iconCollisionBox.collisionVertexArray.clear(),l.hasTextCollisionBoxData()&&l.textCollisionBox.collisionVertexArray.clear();var E=l.layers[0].layout,M=new wn(null,0,!1,!1,!0),T=E.get("text-allow-overlap"),N=E.get("icon-allow-overlap"),G=E.get("text-variable-anchor"),Q="map"===E.get("text-rotation-alignment"),yt="map"===E.get("text-pitch-alignment"),Et="none"!==E.get("icon-text-fit"),_t=new wn(null,0,T&&(N||!l.hasIconData()||E.get("icon-optional")),N&&(T||!l.hasTextData()||E.get("text-optional")),!0);!l.collisionArrays&&c&&(l.hasIconCollisionBoxData()||l.hasTextCollisionBoxData())&&l.deserializeCollisionBoxes(c);for(var Xt=function(ne,ge,Ee){for(var Ue=0;Ue<ge/4;Ue++)ne.opacityVertexArray.emplaceBack(Ee)},Gt=function(ne){var ge=l.symbolInstances.get(ne),Ee=ge.numHorizontalGlyphVertices,Ue=ge.numVerticalGlyphVertices,Fe=ge.crossTileID,We=m.opacities[Fe];f[Fe]?We=M:We||(m.opacities[Fe]=We=_t),f[Fe]=!0;var er=ge.numIconVertices>0,br=m.placedOrientations[ge.crossTileID],fr=br===s.WritingMode.vertical,zr=br===s.WritingMode.horizontal||br===s.WritingMode.horizontalOnly;if(Ee>0||Ue>0){var nn=Rr(We.text);Xt(l.text,Ee,fr?Cn:nn),Xt(l.text,Ue,zr?Cn:nn);var sn=We.text.isHidden();[ge.rightJustifiedTextSymbolIndex,ge.centerJustifiedTextSymbolIndex,ge.leftJustifiedTextSymbolIndex].forEach(function(mn){mn>=0&&(l.text.placedSymbolArray.get(mn).hidden=sn||fr?1:0)}),ge.verticalPlacedTextSymbolIndex>=0&&(l.text.placedSymbolArray.get(ge.verticalPlacedTextSymbolIndex).hidden=sn||zr?1:0);var on=m.variableOffsets[ge.crossTileID];on&&m.markUsedJustification(l,on.anchor,ge,br);var wi=m.placedOrientations[ge.crossTileID];wi&&(m.markUsedJustification(l,"left",ge,wi),m.markUsedOrientation(l,wi,ge))}if(er){var Gr=Rr(We.icon),Vn=!(Et&&ge.verticalPlacedIconSymbolIndex&&fr);ge.placedIconSymbolIndex>=0&&(Xt(l.icon,ge.numIconVertices,Vn?Gr:Cn),l.icon.placedSymbolArray.get(ge.placedIconSymbolIndex).hidden=We.icon.isHidden()),ge.verticalPlacedIconSymbolIndex>=0&&(Xt(l.icon,ge.numVerticalIconVertices,Vn?Cn:Gr),l.icon.placedSymbolArray.get(ge.verticalPlacedIconSymbolIndex).hidden=We.icon.isHidden())}if(l.hasIconCollisionBoxData()||l.hasTextCollisionBoxData()){var ti=l.collisionArrays[ne];if(ti){var Zn=new s.Point(0,0);if(ti.textBox||ti.verticalTextBox){var Nn=!0;if(G){var On=m.variableOffsets[Fe];On?(Zn=ct(On.anchor,On.width,On.height,On.textOffset,On.textBoxScale),Q&&Zn._rotate(yt?m.transform.angle:-m.transform.angle)):Nn=!1}ti.textBox&&Bt(l.textCollisionBox.collisionVertexArray,We.text.placed,!Nn||fr,Zn.x,Zn.y),ti.verticalTextBox&&Bt(l.textCollisionBox.collisionVertexArray,We.text.placed,!Nn||zr,Zn.x,Zn.y)}var An=Boolean(!zr&&ti.verticalIconBox);ti.iconBox&&Bt(l.iconCollisionBox.collisionVertexArray,We.icon.placed,An,Et?Zn.x:0,Et?Zn.y:0),ti.verticalIconBox&&Bt(l.iconCollisionBox.collisionVertexArray,We.icon.placed,!An,Et?Zn.x:0,Et?Zn.y:0)}}},ie=0;ie<l.symbolInstances.length;ie++)Gt(ie);if(l.sortFeatures(this.transform.angle),this.retainedQueryData[l.bucketInstanceId]&&(this.retainedQueryData[l.bucketInstanceId].featureSortOrder=l.featureSortOrder),l.hasTextData()&&l.text.opacityVertexBuffer&&l.text.opacityVertexBuffer.updateData(l.text.opacityVertexArray),l.hasIconData()&&l.icon.opacityVertexBuffer&&l.icon.opacityVertexBuffer.updateData(l.icon.opacityVertexArray),l.hasIconCollisionBoxData()&&l.iconCollisionBox.collisionVertexBuffer&&l.iconCollisionBox.collisionVertexBuffer.updateData(l.iconCollisionBox.collisionVertexArray),l.hasTextCollisionBoxData()&&l.textCollisionBox.collisionVertexBuffer&&l.textCollisionBox.collisionVertexBuffer.updateData(l.textCollisionBox.collisionVertexArray),l.bucketInstanceId in this.collisionCircleArrays){var Zt=this.collisionCircleArrays[l.bucketInstanceId];l.placementInvProjMatrix=Zt.invProjMatrix,l.placementViewportMatrix=Zt.viewportMatrix,l.collisionCircleArray=Zt.circles,delete this.collisionCircleArrays[l.bucketInstanceId]}},Se.prototype.symbolFadeChange=function(l){return 0===this.fadeDuration?1:(l-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment},Se.prototype.zoomAdjustment=function(l){return Math.max(0,(this.transform.zoom-l)/1.5)},Se.prototype.hasTransitions=function(l){return this.stale||l-this.lastPlacementChangeTime<this.fadeDuration},Se.prototype.stillRecent=function(l,f){var c=this.zoomAtLastRecencyCheck===f?1-this.zoomAdjustment(f):1;return this.zoomAtLastRecencyCheck=f,this.commitTime+this.fadeDuration*c>l},Se.prototype.setStale=function(){this.stale=!0};var Te=Math.pow(2,25),ur=Math.pow(2,24),ar=Math.pow(2,17),kr=Math.pow(2,16),Ae=Math.pow(2,9),or=Math.pow(2,8),lr=Math.pow(2,1);function Rr(l){if(0===l.opacity&&!l.placed)return 0;if(1===l.opacity&&l.placed)return 4294967295;var f=l.placed?1:0,c=Math.floor(127*l.opacity);return c*Te+f*ur+c*ar+f*kr+c*Ae+f*or+c*lr+f}var Cn=0,Jo=function(l){this._sortAcrossTiles="viewport-y"!==l.layout.get("symbol-z-order")&&!l.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]};Jo.prototype.continuePlacement=function(l,f,c,m,E){for(var M=this._bucketParts;this._currentTileIndex<l.length;)if(f.getBucketParts(M,m,l[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,E())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,M.sort(function(T,N){return T.sortKey-N.sortKey}));this._currentPartIndex<M.length;)if(f.placeLayerBucketPart(M[this._currentPartIndex],this._seenCrossTileIDs,c),this._currentPartIndex++,E())return!0;return!1};var $e=function(l,f,c,m,E,M,T){this.placement=new Se(l,E,M,T),this._currentPlacementIndex=f.length-1,this._forceFullPlacement=c,this._showCollisionBoxes=m,this._done=!1};$e.prototype.isDone=function(){return this._done},$e.prototype.continuePlacement=function(l,f,c){for(var m=this,E=s.browser.now(),M=function(){var G=s.browser.now()-E;return!m._forceFullPlacement&&G>2};this._currentPlacementIndex>=0;){var T=f[l[this._currentPlacementIndex]],N=this.placement.collisionIndex.transform.zoom;if("symbol"===T.type&&(!T.minzoom||T.minzoom<=N)&&(!T.maxzoom||T.maxzoom>N)){if(this._inProgressLayer||(this._inProgressLayer=new Jo(T)),this._inProgressLayer.continuePlacement(c[T.source],this.placement,this._showCollisionBoxes,T,M))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0},$e.prototype.commit=function(l){return this.placement.commit(l),this.placement};var Vr=512/s.EXTENT/2,Kn=function(l,f,c){this.tileID=l,this.indexedSymbolInstances={},this.bucketInstanceId=c;for(var m=0;m<f.length;m++){var E=f.get(m),M=E.key;this.indexedSymbolInstances[M]||(this.indexedSymbolInstances[M]=[]),this.indexedSymbolInstances[M].push({crossTileID:E.crossTileID,coord:this.getScaledCoordinates(E,l)})}};Kn.prototype.getScaledCoordinates=function(l,f){var c=Vr/Math.pow(2,f.canonical.z-this.tileID.canonical.z);return{x:Math.floor((f.canonical.x*s.EXTENT+l.anchorX)*c),y:Math.floor((f.canonical.y*s.EXTENT+l.anchorY)*c)}},Kn.prototype.findMatches=function(l,f,c){for(var m=this.tileID.canonical.z<f.canonical.z?1:Math.pow(2,this.tileID.canonical.z-f.canonical.z),E=0;E<l.length;E++){var M=l.get(E);if(!M.crossTileID){var T=this.indexedSymbolInstances[M.key];if(T)for(var N=this.getScaledCoordinates(M,f),G=0,Q=T;G<Q.length;G+=1){var yt=Q[G];if(Math.abs(yt.coord.x-N.x)<=m&&Math.abs(yt.coord.y-N.y)<=m&&!c[yt.crossTileID]){c[yt.crossTileID]=!0,M.crossTileID=yt.crossTileID;break}}}}};var rn=function(){this.maxCrossTileID=0};rn.prototype.generate=function(){return++this.maxCrossTileID};var ci=function(){this.indexes={},this.usedCrossTileIDs={},this.lng=0};ci.prototype.handleWrapJump=function(l){var f=Math.round((l-this.lng)/360);if(0!==f)for(var c in this.indexes){var m=this.indexes[c],E={};for(var M in m){var T=m[M];T.tileID=T.tileID.unwrapTo(T.tileID.wrap+f),E[T.tileID.key]=T}this.indexes[c]=E}this.lng=l},ci.prototype.addBucket=function(l,f,c){if(this.indexes[l.overscaledZ]&&this.indexes[l.overscaledZ][l.key]){if(this.indexes[l.overscaledZ][l.key].bucketInstanceId===f.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(l.overscaledZ,this.indexes[l.overscaledZ][l.key])}for(var m=0;m<f.symbolInstances.length;m++)f.symbolInstances.get(m).crossTileID=0;this.usedCrossTileIDs[l.overscaledZ]||(this.usedCrossTileIDs[l.overscaledZ]={});var E=this.usedCrossTileIDs[l.overscaledZ];for(var M in this.indexes){var T=this.indexes[M];if(Number(M)>l.overscaledZ)for(var N in T){var G=T[N];G.tileID.isChildOf(l)&&G.findMatches(f.symbolInstances,l,E)}else{var Q=T[l.scaledTo(Number(M)).key];Q&&Q.findMatches(f.symbolInstances,l,E)}}for(var yt=0;yt<f.symbolInstances.length;yt++){var Et=f.symbolInstances.get(yt);Et.crossTileID||(Et.crossTileID=c.generate(),E[Et.crossTileID]=!0)}return void 0===this.indexes[l.overscaledZ]&&(this.indexes[l.overscaledZ]={}),this.indexes[l.overscaledZ][l.key]=new Kn(l,f.symbolInstances,f.bucketInstanceId),!0},ci.prototype.removeBucketCrossTileIDs=function(l,f){for(var c in f.indexedSymbolInstances)for(var m=0,E=f.indexedSymbolInstances[c];m<E.length;m+=1)delete this.usedCrossTileIDs[l][E[m].crossTileID]},ci.prototype.removeStaleBuckets=function(l){var f=!1;for(var c in this.indexes){var m=this.indexes[c];for(var E in m)l[m[E].bucketInstanceId]||(this.removeBucketCrossTileIDs(c,m[E]),delete m[E],f=!0)}return f};var Cr=function(){this.layerIndexes={},this.crossTileIDs=new rn,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}};Cr.prototype.addLayer=function(l,f,c){var m=this.layerIndexes[l.id];void 0===m&&(m=this.layerIndexes[l.id]=new ci);var E=!1,M={};m.handleWrapJump(c);for(var T=0,N=f;T<N.length;T+=1){var G=N[T],Q=G.getBucket(l);Q&&l.id===Q.layerIds[0]&&(Q.bucketInstanceId||(Q.bucketInstanceId=++this.maxBucketInstanceId),m.addBucket(G.tileID,Q,this.crossTileIDs)&&(E=!0),M[Q.bucketInstanceId]=!0)}return m.removeStaleBuckets(M)&&(E=!0),E},Cr.prototype.pruneUnusedLayers=function(l){var f={};for(var c in l.forEach(function(m){f[m]=!0}),this.layerIndexes)f[c]||delete this.layerIndexes[c]};var us=function(l,f){return s.emitValidationErrors(l,f&&f.filter(function(c){return"source.canvas"!==c.identifier}))},ls=s.pick(Ke,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),qr=s.pick(Ke,["setCenter","setZoom","setBearing","setPitch"]),Bi=function(){var l={},f=s.styleSpec.$version;for(var c in s.styleSpec.$root){var m,E=s.styleSpec.$root[c];E.required&&null!=(m="version"===c?f:"array"===E.type?[]:{})&&(l[c]=m)}return l}(),xo=function(l){function f(c,m){var E=this;void 0===m&&(m={}),l.call(this),this.map=c,this.dispatcher=new kt(Ar(),this),this.imageManager=new j,this.imageManager.setEventedParent(this),this.glyphManager=new et(c._requestManager,m.localIdeographFontFamily),this.lineAtlas=new St(256,512),this.crossTileSymbolIndex=new Cr,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new s.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",s.getReferrer());var M=this;this._rtlTextPluginCallback=f.registerForPluginStateChange(function(T){M.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:T.pluginStatus,pluginURL:T.pluginURL},function(N,G){if(s.triggerPluginCompletionEvent(N),G&&G.every(function(yt){return yt}))for(var Q in M.sourceCaches)M.sourceCaches[Q].reload()})}),this.on("data",function(T){if("source"===T.dataType&&"metadata"===T.sourceDataType){var N=E.sourceCaches[T.sourceId];if(N){var G=N.getSource();if(G&&G.vectorLayerIds)for(var Q in E._layers){var yt=E._layers[Q];yt.source===G.id&&E._validateLayer(yt)}}}})}return l&&(f.__proto__=l),(f.prototype=Object.create(l&&l.prototype)).constructor=f,f.prototype.loadURL=function(c,m){var E=this;void 0===m&&(m={}),this.fire(new s.Event("dataloading",{dataType:"style"}));var M="boolean"==typeof m.validate?m.validate:!s.isMapboxURL(c);c=this.map._requestManager.normalizeStyleURL(c,m.accessToken);var T=this.map._requestManager.transformRequest(c,s.ResourceType.Style);this._request=s.getJSON(T,function(N,G){E._request=null,N?E.fire(new s.ErrorEvent(N)):G&&E._load(G,M)})},f.prototype.loadJSON=function(c,m){var E=this;void 0===m&&(m={}),this.fire(new s.Event("dataloading",{dataType:"style"})),this._request=s.browser.frame(function(){E._request=null,E._load(c,!1!==m.validate)})},f.prototype.loadEmpty=function(){this.fire(new s.Event("dataloading",{dataType:"style"})),this._load(Bi,!1)},f.prototype._load=function(c,m){if(!m||!us(this,s.validateStyle(c))){for(var E in this._loaded=!0,this.stylesheet=c,c.sources)this.addSource(E,c.sources[E],{validate:!1});c.sprite?this._loadSprite(c.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(c.glyphs);var M=vr(this.stylesheet.layers);this._order=M.map(function(Q){return Q.id}),this._layers={},this._serializedLayers={};for(var T=0,N=M;T<N.length;T+=1){var G=N[T];(G=s.createStyleLayer(G)).setEventedParent(this,{layer:{id:G.id}}),this._layers[G.id]=G,this._serializedLayers[G.id]=G.serialize()}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new Wt(this.stylesheet.light),this.fire(new s.Event("data",{dataType:"style"})),this.fire(new s.Event("style.load"))}},f.prototype._loadSprite=function(c){var m=this;this._spriteRequest=function(E,M,T){var N,G,Q,yt=s.browser.devicePixelRatio>1?"@2x":"",Et=s.getJSON(M.transformRequest(M.normalizeSpriteURL(E,yt,".json"),s.ResourceType.SpriteJSON),function(Gt,ie){Et=null,Q||(Q=Gt,N=ie,Xt())}),_t=s.getImage(M.transformRequest(M.normalizeSpriteURL(E,yt,".png"),s.ResourceType.SpriteImage),function(Gt,ie){_t=null,Q||(Q=Gt,G=ie,Xt())});function Xt(){if(Q)T(Q);else if(N&&G){var Gt=s.browser.getImageData(G),ie={};for(var Zt in N){var ne=N[Zt],ge=ne.width,Ee=ne.height,Ue=ne.x,Fe=ne.y,We=ne.sdf,er=ne.pixelRatio,br=ne.stretchX,fr=ne.stretchY,zr=ne.content,nn=new s.RGBAImage({width:ge,height:Ee});s.RGBAImage.copy(Gt,nn,{x:Ue,y:Fe},{x:0,y:0},{width:ge,height:Ee}),ie[Zt]={data:nn,pixelRatio:er,sdf:We,stretchX:br,stretchY:fr,content:zr}}T(null,ie)}}return{cancel:function(){Et&&(Et.cancel(),Et=null),_t&&(_t.cancel(),_t=null)}}}(c,this.map._requestManager,function(E,M){if(m._spriteRequest=null,E)m.fire(new s.ErrorEvent(E));else if(M)for(var T in M)m.imageManager.addImage(T,M[T]);m.imageManager.setLoaded(!0),m._availableImages=m.imageManager.listImages(),m.dispatcher.broadcast("setImages",m._availableImages),m.fire(new s.Event("data",{dataType:"style"}))})},f.prototype._validateLayer=function(c){var m=this.sourceCaches[c.source];if(m){var E=c.sourceLayer;if(E){var M=m.getSource();("geojson"===M.type||M.vectorLayerIds&&-1===M.vectorLayerIds.indexOf(E))&&this.fire(new s.ErrorEvent(new Error('Source layer "'+E+'" does not exist on source "'+M.id+'" as specified by style layer "'+c.id+'"')))}}},f.prototype.loaded=function(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(var c in this.sourceCaches)if(!this.sourceCaches[c].loaded())return!1;return!!this.imageManager.isLoaded()},f.prototype._serializeLayers=function(c){for(var m=[],E=0,M=c;E<M.length;E+=1){var T=this._layers[M[E]];"custom"!==T.type&&m.push(T.serialize())}return m},f.prototype.hasTransitions=function(){if(this.light&&this.light.hasTransition())return!0;for(var c in this.sourceCaches)if(this.sourceCaches[c].hasTransition())return!0;for(var m in this._layers)if(this._layers[m].hasTransition())return!0;return!1},f.prototype._checkLoaded=function(){if(!this._loaded)throw new Error("Style is not done loading")},f.prototype.update=function(c){if(this._loaded){var m=this._changed;if(this._changed){var E=Object.keys(this._updatedLayers),M=Object.keys(this._removedLayers);for(var T in(E.length||M.length)&&this._updateWorkerLayers(E,M),this._updatedSources){var N=this._updatedSources[T];"reload"===N?this._reloadSource(T):"clear"===N&&this._clearSource(T)}for(var G in this._updateTilesForChangedImages(),this._updatedPaintProps)this._layers[G].updateTransitions(c);this.light.updateTransitions(c),this._resetUpdates()}var Q={};for(var yt in this.sourceCaches){var Et=this.sourceCaches[yt];Q[yt]=Et.used,Et.used=!1}for(var _t=0,Xt=this._order;_t<Xt.length;_t+=1){var Gt=this._layers[Xt[_t]];Gt.recalculate(c,this._availableImages),!Gt.isHidden(c.zoom)&&Gt.source&&(this.sourceCaches[Gt.source].used=!0)}for(var ie in Q){var Zt=this.sourceCaches[ie];Q[ie]!==Zt.used&&Zt.fire(new s.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:ie}))}this.light.recalculate(c),this.z=c.zoom,m&&this.fire(new s.Event("data",{dataType:"style"}))}},f.prototype._updateTilesForChangedImages=function(){var c=Object.keys(this._changedImages);if(c.length){for(var m in this.sourceCaches)this.sourceCaches[m].reloadTilesForDependencies(["icons","patterns"],c);this._changedImages={}}},f.prototype._updateWorkerLayers=function(c,m){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(c),removedIds:m})},f.prototype._resetUpdates=function(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}},f.prototype.setState=function(c){var m=this;if(this._checkLoaded(),us(this,s.validateStyle(c)))return!1;(c=s.clone$1(c)).layers=vr(c.layers);var E=function(T,N){if(!T)return[{command:Ke.setStyle,args:[N]}];var G=[];try{if(!s.deepEqual(T.version,N.version))return[{command:Ke.setStyle,args:[N]}];s.deepEqual(T.center,N.center)||G.push({command:Ke.setCenter,args:[N.center]}),s.deepEqual(T.zoom,N.zoom)||G.push({command:Ke.setZoom,args:[N.zoom]}),s.deepEqual(T.bearing,N.bearing)||G.push({command:Ke.setBearing,args:[N.bearing]}),s.deepEqual(T.pitch,N.pitch)||G.push({command:Ke.setPitch,args:[N.pitch]}),s.deepEqual(T.sprite,N.sprite)||G.push({command:Ke.setSprite,args:[N.sprite]}),s.deepEqual(T.glyphs,N.glyphs)||G.push({command:Ke.setGlyphs,args:[N.glyphs]}),s.deepEqual(T.transition,N.transition)||G.push({command:Ke.setTransition,args:[N.transition]}),s.deepEqual(T.light,N.light)||G.push({command:Ke.setLight,args:[N.light]});var Q={},yt=[];!function(_t,Xt,Gt,ie){var Zt;for(Zt in Xt=Xt||{},_t=_t||{})_t.hasOwnProperty(Zt)&&(Xt.hasOwnProperty(Zt)||$r(Zt,Gt,ie));for(Zt in Xt)Xt.hasOwnProperty(Zt)&&(_t.hasOwnProperty(Zt)?s.deepEqual(_t[Zt],Xt[Zt])||("geojson"===_t[Zt].type&&"geojson"===Xt[Zt].type&&Mn(_t,Xt,Zt)?Gt.push({command:Ke.setGeoJSONSourceData,args:[Zt,Xt[Zt].data]}):Lr(Zt,Xt,Gt,ie)):bn(Zt,Xt,Gt))}(T.sources,N.sources,yt,Q);var Et=[];T.layers&&T.layers.forEach(function(_t){Q[_t.source]?G.push({command:Ke.removeLayer,args:[_t.id]}):Et.push(_t)}),G=G.concat(yt),function(_t,Xt,Gt){Xt=Xt||[];var ie,Zt,ne,ge,Ee,Ue,Fe,We=(_t=_t||[]).map(Oi),er=Xt.map(Oi),br=_t.reduce(ai,{}),fr=Xt.reduce(ai,{}),zr=We.slice(),nn=Object.create(null);for(ie=0,Zt=0;ie<We.length;ie++)fr.hasOwnProperty(ne=We[ie])?Zt++:(Gt.push({command:Ke.removeLayer,args:[ne]}),zr.splice(zr.indexOf(ne,Zt),1));for(ie=0,Zt=0;ie<er.length;ie++)zr[zr.length-1-ie]!==(ne=er[er.length-1-ie])&&(br.hasOwnProperty(ne)?(Gt.push({command:Ke.removeLayer,args:[ne]}),zr.splice(zr.lastIndexOf(ne,zr.length-Zt),1)):Zt++,Gt.push({command:Ke.addLayer,args:[fr[ne],Ue=zr[zr.length-ie]]}),zr.splice(zr.length-ie,0,ne),nn[ne]=!0);for(ie=0;ie<er.length;ie++)if(ge=br[ne=er[ie]],Ee=fr[ne],!nn[ne]&&!s.deepEqual(ge,Ee))if(s.deepEqual(ge.source,Ee.source)&&s.deepEqual(ge["source-layer"],Ee["source-layer"])&&s.deepEqual(ge.type,Ee.type)){for(Fe in Nr(ge.layout,Ee.layout,Gt,ne,null,Ke.setLayoutProperty),Nr(ge.paint,Ee.paint,Gt,ne,null,Ke.setPaintProperty),s.deepEqual(ge.filter,Ee.filter)||Gt.push({command:Ke.setFilter,args:[ne,Ee.filter]}),s.deepEqual(ge.minzoom,Ee.minzoom)&&s.deepEqual(ge.maxzoom,Ee.maxzoom)||Gt.push({command:Ke.setLayerZoomRange,args:[ne,Ee.minzoom,Ee.maxzoom]}),ge)ge.hasOwnProperty(Fe)&&"layout"!==Fe&&"paint"!==Fe&&"filter"!==Fe&&"metadata"!==Fe&&"minzoom"!==Fe&&"maxzoom"!==Fe&&(0===Fe.indexOf("paint.")?Nr(ge[Fe],Ee[Fe],Gt,ne,Fe.slice(6),Ke.setPaintProperty):s.deepEqual(ge[Fe],Ee[Fe])||Gt.push({command:Ke.setLayerProperty,args:[ne,Fe,Ee[Fe]]}));for(Fe in Ee)Ee.hasOwnProperty(Fe)&&!ge.hasOwnProperty(Fe)&&"layout"!==Fe&&"paint"!==Fe&&"filter"!==Fe&&"metadata"!==Fe&&"minzoom"!==Fe&&"maxzoom"!==Fe&&(0===Fe.indexOf("paint.")?Nr(ge[Fe],Ee[Fe],Gt,ne,Fe.slice(6),Ke.setPaintProperty):s.deepEqual(ge[Fe],Ee[Fe])||Gt.push({command:Ke.setLayerProperty,args:[ne,Fe,Ee[Fe]]}))}else Gt.push({command:Ke.removeLayer,args:[ne]}),Ue=zr[zr.lastIndexOf(ne)+1],Gt.push({command:Ke.addLayer,args:[Ee,Ue]})}(Et,N.layers,G)}catch(_t){console.warn("Unable to compute style diff:",_t),G=[{command:Ke.setStyle,args:[N]}]}return G}(this.serialize(),c).filter(function(T){return!(T.command in qr)});if(0===E.length)return!1;var M=E.filter(function(T){return!(T.command in ls)});if(M.length>0)throw new Error("Unimplemented: "+M.map(function(T){return T.command}).join(", ")+".");return E.forEach(function(T){"setTransition"!==T.command&&m[T.command].apply(m,T.args)}),this.stylesheet=c,!0},f.prototype.addImage=function(c,m){if(this.getImage(c))return this.fire(new s.ErrorEvent(new Error("An image with this name already exists.")));this.imageManager.addImage(c,m),this._afterImageUpdated(c)},f.prototype.updateImage=function(c,m){this.imageManager.updateImage(c,m)},f.prototype.getImage=function(c){return this.imageManager.getImage(c)},f.prototype.removeImage=function(c){if(!this.getImage(c))return this.fire(new s.ErrorEvent(new Error("No image with this name exists.")));this.imageManager.removeImage(c),this._afterImageUpdated(c)},f.prototype._afterImageUpdated=function(c){this._availableImages=this.imageManager.listImages(),this._changedImages[c]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new s.Event("data",{dataType:"style"}))},f.prototype.listImages=function(){return this._checkLoaded(),this.imageManager.listImages()},f.prototype.addSource=function(c,m,E){var M=this;if(void 0===E&&(E={}),this._checkLoaded(),void 0!==this.sourceCaches[c])throw new Error("There is already a source with this ID");if(!m.type)throw new Error("The type property must be defined, but only the following properties were given: "+Object.keys(m).join(", ")+".");if(!(["vector","raster","geojson","video","image"].indexOf(m.type)>=0&&this._validate(s.validateStyle.source,"sources."+c,m,null,E))){this.map&&this.map._collectResourceTiming&&(m.collectResourceTiming=!0);var T=this.sourceCaches[c]=new Dt(c,m,this.dispatcher);T.style=this,T.setEventedParent(this,function(){return{isSourceLoaded:M.loaded(),source:T.serialize(),sourceId:c}}),T.onAdd(this.map),this._changed=!0}},f.prototype.removeSource=function(c){if(this._checkLoaded(),void 0===this.sourceCaches[c])throw new Error("There is no source with this ID");for(var m in this._layers)if(this._layers[m].source===c)return this.fire(new s.ErrorEvent(new Error('Source "'+c+'" cannot be removed while layer "'+m+'" is using it.')));var E=this.sourceCaches[c];delete this.sourceCaches[c],delete this._updatedSources[c],E.fire(new s.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:c})),E.setEventedParent(null),E.clearTiles(),E.onRemove&&E.onRemove(this.map),this._changed=!0},f.prototype.setGeoJSONSourceData=function(c,m){this._checkLoaded(),this.sourceCaches[c].getSource().setData(m),this._changed=!0},f.prototype.getSource=function(c){return this.sourceCaches[c]&&this.sourceCaches[c].getSource()},f.prototype.addLayer=function(c,m,E){void 0===E&&(E={}),this._checkLoaded();var M=c.id;if(this.getLayer(M))this.fire(new s.ErrorEvent(new Error('Layer with id "'+M+'" already exists on this map')));else{var T;if("custom"===c.type){if(us(this,s.validateCustomStyleLayer(c)))return;T=s.createStyleLayer(c)}else{if("object"==typeof c.source&&(this.addSource(M,c.source),c=s.clone$1(c),c=s.extend(c,{source:M})),this._validate(s.validateStyle.layer,"layers."+M,c,{arrayIndex:-1},E))return;T=s.createStyleLayer(c),this._validateLayer(T),T.setEventedParent(this,{layer:{id:M}}),this._serializedLayers[T.id]=T.serialize()}var N=m?this._order.indexOf(m):this._order.length;if(m&&-1===N)this.fire(new s.ErrorEvent(new Error('Layer with id "'+m+'" does not exist on this map.')));else{if(this._order.splice(N,0,M),this._layerOrderChanged=!0,this._layers[M]=T,this._removedLayers[M]&&T.source&&"custom"!==T.type){var G=this._removedLayers[M];delete this._removedLayers[M],G.type!==T.type?this._updatedSources[T.source]="clear":(this._updatedSources[T.source]="reload",this.sourceCaches[T.source].pause())}this._updateLayer(T),T.onAdd&&T.onAdd(this.map)}}},f.prototype.moveLayer=function(c,m){if(this._checkLoaded(),this._changed=!0,this._layers[c]){if(c!==m){var E=this._order.indexOf(c);this._order.splice(E,1);var M=m?this._order.indexOf(m):this._order.length;m&&-1===M?this.fire(new s.ErrorEvent(new Error('Layer with id "'+m+'" does not exist on this map.'))):(this._order.splice(M,0,c),this._layerOrderChanged=!0)}}else this.fire(new s.ErrorEvent(new Error("The layer '"+c+"' does not exist in the map's style and cannot be moved.")))},f.prototype.removeLayer=function(c){this._checkLoaded();var m=this._layers[c];if(m){m.setEventedParent(null);var E=this._order.indexOf(c);this._order.splice(E,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[c]=m,delete this._layers[c],delete this._serializedLayers[c],delete this._updatedLayers[c],delete this._updatedPaintProps[c],m.onRemove&&m.onRemove(this.map)}else this.fire(new s.ErrorEvent(new Error("The layer '"+c+"' does not exist in the map's style and cannot be removed.")))},f.prototype.getLayer=function(c){return this._layers[c]},f.prototype.hasLayer=function(c){return c in this._layers},f.prototype.setLayerZoomRange=function(c,m,E){this._checkLoaded();var M=this.getLayer(c);M?M.minzoom===m&&M.maxzoom===E||(null!=m&&(M.minzoom=m),null!=E&&(M.maxzoom=E),this._updateLayer(M)):this.fire(new s.ErrorEvent(new Error("The layer '"+c+"' does not exist in the map's style and cannot have zoom extent.")))},f.prototype.setFilter=function(c,m,E){void 0===E&&(E={}),this._checkLoaded();var M=this.getLayer(c);if(M){if(!s.deepEqual(M.filter,m))return null==m?(M.filter=void 0,void this._updateLayer(M)):void(this._validate(s.validateStyle.filter,"layers."+M.id+".filter",m,null,E)||(M.filter=s.clone$1(m),this._updateLayer(M)))}else this.fire(new s.ErrorEvent(new Error("The layer '"+c+"' does not exist in the map's style and cannot be filtered.")))},f.prototype.getFilter=function(c){return s.clone$1(this.getLayer(c).filter)},f.prototype.setLayoutProperty=function(c,m,E,M){void 0===M&&(M={}),this._checkLoaded();var T=this.getLayer(c);T?s.deepEqual(T.getLayoutProperty(m),E)||(T.setLayoutProperty(m,E,M),this._updateLayer(T)):this.fire(new s.ErrorEvent(new Error("The layer '"+c+"' does not exist in the map's style and cannot be styled.")))},f.prototype.getLayoutProperty=function(c,m){var E=this.getLayer(c);if(E)return E.getLayoutProperty(m);this.fire(new s.ErrorEvent(new Error("The layer '"+c+"' does not exist in the map's style.")))},f.prototype.setPaintProperty=function(c,m,E,M){void 0===M&&(M={}),this._checkLoaded();var T=this.getLayer(c);T?s.deepEqual(T.getPaintProperty(m),E)||(T.setPaintProperty(m,E,M)&&this._updateLayer(T),this._changed=!0,this._updatedPaintProps[c]=!0):this.fire(new s.ErrorEvent(new Error("The layer '"+c+"' does not exist in the map's style and cannot be styled.")))},f.prototype.getPaintProperty=function(c,m){return this.getLayer(c).getPaintProperty(m)},f.prototype.setFeatureState=function(c,m){this._checkLoaded();var E=c.source,M=c.sourceLayer,T=this.sourceCaches[E];if(void 0!==T){var N=T.getSource().type;"geojson"===N&&M?this.fire(new s.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):"vector"!==N||M?(void 0===c.id&&this.fire(new s.ErrorEvent(new Error("The feature id parameter must be provided."))),T.setFeatureState(M,c.id,m)):this.fire(new s.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new s.ErrorEvent(new Error("The source '"+E+"' does not exist in the map's style.")))},f.prototype.removeFeatureState=function(c,m){this._checkLoaded();var E=c.source,M=this.sourceCaches[E];if(void 0!==M){var T=M.getSource().type,N="vector"===T?c.sourceLayer:void 0;"vector"!==T||N?m&&"string"!=typeof c.id&&"number"!=typeof c.id?this.fire(new s.ErrorEvent(new Error("A feature id is required to remove its specific state property."))):M.removeFeatureState(N,c.id,m):this.fire(new s.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new s.ErrorEvent(new Error("The source '"+E+"' does not exist in the map's style.")))},f.prototype.getFeatureState=function(c){this._checkLoaded();var m=c.source,E=c.sourceLayer,M=this.sourceCaches[m];if(void 0!==M){if("vector"!==M.getSource().type||E)return void 0===c.id&&this.fire(new s.ErrorEvent(new Error("The feature id parameter must be provided."))),M.getFeatureState(E,c.id);this.fire(new s.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new s.ErrorEvent(new Error("The source '"+m+"' does not exist in the map's style.")))},f.prototype.getTransition=function(){return s.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)},f.prototype.serialize=function(){return s.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:s.mapObject(this.sourceCaches,function(c){return c.serialize()}),layers:this._serializeLayers(this._order)},function(c){return void 0!==c})},f.prototype._updateLayer=function(c){this._updatedLayers[c.id]=!0,c.source&&!this._updatedSources[c.source]&&"raster"!==this.sourceCaches[c.source].getSource().type&&(this._updatedSources[c.source]="reload",this.sourceCaches[c.source].pause()),this._changed=!0},f.prototype._flattenAndSortRenderedFeatures=function(c){for(var m=this,E=function(br){return"fill-extrusion"===m._layers[br].type},M={},T=[],N=this._order.length-1;N>=0;N--){var G=this._order[N];if(E(G)){M[G]=N;for(var Q=0,yt=c;Q<yt.length;Q+=1){var Et=yt[Q][G];if(Et)for(var _t=0,Xt=Et;_t<Xt.length;_t+=1)T.push(Xt[_t])}}}T.sort(function(br,fr){return fr.intersectionZ-br.intersectionZ});for(var Gt=[],ie=this._order.length-1;ie>=0;ie--){var Zt=this._order[ie];if(E(Zt))for(var ne=T.length-1;ne>=0;ne--){var ge=T[ne].feature;if(M[ge.layer.id]<ie)break;Gt.push(ge),T.pop()}else for(var Ee=0,Ue=c;Ee<Ue.length;Ee+=1){var Fe=Ue[Ee][Zt];if(Fe)for(var We=0,er=Fe;We<er.length;We+=1)Gt.push(er[We].feature)}}return Gt},f.prototype.queryRenderedFeatures=function(c,m,E){m&&m.filter&&this._validate(s.validateStyle.filter,"queryRenderedFeatures.filter",m.filter,null,m);var M={};if(m&&m.layers){if(!Array.isArray(m.layers))return this.fire(new s.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(var T=0,N=m.layers;T<N.length;T+=1){var G=N[T],Q=this._layers[G];if(!Q)return this.fire(new s.ErrorEvent(new Error("The layer '"+G+"' does not exist in the map's style and cannot be queried for features."))),[];M[Q.source]=!0}}var yt=[];for(var Et in m.availableImages=this._availableImages,this.sourceCaches)m.layers&&!M[Et]||yt.push(Ie(this.sourceCaches[Et],this._layers,this._serializedLayers,c,m,E));return this.placement&&yt.push(function(_t,Xt,Gt,ie,Zt,ne,ge){for(var Ee={},Ue=ne.queryRenderedSymbols(ie),Fe=[],We=0,er=Object.keys(Ue).map(Number);We<er.length;We+=1)Fe.push(ge[er[We]]);Fe.sort(Sr);for(var br=function(){var on=zr[fr],wi=on.featureIndex.lookupSymbolFeatures(Ue[on.bucketInstanceId],Xt,on.bucketIndex,on.sourceLayerIndex,Zt.filter,Zt.layers,Zt.availableImages,_t);for(var Gr in wi){var Vn=Ee[Gr]=Ee[Gr]||[],ti=wi[Gr];ti.sort(function(On,An){var mn=on.featureSortOrder;if(mn){var Mo=mn.indexOf(On.featureIndex);return mn.indexOf(An.featureIndex)-Mo}return An.featureIndex-On.featureIndex});for(var Zn=0,Nn=ti;Zn<Nn.length;Zn+=1)Vn.push(Nn[Zn])}},fr=0,zr=Fe;fr<zr.length;fr+=1)br();var nn=function(on){Ee[on].forEach(function(wi){var Gr=wi.feature,Vn=Gt[_t[on].source].getFeatureState(Gr.layer["source-layer"],Gr.id);Gr.source=Gr.layer.source,Gr.layer["source-layer"]&&(Gr.sourceLayer=Gr.layer["source-layer"]),Gr.state=Vn})};for(var sn in Ee)nn(sn);return Ee}(this._layers,this._serializedLayers,this.sourceCaches,c,m,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(yt)},f.prototype.querySourceFeatures=function(c,m){m&&m.filter&&this._validate(s.validateStyle.filter,"querySourceFeatures.filter",m.filter,null,m);var E=this.sourceCaches[c];return E?function(M,T){for(var N=M.getRenderableIds().map(function(Xt){return M.getTileByID(Xt)}),G=[],Q={},yt=0;yt<N.length;yt++){var Et=N[yt],_t=Et.tileID.canonical.key;Q[_t]||(Q[_t]=!0,Et.querySourceFeatures(G,T))}return G}(E,m):[]},f.prototype.addSourceType=function(c,m,E){return f.getSourceType(c)?E(new Error('A source type called "'+c+'" already exists.')):(f.setSourceType(c,m),m.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:c,url:m.workerSourceURL},E):E(null,null))},f.prototype.getLight=function(){return this.light.getLight()},f.prototype.setLight=function(c,m){void 0===m&&(m={}),this._checkLoaded();var E=this.light.getLight(),M=!1;for(var T in c)if(!s.deepEqual(c[T],E[T])){M=!0;break}if(M){var N={now:s.browser.now(),transition:s.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(c,m),this.light.updateTransitions(N)}},f.prototype._validate=function(c,m,E,M,T){return void 0===T&&(T={}),(!T||!1!==T.validate)&&us(this,c.call(s.validateStyle,s.extend({key:m,style:this.serialize(),value:E,styleSpec:s.styleSpec},M)))},f.prototype._remove=function(){for(var c in this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),s.evented.off("pluginStateChange",this._rtlTextPluginCallback),this._layers)this._layers[c].setEventedParent(null);for(var m in this.sourceCaches)this.sourceCaches[m].clearTiles(),this.sourceCaches[m].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()},f.prototype._clearSource=function(c){this.sourceCaches[c].clearTiles()},f.prototype._reloadSource=function(c){this.sourceCaches[c].resume(),this.sourceCaches[c].reload()},f.prototype._updateSources=function(c){for(var m in this.sourceCaches)this.sourceCaches[m].update(c)},f.prototype._generateCollisionBoxes=function(){for(var c in this.sourceCaches)this._reloadSource(c)},f.prototype._updatePlacement=function(c,m,E,M,T){void 0===T&&(T=!1);for(var N=!1,G=!1,Q={},yt=0,Et=this._order;yt<Et.length;yt+=1){var _t=this._layers[Et[yt]];if("symbol"===_t.type){if(!Q[_t.source]){var Xt=this.sourceCaches[_t.source];Q[_t.source]=Xt.getRenderableIds(!0).map(function(ge){return Xt.getTileByID(ge)}).sort(function(ge,Ee){return Ee.tileID.overscaledZ-ge.tileID.overscaledZ||(ge.tileID.isLessThan(Ee.tileID)?-1:1)})}var Gt=this.crossTileSymbolIndex.addLayer(_t,Q[_t.source],c.center.lng);N=N||Gt}}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((T=T||this._layerOrderChanged||0===E)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(s.browser.now(),c.zoom))&&(this.pauseablePlacement=new $e(c,this._order,T,m,E,M,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,Q),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(s.browser.now()),G=!0),N&&this.pauseablePlacement.placement.setStale()),G||N)for(var ie=0,Zt=this._order;ie<Zt.length;ie+=1){var ne=this._layers[Zt[ie]];"symbol"===ne.type&&this.placement.updateLayerOpacities(ne,Q[ne.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(s.browser.now())},f.prototype._releaseSymbolFadeTiles=function(){for(var c in this.sourceCaches)this.sourceCaches[c].releaseSymbolFadeTiles()},f.prototype.getImages=function(c,m,E){this.imageManager.getImages(m.icons,E),this._updateTilesForChangedImages();var M=this.sourceCaches[m.source];M&&M.setDependencies(m.tileID.key,m.type,m.icons)},f.prototype.getGlyphs=function(c,m,E){this.glyphManager.getGlyphs(m.stacks,E)},f.prototype.getResource=function(c,m,E){return s.makeRequest(m,E)},f}(s.Evented);xo.getSourceType=function(l){return De[l]},xo.setSourceType=function(l,f){De[l]=f},xo.registerForPluginStateChange=s.registerForPluginStateChange;var Uo=s.createLayout([{name:"a_pos",type:"Int16",components:2}]),ho=qi("#ifdef GL_ES\nprecision mediump float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif","#ifdef GL_ES\nprecision highp float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}"),sa=qi("uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),Ks=qi("uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),Ho=qi("varying vec3 v_data;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,0,1);} else {gl_Position=u_matrix*vec4(circle_center,0,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}"),Ui=qi("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),cs=qi("uniform highp float u_intensity;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}"),bo=qi("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(0.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),qo=qi("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,0.0,1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),Fu=qi("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),Sl=qi("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,0,1);}"),zs=qi("#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_FragColor=color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);}"),Ol=qi("varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),el=qi("uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),ha=qi("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}"),hu=qi("varying vec4 v_color;void main() {gl_FragColor=v_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec4 v_color;\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\nvec3 normal=a_normal_ed.xyz;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}"),gi=qi("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0\n? a_pos\n: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}"),pu=qi("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),Da=qi("uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;\n#define PI 3.141592653589793\nvoid main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),Bs=qi("uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}"),ki=qi("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}"),Hr=qi("uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}"),bu=qi("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}"),fu=qi("uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),pa=qi("uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nlowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),0.0,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));}"),Ba=qi("#define SDF_PX 8.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}"),wu=qi("#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\nreturn;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}");function qi(l,f){var c=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,m=f.match(/attribute ([\w]+) ([\w]+)/g),E=l.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),M=f.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),T=M?M.concat(E):E,N={};return{fragmentSource:l=l.replace(c,function(G,Q,yt,Et,_t){return N[_t]=!0,"define"===Q?"\n#ifndef HAS_UNIFORM_u_"+_t+"\nvarying "+yt+" "+Et+" "+_t+";\n#else\nuniform "+yt+" "+Et+" u_"+_t+";\n#endif\n":"\n#ifdef HAS_UNIFORM_u_"+_t+"\n    "+yt+" "+Et+" "+_t+" = u_"+_t+";\n#endif\n"}),vertexSource:f=f.replace(c,function(G,Q,yt,Et,_t){var Xt="float"===Et?"vec2":"vec4",Gt=_t.match(/color/)?"color":Xt;return N[_t]?"define"===Q?"\n#ifndef HAS_UNIFORM_u_"+_t+"\nuniform lowp float u_"+_t+"_t;\nattribute "+yt+" "+Xt+" a_"+_t+";\nvarying "+yt+" "+Et+" "+_t+";\n#else\nuniform "+yt+" "+Et+" u_"+_t+";\n#endif\n":"vec4"===Gt?"\n#ifndef HAS_UNIFORM_u_"+_t+"\n    "+_t+" = a_"+_t+";\n#else\n    "+yt+" "+Et+" "+_t+" = u_"+_t+";\n#endif\n":"\n#ifndef HAS_UNIFORM_u_"+_t+"\n    "+_t+" = unpack_mix_"+Gt+"(a_"+_t+", u_"+_t+"_t);\n#else\n    "+yt+" "+Et+" "+_t+" = u_"+_t+";\n#endif\n":"define"===Q?"\n#ifndef HAS_UNIFORM_u_"+_t+"\nuniform lowp float u_"+_t+"_t;\nattribute "+yt+" "+Xt+" a_"+_t+";\n#else\nuniform "+yt+" "+Et+" u_"+_t+";\n#endif\n":"vec4"===Gt?"\n#ifndef HAS_UNIFORM_u_"+_t+"\n    "+yt+" "+Et+" "+_t+" = a_"+_t+";\n#else\n    "+yt+" "+Et+" "+_t+" = u_"+_t+";\n#endif\n":"\n#ifndef HAS_UNIFORM_u_"+_t+"\n    "+yt+" "+Et+" "+_t+" = unpack_mix_"+Gt+"(a_"+_t+", u_"+_t+"_t);\n#else\n    "+yt+" "+Et+" "+_t+" = u_"+_t+";\n#endif\n"}),staticAttributes:m,staticUniforms:T}}var Us=Object.freeze({__proto__:null,prelude:ho,background:sa,backgroundPattern:Ks,circle:Ho,clippingMask:Ui,heatmap:cs,heatmapTexture:bo,collisionBox:qo,collisionCircle:Fu,debug:Sl,fill:zs,fillOutline:Ol,fillOutlinePattern:el,fillPattern:ha,fillExtrusion:hu,fillExtrusionPattern:gi,hillshadePrepare:pu,hillshade:Da,line:Bs,lineGradient:ki,linePattern:Hr,lineSDF:bu,raster:fu,symbolIcon:pa,symbolSDF:Ba,symbolTextAndIcon:wu}),Ms=function(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null};function $n(l){for(var f=[],c=0;c<l.length;c++)if(null!==l[c]){var m=l[c].split(" ");f.push(m.pop())}return f}Ms.prototype.bind=function(l,f,c,m,E,M,T,N){this.context=l;for(var G=this.boundPaintVertexBuffers.length!==m.length,Q=0;!G&&Q<m.length;Q++)this.boundPaintVertexBuffers[Q]!==m[Q]&&(G=!0);l.extVertexArrayObject&&this.vao&&this.boundProgram===f&&this.boundLayoutVertexBuffer===c&&!G&&this.boundIndexBuffer===E&&this.boundVertexOffset===M&&this.boundDynamicVertexBuffer===T&&this.boundDynamicVertexBuffer2===N?(l.bindVertexArrayOES.set(this.vao),T&&T.bind(),E&&E.dynamicDraw&&E.bind(),N&&N.bind()):this.freshBind(f,c,m,E,M,T,N)},Ms.prototype.freshBind=function(l,f,c,m,E,M,T){var N,G=l.numAttributes,Q=this.context,yt=Q.gl;if(Q.extVertexArrayObject)this.vao&&this.destroy(),this.vao=Q.extVertexArrayObject.createVertexArrayOES(),Q.bindVertexArrayOES.set(this.vao),N=0,this.boundProgram=l,this.boundLayoutVertexBuffer=f,this.boundPaintVertexBuffers=c,this.boundIndexBuffer=m,this.boundVertexOffset=E,this.boundDynamicVertexBuffer=M,this.boundDynamicVertexBuffer2=T;else{N=Q.currentNumAttributes||0;for(var Et=G;Et<N;Et++)yt.disableVertexAttribArray(Et)}f.enableAttributes(yt,l);for(var _t=0,Xt=c;_t<Xt.length;_t+=1)Xt[_t].enableAttributes(yt,l);M&&M.enableAttributes(yt,l),T&&T.enableAttributes(yt,l),f.bind(),f.setVertexAttribPointers(yt,l,E);for(var Gt=0,ie=c;Gt<ie.length;Gt+=1){var Zt=ie[Gt];Zt.bind(),Zt.setVertexAttribPointers(yt,l,E)}M&&(M.bind(),M.setVertexAttribPointers(yt,l,E)),m&&m.bind(),T&&(T.bind(),T.setVertexAttribPointers(yt,l,E)),Q.currentNumAttributes=G},Ms.prototype.destroy=function(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)};var Ts=function(l,f,c,m,E,M){var T=l.gl;this.program=T.createProgram();for(var N=$n(c.staticAttributes),G=m?m.getBinderAttributes():[],Q=N.concat(G),yt=c.staticUniforms?$n(c.staticUniforms):[],Et=m?m.getBinderUniforms():[],_t=[],Xt=0,Gt=yt.concat(Et);Xt<Gt.length;Xt+=1){var ie=Gt[Xt];_t.indexOf(ie)<0&&_t.push(ie)}var Zt=m?m.defines():[];M&&Zt.push("#define OVERDRAW_INSPECTOR;");var ne=Zt.concat(ho.fragmentSource,c.fragmentSource).join("\n"),ge=Zt.concat(ho.vertexSource,c.vertexSource).join("\n"),Ee=T.createShader(T.FRAGMENT_SHADER);if(T.isContextLost())this.failedToCreate=!0;else{T.shaderSource(Ee,ne),T.compileShader(Ee),T.attachShader(this.program,Ee);var Ue=T.createShader(T.VERTEX_SHADER);if(T.isContextLost())this.failedToCreate=!0;else{T.shaderSource(Ue,ge),T.compileShader(Ue),T.attachShader(this.program,Ue),this.attributes={};var Fe={};this.numAttributes=Q.length;for(var We=0;We<this.numAttributes;We++)Q[We]&&(T.bindAttribLocation(this.program,We,Q[We]),this.attributes[Q[We]]=We);T.linkProgram(this.program),T.deleteShader(Ue),T.deleteShader(Ee);for(var er=0;er<_t.length;er++){var br=_t[er];if(br&&!Fe[br]){var fr=T.getUniformLocation(this.program,br);fr&&(Fe[br]=fr)}}this.fixedUniforms=E(l,Fe),this.binderUniforms=m?m.getUniforms(l,Fe):[]}}};function Ni(l,f,c){var m=1/Bo(c,1,f.transform.tileZoom),E=Math.pow(2,c.tileID.overscaledZ),M=c.tileSize*Math.pow(2,f.transform.tileZoom)/E,T=M*(c.tileID.canonical.x+c.tileID.wrap*E),N=M*c.tileID.canonical.y;return{u_image:0,u_texsize:c.imageAtlasTexture.size,u_scale:[m,l.fromScale,l.toScale],u_fade:l.t,u_pixel_coord_upper:[T>>16,N>>16],u_pixel_coord_lower:[65535&T,65535&N]}}Ts.prototype.draw=function(l,f,c,m,E,M,T,N,G,Q,yt,Et,_t,Xt,Gt,ie){var Zt,ne=l.gl;if(!this.failedToCreate){for(var ge in l.program.set(this.program),l.setDepthMode(c),l.setStencilMode(m),l.setColorMode(E),l.setCullFace(M),this.fixedUniforms)this.fixedUniforms[ge].set(T[ge]);Xt&&Xt.setUniforms(l,this.binderUniforms,Et,{zoom:_t});for(var Ee=(Zt={},Zt[ne.LINES]=2,Zt[ne.TRIANGLES]=3,Zt[ne.LINE_STRIP]=1,Zt)[f],Ue=0,Fe=yt.get();Ue<Fe.length;Ue+=1){var We=Fe[Ue],er=We.vaos||(We.vaos={});(er[N]||(er[N]=new Ms)).bind(l,this,G,Xt?Xt.getPaintVertexBuffers():[],Q,We.vertexOffset,Gt,ie),ne.drawElements(f,We.primitiveLength*Ee,ne.UNSIGNED_SHORT,We.primitiveOffset*Ee*2)}}};var sl=function(l,f,c,m){var E=f.style.light,M=E.properties.get("position"),T=[M.x,M.y,M.z],N=s.create$1();"viewport"===E.properties.get("anchor")&&s.fromRotation(N,-f.transform.angle),s.transformMat3(T,T,N);var G=E.properties.get("color");return{u_matrix:l,u_lightpos:T,u_lightintensity:E.properties.get("intensity"),u_lightcolor:[G.r,G.g,G.b],u_vertical_gradient:+c,u_opacity:m}},fa=function(l,f,c,m,E,M,T){return s.extend(sl(l,f,c,m),Ni(M,f,T),{u_height_factor:-Math.pow(2,E.overscaledZ)/T.tileSize/8})},qs=function(l){return{u_matrix:l}},Un=function(l,f,c,m){return s.extend(qs(l),Ni(c,f,m))},$s=function(l,f){return{u_matrix:l,u_world:f}},wo=function(l,f,c,m,E){return s.extend(Un(l,f,c,m),{u_world:E})},Wu=function(l,f,c,m){var E,M,T=l.transform;if("map"===m.paint.get("circle-pitch-alignment")){var N=Bo(c,1,T.zoom);E=!0,M=[N,N]}else E=!1,M=T.pixelsToGLUnits;return{u_camera_to_center_distance:T.cameraToCenterDistance,u_scale_with_map:+("map"===m.paint.get("circle-pitch-scale")),u_matrix:l.translatePosMatrix(f.posMatrix,c,m.paint.get("circle-translate"),m.paint.get("circle-translate-anchor")),u_pitch_with_map:+E,u_device_pixel_ratio:s.browser.devicePixelRatio,u_extrude_scale:M}},da=function(l,f,c){var m=Bo(c,1,f.zoom),E=Math.pow(2,f.zoom-c.tileID.overscaledZ),M=c.tileID.overscaleFactor();return{u_matrix:l,u_camera_to_center_distance:f.cameraToCenterDistance,u_pixels_to_tile_units:m,u_extrude_scale:[f.pixelsToGLUnits[0]/(m*E),f.pixelsToGLUnits[1]/(m*E)],u_overscale_factor:M}},Ka=function(l,f,c){return{u_matrix:l,u_inv_matrix:f,u_camera_to_center_distance:c.cameraToCenterDistance,u_viewport_size:[c.width,c.height]}},rl=function(l,f,c){return void 0===c&&(c=1),{u_matrix:l,u_color:f,u_overlay:0,u_overlay_scale:c}},Ua=function(l){return{u_matrix:l}},hi=function(l,f,c,m){return{u_matrix:l,u_extrude_scale:Bo(f,1,c),u_intensity:m}},Wo=function(l,f,c){var m=l.transform;return{u_matrix:zu(l,f,c),u_ratio:1/Bo(f,1,m.zoom),u_device_pixel_ratio:s.browser.devicePixelRatio,u_units_to_pixels:[1/m.pixelsToGLUnits[0],1/m.pixelsToGLUnits[1]]}},Eu=function(l,f,c,m){return s.extend(Wo(l,f,c),{u_image:0,u_image_height:m})},Qn=function(l,f,c,m){var E=l.transform,M=Oa(f,E);return{u_matrix:zu(l,f,c),u_texsize:f.imageAtlasTexture.size,u_ratio:1/Bo(f,1,E.zoom),u_device_pixel_ratio:s.browser.devicePixelRatio,u_image:0,u_scale:[M,m.fromScale,m.toScale],u_fade:m.t,u_units_to_pixels:[1/E.pixelsToGLUnits[0],1/E.pixelsToGLUnits[1]]}},qa=function(l,f,c,m,E){var M=l.lineAtlas,T=Oa(f,l.transform),N="round"===c.layout.get("line-cap"),G=M.getDash(m.from,N),Q=M.getDash(m.to,N),yt=G.width*E.fromScale,Et=Q.width*E.toScale;return s.extend(Wo(l,f,c),{u_patternscale_a:[T/yt,-G.height/2],u_patternscale_b:[T/Et,-Q.height/2],u_sdfgamma:M.width/(256*Math.min(yt,Et)*s.browser.devicePixelRatio)/2,u_image:0,u_tex_y_a:G.y,u_tex_y_b:Q.y,u_mix:E.t})};function Oa(l,f){return 1/Bo(l,1,f.tileZoom)}function zu(l,f,c){return l.translatePosMatrix(f.tileID.posMatrix,f,c.paint.get("line-translate"),c.paint.get("line-translate-anchor"))}var Cl=function(l,f,c,m,E){return{u_matrix:l,u_tl_parent:f,u_scale_parent:c,u_buffer_scale:1,u_fade_t:m.mix,u_opacity:m.opacity*E.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:E.paint.get("raster-brightness-min"),u_brightness_high:E.paint.get("raster-brightness-max"),u_saturation_factor:(T=E.paint.get("raster-saturation"),T>0?1-1/(1.001-T):-T),u_contrast_factor:(M=E.paint.get("raster-contrast"),M>0?1/(1-M):1+M),u_spin_weights:Su(E.paint.get("raster-hue-rotate"))};var M,T};function Su(l){l*=Math.PI/180;var f=Math.sin(l),c=Math.cos(l);return[(2*c+1)/3,(-Math.sqrt(3)*f-c+1)/3,(Math.sqrt(3)*f-c+1)/3]}var $a,Au=function(l,f,c,m,E,M,T,N,G,Q){var yt=E.transform;return{u_is_size_zoom_constant:+("constant"===l||"source"===l),u_is_size_feature_constant:+("constant"===l||"camera"===l),u_size_t:f?f.uSizeT:0,u_size:f?f.uSize:0,u_camera_to_center_distance:yt.cameraToCenterDistance,u_pitch:yt.pitch/360*2*Math.PI,u_rotate_symbol:+c,u_aspect_ratio:yt.width/yt.height,u_fade_change:E.options.fadeDuration?E.symbolFadeChange:1,u_matrix:M,u_label_plane_matrix:T,u_coord_matrix:N,u_is_text:+G,u_pitch_with_map:+m,u_texsize:Q,u_texture:0}},Ko=function(l,f,c,m,E,M,T,N,G,Q,yt){var Et=E.transform;return s.extend(Au(l,f,c,m,E,M,T,N,G,Q),{u_gamma_scale:m?Math.cos(Et._pitch)*Et.cameraToCenterDistance:1,u_device_pixel_ratio:s.browser.devicePixelRatio,u_is_halo:+yt})},ms=function(l,f,c,m,E,M,T,N,G,Q){return s.extend(Ko(l,f,c,m,E,M,T,N,!0,G,!0),{u_texsize_icon:Q,u_texture_icon:1})},Gs=function(l,f,c){return{u_matrix:l,u_opacity:f,u_color:c}},be=function(l,f,c,m,E,M){return s.extend((N=M,Q=E,yt=(G=c).imageManager.getPattern((T=m).from.toString()),Et=G.imageManager.getPattern(T.to.toString()),Xt=(_t=G.imageManager.getPixelSize()).width,Gt=_t.height,ie=Math.pow(2,Q.tileID.overscaledZ),ne=(Zt=Q.tileSize*Math.pow(2,G.transform.tileZoom)/ie)*(Q.tileID.canonical.x+Q.tileID.wrap*ie),ge=Zt*Q.tileID.canonical.y,{u_image:0,u_pattern_tl_a:yt.tl,u_pattern_br_a:yt.br,u_pattern_tl_b:Et.tl,u_pattern_br_b:Et.br,u_texsize:[Xt,Gt],u_mix:N.t,u_pattern_size_a:yt.displaySize,u_pattern_size_b:Et.displaySize,u_scale_a:N.fromScale,u_scale_b:N.toScale,u_tile_units_to_pixels:1/Bo(Q,1,G.transform.tileZoom),u_pixel_coord_upper:[ne>>16,ge>>16],u_pixel_coord_lower:[65535&ne,65535&ge]}),{u_matrix:l,u_opacity:f});var T,N,G,Q,yt,Et,_t,Xt,Gt,ie,Zt,ne,ge},Ye={fillExtrusion:function(l,f){return{u_matrix:new s.UniformMatrix4f(l,f.u_matrix),u_lightpos:new s.Uniform3f(l,f.u_lightpos),u_lightintensity:new s.Uniform1f(l,f.u_lightintensity),u_lightcolor:new s.Uniform3f(l,f.u_lightcolor),u_vertical_gradient:new s.Uniform1f(l,f.u_vertical_gradient),u_opacity:new s.Uniform1f(l,f.u_opacity)}},fillExtrusionPattern:function(l,f){return{u_matrix:new s.UniformMatrix4f(l,f.u_matrix),u_lightpos:new s.Uniform3f(l,f.u_lightpos),u_lightintensity:new s.Uniform1f(l,f.u_lightintensity),u_lightcolor:new s.Uniform3f(l,f.u_lightcolor),u_vertical_gradient:new s.Uniform1f(l,f.u_vertical_gradient),u_height_factor:new s.Uniform1f(l,f.u_height_factor),u_image:new s.Uniform1i(l,f.u_image),u_texsize:new s.Uniform2f(l,f.u_texsize),u_pixel_coord_upper:new s.Uniform2f(l,f.u_pixel_coord_upper),u_pixel_coord_lower:new s.Uniform2f(l,f.u_pixel_coord_lower),u_scale:new s.Uniform3f(l,f.u_scale),u_fade:new s.Uniform1f(l,f.u_fade),u_opacity:new s.Uniform1f(l,f.u_opacity)}},fill:function(l,f){return{u_matrix:new s.UniformMatrix4f(l,f.u_matrix)}},fillPattern:function(l,f){return{u_matrix:new s.UniformMatrix4f(l,f.u_matrix),u_image:new s.Uniform1i(l,f.u_image),u_texsize:new s.Uniform2f(l,f.u_texsize),u_pixel_coord_upper:new s.Uniform2f(l,f.u_pixel_coord_upper),u_pixel_coord_lower:new s.Uniform2f(l,f.u_pixel_coord_lower),u_scale:new s.Uniform3f(l,f.u_scale),u_fade:new s.Uniform1f(l,f.u_fade)}},fillOutline:function(l,f){return{u_matrix:new s.UniformMatrix4f(l,f.u_matrix),u_world:new s.Uniform2f(l,f.u_world)}},fillOutlinePattern:function(l,f){return{u_matrix:new s.UniformMatrix4f(l,f.u_matrix),u_world:new s.Uniform2f(l,f.u_world),u_image:new s.Uniform1i(l,f.u_image),u_texsize:new s.Uniform2f(l,f.u_texsize),u_pixel_coord_upper:new s.Uniform2f(l,f.u_pixel_coord_upper),u_pixel_coord_lower:new s.Uniform2f(l,f.u_pixel_coord_lower),u_scale:new s.Uniform3f(l,f.u_scale),u_fade:new s.Uniform1f(l,f.u_fade)}},circle:function(l,f){return{u_camera_to_center_distance:new s.Uniform1f(l,f.u_camera_to_center_distance),u_scale_with_map:new s.Uniform1i(l,f.u_scale_with_map),u_pitch_with_map:new s.Uniform1i(l,f.u_pitch_with_map),u_extrude_scale:new s.Uniform2f(l,f.u_extrude_scale),u_device_pixel_ratio:new s.Uniform1f(l,f.u_device_pixel_ratio),u_matrix:new s.UniformMatrix4f(l,f.u_matrix)}},collisionBox:function(l,f){return{u_matrix:new s.UniformMatrix4f(l,f.u_matrix),u_camera_to_center_distance:new s.Uniform1f(l,f.u_camera_to_center_distance),u_pixels_to_tile_units:new s.Uniform1f(l,f.u_pixels_to_tile_units),u_extrude_scale:new s.Uniform2f(l,f.u_extrude_scale),u_overscale_factor:new s.Uniform1f(l,f.u_overscale_factor)}},collisionCircle:function(l,f){return{u_matrix:new s.UniformMatrix4f(l,f.u_matrix),u_inv_matrix:new s.UniformMatrix4f(l,f.u_inv_matrix),u_camera_to_center_distance:new s.Uniform1f(l,f.u_camera_to_center_distance),u_viewport_size:new s.Uniform2f(l,f.u_viewport_size)}},debug:function(l,f){return{u_color:new s.UniformColor(l,f.u_color),u_matrix:new s.UniformMatrix4f(l,f.u_matrix),u_overlay:new s.Uniform1i(l,f.u_overlay),u_overlay_scale:new s.Uniform1f(l,f.u_overlay_scale)}},clippingMask:function(l,f){return{u_matrix:new s.UniformMatrix4f(l,f.u_matrix)}},heatmap:function(l,f){return{u_extrude_scale:new s.Uniform1f(l,f.u_extrude_scale),u_intensity:new s.Uniform1f(l,f.u_intensity),u_matrix:new s.UniformMatrix4f(l,f.u_matrix)}},heatmapTexture:function(l,f){return{u_matrix:new s.UniformMatrix4f(l,f.u_matrix),u_world:new s.Uniform2f(l,f.u_world),u_image:new s.Uniform1i(l,f.u_image),u_color_ramp:new s.Uniform1i(l,f.u_color_ramp),u_opacity:new s.Uniform1f(l,f.u_opacity)}},hillshade:function(l,f){return{u_matrix:new s.UniformMatrix4f(l,f.u_matrix),u_image:new s.Uniform1i(l,f.u_image),u_latrange:new s.Uniform2f(l,f.u_latrange),u_light:new s.Uniform2f(l,f.u_light),u_shadow:new s.UniformColor(l,f.u_shadow),u_highlight:new s.UniformColor(l,f.u_highlight),u_accent:new s.UniformColor(l,f.u_accent)}},hillshadePrepare:function(l,f){return{u_matrix:new s.UniformMatrix4f(l,f.u_matrix),u_image:new s.Uniform1i(l,f.u_image),u_dimension:new s.Uniform2f(l,f.u_dimension),u_zoom:new s.Uniform1f(l,f.u_zoom),u_unpack:new s.Uniform4f(l,f.u_unpack)}},line:function(l,f){return{u_matrix:new s.UniformMatrix4f(l,f.u_matrix),u_ratio:new s.Uniform1f(l,f.u_ratio),u_device_pixel_ratio:new s.Uniform1f(l,f.u_device_pixel_ratio),u_units_to_pixels:new s.Uniform2f(l,f.u_units_to_pixels)}},lineGradient:function(l,f){return{u_matrix:new s.UniformMatrix4f(l,f.u_matrix),u_ratio:new s.Uniform1f(l,f.u_ratio),u_device_pixel_ratio:new s.Uniform1f(l,f.u_device_pixel_ratio),u_units_to_pixels:new s.Uniform2f(l,f.u_units_to_pixels),u_image:new s.Uniform1i(l,f.u_image),u_image_height:new s.Uniform1f(l,f.u_image_height)}},linePattern:function(l,f){return{u_matrix:new s.UniformMatrix4f(l,f.u_matrix),u_texsize:new s.Uniform2f(l,f.u_texsize),u_ratio:new s.Uniform1f(l,f.u_ratio),u_device_pixel_ratio:new s.Uniform1f(l,f.u_device_pixel_ratio),u_image:new s.Uniform1i(l,f.u_image),u_units_to_pixels:new s.Uniform2f(l,f.u_units_to_pixels),u_scale:new s.Uniform3f(l,f.u_scale),u_fade:new s.Uniform1f(l,f.u_fade)}},lineSDF:function(l,f){return{u_matrix:new s.UniformMatrix4f(l,f.u_matrix),u_ratio:new s.Uniform1f(l,f.u_ratio),u_device_pixel_ratio:new s.Uniform1f(l,f.u_device_pixel_ratio),u_units_to_pixels:new s.Uniform2f(l,f.u_units_to_pixels),u_patternscale_a:new s.Uniform2f(l,f.u_patternscale_a),u_patternscale_b:new s.Uniform2f(l,f.u_patternscale_b),u_sdfgamma:new s.Uniform1f(l,f.u_sdfgamma),u_image:new s.Uniform1i(l,f.u_image),u_tex_y_a:new s.Uniform1f(l,f.u_tex_y_a),u_tex_y_b:new s.Uniform1f(l,f.u_tex_y_b),u_mix:new s.Uniform1f(l,f.u_mix)}},raster:function(l,f){return{u_matrix:new s.UniformMatrix4f(l,f.u_matrix),u_tl_parent:new s.Uniform2f(l,f.u_tl_parent),u_scale_parent:new s.Uniform1f(l,f.u_scale_parent),u_buffer_scale:new s.Uniform1f(l,f.u_buffer_scale),u_fade_t:new s.Uniform1f(l,f.u_fade_t),u_opacity:new s.Uniform1f(l,f.u_opacity),u_image0:new s.Uniform1i(l,f.u_image0),u_image1:new s.Uniform1i(l,f.u_image1),u_brightness_low:new s.Uniform1f(l,f.u_brightness_low),u_brightness_high:new s.Uniform1f(l,f.u_brightness_high),u_saturation_factor:new s.Uniform1f(l,f.u_saturation_factor),u_contrast_factor:new s.Uniform1f(l,f.u_contrast_factor),u_spin_weights:new s.Uniform3f(l,f.u_spin_weights)}},symbolIcon:function(l,f){return{u_is_size_zoom_constant:new s.Uniform1i(l,f.u_is_size_zoom_constant),u_is_size_feature_constant:new s.Uniform1i(l,f.u_is_size_feature_constant),u_size_t:new s.Uniform1f(l,f.u_size_t),u_size:new s.Uniform1f(l,f.u_size),u_camera_to_center_distance:new s.Uniform1f(l,f.u_camera_to_center_distance),u_pitch:new s.Uniform1f(l,f.u_pitch),u_rotate_symbol:new s.Uniform1i(l,f.u_rotate_symbol),u_aspect_ratio:new s.Uniform1f(l,f.u_aspect_ratio),u_fade_change:new s.Uniform1f(l,f.u_fade_change),u_matrix:new s.UniformMatrix4f(l,f.u_matrix),u_label_plane_matrix:new s.UniformMatrix4f(l,f.u_label_plane_matrix),u_coord_matrix:new s.UniformMatrix4f(l,f.u_coord_matrix),u_is_text:new s.Uniform1i(l,f.u_is_text),u_pitch_with_map:new s.Uniform1i(l,f.u_pitch_with_map),u_texsize:new s.Uniform2f(l,f.u_texsize),u_texture:new s.Uniform1i(l,f.u_texture)}},symbolSDF:function(l,f){return{u_is_size_zoom_constant:new s.Uniform1i(l,f.u_is_size_zoom_constant),u_is_size_feature_constant:new s.Uniform1i(l,f.u_is_size_feature_constant),u_size_t:new s.Uniform1f(l,f.u_size_t),u_size:new s.Uniform1f(l,f.u_size),u_camera_to_center_distance:new s.Uniform1f(l,f.u_camera_to_center_distance),u_pitch:new s.Uniform1f(l,f.u_pitch),u_rotate_symbol:new s.Uniform1i(l,f.u_rotate_symbol),u_aspect_ratio:new s.Uniform1f(l,f.u_aspect_ratio),u_fade_change:new s.Uniform1f(l,f.u_fade_change),u_matrix:new s.UniformMatrix4f(l,f.u_matrix),u_label_plane_matrix:new s.UniformMatrix4f(l,f.u_label_plane_matrix),u_coord_matrix:new s.UniformMatrix4f(l,f.u_coord_matrix),u_is_text:new s.Uniform1i(l,f.u_is_text),u_pitch_with_map:new s.Uniform1i(l,f.u_pitch_with_map),u_texsize:new s.Uniform2f(l,f.u_texsize),u_texture:new s.Uniform1i(l,f.u_texture),u_gamma_scale:new s.Uniform1f(l,f.u_gamma_scale),u_device_pixel_ratio:new s.Uniform1f(l,f.u_device_pixel_ratio),u_is_halo:new s.Uniform1i(l,f.u_is_halo)}},symbolTextAndIcon:function(l,f){return{u_is_size_zoom_constant:new s.Uniform1i(l,f.u_is_size_zoom_constant),u_is_size_feature_constant:new s.Uniform1i(l,f.u_is_size_feature_constant),u_size_t:new s.Uniform1f(l,f.u_size_t),u_size:new s.Uniform1f(l,f.u_size),u_camera_to_center_distance:new s.Uniform1f(l,f.u_camera_to_center_distance),u_pitch:new s.Uniform1f(l,f.u_pitch),u_rotate_symbol:new s.Uniform1i(l,f.u_rotate_symbol),u_aspect_ratio:new s.Uniform1f(l,f.u_aspect_ratio),u_fade_change:new s.Uniform1f(l,f.u_fade_change),u_matrix:new s.UniformMatrix4f(l,f.u_matrix),u_label_plane_matrix:new s.UniformMatrix4f(l,f.u_label_plane_matrix),u_coord_matrix:new s.UniformMatrix4f(l,f.u_coord_matrix),u_is_text:new s.Uniform1i(l,f.u_is_text),u_pitch_with_map:new s.Uniform1i(l,f.u_pitch_with_map),u_texsize:new s.Uniform2f(l,f.u_texsize),u_texsize_icon:new s.Uniform2f(l,f.u_texsize_icon),u_texture:new s.Uniform1i(l,f.u_texture),u_texture_icon:new s.Uniform1i(l,f.u_texture_icon),u_gamma_scale:new s.Uniform1f(l,f.u_gamma_scale),u_device_pixel_ratio:new s.Uniform1f(l,f.u_device_pixel_ratio),u_is_halo:new s.Uniform1i(l,f.u_is_halo)}},background:function(l,f){return{u_matrix:new s.UniformMatrix4f(l,f.u_matrix),u_opacity:new s.Uniform1f(l,f.u_opacity),u_color:new s.UniformColor(l,f.u_color)}},backgroundPattern:function(l,f){return{u_matrix:new s.UniformMatrix4f(l,f.u_matrix),u_opacity:new s.Uniform1f(l,f.u_opacity),u_image:new s.Uniform1i(l,f.u_image),u_pattern_tl_a:new s.Uniform2f(l,f.u_pattern_tl_a),u_pattern_br_a:new s.Uniform2f(l,f.u_pattern_br_a),u_pattern_tl_b:new s.Uniform2f(l,f.u_pattern_tl_b),u_pattern_br_b:new s.Uniform2f(l,f.u_pattern_br_b),u_texsize:new s.Uniform2f(l,f.u_texsize),u_mix:new s.Uniform1f(l,f.u_mix),u_pattern_size_a:new s.Uniform2f(l,f.u_pattern_size_a),u_pattern_size_b:new s.Uniform2f(l,f.u_pattern_size_b),u_scale_a:new s.Uniform1f(l,f.u_scale_a),u_scale_b:new s.Uniform1f(l,f.u_scale_b),u_pixel_coord_upper:new s.Uniform2f(l,f.u_pixel_coord_upper),u_pixel_coord_lower:new s.Uniform2f(l,f.u_pixel_coord_lower),u_tile_units_to_pixels:new s.Uniform1f(l,f.u_tile_units_to_pixels)}}};function dr(l,f,c,m,E,M,T){for(var N=l.context,G=N.gl,Q=l.useProgram("collisionBox"),yt=[],Et=0,_t=0,Xt=0;Xt<m.length;Xt++){var Gt=m[Xt],ie=f.getTile(Gt),Zt=ie.getBucket(c);if(Zt){var ne=Gt.posMatrix;0===E[0]&&0===E[1]||(ne=l.translatePosMatrix(Gt.posMatrix,ie,E,M));var ge=T?Zt.textCollisionBox:Zt.iconCollisionBox,Ee=Zt.collisionCircleArray;if(Ee.length>0){var Ue=s.create(),Fe=ne;s.mul(Ue,Zt.placementInvProjMatrix,l.transform.glCoordMatrix),s.mul(Ue,Ue,Zt.placementViewportMatrix),yt.push({circleArray:Ee,circleOffset:_t,transform:Fe,invTransform:Ue}),_t=Et+=Ee.length/4}ge&&Q.draw(N,G.LINES,bt.disabled,zt.disabled,l.colorModeForRenderPass(),me.disabled,da(ne,l.transform,ie),c.id,ge.layoutVertexBuffer,ge.indexBuffer,ge.segments,null,l.transform.zoom,null,null,ge.collisionVertexBuffer)}}if(T&&yt.length){var We=l.useProgram("collisionCircle"),er=new s.StructArrayLayout2f1f2i16;er.resize(4*Et),er._trim();for(var br=0,fr=0,zr=yt;fr<zr.length;fr+=1)for(var nn=zr[fr],sn=0;sn<nn.circleArray.length/4;sn++){var on=4*sn,wi=nn.circleArray[on+0],Gr=nn.circleArray[on+1],Vn=nn.circleArray[on+2],ti=nn.circleArray[on+3];er.emplace(br++,wi,Gr,Vn,ti,0),er.emplace(br++,wi,Gr,Vn,ti,1),er.emplace(br++,wi,Gr,Vn,ti,2),er.emplace(br++,wi,Gr,Vn,ti,3)}(!$a||$a.length<2*Et)&&($a=function(Ca){var nu=2*Ca,ws=new s.StructArrayLayout3ui6;ws.resize(nu),ws._trim();for(var Es=0;Es<nu;Es++){var Ia=6*Es;ws.uint16[Ia+0]=4*Es+0,ws.uint16[Ia+1]=4*Es+1,ws.uint16[Ia+2]=4*Es+2,ws.uint16[Ia+3]=4*Es+2,ws.uint16[Ia+4]=4*Es+3,ws.uint16[Ia+5]=4*Es+0}return ws}(Et));for(var Zn=N.createIndexBuffer($a,!0),Nn=N.createVertexBuffer(er,s.collisionCircleLayout.members,!0),On=0,An=yt;On<An.length;On+=1){var mn=An[On],Mo=Ka(mn.transform,mn.invTransform,l.transform);We.draw(N,G.TRIANGLES,bt.disabled,zt.disabled,l.colorModeForRenderPass(),me.disabled,Mo,c.id,Nn,Zn,s.SegmentVector.simpleSegment(0,2*mn.circleOffset,mn.circleArray.length,mn.circleArray.length/2),null,l.transform.zoom,null,null,null)}Nn.destroy(),Zn.destroy()}}var dn=s.identity(new Float32Array(16));function xi(l,f,c,m,E,M){var T=s.getAnchorAlignment(l),N=-(T.horizontalAlign-.5)*f,G=-(T.verticalAlign-.5)*c,Q=s.evaluateVariableOffset(l,m);return new s.Point((N/E+Q[0])*M,(G/E+Q[1])*M)}function Ln(l,f,c,m,E,M,T,N,G,Q,yt){var Et=l.text.placedSymbolArray,_t=l.text.dynamicLayoutVertexArray,Xt=l.icon.dynamicLayoutVertexArray,Gt={};_t.clear();for(var ie=0;ie<Et.length;ie++){var Zt=Et.get(ie),ne=Zt.hidden||!Zt.crossTileID||l.allowVerticalPlacement&&!Zt.placedOrientation?null:m[Zt.crossTileID];if(ne){var ge=new s.Point(Zt.anchorX,Zt.anchorY),Ee=Xr(ge,c?N:T),Ue=ca(M.cameraToCenterDistance,Ee.signedDistanceFromCamera),Fe=E.evaluateSizeForFeature(l.textSizeData,Q,Zt)*Ue/s.ONE_EM;c&&(Fe*=l.tilePixelRatio/G);for(var We=xi(ne.anchor,ne.width,ne.height,ne.textOffset,ne.textBoxScale,Fe),er=c?Xr(ge.add(We),T).point:Ee.point.add(f?We.rotate(-M.angle):We),br=l.allowVerticalPlacement&&Zt.placedOrientation===s.WritingMode.vertical?Math.PI/2:0,fr=0;fr<Zt.numGlyphs;fr++)s.addDynamicAttributes(_t,er,br);yt&&Zt.associatedIconIndex>=0&&(Gt[Zt.associatedIconIndex]={shiftedAnchor:er,angle:br})}else ss(Zt.numGlyphs,_t)}if(yt){Xt.clear();for(var zr=l.icon.placedSymbolArray,nn=0;nn<zr.length;nn++){var sn=zr.get(nn);if(sn.hidden)ss(sn.numGlyphs,Xt);else{var on=Gt[nn];if(on)for(var wi=0;wi<sn.numGlyphs;wi++)s.addDynamicAttributes(Xt,on.shiftedAnchor,on.angle);else ss(sn.numGlyphs,Xt)}}l.icon.dynamicLayoutVertexBuffer.updateData(Xt)}l.text.dynamicLayoutVertexBuffer.updateData(_t)}function mo(l,f,c){return c.iconsInText&&f?"symbolTextAndIcon":l?"symbolSDF":"symbolIcon"}function Gi(l,f,c,m,E,M,T,N,G,Q,yt,Et){for(var _t=l.context,Xt=_t.gl,Gt=l.transform,ie="map"===N,Zt="map"===G,ne=ie&&"point"!==c.layout.get("symbol-placement"),ge=ie&&!Zt&&!ne,Ee=!c.layout.get("symbol-sort-key").isConstant(),Ue=!1,Fe=l.depthModeForSublayer(0,bt.ReadOnly),We=c.layout.get("text-variable-anchor"),er=[],br=0,fr=m;br<fr.length;br+=1){var zr=fr[br],nn=f.getTile(zr),sn=nn.getBucket(c);if(sn){var on=E?sn.text:sn.icon;if(on&&on.segments.get().length){var wi=on.programConfigurations.get(c.id),Gr=E||sn.sdfIcons,Vn=E?sn.textSizeData:sn.iconSizeData,ti=Zt||0!==Gt.pitch,Zn=l.useProgram(mo(Gr,E,sn),wi),Nn=s.evaluateSizeForZoom(Vn,Gt.zoom),On=void 0,An=[0,0],mn=void 0,Mo=void 0,Ca=null,nu=void 0;if(E)mn=nn.glyphAtlasTexture,Mo=Xt.LINEAR,On=nn.glyphAtlasTexture.size,sn.iconsInText&&(An=nn.imageAtlasTexture.size,Ca=nn.imageAtlasTexture,nu=ti||l.options.rotating||l.options.zooming||"composite"===Vn.kind||"camera"===Vn.kind?Xt.LINEAR:Xt.NEAREST);else{var ws=1!==c.layout.get("icon-size").constantOr(0)||sn.iconsNeedLinear;mn=nn.imageAtlasTexture,Mo=Gr||l.options.rotating||l.options.zooming||ws||ti?Xt.LINEAR:Xt.NEAREST,On=nn.imageAtlasTexture.size}var Es=Bo(nn,1,l.transform.zoom),Ia=co(zr.posMatrix,Zt,ie,l.transform,Es),iu=ni(zr.posMatrix,Zt,ie,l.transform,Es),cl=We&&sn.hasTextData(),ks="none"!==c.layout.get("icon-text-fit")&&cl&&sn.hasIconData();ne&&Fa(sn,zr.posMatrix,l,E,Ia,iu,Zt,Q);var yu=l.translatePosMatrix(zr.posMatrix,nn,M,T),hl=ne||E&&We||ks?dn:Ia,Iu=l.translatePosMatrix(iu,nn,M,T,!0),Sh=Gr&&0!==c.paint.get(E?"text-halo-width":"icon-halo-width").constantOr(1),kl={program:Zn,buffers:on,uniformValues:Gr?sn.iconsInText?ms(Vn.kind,Nn,ge,Zt,l,yu,hl,Iu,On,An):Ko(Vn.kind,Nn,ge,Zt,l,yu,hl,Iu,E,On,!0):Au(Vn.kind,Nn,ge,Zt,l,yu,hl,Iu,E,On),atlasTexture:mn,atlasTextureIcon:Ca,atlasInterpolation:Mo,atlasInterpolationIcon:nu,isSDF:Gr,hasHalo:Sh};if(Ee&&sn.canOverlap){Ue=!0;for(var Nl=0,Yl=on.segments.get();Nl<Yl.length;Nl+=1){var Ic=Yl[Nl];er.push({segments:new s.SegmentVector([Ic]),sortKey:Ic.sortKey,state:kl})}}else er.push({segments:on.segments,sortKey:0,state:kl})}}}Ue&&er.sort(function(Ku,$u){return Ku.sortKey-$u.sortKey});for(var Jl=0,pl=er;Jl<pl.length;Jl+=1){var hc=pl[Jl],Xa=hc.state;if(_t.activeTexture.set(Xt.TEXTURE0),Xa.atlasTexture.bind(Xa.atlasInterpolation,Xt.CLAMP_TO_EDGE),Xa.atlasTextureIcon&&(_t.activeTexture.set(Xt.TEXTURE1),Xa.atlasTextureIcon&&Xa.atlasTextureIcon.bind(Xa.atlasInterpolationIcon,Xt.CLAMP_TO_EDGE)),Xa.isSDF){var fl=Xa.uniformValues;Xa.hasHalo&&(fl.u_is_halo=1,Ga(Xa.buffers,hc.segments,c,l,Xa.program,Fe,yt,Et,fl)),fl.u_is_halo=0}Ga(Xa.buffers,hc.segments,c,l,Xa.program,Fe,yt,Et,Xa.uniformValues)}}function Ga(l,f,c,m,E,M,T,N,G){var Q=m.context;E.draw(Q,Q.gl.TRIANGLES,M,T,N,me.disabled,G,c.id,l.layoutVertexBuffer,l.indexBuffer,f,c.paint,m.transform.zoom,l.programConfigurations.get(c.id),l.dynamicLayoutVertexBuffer,l.opacityVertexBuffer)}function mi(l,f,c,m,E,M,T){var N,G,Q,yt,Et,_t=l.context.gl,Xt=c.paint.get("fill-pattern"),Gt=Xt&&Xt.constantOr(1),ie=c.getCrossfadeParameters();T?(G=Gt&&!c.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",N=_t.LINES):(G=Gt?"fillPattern":"fill",N=_t.TRIANGLES);for(var Zt=0,ne=m;Zt<ne.length;Zt+=1){var ge=ne[Zt],Ee=f.getTile(ge);if(!Gt||Ee.patternsLoaded()){var Ue=Ee.getBucket(c);if(Ue){var Fe=Ue.programConfigurations.get(c.id),We=l.useProgram(G,Fe);Gt&&(l.context.activeTexture.set(_t.TEXTURE0),Ee.imageAtlasTexture.bind(_t.LINEAR,_t.CLAMP_TO_EDGE),Fe.updatePaintBuffers(ie));var er=Xt.constantOr(null);if(er&&Ee.imageAtlas){var br=Ee.imageAtlas,fr=br.patternPositions[er.to.toString()],zr=br.patternPositions[er.from.toString()];fr&&zr&&Fe.setConstantPatternPositions(fr,zr)}var nn=l.translatePosMatrix(ge.posMatrix,Ee,c.paint.get("fill-translate"),c.paint.get("fill-translate-anchor"));if(T){yt=Ue.indexBuffer2,Et=Ue.segments2;var sn=[_t.drawingBufferWidth,_t.drawingBufferHeight];Q="fillOutlinePattern"===G&&Gt?wo(nn,l,ie,Ee,sn):$s(nn,sn)}else yt=Ue.indexBuffer,Et=Ue.segments,Q=Gt?Un(nn,l,ie,Ee):qs(nn);We.draw(l.context,N,E,l.stencilModeForClipping(ge),M,me.disabled,Q,c.id,Ue.layoutVertexBuffer,yt,Et,c.paint,l.transform.zoom,Fe)}}}}function $o(l,f,c,m,E,M,T){for(var N=l.context,G=N.gl,Q=c.paint.get("fill-extrusion-pattern"),yt=Q.constantOr(1),Et=c.getCrossfadeParameters(),_t=c.paint.get("fill-extrusion-opacity"),Xt=0,Gt=m;Xt<Gt.length;Xt+=1){var ie=Gt[Xt],Zt=f.getTile(ie),ne=Zt.getBucket(c);if(ne){var ge=ne.programConfigurations.get(c.id),Ee=l.useProgram(yt?"fillExtrusionPattern":"fillExtrusion",ge);yt&&(l.context.activeTexture.set(G.TEXTURE0),Zt.imageAtlasTexture.bind(G.LINEAR,G.CLAMP_TO_EDGE),ge.updatePaintBuffers(Et));var Ue=Q.constantOr(null);if(Ue&&Zt.imageAtlas){var Fe=Zt.imageAtlas,We=Fe.patternPositions[Ue.to.toString()],er=Fe.patternPositions[Ue.from.toString()];We&&er&&ge.setConstantPatternPositions(We,er)}var br=l.translatePosMatrix(ie.posMatrix,Zt,c.paint.get("fill-extrusion-translate"),c.paint.get("fill-extrusion-translate-anchor")),fr=c.paint.get("fill-extrusion-vertical-gradient"),zr=yt?fa(br,l,fr,_t,ie,Et,Zt):sl(br,l,fr,_t);Ee.draw(N,N.gl.TRIANGLES,E,M,T,me.backCCW,zr,c.id,ne.layoutVertexBuffer,ne.indexBuffer,ne.segments,c.paint,l.transform.zoom,ge)}}}function As(l,f,c,m,E,M){var T=l.context,N=T.gl,G=f.fbo;if(G){var Q=l.useProgram("hillshade");T.activeTexture.set(N.TEXTURE0),N.bindTexture(N.TEXTURE_2D,G.colorAttachment.get());var yt=function(Et,_t,Xt){var Gt=Xt.paint.get("hillshade-shadow-color"),ie=Xt.paint.get("hillshade-highlight-color"),Zt=Xt.paint.get("hillshade-accent-color"),ne=Xt.paint.get("hillshade-illumination-direction")*(Math.PI/180);"viewport"===Xt.paint.get("hillshade-illumination-anchor")&&(ne-=Et.transform.angle);var ge,Ee,Ue,Fe=!Et.options.moving;return{u_matrix:Et.transform.calculatePosMatrix(_t.tileID.toUnwrapped(),Fe),u_image:0,u_latrange:(ge=_t.tileID,Ee=Math.pow(2,ge.canonical.z),Ue=ge.canonical.y,[new s.MercatorCoordinate(0,Ue/Ee).toLngLat().lat,new s.MercatorCoordinate(0,(Ue+1)/Ee).toLngLat().lat]),u_light:[Xt.paint.get("hillshade-exaggeration"),ne],u_shadow:Gt,u_highlight:ie,u_accent:Zt}}(l,f,c);Q.draw(T,N.TRIANGLES,m,E,M,me.disabled,yt,c.id,l.rasterBoundsBuffer,l.quadTriangleIndexBuffer,l.rasterBoundsSegments)}}function Qa(l,f,c,m,E,M){var ie,Zt,ne,ge,T=l.context,N=T.gl,G=f.dem;if(G&&G.data){var Q=G.dim,yt=G.stride,Et=G.getPixels();if(T.activeTexture.set(N.TEXTURE1),T.pixelStoreUnpackPremultiplyAlpha.set(!1),f.demTexture=f.demTexture||l.getTileTexture(yt),f.demTexture){var _t=f.demTexture;_t.update(Et,{premultiply:!1}),_t.bind(N.NEAREST,N.CLAMP_TO_EDGE)}else f.demTexture=new s.Texture(T,Et,N.RGBA,{premultiply:!1}),f.demTexture.bind(N.NEAREST,N.CLAMP_TO_EDGE);T.activeTexture.set(N.TEXTURE0);var Xt=f.fbo;if(!Xt){var Gt=new s.Texture(T,{width:Q,height:Q,data:null},N.RGBA);Gt.bind(N.LINEAR,N.CLAMP_TO_EDGE),(Xt=f.fbo=T.createFramebuffer(Q,Q,!0)).colorAttachment.set(Gt.texture)}T.bindFramebuffer.set(Xt.framebuffer),T.viewport.set([0,0,Q,Q]),l.useProgram("hillshadePrepare").draw(T,N.TRIANGLES,m,E,M,me.disabled,(ie=f.tileID,ne=(Zt=G).stride,ge=s.create(),s.ortho(ge,0,s.EXTENT,-s.EXTENT,0,0,1),s.translate(ge,ge,[0,-s.EXTENT,0]),{u_matrix:ge,u_image:1,u_dimension:[ne,ne],u_zoom:ie.overscaledZ,u_unpack:Zt.getUnpackVector()}),c.id,l.rasterBoundsBuffer,l.quadTriangleIndexBuffer,l.rasterBoundsSegments),f.needsHillshadePrepare=!1}}function ys(l,f,c,m,E){var M=m.paint.get("raster-fade-duration");if(M>0){var T=s.browser.now(),N=(T-l.timeAdded)/M,G=f?(T-f.timeAdded)/M:-1,Q=c.getSource(),yt=E.coveringZoomLevel({tileSize:Q.tileSize,roundZoom:Q.roundZoom}),Et=!f||Math.abs(f.tileID.overscaledZ-yt)>Math.abs(l.tileID.overscaledZ-yt),_t=Et&&l.refreshedUponExpiration?1:s.clamp(Et?N:1-G,0,1);return l.refreshedUponExpiration&&N>=1&&(l.refreshedUponExpiration=!1),f?{opacity:1,mix:1-_t}:{opacity:_t,mix:0}}return{opacity:1,mix:0}}var Qs=new s.Color(1,0,0,1),Vs=new s.Color(0,1,0,1),vs=new s.Color(0,0,1,1),Go=new s.Color(1,0,1,1),Zs=new s.Color(0,1,1,1);function ua(l,f,c,m){du(l,0,f+c/2,l.transform.width,c,m)}function js(l,f,c,m){du(l,f-c/2,0,c,l.transform.height,m)}function du(l,f,c,m,E,M){var T=l.context,N=T.gl;N.enable(N.SCISSOR_TEST),N.scissor(f*s.browser.devicePixelRatio,c*s.browser.devicePixelRatio,m*s.browser.devicePixelRatio,E*s.browser.devicePixelRatio),T.clear({color:M}),N.disable(N.SCISSOR_TEST)}function Eo(l,f,c){var m=l.context,E=m.gl,M=c.posMatrix,T=l.useProgram("debug"),N=bt.disabled,G=zt.disabled,Q=l.colorModeForRenderPass();m.activeTexture.set(E.TEXTURE0),l.emptyTexture.bind(E.LINEAR,E.CLAMP_TO_EDGE),T.draw(m,E.LINE_STRIP,N,G,Q,me.disabled,rl(M,s.Color.red),"$debug",l.debugBuffer,l.tileBorderIndexBuffer,l.debugSegments);var yt=f.getTileByID(c.key).latestRawTileData,Et=Math.floor((yt&&yt.byteLength||0)/1024),_t=f.getTile(c).tileSize,Xt=512/Math.min(_t,512)*(c.overscaledZ/l.transform.zoom)*.5,Gt=c.canonical.toString();c.overscaledZ!==c.canonical.z&&(Gt+=" => "+c.overscaledZ),function(ie,Zt){ie.initDebugOverlayCanvas();var ne=ie.debugOverlayCanvas,ge=ie.context.gl,Ee=ie.debugOverlayCanvas.getContext("2d");Ee.clearRect(0,0,ne.width,ne.height),Ee.shadowColor="white",Ee.shadowBlur=2,Ee.lineWidth=1.5,Ee.strokeStyle="white",Ee.textBaseline="top",Ee.font="bold 36px Open Sans, sans-serif",Ee.fillText(Zt,5,5),Ee.strokeText(Zt,5,5),ie.debugOverlayTexture.update(ne),ie.debugOverlayTexture.bind(ge.LINEAR,ge.CLAMP_TO_EDGE)}(l,Gt+" "+Et+"kb"),T.draw(m,E.TRIANGLES,N,G,ae.alphaBlended,me.disabled,rl(M,s.Color.transparent,Xt),"$debug",l.debugBuffer,l.quadTriangleIndexBuffer,l.debugSegments)}var bi={symbol:function(l,f,c,m,E){if("translucent"===l.renderPass){var M=zt.disabled,T=l.colorModeForRenderPass();c.layout.get("text-variable-anchor")&&function(N,G,Q,yt,Et,_t,Xt){for(var Gt=G.transform,ie="map"===Et,Zt="map"===_t,ne=0,ge=N;ne<ge.length;ne+=1){var Ee=ge[ne],Ue=yt.getTile(Ee),Fe=Ue.getBucket(Q);if(Fe&&Fe.text&&Fe.text.segments.get().length){var We=s.evaluateSizeForZoom(Fe.textSizeData,Gt.zoom),er=Bo(Ue,1,G.transform.zoom),br=co(Ee.posMatrix,Zt,ie,G.transform,er),fr="none"!==Q.layout.get("icon-text-fit")&&Fe.hasIconData();if(We){var zr=Math.pow(2,Gt.zoom-Ue.tileID.overscaledZ);Ln(Fe,ie,Zt,Xt,s.symbolSize,Gt,br,Ee.posMatrix,zr,We,fr)}}}}(m,l,c,f,c.layout.get("text-rotation-alignment"),c.layout.get("text-pitch-alignment"),E),0!==c.paint.get("icon-opacity").constantOr(1)&&Gi(l,f,c,m,!1,c.paint.get("icon-translate"),c.paint.get("icon-translate-anchor"),c.layout.get("icon-rotation-alignment"),c.layout.get("icon-pitch-alignment"),c.layout.get("icon-keep-upright"),M,T),0!==c.paint.get("text-opacity").constantOr(1)&&Gi(l,f,c,m,!0,c.paint.get("text-translate"),c.paint.get("text-translate-anchor"),c.layout.get("text-rotation-alignment"),c.layout.get("text-pitch-alignment"),c.layout.get("text-keep-upright"),M,T),f.map.showCollisionBoxes&&(dr(l,f,c,m,c.paint.get("text-translate"),c.paint.get("text-translate-anchor"),!0),dr(l,f,c,m,c.paint.get("icon-translate"),c.paint.get("icon-translate-anchor"),!1))}},circle:function(l,f,c,m){if("translucent"===l.renderPass){var E=c.paint.get("circle-opacity"),M=c.paint.get("circle-stroke-width"),T=c.paint.get("circle-stroke-opacity"),N=!c.layout.get("circle-sort-key").isConstant();if(0!==E.constantOr(1)||0!==M.constantOr(1)&&0!==T.constantOr(1)){for(var G=l.context,Q=G.gl,yt=l.depthModeForSublayer(0,bt.ReadOnly),Et=zt.disabled,_t=l.colorModeForRenderPass(),Xt=[],Gt=0;Gt<m.length;Gt++){var ie=m[Gt],Zt=f.getTile(ie),ne=Zt.getBucket(c);if(ne){var ge=ne.programConfigurations.get(c.id),Ee={programConfiguration:ge,program:l.useProgram("circle",ge),layoutVertexBuffer:ne.layoutVertexBuffer,indexBuffer:ne.indexBuffer,uniformValues:Wu(l,ie,Zt,c)};if(N)for(var Ue=0,Fe=ne.segments.get();Ue<Fe.length;Ue+=1){var We=Fe[Ue];Xt.push({segments:new s.SegmentVector([We]),sortKey:We.sortKey,state:Ee})}else Xt.push({segments:ne.segments,sortKey:0,state:Ee})}}N&&Xt.sort(function(nn,sn){return nn.sortKey-sn.sortKey});for(var er=0,br=Xt;er<br.length;er+=1){var fr=br[er],zr=fr.state;zr.program.draw(G,Q.TRIANGLES,yt,Et,_t,me.disabled,zr.uniformValues,c.id,zr.layoutVertexBuffer,zr.indexBuffer,fr.segments,c.paint,l.transform.zoom,zr.programConfiguration)}}}},heatmap:function(l,f,c,m){if(0!==c.paint.get("heatmap-opacity"))if("offscreen"===l.renderPass){var E=l.context,M=E.gl,T=zt.disabled,N=new ae([M.ONE,M.ONE],s.Color.transparent,[!0,!0,!0,!0]);(function(Xt,Gt,ie){var Zt=Xt.gl;Xt.activeTexture.set(Zt.TEXTURE1),Xt.viewport.set([0,0,Gt.width/4,Gt.height/4]);var Ee,Ue,Fe,We,er,ne=ie.heatmapFbo;if(ne)Zt.bindTexture(Zt.TEXTURE_2D,ne.colorAttachment.get()),Xt.bindFramebuffer.set(ne.framebuffer);else{var ge=Zt.createTexture();Zt.bindTexture(Zt.TEXTURE_2D,ge),Zt.texParameteri(Zt.TEXTURE_2D,Zt.TEXTURE_WRAP_S,Zt.CLAMP_TO_EDGE),Zt.texParameteri(Zt.TEXTURE_2D,Zt.TEXTURE_WRAP_T,Zt.CLAMP_TO_EDGE),Zt.texParameteri(Zt.TEXTURE_2D,Zt.TEXTURE_MIN_FILTER,Zt.LINEAR),Zt.texParameteri(Zt.TEXTURE_2D,Zt.TEXTURE_MAG_FILTER,Zt.LINEAR),Fe=ge,We=ne=ie.heatmapFbo=Xt.createFramebuffer(Gt.width/4,Gt.height/4,!1),(er=(Ee=Xt).gl).texImage2D(er.TEXTURE_2D,0,er.RGBA,(Ue=Gt).width/4,Ue.height/4,0,er.RGBA,Ee.extRenderToTextureHalfFloat?Ee.extTextureHalfFloat.HALF_FLOAT_OES:er.UNSIGNED_BYTE,null),We.colorAttachment.set(Fe)}})(E,l,c),E.clear({color:s.Color.transparent});for(var G=0;G<m.length;G++){var Q=m[G];if(!f.hasRenderableParent(Q)){var yt=f.getTile(Q),Et=yt.getBucket(c);if(Et){var _t=Et.programConfigurations.get(c.id);l.useProgram("heatmap",_t).draw(E,M.TRIANGLES,bt.disabled,T,N,me.disabled,hi(Q.posMatrix,yt,l.transform.zoom,c.paint.get("heatmap-intensity")),c.id,Et.layoutVertexBuffer,Et.indexBuffer,Et.segments,c.paint,l.transform.zoom,_t)}}}E.viewport.set([0,0,l.width,l.height])}else"translucent"===l.renderPass&&(l.context.setColorMode(l.colorModeForRenderPass()),function(Xt,Gt){var ie=Xt.context,Zt=ie.gl,ne=Gt.heatmapFbo;if(ne){ie.activeTexture.set(Zt.TEXTURE0),Zt.bindTexture(Zt.TEXTURE_2D,ne.colorAttachment.get()),ie.activeTexture.set(Zt.TEXTURE1);var ge=Gt.colorRampTexture;ge||(ge=Gt.colorRampTexture=new s.Texture(ie,Gt.colorRamp,Zt.RGBA)),ge.bind(Zt.LINEAR,Zt.CLAMP_TO_EDGE),Xt.useProgram("heatmapTexture").draw(ie,Zt.TRIANGLES,bt.disabled,zt.disabled,Xt.colorModeForRenderPass(),me.disabled,function(Ee,Ue,Fe,We){var er=s.create();s.ortho(er,0,Ee.width,Ee.height,0,0,1);var br=Ee.context.gl;return{u_matrix:er,u_world:[br.drawingBufferWidth,br.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:Ue.paint.get("heatmap-opacity")}}(Xt,Gt),Gt.id,Xt.viewportBuffer,Xt.quadTriangleIndexBuffer,Xt.viewportSegments,Gt.paint,Xt.transform.zoom)}}(l,c))},line:function(l,f,c,m){if("translucent"===l.renderPass){var E=c.paint.get("line-opacity"),M=c.paint.get("line-width");if(0!==E.constantOr(1)&&0!==M.constantOr(1))for(var T=l.depthModeForSublayer(0,bt.ReadOnly),N=l.colorModeForRenderPass(),G=c.paint.get("line-dasharray"),Q=c.paint.get("line-pattern"),yt=Q.constantOr(1),Et=c.paint.get("line-gradient"),_t=c.getCrossfadeParameters(),Xt=yt?"linePattern":G?"lineSDF":Et?"lineGradient":"line",Gt=l.context,ie=Gt.gl,Zt=!0,ne=0,ge=m;ne<ge.length;ne+=1){var Ee=ge[ne],Ue=f.getTile(Ee);if(!yt||Ue.patternsLoaded()){var Fe=Ue.getBucket(c);if(Fe){var We=Fe.programConfigurations.get(c.id),er=l.context.program.get(),br=l.useProgram(Xt,We),fr=Zt||br.program!==er,zr=Q.constantOr(null);if(zr&&Ue.imageAtlas){var nn=Ue.imageAtlas,sn=nn.patternPositions[zr.to.toString()],on=nn.patternPositions[zr.from.toString()];sn&&on&&We.setConstantPatternPositions(sn,on)}var wi=yt?Qn(l,Ue,c,_t):G?qa(l,Ue,c,G,_t):Et?Eu(l,Ue,c,Fe.lineClipsArray.length):Wo(l,Ue,c);if(yt)Gt.activeTexture.set(ie.TEXTURE0),Ue.imageAtlasTexture.bind(ie.LINEAR,ie.CLAMP_TO_EDGE),We.updatePaintBuffers(_t);else if(G&&(fr||l.lineAtlas.dirty))Gt.activeTexture.set(ie.TEXTURE0),l.lineAtlas.bind(Gt);else if(Et){var Gr=Fe.gradients[c.id],Vn=Gr.texture;if(c.gradientVersion!==Gr.version){var ti=256;if(c.stepInterpolant){var Zn=f.getSource().maxzoom,Nn=Ee.canonical.z===Zn?Math.ceil(1<<l.transform.maxZoom-Ee.canonical.z):1;ti=s.clamp(s.nextPowerOfTwo(Fe.maxLineLength/s.EXTENT*1024*Nn),256,Gt.maxTextureSize)}Gr.gradient=s.renderColorRamp({expression:c.gradientExpression(),evaluationKey:"lineProgress",resolution:ti,image:Gr.gradient||void 0,clips:Fe.lineClipsArray}),Gr.texture?Gr.texture.update(Gr.gradient):Gr.texture=new s.Texture(Gt,Gr.gradient,ie.RGBA),Gr.version=c.gradientVersion,Vn=Gr.texture}Gt.activeTexture.set(ie.TEXTURE0),Vn.bind(c.stepInterpolant?ie.NEAREST:ie.LINEAR,ie.CLAMP_TO_EDGE)}br.draw(Gt,ie.TRIANGLES,T,l.stencilModeForClipping(Ee),N,me.disabled,wi,c.id,Fe.layoutVertexBuffer,Fe.indexBuffer,Fe.segments,c.paint,l.transform.zoom,We,Fe.layoutVertexBuffer2),Zt=!1}}}}},fill:function(l,f,c,m){var E=c.paint.get("fill-color"),M=c.paint.get("fill-opacity");if(0!==M.constantOr(1)){var T=l.colorModeForRenderPass(),N=c.paint.get("fill-pattern"),G=l.opaquePassEnabledForLayer()&&!N.constantOr(1)&&1===E.constantOr(s.Color.transparent).a&&1===M.constantOr(0)?"opaque":"translucent";if(l.renderPass===G){var Q=l.depthModeForSublayer(1,"opaque"===l.renderPass?bt.ReadWrite:bt.ReadOnly);mi(l,f,c,m,Q,T,!1)}if("translucent"===l.renderPass&&c.paint.get("fill-antialias")){var yt=l.depthModeForSublayer(c.getPaintProperty("fill-outline-color")?2:0,bt.ReadOnly);mi(l,f,c,m,yt,T,!0)}}},"fill-extrusion":function(l,f,c,m){var E=c.paint.get("fill-extrusion-opacity");if(0!==E&&"translucent"===l.renderPass){var M=new bt(l.context.gl.LEQUAL,bt.ReadWrite,l.depthRangeFor3D);if(1!==E||c.paint.get("fill-extrusion-pattern").constantOr(1))$o(l,f,c,m,M,zt.disabled,ae.disabled),$o(l,f,c,m,M,l.stencilModeFor3D(),l.colorModeForRenderPass());else{var T=l.colorModeForRenderPass();$o(l,f,c,m,M,zt.disabled,T)}}},hillshade:function(l,f,c,m){if("offscreen"===l.renderPass||"translucent"===l.renderPass){for(var E=l.context,M=l.depthModeForSublayer(0,bt.ReadOnly),T=l.colorModeForRenderPass(),N="translucent"===l.renderPass?l.stencilConfigForOverlap(m):[{},m],G=N[0],Q=0,yt=N[1];Q<yt.length;Q+=1){var Et=yt[Q],_t=f.getTile(Et);_t.needsHillshadePrepare&&"offscreen"===l.renderPass?Qa(l,_t,c,M,zt.disabled,T):"translucent"===l.renderPass&&As(l,_t,c,M,G[Et.overscaledZ],T)}E.viewport.set([0,0,l.width,l.height])}},raster:function(l,f,c,m){if("translucent"===l.renderPass&&0!==c.paint.get("raster-opacity")&&m.length)for(var E=l.context,M=E.gl,T=f.getSource(),N=l.useProgram("raster"),G=l.colorModeForRenderPass(),Q=T instanceof fe?[{},m]:l.stencilConfigForOverlap(m),yt=Q[0],Et=Q[1],_t=Et[Et.length-1].overscaledZ,Xt=!l.options.moving,Gt=0,ie=Et;Gt<ie.length;Gt+=1){var Zt=ie[Gt],ne=l.depthModeForSublayer(Zt.overscaledZ-_t,1===c.paint.get("raster-opacity")?bt.ReadWrite:bt.ReadOnly,M.LESS),ge=f.getTile(Zt),Ee=l.transform.calculatePosMatrix(Zt.toUnwrapped(),Xt);ge.registerFadeDuration(c.paint.get("raster-fade-duration"));var Ue=f.findLoadedParent(Zt,0),Fe=ys(ge,Ue,f,c,l.transform),We=void 0,er=void 0,br="nearest"===c.paint.get("raster-resampling")?M.NEAREST:M.LINEAR;E.activeTexture.set(M.TEXTURE0),ge.texture.bind(br,M.CLAMP_TO_EDGE,M.LINEAR_MIPMAP_NEAREST),E.activeTexture.set(M.TEXTURE1),Ue?(Ue.texture.bind(br,M.CLAMP_TO_EDGE,M.LINEAR_MIPMAP_NEAREST),We=Math.pow(2,Ue.tileID.overscaledZ-ge.tileID.overscaledZ),er=[ge.tileID.canonical.x*We%1,ge.tileID.canonical.y*We%1]):ge.texture.bind(br,M.CLAMP_TO_EDGE,M.LINEAR_MIPMAP_NEAREST);var fr=Cl(Ee,er||[0,0],We||1,Fe,c);T instanceof fe?N.draw(E,M.TRIANGLES,ne,zt.disabled,G,me.disabled,fr,c.id,T.boundsBuffer,l.quadTriangleIndexBuffer,T.boundsSegments):N.draw(E,M.TRIANGLES,ne,yt[Zt.overscaledZ],G,me.disabled,fr,c.id,l.rasterBoundsBuffer,l.quadTriangleIndexBuffer,l.rasterBoundsSegments)}},background:function(l,f,c){var m=c.paint.get("background-color"),E=c.paint.get("background-opacity");if(0!==E){var M=l.context,T=M.gl,N=l.transform,G=N.tileSize,Q=c.paint.get("background-pattern");if(!l.isPatternMissing(Q)){var yt=!Q&&1===m.a&&1===E&&l.opaquePassEnabledForLayer()?"opaque":"translucent";if(l.renderPass===yt){var Et=zt.disabled,_t=l.depthModeForSublayer(0,"opaque"===yt?bt.ReadWrite:bt.ReadOnly),Xt=l.colorModeForRenderPass(),Gt=l.useProgram(Q?"backgroundPattern":"background"),ie=N.coveringTiles({tileSize:G});Q&&(M.activeTexture.set(T.TEXTURE0),l.imageManager.bind(l.context));for(var Zt=c.getCrossfadeParameters(),ne=0,ge=ie;ne<ge.length;ne+=1){var Ee=ge[ne],Ue=l.transform.calculatePosMatrix(Ee.toUnwrapped()),Fe=Q?be(Ue,E,l,Q,{tileID:Ee,tileSize:G},Zt):Gs(Ue,E,m);Gt.draw(M,T.TRIANGLES,_t,Et,Xt,me.disabled,Fe,c.id,l.tileExtentBuffer,l.quadTriangleIndexBuffer,l.tileExtentSegments)}}}}},debug:function(l,f,c){for(var m=0;m<c.length;m++)Eo(l,f,c[m])},custom:function(l,f,c){var m=l.context,E=c.implementation;if("offscreen"===l.renderPass){var M=E.prerender;M&&(l.setCustomLayerDefaults(),m.setColorMode(l.colorModeForRenderPass()),M.call(E,m.gl,l.transform.customLayerMatrix()),m.setDirty(),l.setBaseState())}else if("translucent"===l.renderPass){l.setCustomLayerDefaults(),m.setColorMode(l.colorModeForRenderPass()),m.setStencilMode(zt.disabled);var T="3d"===E.renderingMode?new bt(l.context.gl.LEQUAL,bt.ReadWrite,l.depthRangeFor3D):l.depthModeForSublayer(0,bt.ReadOnly);m.setDepthMode(T),E.render(m.gl,l.transform.customLayerMatrix()),m.setDirty(),l.setBaseState(),m.bindFramebuffer.set(null)}}},si=function(l,f){this.context=new ue(l),this.transform=f,this._tileTextures={},this.setup(),this.numSublayers=Dt.maxUnderzooming+Dt.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Cr,this.gpuTimers={}};si.prototype.resize=function(l,f){if(this.width=l*s.browser.devicePixelRatio,this.height=f*s.browser.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(var c=0,m=this.style._order;c<m.length;c+=1)this.style._layers[m[c]].resize()},si.prototype.setup=function(){var l=this.context,f=new s.StructArrayLayout2i4;f.emplaceBack(0,0),f.emplaceBack(s.EXTENT,0),f.emplaceBack(0,s.EXTENT),f.emplaceBack(s.EXTENT,s.EXTENT),this.tileExtentBuffer=l.createVertexBuffer(f,Uo.members),this.tileExtentSegments=s.SegmentVector.simpleSegment(0,0,4,2);var c=new s.StructArrayLayout2i4;c.emplaceBack(0,0),c.emplaceBack(s.EXTENT,0),c.emplaceBack(0,s.EXTENT),c.emplaceBack(s.EXTENT,s.EXTENT),this.debugBuffer=l.createVertexBuffer(c,Uo.members),this.debugSegments=s.SegmentVector.simpleSegment(0,0,4,5);var m=new s.StructArrayLayout4i8;m.emplaceBack(0,0,0,0),m.emplaceBack(s.EXTENT,0,s.EXTENT,0),m.emplaceBack(0,s.EXTENT,0,s.EXTENT),m.emplaceBack(s.EXTENT,s.EXTENT,s.EXTENT,s.EXTENT),this.rasterBoundsBuffer=l.createVertexBuffer(m,$t.members),this.rasterBoundsSegments=s.SegmentVector.simpleSegment(0,0,4,2);var E=new s.StructArrayLayout2i4;E.emplaceBack(0,0),E.emplaceBack(1,0),E.emplaceBack(0,1),E.emplaceBack(1,1),this.viewportBuffer=l.createVertexBuffer(E,Uo.members),this.viewportSegments=s.SegmentVector.simpleSegment(0,0,4,2);var M=new s.StructArrayLayout1ui2;M.emplaceBack(0),M.emplaceBack(1),M.emplaceBack(3),M.emplaceBack(2),M.emplaceBack(0),this.tileBorderIndexBuffer=l.createIndexBuffer(M);var T=new s.StructArrayLayout3ui6;T.emplaceBack(0,1,2),T.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=l.createIndexBuffer(T),this.emptyTexture=new s.Texture(l,{width:1,height:1,data:new Uint8Array([0,0,0,0])},l.gl.RGBA);var N=this.context.gl;this.stencilClearMode=new zt({func:N.ALWAYS,mask:0},0,255,N.ZERO,N.ZERO,N.ZERO)},si.prototype.clearStencil=function(){var l=this.context,f=l.gl;this.nextStencilID=1,this.currentStencilSource=void 0;var c=s.create();s.ortho(c,0,this.width,this.height,0,0,1),s.scale(c,c,[f.drawingBufferWidth,f.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(l,f.TRIANGLES,bt.disabled,this.stencilClearMode,ae.disabled,me.disabled,Ua(c),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)},si.prototype._renderTileClippingMasks=function(l,f){if(this.currentStencilSource!==l.source&&l.isTileClipped()&&f&&f.length){this.currentStencilSource=l.source;var c=this.context,m=c.gl;this.nextStencilID+f.length>256&&this.clearStencil(),c.setColorMode(ae.disabled),c.setDepthMode(bt.disabled);var E=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(var M=0,T=f;M<T.length;M+=1){var N=T[M],G=this._tileClippingMaskIDs[N.key]=this.nextStencilID++;E.draw(c,m.TRIANGLES,bt.disabled,new zt({func:m.ALWAYS,mask:0},G,255,m.KEEP,m.KEEP,m.REPLACE),ae.disabled,me.disabled,Ua(N.posMatrix),"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}},si.prototype.stencilModeFor3D=function(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();var l=this.nextStencilID++,f=this.context.gl;return new zt({func:f.NOTEQUAL,mask:255},l,255,f.KEEP,f.KEEP,f.REPLACE)},si.prototype.stencilModeForClipping=function(l){var f=this.context.gl;return new zt({func:f.EQUAL,mask:255},this._tileClippingMaskIDs[l.key],0,f.KEEP,f.KEEP,f.REPLACE)},si.prototype.stencilConfigForOverlap=function(l){var f,c=this.context.gl,m=l.sort(function(G,Q){return Q.overscaledZ-G.overscaledZ}),E=m[m.length-1].overscaledZ,M=m[0].overscaledZ-E+1;if(M>1){this.currentStencilSource=void 0,this.nextStencilID+M>256&&this.clearStencil();for(var T={},N=0;N<M;N++)T[N+E]=new zt({func:c.GEQUAL,mask:255},N+this.nextStencilID,255,c.KEEP,c.KEEP,c.REPLACE);return this.nextStencilID+=M,[T,m]}return[(f={},f[E]=zt.disabled,f),m]},si.prototype.colorModeForRenderPass=function(){var l=this.context.gl;return this._showOverdrawInspector?new ae([l.CONSTANT_COLOR,l.ONE],new s.Color(1/8,1/8,1/8,0),[!0,!0,!0,!0]):"opaque"===this.renderPass?ae.unblended:ae.alphaBlended},si.prototype.depthModeForSublayer=function(l,f,c){if(!this.opaquePassEnabledForLayer())return bt.disabled;var m=1-((1+this.currentLayer)*this.numSublayers+l)*this.depthEpsilon;return new bt(c||this.context.gl.LEQUAL,f,[m,m])},si.prototype.opaquePassEnabledForLayer=function(){return this.currentLayer<this.opaquePassCutoff},si.prototype.render=function(l,f){var c=this;this.style=l,this.options=f,this.lineAtlas=l.lineAtlas,this.imageManager=l.imageManager,this.glyphManager=l.glyphManager,this.symbolFadeChange=l.placement.symbolFadeChange(s.browser.now()),this.imageManager.beginFrame();var m=this.style._order,E=this.style.sourceCaches;for(var M in E){var T=E[M];T.used&&T.prepare(this.context)}var N,G,Q={},yt={},Et={};for(var _t in E){var Xt=E[_t];Q[_t]=Xt.getVisibleCoordinates(),yt[_t]=Q[_t].slice().reverse(),Et[_t]=Xt.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(var Gt=0;Gt<m.length;Gt++)if(this.style._layers[m[Gt]].is3D()){this.opaquePassCutoff=Gt;break}this.renderPass="offscreen";for(var ie=0,Zt=m;ie<Zt.length;ie+=1){var ne=this.style._layers[Zt[ie]];if(ne.hasOffscreenPass()&&!ne.isHidden(this.transform.zoom)){var ge=yt[ne.source];("custom"===ne.type||ge.length)&&this.renderLayer(this,E[ne.source],ne,ge)}}for(this.context.bindFramebuffer.set(null),this.context.clear({color:f.showOverdrawInspector?s.Color.black:s.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=f.showOverdrawInspector,this.depthRangeFor3D=[0,1-(l._order.length+2)*this.numSublayers*this.depthEpsilon],this.renderPass="opaque",this.currentLayer=m.length-1;this.currentLayer>=0;this.currentLayer--){var Ee=this.style._layers[m[this.currentLayer]],Ue=E[Ee.source],Fe=Q[Ee.source];this._renderTileClippingMasks(Ee,Fe),this.renderLayer(this,Ue,Ee,Fe)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<m.length;this.currentLayer++){var We=this.style._layers[m[this.currentLayer]],er=E[We.source],br=("symbol"===We.type?Et:yt)[We.source];this._renderTileClippingMasks(We,Q[We.source]),this.renderLayer(this,er,We,br)}this.options.showTileBoundaries&&(s.values(this.style._layers).forEach(function(fr){fr.source&&!fr.isHidden(c.transform.zoom)&&(fr.source!==(G&&G.id)&&(G=c.style.sourceCaches[fr.source]),(!N||N.getSource().maxzoom<G.getSource().maxzoom)&&(N=G))}),N&&bi.debug(this,N,N.getVisibleCoordinates())),this.options.showPadding&&function(fr){var zr=fr.transform.padding;ua(fr,fr.transform.height-(zr.top||0),3,Qs),ua(fr,zr.bottom||0,3,Vs),js(fr,zr.left||0,3,vs),js(fr,fr.transform.width-(zr.right||0),3,Go);var sn,on,wi,Gr,nn=fr.transform.centerPoint;du(sn=fr,(on=nn.x)-1,(wi=fr.transform.height-nn.y)-10,2,20,Gr=Zs),du(sn,on-10,wi-1,20,2,Gr)}(this),this.context.setDefault()},si.prototype.renderLayer=function(l,f,c,m){c.isHidden(this.transform.zoom)||("background"===c.type||"custom"===c.type||m.length)&&(this.id=c.id,this.gpuTimingStart(c),bi[c.type](l,f,c,m,this.style.placement.variableOffsets),this.gpuTimingEnd())},si.prototype.gpuTimingStart=function(l){if(this.options.gpuTiming){var f=this.context.extTimerQuery,c=this.gpuTimers[l.id];c||(c=this.gpuTimers[l.id]={calls:0,cpuTime:0,query:f.createQueryEXT()}),c.calls++,f.beginQueryEXT(f.TIME_ELAPSED_EXT,c.query)}},si.prototype.gpuTimingEnd=function(){if(this.options.gpuTiming){var l=this.context.extTimerQuery;l.endQueryEXT(l.TIME_ELAPSED_EXT)}},si.prototype.collectGpuTimers=function(){var l=this.gpuTimers;return this.gpuTimers={},l},si.prototype.queryGpuTimers=function(l){var f={};for(var c in l){var m=l[c],E=this.context.extTimerQuery,M=E.getQueryObjectEXT(m.query,E.QUERY_RESULT_EXT)/1e6;E.deleteQueryEXT(m.query),f[c]=M}return f},si.prototype.translatePosMatrix=function(l,f,c,m,E){if(!c[0]&&!c[1])return l;var M=E?"map"===m?this.transform.angle:0:"viewport"===m?-this.transform.angle:0;if(M){var T=Math.sin(M),N=Math.cos(M);c=[c[0]*N-c[1]*T,c[0]*T+c[1]*N]}var G=[E?c[0]:Bo(f,c[0],this.transform.zoom),E?c[1]:Bo(f,c[1],this.transform.zoom),0],Q=new Float32Array(16);return s.translate(Q,l,G),Q},si.prototype.saveTileTexture=function(l){var f=this._tileTextures[l.size[0]];f?f.push(l):this._tileTextures[l.size[0]]=[l]},si.prototype.getTileTexture=function(l){var f=this._tileTextures[l];return f&&f.length>0?f.pop():null},si.prototype.isPatternMissing=function(l){if(!l)return!1;if(!l.from||!l.to)return!0;var f=this.imageManager.getPattern(l.from.toString()),c=this.imageManager.getPattern(l.to.toString());return!f||!c},si.prototype.useProgram=function(l,f){this.cache=this.cache||{};var c=""+l+(f?f.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"");return this.cache[c]||(this.cache[c]=new Ts(this.context,l,Us[l],f,Ye[l],this._showOverdrawInspector)),this.cache[c]},si.prototype.setCustomLayerDefaults=function(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()},si.prototype.setBaseState=function(){var l=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(l.FUNC_ADD)},si.prototype.initDebugOverlayCanvas=function(){null==this.debugOverlayCanvas&&(this.debugOverlayCanvas=s.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new s.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))},si.prototype.destroy=function(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()};var ba=function(l,f){this.points=l,this.planes=f};ba.fromInvProjectionMatrix=function(l,f,c){var m=Math.pow(2,c),E=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(function(T){return s.transformMat4([],T,l)}).map(function(T){return s.scale$1([],T,1/T[3]/f*m)}),M=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(function(T){var N=s.sub([],E[T[0]],E[T[1]]),G=s.sub([],E[T[2]],E[T[1]]),Q=s.normalize([],s.cross([],N,G)),yt=-s.dot(Q,E[T[1]]);return Q.concat(yt)});return new ba(E,M)};var Po=function(l,f){this.min=l,this.max=f,this.center=s.scale$2([],s.add([],this.min,this.max),.5)};Po.prototype.quadrant=function(l){for(var f=[l%2==0,l<2],c=s.clone$2(this.min),m=s.clone$2(this.max),E=0;E<f.length;E++)c[E]=f[E]?this.min[E]:this.center[E],m[E]=f[E]?this.center[E]:this.max[E];return m[2]=this.max[2],new Po(c,m)},Po.prototype.distanceX=function(l){return Math.max(Math.min(this.max[0],l[0]),this.min[0])-l[0]},Po.prototype.distanceY=function(l){return Math.max(Math.min(this.max[1],l[1]),this.min[1])-l[1]},Po.prototype.intersects=function(l){for(var f=[[this.min[0],this.min[1],0,1],[this.max[0],this.min[1],0,1],[this.max[0],this.max[1],0,1],[this.min[0],this.max[1],0,1]],c=!0,m=0;m<l.planes.length;m++){for(var E=l.planes[m],M=0,T=0;T<f.length;T++)M+=s.dot$1(E,f[T])>=0;if(0===M)return 0;M!==f.length&&(c=!1)}if(c)return 2;for(var N=0;N<3;N++){for(var G=Number.MAX_VALUE,Q=-Number.MAX_VALUE,yt=0;yt<l.points.length;yt++){var Et=l.points[yt][N]-this.min[N];G=Math.min(G,Et),Q=Math.max(Q,Et)}if(Q<0||G>this.max[N]-this.min[N])return 0}return 1};var po=function(l,f,c,m){if(void 0===l&&(l=0),void 0===f&&(f=0),void 0===c&&(c=0),void 0===m&&(m=0),isNaN(l)||l<0||isNaN(f)||f<0||isNaN(c)||c<0||isNaN(m)||m<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=l,this.bottom=f,this.left=c,this.right=m};po.prototype.interpolate=function(l,f,c){return null!=f.top&&null!=l.top&&(this.top=s.number(l.top,f.top,c)),null!=f.bottom&&null!=l.bottom&&(this.bottom=s.number(l.bottom,f.bottom,c)),null!=f.left&&null!=l.left&&(this.left=s.number(l.left,f.left,c)),null!=f.right&&null!=l.right&&(this.right=s.number(l.right,f.right,c)),this},po.prototype.getCenter=function(l,f){var c=s.clamp((this.left+l-this.right)/2,0,l),m=s.clamp((this.top+f-this.bottom)/2,0,f);return new s.Point(c,m)},po.prototype.equals=function(l){return this.top===l.top&&this.bottom===l.bottom&&this.left===l.left&&this.right===l.right},po.prototype.clone=function(){return new po(this.top,this.bottom,this.left,this.right)},po.prototype.toJSON=function(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}};var En=function(l,f,c,m,E){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=void 0===E||E,this._minZoom=l||0,this._maxZoom=f||22,this._minPitch=c??0,this._maxPitch=m??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new s.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new po,this._posMatrixCache={},this._alignedPosMatrixCache={}},jn={minZoom:{configurable:!0},maxZoom:{configurable:!0},minPitch:{configurable:!0},maxPitch:{configurable:!0},renderWorldCopies:{configurable:!0},worldSize:{configurable:!0},centerOffset:{configurable:!0},size:{configurable:!0},bearing:{configurable:!0},pitch:{configurable:!0},fov:{configurable:!0},zoom:{configurable:!0},center:{configurable:!0},padding:{configurable:!0},centerPoint:{configurable:!0},unmodified:{configurable:!0},point:{configurable:!0}};En.prototype.clone=function(){var l=new En(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return l.tileSize=this.tileSize,l.latRange=this.latRange,l.width=this.width,l.height=this.height,l._center=this._center,l.zoom=this.zoom,l.angle=this.angle,l._fov=this._fov,l._pitch=this._pitch,l._unmodified=this._unmodified,l._edgeInsets=this._edgeInsets.clone(),l._calcMatrices(),l},jn.minZoom.get=function(){return this._minZoom},jn.minZoom.set=function(l){this._minZoom!==l&&(this._minZoom=l,this.zoom=Math.max(this.zoom,l))},jn.maxZoom.get=function(){return this._maxZoom},jn.maxZoom.set=function(l){this._maxZoom!==l&&(this._maxZoom=l,this.zoom=Math.min(this.zoom,l))},jn.minPitch.get=function(){return this._minPitch},jn.minPitch.set=function(l){this._minPitch!==l&&(this._minPitch=l,this.pitch=Math.max(this.pitch,l))},jn.maxPitch.get=function(){return this._maxPitch},jn.maxPitch.set=function(l){this._maxPitch!==l&&(this._maxPitch=l,this.pitch=Math.min(this.pitch,l))},jn.renderWorldCopies.get=function(){return this._renderWorldCopies},jn.renderWorldCopies.set=function(l){void 0===l?l=!0:null===l&&(l=!1),this._renderWorldCopies=l},jn.worldSize.get=function(){return this.tileSize*this.scale},jn.centerOffset.get=function(){return this.centerPoint._sub(this.size._div(2))},jn.size.get=function(){return new s.Point(this.width,this.height)},jn.bearing.get=function(){return-this.angle/Math.PI*180},jn.bearing.set=function(l){var f=-s.wrap(l,-180,180)*Math.PI/180;this.angle!==f&&(this._unmodified=!1,this.angle=f,this._calcMatrices(),this.rotationMatrix=s.create$2(),s.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))},jn.pitch.get=function(){return this._pitch/Math.PI*180},jn.pitch.set=function(l){var f=s.clamp(l,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==f&&(this._unmodified=!1,this._pitch=f,this._calcMatrices())},jn.fov.get=function(){return this._fov/Math.PI*180},jn.fov.set=function(l){l=Math.max(.01,Math.min(60,l)),this._fov!==l&&(this._unmodified=!1,this._fov=l/180*Math.PI,this._calcMatrices())},jn.zoom.get=function(){return this._zoom},jn.zoom.set=function(l){var f=Math.min(Math.max(l,this.minZoom),this.maxZoom);this._zoom!==f&&(this._unmodified=!1,this._zoom=f,this.scale=this.zoomScale(f),this.tileZoom=Math.floor(f),this.zoomFraction=f-this.tileZoom,this._constrain(),this._calcMatrices())},jn.center.get=function(){return this._center},jn.center.set=function(l){l.lat===this._center.lat&&l.lng===this._center.lng||(this._unmodified=!1,this._center=l,this._constrain(),this._calcMatrices())},jn.padding.get=function(){return this._edgeInsets.toJSON()},jn.padding.set=function(l){this._edgeInsets.equals(l)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,l,1),this._calcMatrices())},jn.centerPoint.get=function(){return this._edgeInsets.getCenter(this.width,this.height)},En.prototype.isPaddingEqual=function(l){return this._edgeInsets.equals(l)},En.prototype.interpolatePadding=function(l,f,c){this._unmodified=!1,this._edgeInsets.interpolate(l,f,c),this._constrain(),this._calcMatrices()},En.prototype.coveringZoomLevel=function(l){var f=(l.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/l.tileSize));return Math.max(0,f)},En.prototype.getVisibleUnwrappedCoordinates=function(l){var f=[new s.UnwrappedTileID(0,l)];if(this._renderWorldCopies)for(var c=this.pointCoordinate(new s.Point(0,0)),m=this.pointCoordinate(new s.Point(this.width,0)),E=this.pointCoordinate(new s.Point(this.width,this.height)),M=this.pointCoordinate(new s.Point(0,this.height)),T=Math.floor(Math.min(c.x,m.x,E.x,M.x)),N=Math.floor(Math.max(c.x,m.x,E.x,M.x)),G=T-1;G<=N+1;G++)0!==G&&f.push(new s.UnwrappedTileID(G,l));return f},En.prototype.coveringTiles=function(l){var f=this.coveringZoomLevel(l),c=f;if(void 0!==l.minzoom&&f<l.minzoom)return[];void 0!==l.maxzoom&&f>l.maxzoom&&(f=l.maxzoom);var m=s.MercatorCoordinate.fromLngLat(this.center),E=Math.pow(2,f),M=[E*m.x,E*m.y,0],T=ba.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,f),N=l.minzoom||0;this.pitch<=60&&this._edgeInsets.top<.1&&(N=f);var G=function(fr){return{aabb:new Po([fr*E,0,0],[(fr+1)*E,E,0]),zoom:0,x:0,y:0,wrap:fr,fullyVisible:!1}},Q=[],yt=[],Et=f,_t=l.reparseOverscaled?c:f;if(this._renderWorldCopies)for(var Xt=1;Xt<=3;Xt++)Q.push(G(-Xt)),Q.push(G(Xt));for(Q.push(G(0));Q.length>0;){var Gt=Q.pop(),ie=Gt.x,Zt=Gt.y,ne=Gt.fullyVisible;if(!ne){var ge=Gt.aabb.intersects(T);if(0===ge)continue;ne=2===ge}var Ee=Gt.aabb.distanceX(M),Ue=Gt.aabb.distanceY(M),Fe=Math.max(Math.abs(Ee),Math.abs(Ue));if(Gt.zoom===Et||Fe>3+(1<<Et-Gt.zoom)-2&&Gt.zoom>=N)yt.push({tileID:new s.OverscaledTileID(Gt.zoom===Et?_t:Gt.zoom,Gt.wrap,Gt.zoom,ie,Zt),distanceSq:s.sqrLen([M[0]-.5-ie,M[1]-.5-Zt])});else for(var We=0;We<4;We++){var er=(ie<<1)+We%2,br=(Zt<<1)+(We>>1);Q.push({aabb:Gt.aabb.quadrant(We),zoom:Gt.zoom+1,x:er,y:br,wrap:Gt.wrap,fullyVisible:ne})}}return yt.sort(function(fr,zr){return fr.distanceSq-zr.distanceSq}).map(function(fr){return fr.tileID})},En.prototype.resize=function(l,f){this.width=l,this.height=f,this.pixelsToGLUnits=[2/l,-2/f],this._constrain(),this._calcMatrices()},jn.unmodified.get=function(){return this._unmodified},En.prototype.zoomScale=function(l){return Math.pow(2,l)},En.prototype.scaleZoom=function(l){return Math.log(l)/Math.LN2},En.prototype.project=function(l){var f=s.clamp(l.lat,-this.maxValidLatitude,this.maxValidLatitude);return new s.Point(s.mercatorXfromLng(l.lng)*this.worldSize,s.mercatorYfromLat(f)*this.worldSize)},En.prototype.unproject=function(l){return new s.MercatorCoordinate(l.x/this.worldSize,l.y/this.worldSize).toLngLat()},jn.point.get=function(){return this.project(this.center)},En.prototype.setLocationAtPoint=function(l,f){var c=this.pointCoordinate(f),m=this.pointCoordinate(this.centerPoint),E=this.locationCoordinate(l),M=new s.MercatorCoordinate(E.x-(c.x-m.x),E.y-(c.y-m.y));this.center=this.coordinateLocation(M),this._renderWorldCopies&&(this.center=this.center.wrap())},En.prototype.locationPoint=function(l){return this.coordinatePoint(this.locationCoordinate(l))},En.prototype.pointLocation=function(l){return this.coordinateLocation(this.pointCoordinate(l))},En.prototype.locationCoordinate=function(l){return s.MercatorCoordinate.fromLngLat(l)},En.prototype.coordinateLocation=function(l){return l.toLngLat()},En.prototype.pointCoordinate=function(l){var f=[l.x,l.y,0,1],c=[l.x,l.y,1,1];s.transformMat4(f,f,this.pixelMatrixInverse),s.transformMat4(c,c,this.pixelMatrixInverse);var m=f[3],E=c[3],M=f[1]/m,T=c[1]/E,N=f[2]/m,G=c[2]/E,Q=N===G?0:(0-N)/(G-N);return new s.MercatorCoordinate(s.number(f[0]/m,c[0]/E,Q)/this.worldSize,s.number(M,T,Q)/this.worldSize)},En.prototype.coordinatePoint=function(l){var f=[l.x*this.worldSize,l.y*this.worldSize,0,1];return s.transformMat4(f,f,this.pixelMatrix),new s.Point(f[0]/f[3],f[1]/f[3])},En.prototype.getBounds=function(){return(new s.LngLatBounds).extend(this.pointLocation(new s.Point(0,0))).extend(this.pointLocation(new s.Point(this.width,0))).extend(this.pointLocation(new s.Point(this.width,this.height))).extend(this.pointLocation(new s.Point(0,this.height)))},En.prototype.getMaxBounds=function(){return this.latRange&&2===this.latRange.length&&this.lngRange&&2===this.lngRange.length?new s.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null},En.prototype.setMaxBounds=function(l){l?(this.lngRange=[l.getWest(),l.getEast()],this.latRange=[l.getSouth(),l.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])},En.prototype.calculatePosMatrix=function(l,f){void 0===f&&(f=!1);var c=l.key,m=f?this._alignedPosMatrixCache:this._posMatrixCache;if(m[c])return m[c];var E=l.canonical,M=this.worldSize/this.zoomScale(E.z),T=E.x+Math.pow(2,E.z)*l.wrap,N=s.identity(new Float64Array(16));return s.translate(N,N,[T*M,E.y*M,0]),s.scale(N,N,[M/s.EXTENT,M/s.EXTENT,1]),s.multiply(N,f?this.alignedProjMatrix:this.projMatrix,N),m[c]=new Float32Array(N),m[c]},En.prototype.customLayerMatrix=function(){return this.mercatorMatrix.slice()},En.prototype._constrain=function(){if(this.center&&this.width&&this.height&&!this._constraining){this._constraining=!0;var l,f,c,m,E=-90,M=90,T=-180,N=180,G=this.size,Q=this._unmodified;if(this.latRange){var yt=this.latRange;E=s.mercatorYfromLat(yt[1])*this.worldSize,l=(M=s.mercatorYfromLat(yt[0])*this.worldSize)-E<G.y?G.y/(M-E):0}if(this.lngRange){var Et=this.lngRange;T=s.mercatorXfromLng(Et[0])*this.worldSize,f=(N=s.mercatorXfromLng(Et[1])*this.worldSize)-T<G.x?G.x/(N-T):0}var _t=this.point,Xt=Math.max(f||0,l||0);if(Xt)return this.center=this.unproject(new s.Point(f?(N+T)/2:_t.x,l?(M+E)/2:_t.y)),this.zoom+=this.scaleZoom(Xt),this._unmodified=Q,void(this._constraining=!1);if(this.latRange){var Gt=_t.y,ie=G.y/2;Gt-ie<E&&(m=E+ie),Gt+ie>M&&(m=M-ie)}if(this.lngRange){var Zt=_t.x,ne=G.x/2;Zt-ne<T&&(c=T+ne),Zt+ne>N&&(c=N-ne)}void 0===c&&void 0===m||(this.center=this.unproject(new s.Point(void 0!==c?c:_t.x,void 0!==m?m:_t.y))),this._unmodified=Q,this._constraining=!1}},En.prototype._calcMatrices=function(){if(this.height){var l=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height;var f=Math.PI/2+this._pitch,c=this._fov*(.5+l.y/this.height),m=Math.sin(c)*this.cameraToCenterDistance/Math.sin(s.clamp(Math.PI-f-c,.01,Math.PI-.01)),E=this.point,M=E.x,T=E.y,N=1.01*(Math.cos(Math.PI/2-this._pitch)*m+this.cameraToCenterDistance),G=this.height/50,Q=new Float64Array(16);s.perspective(Q,this._fov,this.width/this.height,G,N),Q[8]=2*-l.x/this.width,Q[9]=2*l.y/this.height,s.scale(Q,Q,[1,-1,1]),s.translate(Q,Q,[0,0,-this.cameraToCenterDistance]),s.rotateX(Q,Q,this._pitch),s.rotateZ(Q,Q,this.angle),s.translate(Q,Q,[-M,-T,0]),this.mercatorMatrix=s.scale([],Q,[this.worldSize,this.worldSize,this.worldSize]),s.scale(Q,Q,[1,1,s.mercatorZfromAltitude(1,this.center.lat)*this.worldSize,1]),this.projMatrix=Q,this.invProjMatrix=s.invert([],this.projMatrix);var yt=this.width%2/2,Et=this.height%2/2,_t=Math.cos(this.angle),Xt=Math.sin(this.angle),Gt=M-Math.round(M)+_t*yt+Xt*Et,ie=T-Math.round(T)+_t*Et+Xt*yt,Zt=new Float64Array(Q);if(s.translate(Zt,Zt,[Gt>.5?Gt-1:Gt,ie>.5?ie-1:ie,0]),this.alignedProjMatrix=Zt,Q=s.create(),s.scale(Q,Q,[this.width/2,-this.height/2,1]),s.translate(Q,Q,[1,-1,0]),this.labelPlaneMatrix=Q,Q=s.create(),s.scale(Q,Q,[1,-1,1]),s.translate(Q,Q,[-1,-1,0]),s.scale(Q,Q,[2/this.width,2/this.height,1]),this.glCoordMatrix=Q,this.pixelMatrix=s.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),!(Q=s.invert(new Float64Array(16),this.pixelMatrix)))throw new Error("failed to invert matrix");this.pixelMatrixInverse=Q,this._posMatrixCache={},this._alignedPosMatrixCache={}}},En.prototype.maxPitchScaleFactor=function(){if(!this.pixelMatrixInverse)return 1;var l=this.pointCoordinate(new s.Point(0,0)),f=[l.x*this.worldSize,l.y*this.worldSize,0,1];return s.transformMat4(f,f,this.pixelMatrix)[3]/this.cameraToCenterDistance},En.prototype.getCameraPoint=function(){var l=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new s.Point(0,l))},En.prototype.getCameraQueryGeometry=function(l){var f=this.getCameraPoint();if(1===l.length)return[l[0],f];for(var c=f.x,m=f.y,E=f.x,M=f.y,T=0,N=l;T<N.length;T+=1){var G=N[T];c=Math.min(c,G.x),m=Math.min(m,G.y),E=Math.max(E,G.x),M=Math.max(M,G.y)}return[new s.Point(c,m),new s.Point(E,m),new s.Point(E,M),new s.Point(c,M),new s.Point(c,m)]},Object.defineProperties(En.prototype,jn);var Va=function(l){var f,c,m,E;this._hashName=l&&encodeURIComponent(l),s.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=(f=this._updateHashUnthrottled.bind(this),c=!1,m=null,E=function(){m=null,c&&(f(),m=setTimeout(E,300),c=!1)},function(){return c=!0,m||E(),m})};Va.prototype.addTo=function(l){return this._map=l,s.window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this},Va.prototype.remove=function(){return s.window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this},Va.prototype.getHashString=function(l){var f=this._map.getCenter(),c=Math.round(100*this._map.getZoom())/100,m=Math.ceil((c*Math.LN2+Math.log(512/360/.5))/Math.LN10),E=Math.pow(10,m),M=Math.round(f.lng*E)/E,T=Math.round(f.lat*E)/E,N=this._map.getBearing(),G=this._map.getPitch(),Q="";if(Q+=l?"/"+M+"/"+T+"/"+c:c+"/"+T+"/"+M,(N||G)&&(Q+="/"+Math.round(10*N)/10),G&&(Q+="/"+Math.round(G)),this._hashName){var yt=this._hashName,Et=!1,_t=s.window.location.hash.slice(1).split("&").map(function(Xt){var Gt=Xt.split("=")[0];return Gt===yt?(Et=!0,Gt+"="+Q):Xt}).filter(function(Xt){return Xt});return Et||_t.push(yt+"="+Q),"#"+_t.join("&")}return"#"+Q},Va.prototype._getCurrentHash=function(){var l,f=this,c=s.window.location.hash.replace("#","");return this._hashName?(c.split("&").map(function(m){return m.split("=")}).forEach(function(m){m[0]===f._hashName&&(l=m)}),(l&&l[1]||"").split("/")):c.split("/")},Va.prototype._onHashChange=function(){var l=this._getCurrentHash();if(l.length>=3&&!l.some(function(c){return isNaN(c)})){var f=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(l[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+l[2],+l[1]],zoom:+l[0],bearing:f,pitch:+(l[4]||0)}),!0}return!1},Va.prototype._updateHashUnthrottled=function(){var l=s.window.location.href.replace(/(#.+)?$/,this.getHashString());try{s.window.history.replaceState(s.window.history.state,null,l)}catch{}};var Za={linearity:.3,easing:s.bezier(0,0,.3,1)},Ro=s.extend({deceleration:2500,maxSpeed:1400},Za),fo=s.extend({deceleration:20,maxSpeed:1400},Za),ts=s.extend({deceleration:1e3,maxSpeed:360},Za),hs=s.extend({deceleration:1e3,maxSpeed:90},Za),Bu=function(l){this._map=l,this.clear()};function tu(l,f){(!l.duration||l.duration<f.duration)&&(l.duration=f.duration,l.easing=f.easing)}function _s(l,f,c){var m=c.maxSpeed,E=c.linearity,M=c.deceleration,T=s.clamp(l*E/(f/1e3),-m,m),N=Math.abs(T)/(M*E);return{easing:c.easing,duration:1e3*N,amount:T*(N/2)}}Bu.prototype.clear=function(){this._inertiaBuffer=[]},Bu.prototype.record=function(l){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:s.browser.now(),settings:l})},Bu.prototype._drainInertiaBuffer=function(){for(var l=this._inertiaBuffer,f=s.browser.now();l.length>0&&f-l[0].time>160;)l.shift()},Bu.prototype._onMoveEnd=function(l){if(this._drainInertiaBuffer(),!(this._inertiaBuffer.length<2)){for(var f={zoom:0,bearing:0,pitch:0,pan:new s.Point(0,0),pinchAround:void 0,around:void 0},c=0,m=this._inertiaBuffer;c<m.length;c+=1){var E=m[c].settings;f.zoom+=E.zoomDelta||0,f.bearing+=E.bearingDelta||0,f.pitch+=E.pitchDelta||0,E.panDelta&&f.pan._add(E.panDelta),E.around&&(f.around=E.around),E.pinchAround&&(f.pinchAround=E.pinchAround)}var M=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,T={};if(f.pan.mag()){var N=_s(f.pan.mag(),M,s.extend({},Ro,l||{}));T.offset=f.pan.mult(N.amount/f.pan.mag()),T.center=this._map.transform.center,tu(T,N)}if(f.zoom){var G=_s(f.zoom,M,fo);T.zoom=this._map.transform.zoom+G.amount,tu(T,G)}if(f.bearing){var Q=_s(f.bearing,M,ts);T.bearing=this._map.transform.bearing+s.clamp(Q.amount,-179,179),tu(T,Q)}if(f.pitch){var yt=_s(f.pitch,M,hs);T.pitch=this._map.transform.pitch+yt.amount,tu(T,yt)}if(T.zoom||T.bearing){var Et=void 0===f.pinchAround?f.around:f.pinchAround;T.around=Et?this._map.unproject(Et):this._map.getCenter()}return this.clear(),s.extend(T,{noMoveStart:!0})}};var ao=function(l){function f(m,E,M,T){void 0===T&&(T={});var N=ht.mousePos(E.getCanvasContainer(),M),G=E.unproject(N);l.call(this,m,s.extend({point:N,lngLat:G,originalEvent:M},T)),this._defaultPrevented=!1,this.target=E}l&&(f.__proto__=l),(f.prototype=Object.create(l&&l.prototype)).constructor=f;var c={defaultPrevented:{configurable:!0}};return f.prototype.preventDefault=function(){this._defaultPrevented=!0},c.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(f.prototype,c),f}(s.Event),es=function(l){function f(m,E,M){var T="touchend"===m?M.changedTouches:M.touches,N=ht.touchPos(E.getCanvasContainer(),T),G=N.map(function(Et){return E.unproject(Et)}),Q=N.reduce(function(Et,_t,Xt,Gt){return Et.add(_t.div(Gt.length))},new s.Point(0,0)),yt=E.unproject(Q);l.call(this,m,{points:N,point:Q,lngLats:G,lngLat:yt,originalEvent:M}),this._defaultPrevented=!1}l&&(f.__proto__=l),(f.prototype=Object.create(l&&l.prototype)).constructor=f;var c={defaultPrevented:{configurable:!0}};return f.prototype.preventDefault=function(){this._defaultPrevented=!0},c.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(f.prototype,c),f}(s.Event),ea=function(l){function f(m,E,M){l.call(this,m,{originalEvent:M}),this._defaultPrevented=!1}l&&(f.__proto__=l),(f.prototype=Object.create(l&&l.prototype)).constructor=f;var c={defaultPrevented:{configurable:!0}};return f.prototype.preventDefault=function(){this._defaultPrevented=!0},c.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(f.prototype,c),f}(s.Event),wa=function(l,f){this._map=l,this._clickTolerance=f.clickTolerance};wa.prototype.reset=function(){delete this._mousedownPos},wa.prototype.wheel=function(l){return this._firePreventable(new ea(l.type,this._map,l))},wa.prototype.mousedown=function(l,f){return this._mousedownPos=f,this._firePreventable(new ao(l.type,this._map,l))},wa.prototype.mouseup=function(l){this._map.fire(new ao(l.type,this._map,l))},wa.prototype.click=function(l,f){this._mousedownPos&&this._mousedownPos.dist(f)>=this._clickTolerance||this._map.fire(new ao(l.type,this._map,l))},wa.prototype.dblclick=function(l){return this._firePreventable(new ao(l.type,this._map,l))},wa.prototype.mouseover=function(l){this._map.fire(new ao(l.type,this._map,l))},wa.prototype.mouseout=function(l){this._map.fire(new ao(l.type,this._map,l))},wa.prototype.touchstart=function(l){return this._firePreventable(new es(l.type,this._map,l))},wa.prototype.touchmove=function(l){this._map.fire(new es(l.type,this._map,l))},wa.prototype.touchend=function(l){this._map.fire(new es(l.type,this._map,l))},wa.prototype.touchcancel=function(l){this._map.fire(new es(l.type,this._map,l))},wa.prototype._firePreventable=function(l){if(this._map.fire(l),l.defaultPrevented)return{}},wa.prototype.isEnabled=function(){return!0},wa.prototype.isActive=function(){return!1},wa.prototype.enable=function(){},wa.prototype.disable=function(){};var ra=function(l){this._map=l};ra.prototype.reset=function(){this._delayContextMenu=!1,delete this._contextMenuEvent},ra.prototype.mousemove=function(l){this._map.fire(new ao(l.type,this._map,l))},ra.prototype.mousedown=function(){this._delayContextMenu=!0},ra.prototype.mouseup=function(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new ao("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)},ra.prototype.contextmenu=function(l){this._delayContextMenu?this._contextMenuEvent=l:this._map.fire(new ao(l.type,this._map,l)),this._map.listens("contextmenu")&&l.preventDefault()},ra.prototype.isEnabled=function(){return!0},ra.prototype.isActive=function(){return!1},ra.prototype.enable=function(){},ra.prototype.disable=function(){};var _r=function(l,f){this._map=l,this._el=l.getCanvasContainer(),this._container=l.getContainer(),this._clickTolerance=f.clickTolerance||1};function Ls(l,f){for(var c={},m=0;m<l.length;m++)c[l[m].identifier]=f[m];return c}_r.prototype.isEnabled=function(){return!!this._enabled},_r.prototype.isActive=function(){return!!this._active},_r.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},_r.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},_r.prototype.mousedown=function(l,f){this.isEnabled()&&l.shiftKey&&0===l.button&&(ht.disableDrag(),this._startPos=this._lastPos=f,this._active=!0)},_r.prototype.mousemoveWindow=function(l,f){if(this._active){var c=f;if(!(this._lastPos.equals(c)||!this._box&&c.dist(this._startPos)<this._clickTolerance)){var m=this._startPos;this._lastPos=c,this._box||(this._box=ht.create("div","maplibregl-boxzoom mapboxgl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair","mapboxgl-crosshair"),this._fireEvent("boxzoomstart",l));var E=Math.min(m.x,c.x),M=Math.max(m.x,c.x),T=Math.min(m.y,c.y),N=Math.max(m.y,c.y);ht.setTransform(this._box,"translate("+E+"px,"+T+"px)"),this._box.style.width=M-E+"px",this._box.style.height=N-T+"px"}}},_r.prototype.mouseupWindow=function(l,f){var c=this;if(this._active&&0===l.button){var m=this._startPos,E=f;if(this.reset(),ht.suppressClick(),m.x!==E.x||m.y!==E.y)return this._map.fire(new s.Event("boxzoomend",{originalEvent:l})),{cameraAnimation:function(M){return M.fitScreenCoordinates(m,E,c._map.getBearing(),{linear:!0})}};this._fireEvent("boxzoomcancel",l)}},_r.prototype.keydown=function(l){this._active&&27===l.keyCode&&(this.reset(),this._fireEvent("boxzoomcancel",l))},_r.prototype.reset=function(){this._active=!1,this._container.classList.remove("maplibregl-crosshair","mapboxgl-crosshair"),this._box&&(ht.remove(this._box),this._box=null),ht.enableDrag(),delete this._startPos,delete this._lastPos},_r.prototype._fireEvent=function(l,f){return this._map.fire(new s.Event(l,{originalEvent:f}))};var Cu=function(l){this.reset(),this.numTouches=l.numTouches};Cu.prototype.reset=function(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1},Cu.prototype.touchstart=function(l,f,c){(this.centroid||c.length>this.numTouches)&&(this.aborted=!0),this.aborted||(void 0===this.startTime&&(this.startTime=l.timeStamp),c.length===this.numTouches&&(this.centroid=function(m){for(var E=new s.Point(0,0),M=0,T=m;M<T.length;M+=1)E._add(T[M]);return E.div(m.length)}(f),this.touches=Ls(c,f)))},Cu.prototype.touchmove=function(l,f,c){if(!this.aborted&&this.centroid){var m=Ls(c,f);for(var E in this.touches){var M=m[E];(!M||M.dist(this.touches[E])>30)&&(this.aborted=!0)}}},Cu.prototype.touchend=function(l,f,c){if((!this.centroid||l.timeStamp-this.startTime>500)&&(this.aborted=!0),0===c.length){var m=!this.aborted&&this.centroid;if(this.reset(),m)return m}};var gu=function(l){this.singleTap=new Cu(l),this.numTaps=l.numTaps,this.reset()};gu.prototype.reset=function(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()},gu.prototype.touchstart=function(l,f,c){this.singleTap.touchstart(l,f,c)},gu.prototype.touchmove=function(l,f,c){this.singleTap.touchmove(l,f,c)},gu.prototype.touchend=function(l,f,c){var m=this.singleTap.touchend(l,f,c);if(m){var E=l.timeStamp-this.lastTime<500,M=!this.lastTap||this.lastTap.dist(m)<30;if(E&&M||this.reset(),this.count++,this.lastTime=l.timeStamp,this.lastTap=m,this.count===this.numTaps)return this.reset(),m}};var na=function(){this._zoomIn=new gu({numTouches:1,numTaps:2}),this._zoomOut=new gu({numTouches:2,numTaps:1}),this.reset()};na.prototype.reset=function(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()},na.prototype.touchstart=function(l,f,c){this._zoomIn.touchstart(l,f,c),this._zoomOut.touchstart(l,f,c)},na.prototype.touchmove=function(l,f,c){this._zoomIn.touchmove(l,f,c),this._zoomOut.touchmove(l,f,c)},na.prototype.touchend=function(l,f,c){var m=this,E=this._zoomIn.touchend(l,f,c),M=this._zoomOut.touchend(l,f,c);return E?(this._active=!0,l.preventDefault(),setTimeout(function(){return m.reset()},0),{cameraAnimation:function(T){return T.easeTo({duration:300,zoom:T.getZoom()+1,around:T.unproject(E)},{originalEvent:l})}}):M?(this._active=!0,l.preventDefault(),setTimeout(function(){return m.reset()},0),{cameraAnimation:function(T){return T.easeTo({duration:300,zoom:T.getZoom()-1,around:T.unproject(M)},{originalEvent:l})}}):void 0},na.prototype.touchcancel=function(){this.reset()},na.prototype.enable=function(){this._enabled=!0},na.prototype.disable=function(){this._enabled=!1,this.reset()},na.prototype.isEnabled=function(){return this._enabled},na.prototype.isActive=function(){return this._active};var Lu={0:1,2:2},So=function(l){this.reset(),this._clickTolerance=l.clickTolerance||1};So.prototype.reset=function(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton},So.prototype._correctButton=function(l,f){return!1},So.prototype._move=function(l,f){return{}},So.prototype.mousedown=function(l,f){if(!this._lastPoint){var c=ht.mouseButton(l);this._correctButton(l,c)&&(this._lastPoint=f,this._eventButton=c)}},So.prototype.mousemoveWindow=function(l,f){var m,M,c=this._lastPoint;if(c)if(l.preventDefault(),M=Lu[this._eventButton],void 0===(m=l).buttons||(m.buttons&M)!==M)this.reset();else if(this._moved||!(f.dist(c)<this._clickTolerance))return this._moved=!0,this._lastPoint=f,this._move(c,f)},So.prototype.mouseupWindow=function(l){this._lastPoint&&ht.mouseButton(l)===this._eventButton&&(this._moved&&ht.suppressClick(),this.reset())},So.prototype.enable=function(){this._enabled=!0},So.prototype.disable=function(){this._enabled=!1,this.reset()},So.prototype.isEnabled=function(){return this._enabled},So.prototype.isActive=function(){return this._active};var Ir=function(l){function f(){l.apply(this,arguments)}return l&&(f.__proto__=l),(f.prototype=Object.create(l&&l.prototype)).constructor=f,f.prototype.mousedown=function(c,m){l.prototype.mousedown.call(this,c,m),this._lastPoint&&(this._active=!0)},f.prototype._correctButton=function(c,m){return 0===m&&!c.ctrlKey},f.prototype._move=function(c,m){return{around:m,panDelta:m.sub(c)}},f}(So),Vo=function(l){function f(){l.apply(this,arguments)}return l&&(f.__proto__=l),(f.prototype=Object.create(l&&l.prototype)).constructor=f,f.prototype._correctButton=function(c,m){return 0===m&&c.ctrlKey||2===m},f.prototype._move=function(c,m){var E=.8*(m.x-c.x);if(E)return this._active=!0,{bearingDelta:E}},f.prototype.contextmenu=function(c){c.preventDefault()},f}(So),jl=function(l){function f(){l.apply(this,arguments)}return l&&(f.__proto__=l),(f.prototype=Object.create(l&&l.prototype)).constructor=f,f.prototype._correctButton=function(c,m){return 0===m&&c.ctrlKey||2===m},f.prototype._move=function(c,m){var E=-.5*(m.y-c.y);if(E)return this._active=!0,{pitchDelta:E}},f.prototype.contextmenu=function(c){c.preventDefault()},f}(So),eu=function(l){this._minTouches=1,this._clickTolerance=l.clickTolerance||1,this.reset()};eu.prototype.reset=function(){this._active=!1,this._touches={},this._sum=new s.Point(0,0)},eu.prototype.touchstart=function(l,f,c){return this._calculateTransform(l,f,c)},eu.prototype.touchmove=function(l,f,c){if(this._active&&!(c.length<this._minTouches))return l.preventDefault(),this._calculateTransform(l,f,c)},eu.prototype.touchend=function(l,f,c){this._calculateTransform(l,f,c),this._active&&c.length<this._minTouches&&this.reset()},eu.prototype.touchcancel=function(){this.reset()},eu.prototype._calculateTransform=function(l,f,c){c.length>0&&(this._active=!0);var m=Ls(c,f),E=new s.Point(0,0),M=new s.Point(0,0),T=0;for(var N in m){var G=m[N],Q=this._touches[N];Q&&(E._add(G),M._add(G.sub(Q)),T++,m[N]=G)}if(this._touches=m,!(T<this._minTouches)&&M.mag()){var yt=M.div(T);if(this._sum._add(yt),!(this._sum.mag()<this._clickTolerance))return{around:E.div(T),panDelta:yt}}},eu.prototype.enable=function(){this._enabled=!0},eu.prototype.disable=function(){this._enabled=!1,this.reset()},eu.prototype.isEnabled=function(){return this._enabled},eu.prototype.isActive=function(){return this._active};var Co=function(){this.reset()};function Du(l,f,c){for(var m=0;m<l.length;m++)if(l[m].identifier===c)return f[m]}function lc(l,f){return Math.log(l/f)/Math.LN2}Co.prototype.reset=function(){this._active=!1,delete this._firstTwoTouches},Co.prototype._start=function(l){},Co.prototype._move=function(l,f,c){return{}},Co.prototype.touchstart=function(l,f,c){this._firstTwoTouches||c.length<2||(this._firstTwoTouches=[c[0].identifier,c[1].identifier],this._start([f[0],f[1]]))},Co.prototype.touchmove=function(l,f,c){if(this._firstTwoTouches){l.preventDefault();var m=this._firstTwoTouches,E=m[1],M=Du(c,f,m[0]),T=Du(c,f,E);if(M&&T){var N=this._aroundCenter?null:M.add(T).div(2);return this._move([M,T],N,l)}}},Co.prototype.touchend=function(l,f,c){if(this._firstTwoTouches){var m=this._firstTwoTouches,E=m[1],M=Du(c,f,m[0]),T=Du(c,f,E);M&&T||(this._active&&ht.suppressClick(),this.reset())}},Co.prototype.touchcancel=function(){this.reset()},Co.prototype.enable=function(l){this._enabled=!0,this._aroundCenter=!!l&&"center"===l.around},Co.prototype.disable=function(){this._enabled=!1,this.reset()},Co.prototype.isEnabled=function(){return this._enabled},Co.prototype.isActive=function(){return this._active};var nl=function(l){function f(){l.apply(this,arguments)}return l&&(f.__proto__=l),(f.prototype=Object.create(l&&l.prototype)).constructor=f,f.prototype.reset=function(){l.prototype.reset.call(this),delete this._distance,delete this._startDistance},f.prototype._start=function(c){this._startDistance=this._distance=c[0].dist(c[1])},f.prototype._move=function(c,m){var E=this._distance;if(this._distance=c[0].dist(c[1]),this._active||!(Math.abs(lc(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:lc(this._distance,E),pinchAround:m}},f}(Co);function ga(l,f){return 180*l.angleWith(f)/Math.PI}var Zo=function(l){function f(){l.apply(this,arguments)}return l&&(f.__proto__=l),(f.prototype=Object.create(l&&l.prototype)).constructor=f,f.prototype.reset=function(){l.prototype.reset.call(this),delete this._minDiameter,delete this._startVector,delete this._vector},f.prototype._start=function(c){this._startVector=this._vector=c[0].sub(c[1]),this._minDiameter=c[0].dist(c[1])},f.prototype._move=function(c,m){var E=this._vector;if(this._vector=c[0].sub(c[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:ga(this._vector,E),pinchAround:m}},f.prototype._isBelowThreshold=function(c){this._minDiameter=Math.min(this._minDiameter,c.mag());var m=25/(Math.PI*this._minDiameter)*360,E=ga(c,this._startVector);return Math.abs(E)<m},f}(Co);function ja(l){return Math.abs(l.y)>Math.abs(l.x)}var ul=function(l){function f(){l.apply(this,arguments)}return l&&(f.__proto__=l),(f.prototype=Object.create(l&&l.prototype)).constructor=f,f.prototype.reset=function(){l.prototype.reset.call(this),this._valid=void 0,delete this._firstMove,delete this._lastPoints},f.prototype._start=function(c){this._lastPoints=c,ja(c[0].sub(c[1]))&&(this._valid=!1)},f.prototype._move=function(c,m,E){var M=c[0].sub(this._lastPoints[0]),T=c[1].sub(this._lastPoints[1]);if(this._valid=this.gestureBeginsVertically(M,T,E.timeStamp),this._valid)return this._lastPoints=c,this._active=!0,{pitchDelta:(M.y+T.y)/2*-.5}},f.prototype.gestureBeginsVertically=function(c,m,E){if(void 0!==this._valid)return this._valid;var M=c.mag()>=2,T=m.mag()>=2;if(M||T){if(!M||!T)return void 0===this._firstMove&&(this._firstMove=E),E-this._firstMove<100&&void 0;var N=c.y>0==m.y>0;return ja(c)&&ja(m)&&N}},f}(Co),rs={panStep:100,bearingStep:15,pitchStep:10},Xs=function(){var l=rs;this._panStep=l.panStep,this._bearingStep=l.bearingStep,this._pitchStep=l.pitchStep,this._rotationDisabled=!1};function Xl(l){return l*(2-l)}Xs.prototype.reset=function(){this._active=!1},Xs.prototype.keydown=function(l){var f=this;if(!(l.altKey||l.ctrlKey||l.metaKey)){var c=0,m=0,E=0,M=0,T=0;switch(l.keyCode){case 61:case 107:case 171:case 187:c=1;break;case 189:case 109:case 173:c=-1;break;case 37:l.shiftKey?m=-1:(l.preventDefault(),M=-1);break;case 39:l.shiftKey?m=1:(l.preventDefault(),M=1);break;case 38:l.shiftKey?E=1:(l.preventDefault(),T=-1);break;case 40:l.shiftKey?E=-1:(l.preventDefault(),T=1);break;default:return}return this._rotationDisabled&&(m=0,E=0),{cameraAnimation:function(N){var G=N.getZoom();N.easeTo({duration:300,easeId:"keyboardHandler",easing:Xl,zoom:c?Math.round(G)+c*(l.shiftKey?2:1):G,bearing:N.getBearing()+m*f._bearingStep,pitch:N.getPitch()+E*f._pitchStep,offset:[-M*f._panStep,-T*f._panStep],center:N.getCenter()},{originalEvent:l})}}}},Xs.prototype.enable=function(){this._enabled=!0},Xs.prototype.disable=function(){this._enabled=!1,this.reset()},Xs.prototype.isEnabled=function(){return this._enabled},Xs.prototype.isActive=function(){return this._active},Xs.prototype.disableRotation=function(){this._rotationDisabled=!0},Xs.prototype.enableRotation=function(){this._rotationDisabled=!1};var ui=function(l,f){this._map=l,this._el=l.getCanvasContainer(),this._handler=f,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=1/450,s.bindAll(["_onTimeout"],this)};ui.prototype.setZoomRate=function(l){this._defaultZoomRate=l},ui.prototype.setWheelZoomRate=function(l){this._wheelZoomRate=l},ui.prototype.isEnabled=function(){return!!this._enabled},ui.prototype.isActive=function(){return!!this._active||void 0!==this._finishTimeout},ui.prototype.isZooming=function(){return!!this._zooming},ui.prototype.enable=function(l){this.isEnabled()||(this._enabled=!0,this._aroundCenter=l&&"center"===l.around)},ui.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},ui.prototype.wheel=function(l){if(this.isEnabled()){var f=l.deltaMode===s.window.WheelEvent.DOM_DELTA_LINE?40*l.deltaY:l.deltaY,c=s.browser.now(),m=c-(this._lastWheelEventTime||0);this._lastWheelEventTime=c,0!==f&&f%4.000244140625==0?this._type="wheel":0!==f&&Math.abs(f)<4?this._type="trackpad":m>400?(this._type=null,this._lastValue=f,this._timeout=setTimeout(this._onTimeout,40,l)):this._type||(this._type=Math.abs(m*f)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,f+=this._lastValue)),l.shiftKey&&f&&(f/=4),this._type&&(this._lastWheelEvent=l,this._delta-=f,this._active||this._start(l)),l.preventDefault()}},ui.prototype._onTimeout=function(l){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(l)},ui.prototype._start=function(l){if(this._delta){this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);var f=ht.mousePos(this._el,l);this._around=s.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(f)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}},ui.prototype.renderFrame=function(){var l=this;if(this._frameId&&(this._frameId=null,this.isActive())){var f=this._map.transform;if(0!==this._delta){var c="wheel"===this._type&&Math.abs(this._delta)>4.000244140625?this._wheelZoomRate:this._defaultZoomRate,m=2/(1+Math.exp(-Math.abs(this._delta*c)));this._delta<0&&0!==m&&(m=1/m);var E="number"==typeof this._targetZoom?f.zoomScale(this._targetZoom):f.scale;this._targetZoom=Math.min(f.maxZoom,Math.max(f.minZoom,f.scaleZoom(E*m))),"wheel"===this._type&&(this._startZoom=f.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}var M,T="number"==typeof this._targetZoom?this._targetZoom:f.zoom,N=this._startZoom,G=this._easing,Q=!1;if("wheel"===this._type&&N&&G){var yt=Math.min((s.browser.now()-this._lastWheelEventTime)/200,1),Et=G(yt);M=s.number(N,T,Et),yt<1?this._frameId||(this._frameId=!0):Q=!0}else M=T,Q=!0;return this._active=!0,Q&&(this._active=!1,this._finishTimeout=setTimeout(function(){l._zooming=!1,l._handler._triggerRenderFrame(),delete l._targetZoom,delete l._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!Q,zoomDelta:M-f.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}},ui.prototype._smoothOutEasing=function(l){var f=s.ease;if(this._prevEase){var c=this._prevEase,m=(s.browser.now()-c.start)/c.duration,E=c.easing(m+.01)-c.easing(m),M=.27/Math.sqrt(E*E+1e-4)*.01,T=Math.sqrt(.0729-M*M);f=s.bezier(M,T,.25,1)}return this._prevEase={start:s.browser.now(),duration:l,easing:f},f},ui.prototype.reset=function(){this._active=!1};var so=function(l,f){this._clickZoom=l,this._tapZoom=f};so.prototype.enable=function(){this._clickZoom.enable(),this._tapZoom.enable()},so.prototype.disable=function(){this._clickZoom.disable(),this._tapZoom.disable()},so.prototype.isEnabled=function(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()},so.prototype.isActive=function(){return this._clickZoom.isActive()||this._tapZoom.isActive()};var ka=function(){this.reset()};ka.prototype.reset=function(){this._active=!1},ka.prototype.dblclick=function(l,f){return l.preventDefault(),{cameraAnimation:function(c){c.easeTo({duration:300,zoom:c.getZoom()+(l.shiftKey?-1:1),around:c.unproject(f)},{originalEvent:l})}}},ka.prototype.enable=function(){this._enabled=!0},ka.prototype.disable=function(){this._enabled=!1,this.reset()},ka.prototype.isEnabled=function(){return this._enabled},ka.prototype.isActive=function(){return this._active};var ru=function(){this._tap=new gu({numTouches:1,numTaps:1}),this.reset()};ru.prototype.reset=function(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()},ru.prototype.touchstart=function(l,f,c){this._swipePoint||(this._tapTime&&l.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?c.length>0&&(this._swipePoint=f[0],this._swipeTouch=c[0].identifier):this._tap.touchstart(l,f,c))},ru.prototype.touchmove=function(l,f,c){if(this._tapTime){if(this._swipePoint){if(c[0].identifier!==this._swipeTouch)return;var m=f[0],E=m.y-this._swipePoint.y;return this._swipePoint=m,l.preventDefault(),this._active=!0,{zoomDelta:E/128}}}else this._tap.touchmove(l,f,c)},ru.prototype.touchend=function(l,f,c){this._tapTime?this._swipePoint&&0===c.length&&this.reset():this._tap.touchend(l,f,c)&&(this._tapTime=l.timeStamp)},ru.prototype.touchcancel=function(){this.reset()},ru.prototype.enable=function(){this._enabled=!0},ru.prototype.disable=function(){this._enabled=!1,this.reset()},ru.prototype.isEnabled=function(){return this._enabled},ru.prototype.isActive=function(){return this._active};var Ds=function(l,f,c){this._el=l,this._mousePan=f,this._touchPan=c};Ds.prototype.enable=function(l){this._inertiaOptions=l||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan","mapboxgl-touch-drag-pan")},Ds.prototype.disable=function(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan","mapboxgl-touch-drag-pan")},Ds.prototype.isEnabled=function(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()},Ds.prototype.isActive=function(){return this._mousePan.isActive()||this._touchPan.isActive()};var Il=function(l,f,c){this._pitchWithRotate=l.pitchWithRotate,this._mouseRotate=f,this._mousePitch=c};Il.prototype.enable=function(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()},Il.prototype.disable=function(){this._mouseRotate.disable(),this._mousePitch.disable()},Il.prototype.isEnabled=function(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())},Il.prototype.isActive=function(){return this._mouseRotate.isActive()||this._mousePitch.isActive()};var Uu=function(l,f,c,m){this._el=l,this._touchZoom=f,this._touchRotate=c,this._tapDragZoom=m,this._rotationDisabled=!1,this._enabled=!0};Uu.prototype.enable=function(l){this._touchZoom.enable(l),this._rotationDisabled||this._touchRotate.enable(l),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate","mapboxgl-touch-zoom-rotate")},Uu.prototype.disable=function(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate","mapboxgl-touch-zoom-rotate")},Uu.prototype.isEnabled=function(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()},Uu.prototype.isActive=function(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()},Uu.prototype.disableRotation=function(){this._rotationDisabled=!0,this._touchRotate.disable()},Uu.prototype.enableRotation=function(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()};var xs=function(l){return l.zoom||l.drag||l.pitch||l.rotate},ps=function(l){function f(){l.apply(this,arguments)}return l&&(f.__proto__=l),(f.prototype=Object.create(l&&l.prototype)).constructor=f,f}(s.Event);function mu(l){return l.panDelta&&l.panDelta.mag()||l.zoomDelta||l.bearingDelta||l.pitchDelta}var Dr=function(l,f){this._map=l,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Bu(l),this._bearingSnap=f.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(f),s.bindAll(["handleEvent","handleWindowEvent"],this);var c=this._el;this._listeners=[[c,"touchstart",{passive:!0}],[c,"touchmove",{passive:!1}],[c,"touchend",void 0],[c,"touchcancel",void 0],[c,"mousedown",void 0],[c,"mousemove",void 0],[c,"mouseup",void 0],[s.window.document,"mousemove",{capture:!0}],[s.window.document,"mouseup",void 0],[c,"mouseover",void 0],[c,"mouseout",void 0],[c,"dblclick",void 0],[c,"click",void 0],[c,"keydown",{capture:!1}],[c,"keyup",void 0],[c,"wheel",{passive:!1}],[c,"contextmenu",void 0],[s.window,"blur",void 0]];for(var m=0,E=this._listeners;m<E.length;m+=1){var M=E[m],T=M[0];ht.addEventListener(T,M[1],T===s.window.document?this.handleWindowEvent:this.handleEvent,M[2])}};Dr.prototype.destroy=function(){for(var l=0,f=this._listeners;l<f.length;l+=1){var c=f[l],m=c[0];ht.removeEventListener(m,c[1],m===s.window.document?this.handleWindowEvent:this.handleEvent,c[2])}},Dr.prototype._addDefaultHandlers=function(l){var f=this._map,c=f.getCanvasContainer();this._add("mapEvent",new wa(f,l));var m=f.boxZoom=new _r(f,l);this._add("boxZoom",m);var E=new na,M=new ka;f.doubleClickZoom=new so(M,E),this._add("tapZoom",E),this._add("clickZoom",M);var T=new ru;this._add("tapDragZoom",T);var N=f.touchPitch=new ul;this._add("touchPitch",N);var G=new Vo(l),Q=new jl(l);f.dragRotate=new Il(l,G,Q),this._add("mouseRotate",G,["mousePitch"]),this._add("mousePitch",Q,["mouseRotate"]);var yt=new Ir(l),Et=new eu(l);f.dragPan=new Ds(c,yt,Et),this._add("mousePan",yt),this._add("touchPan",Et,["touchZoom","touchRotate"]);var _t=new Zo,Xt=new nl;f.touchZoomRotate=new Uu(c,Xt,_t,T),this._add("touchRotate",_t,["touchPan","touchZoom"]),this._add("touchZoom",Xt,["touchPan","touchRotate"]);var Gt=f.scrollZoom=new ui(f,this);this._add("scrollZoom",Gt,["mousePan"]);var ie=f.keyboard=new Xs;this._add("keyboard",ie),this._add("blockableMapEvent",new ra(f));for(var Zt=0,ne=["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"];Zt<ne.length;Zt+=1){var ge=ne[Zt];l.interactive&&l[ge]&&f[ge].enable(l[ge])}},Dr.prototype._add=function(l,f,c){this._handlers.push({handlerName:l,handler:f,allowed:c}),this._handlersById[l]=f},Dr.prototype.stop=function(l){if(!this._updatingCamera){for(var f=0,c=this._handlers;f<c.length;f+=1)c[f].handler.reset();this._inertia.clear(),this._fireEvents({},{},l),this._changes=[]}},Dr.prototype.isActive=function(){for(var l=0,f=this._handlers;l<f.length;l+=1)if(f[l].handler.isActive())return!0;return!1},Dr.prototype.isZooming=function(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()},Dr.prototype.isRotating=function(){return!!this._eventsInProgress.rotate},Dr.prototype.isMoving=function(){return Boolean(xs(this._eventsInProgress))||this.isZooming()},Dr.prototype._blockedByActive=function(l,f,c){for(var m in l)if(m!==c&&(!f||f.indexOf(m)<0))return!0;return!1},Dr.prototype.handleWindowEvent=function(l){this.handleEvent(l,l.type+"Window")},Dr.prototype._getMapTouches=function(l){for(var f=[],c=0,m=l;c<m.length;c+=1){var E=m[c];this._el.contains(E.target)&&f.push(E)}return f},Dr.prototype.handleEvent=function(l,f){if("blur"!==l.type){this._updatingCamera=!0;for(var c="renderFrame"===l.type?void 0:l,m={needsRenderFrame:!1},E={},M={},T=l.touches?this._getMapTouches(l.touches):void 0,N=T?ht.touchPos(this._el,T):ht.mousePos(this._el,l),G=0,Q=this._handlers;G<Q.length;G+=1){var yt=Q[G],Et=yt.handlerName,_t=yt.handler,Xt=yt.allowed;if(_t.isEnabled()){var Gt=void 0;this._blockedByActive(M,Xt,Et)?_t.reset():_t[f||l.type]&&(Gt=_t[f||l.type](l,N,T),this.mergeHandlerResult(m,E,Gt,Et,c),Gt&&Gt.needsRenderFrame&&this._triggerRenderFrame()),(Gt||_t.isActive())&&(M[Et]=_t)}}var ie={};for(var Zt in this._previousActiveHandlers)M[Zt]||(ie[Zt]=c);this._previousActiveHandlers=M,(Object.keys(ie).length||mu(m))&&(this._changes.push([m,E,ie]),this._triggerRenderFrame()),(Object.keys(M).length||mu(m))&&this._map._stop(!0),this._updatingCamera=!1;var ne=m.cameraAnimation;ne&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],ne(this._map))}else this.stop(!0)},Dr.prototype.mergeHandlerResult=function(l,f,c,m,E){if(c){s.extend(l,c);var M={handlerName:m,originalEvent:c.originalEvent||E};void 0!==c.zoomDelta&&(f.zoom=M),void 0!==c.panDelta&&(f.drag=M),void 0!==c.pitchDelta&&(f.pitch=M),void 0!==c.bearingDelta&&(f.rotate=M)}},Dr.prototype._applyChanges=function(){for(var l={},f={},c={},m=0,E=this._changes;m<E.length;m+=1){var M=E[m],T=M[0],N=M[1],G=M[2];T.panDelta&&(l.panDelta=(l.panDelta||new s.Point(0,0))._add(T.panDelta)),T.zoomDelta&&(l.zoomDelta=(l.zoomDelta||0)+T.zoomDelta),T.bearingDelta&&(l.bearingDelta=(l.bearingDelta||0)+T.bearingDelta),T.pitchDelta&&(l.pitchDelta=(l.pitchDelta||0)+T.pitchDelta),void 0!==T.around&&(l.around=T.around),void 0!==T.pinchAround&&(l.pinchAround=T.pinchAround),T.noInertia&&(l.noInertia=T.noInertia),s.extend(f,N),s.extend(c,G)}this._updateMapTransform(l,f,c),this._changes=[]},Dr.prototype._updateMapTransform=function(l,f,c){var m=this._map,E=m.transform;if(!mu(l))return this._fireEvents(f,c,!0);var M=l.panDelta,T=l.zoomDelta,N=l.bearingDelta,G=l.pitchDelta,Q=l.around,yt=l.pinchAround;void 0!==yt&&(Q=yt),m._stop(!0),Q=Q||m.transform.centerPoint;var Et=E.pointLocation(M?Q.sub(M):Q);N&&(E.bearing+=N),G&&(E.pitch+=G),T&&(E.zoom+=T),E.setLocationAtPoint(Et,Q),this._map._update(),l.noInertia||this._inertia.record(l),this._fireEvents(f,c,!0)},Dr.prototype._fireEvents=function(l,f,c){var m=this,E=xs(this._eventsInProgress),M=xs(l),T={};for(var N in l)this._eventsInProgress[N]||(T[N+"start"]=l[N].originalEvent),this._eventsInProgress[N]=l[N];for(var G in!E&&M&&this._fireEvent("movestart",M.originalEvent),T)this._fireEvent(G,T[G]);for(var Q in M&&this._fireEvent("move",M.originalEvent),l)this._fireEvent(Q,l[Q].originalEvent);var yt,Et={};for(var _t in this._eventsInProgress){var Xt=this._eventsInProgress[_t],Gt=Xt.handlerName,ie=Xt.originalEvent;this._handlersById[Gt].isActive()||(delete this._eventsInProgress[_t],Et[_t+"end"]=yt=f[Gt]||ie)}for(var Zt in Et)this._fireEvent(Zt,Et[Zt]);var ne=xs(this._eventsInProgress);if(c&&(E||M)&&!ne){this._updatingCamera=!0;var ge=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),Ee=function(Ue){return 0!==Ue&&-m._bearingSnap<Ue&&Ue<m._bearingSnap};ge?(Ee(ge.bearing||this._map.getBearing())&&(ge.bearing=0),this._map.easeTo(ge,{originalEvent:yt})):(this._map.fire(new s.Event("moveend",{originalEvent:yt})),Ee(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}},Dr.prototype._fireEvent=function(l,f){this._map.fire(new s.Event(l,f?{originalEvent:f}:{}))},Dr.prototype._requestFrame=function(){var l=this;return this._map.triggerRepaint(),this._map._renderTaskQueue.add(function(f){delete l._frameId,l.handleEvent(new ps("renderFrame",{timeStamp:f})),l._applyChanges()})},Dr.prototype._triggerRenderFrame=function(){void 0===this._frameId&&(this._frameId=this._requestFrame())};var cn=function(l){function f(c,m){l.call(this),this._moving=!1,this._zooming=!1,this.transform=c,this._bearingSnap=m.bearingSnap,s.bindAll(["_renderFrameCallback"],this)}return l&&(f.__proto__=l),(f.prototype=Object.create(l&&l.prototype)).constructor=f,f.prototype.getCenter=function(){return new s.LngLat(this.transform.center.lng,this.transform.center.lat)},f.prototype.setCenter=function(c,m){return this.jumpTo({center:c},m)},f.prototype.panBy=function(c,m,E){return c=s.Point.convert(c).mult(-1),this.panTo(this.transform.center,s.extend({offset:c},m),E)},f.prototype.panTo=function(c,m,E){return this.easeTo(s.extend({center:c},m),E)},f.prototype.getZoom=function(){return this.transform.zoom},f.prototype.setZoom=function(c,m){return this.jumpTo({zoom:c},m),this},f.prototype.zoomTo=function(c,m,E){return this.easeTo(s.extend({zoom:c},m),E)},f.prototype.zoomIn=function(c,m){return this.zoomTo(this.getZoom()+1,c,m),this},f.prototype.zoomOut=function(c,m){return this.zoomTo(this.getZoom()-1,c,m),this},f.prototype.getBearing=function(){return this.transform.bearing},f.prototype.setBearing=function(c,m){return this.jumpTo({bearing:c},m),this},f.prototype.getPadding=function(){return this.transform.padding},f.prototype.setPadding=function(c,m){return this.jumpTo({padding:c},m),this},f.prototype.rotateTo=function(c,m,E){return this.easeTo(s.extend({bearing:c},m),E)},f.prototype.resetNorth=function(c,m){return this.rotateTo(0,s.extend({duration:1e3},c),m),this},f.prototype.resetNorthPitch=function(c,m){return this.easeTo(s.extend({bearing:0,pitch:0,duration:1e3},c),m),this},f.prototype.snapToNorth=function(c,m){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(c,m):this},f.prototype.getPitch=function(){return this.transform.pitch},f.prototype.setPitch=function(c,m){return this.jumpTo({pitch:c},m),this},f.prototype.cameraForBounds=function(c,m){c=s.LngLatBounds.convert(c);var E=m&&m.bearing||0;return this._cameraForBoxAndBearing(c.getNorthWest(),c.getSouthEast(),E,m)},f.prototype._cameraForBoxAndBearing=function(c,m,E,M){var T={top:0,bottom:0,right:0,left:0};if("number"==typeof(M=s.extend({padding:T,offset:[0,0],maxZoom:this.transform.maxZoom},M)).padding){var N=M.padding;M.padding={top:N,bottom:N,right:N,left:N}}M.padding=s.extend(T,M.padding);var G=this.transform,Q=G.padding,yt=G.project(s.LngLat.convert(c)),Et=G.project(s.LngLat.convert(m)),_t=yt.rotate(-E*Math.PI/180),Xt=Et.rotate(-E*Math.PI/180),Gt=new s.Point(Math.max(_t.x,Xt.x),Math.max(_t.y,Xt.y)),ie=new s.Point(Math.min(_t.x,Xt.x),Math.min(_t.y,Xt.y)),Zt=Gt.sub(ie),ne=(G.width-(Q.left+Q.right+M.padding.left+M.padding.right))/Zt.x,ge=(G.height-(Q.top+Q.bottom+M.padding.top+M.padding.bottom))/Zt.y;if(!(ge<0||ne<0)){var Ee=Math.min(G.scaleZoom(G.scale*Math.min(ne,ge)),M.maxZoom),Ue="number"==typeof M.offset.x?new s.Point(M.offset.x,M.offset.y):s.Point.convert(M.offset),Fe=new s.Point((M.padding.left-M.padding.right)/2,(M.padding.top-M.padding.bottom)/2).rotate(E*Math.PI/180),We=Ue.add(Fe).mult(G.scale/G.zoomScale(Ee));return{center:G.unproject(yt.add(Et).div(2).sub(We)),zoom:Ee,bearing:E}}s.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")},f.prototype.fitBounds=function(c,m,E){return this._fitInternal(this.cameraForBounds(c,m),m,E)},f.prototype.fitScreenCoordinates=function(c,m,E,M,T){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(s.Point.convert(c)),this.transform.pointLocation(s.Point.convert(m)),E,M),M,T)},f.prototype._fitInternal=function(c,m,E){return c?(delete(m=s.extend(c,m)).padding,m.linear?this.easeTo(m,E):this.flyTo(m,E)):this},f.prototype.jumpTo=function(c,m){this.stop();var E=this.transform,M=!1,T=!1,N=!1;return"zoom"in c&&E.zoom!==+c.zoom&&(M=!0,E.zoom=+c.zoom),void 0!==c.center&&(E.center=s.LngLat.convert(c.center)),"bearing"in c&&E.bearing!==+c.bearing&&(T=!0,E.bearing=+c.bearing),"pitch"in c&&E.pitch!==+c.pitch&&(N=!0,E.pitch=+c.pitch),null==c.padding||E.isPaddingEqual(c.padding)||(E.padding=c.padding),this.fire(new s.Event("movestart",m)).fire(new s.Event("move",m)),M&&this.fire(new s.Event("zoomstart",m)).fire(new s.Event("zoom",m)).fire(new s.Event("zoomend",m)),T&&this.fire(new s.Event("rotatestart",m)).fire(new s.Event("rotate",m)).fire(new s.Event("rotateend",m)),N&&this.fire(new s.Event("pitchstart",m)).fire(new s.Event("pitch",m)).fire(new s.Event("pitchend",m)),this.fire(new s.Event("moveend",m))},f.prototype.easeTo=function(c,m){var E=this;this._stop(!1,c.easeId),(!1===(c=s.extend({offset:[0,0],duration:500,easing:s.ease},c)).animate||!c.essential&&s.browser.prefersReducedMotion)&&(c.duration=0);var M=this.transform,T=this.getZoom(),N=this.getBearing(),G=this.getPitch(),Q=this.getPadding(),yt="zoom"in c?+c.zoom:T,Et="bearing"in c?this._normalizeBearing(c.bearing,N):N,_t="pitch"in c?+c.pitch:G,Xt="padding"in c?c.padding:M.padding,Gt=s.Point.convert(c.offset),ie=M.centerPoint.add(Gt),Zt=M.pointLocation(ie),ne=s.LngLat.convert(c.center||Zt);this._normalizeCenter(ne);var ge,Ee,Ue=M.project(Zt),Fe=M.project(ne).sub(Ue),We=M.zoomScale(yt-T);c.around&&(ge=s.LngLat.convert(c.around),Ee=M.locationPoint(ge));var er={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||yt!==T,this._rotating=this._rotating||N!==Et,this._pitching=this._pitching||_t!==G,this._padding=!M.isPaddingEqual(Xt),this._easeId=c.easeId,this._prepareEase(m,c.noMoveStart,er),this._ease(function(br){if(E._zooming&&(M.zoom=s.number(T,yt,br)),E._rotating&&(M.bearing=s.number(N,Et,br)),E._pitching&&(M.pitch=s.number(G,_t,br)),E._padding&&(M.interpolatePadding(Q,Xt,br),ie=M.centerPoint.add(Gt)),ge)M.setLocationAtPoint(ge,Ee);else{var fr=M.zoomScale(M.zoom-T),zr=yt>T?Math.min(2,We):Math.max(.5,We),nn=Math.pow(zr,1-br),sn=M.unproject(Ue.add(Fe.mult(br*nn)).mult(fr));M.setLocationAtPoint(M.renderWorldCopies?sn.wrap():sn,ie)}E._fireMoveEvents(m)},function(br){E._afterEase(m,br)},c),this},f.prototype._prepareEase=function(c,m,E){void 0===E&&(E={}),this._moving=!0,m||E.moving||this.fire(new s.Event("movestart",c)),this._zooming&&!E.zooming&&this.fire(new s.Event("zoomstart",c)),this._rotating&&!E.rotating&&this.fire(new s.Event("rotatestart",c)),this._pitching&&!E.pitching&&this.fire(new s.Event("pitchstart",c))},f.prototype._fireMoveEvents=function(c){this.fire(new s.Event("move",c)),this._zooming&&this.fire(new s.Event("zoom",c)),this._rotating&&this.fire(new s.Event("rotate",c)),this._pitching&&this.fire(new s.Event("pitch",c))},f.prototype._afterEase=function(c,m){if(!this._easeId||!m||this._easeId!==m){delete this._easeId;var E=this._zooming,M=this._rotating,T=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,E&&this.fire(new s.Event("zoomend",c)),M&&this.fire(new s.Event("rotateend",c)),T&&this.fire(new s.Event("pitchend",c)),this.fire(new s.Event("moveend",c))}},f.prototype.flyTo=function(c,m){var E=this;if(!c.essential&&s.browser.prefersReducedMotion){var M=s.pick(c,["center","zoom","bearing","pitch","around"]);return this.jumpTo(M,m)}this.stop(),c=s.extend({offset:[0,0],speed:1.2,curve:1.42,easing:s.ease},c);var T=this.transform,N=this.getZoom(),G=this.getBearing(),Q=this.getPitch(),yt=this.getPadding(),Et="zoom"in c?s.clamp(+c.zoom,T.minZoom,T.maxZoom):N,_t="bearing"in c?this._normalizeBearing(c.bearing,G):G,Xt="pitch"in c?+c.pitch:Q,Gt="padding"in c?c.padding:T.padding,ie=T.zoomScale(Et-N),Zt=s.Point.convert(c.offset),ne=T.centerPoint.add(Zt),ge=T.pointLocation(ne),Ee=s.LngLat.convert(c.center||ge);this._normalizeCenter(Ee);var Ue=T.project(ge),Fe=T.project(Ee).sub(Ue),We=c.curve,er=Math.max(T.width,T.height),br=er/ie,fr=Fe.mag();if("minZoom"in c){var zr=s.clamp(Math.min(c.minZoom,N,Et),T.minZoom,T.maxZoom),nn=er/T.zoomScale(zr-N);We=Math.sqrt(nn/fr*2)}var sn=We*We;function on(An){var mn=(br*br-er*er+(An?-1:1)*sn*sn*fr*fr)/(2*(An?br:er)*sn*fr);return Math.log(Math.sqrt(mn*mn+1)-mn)}function wi(An){return(Math.exp(An)-Math.exp(-An))/2}function Gr(An){return(Math.exp(An)+Math.exp(-An))/2}var Vn=on(0),ti=function(An){return Gr(Vn)/Gr(Vn+We*An)},Zn=function(An){return er*((Gr(Vn)*(wi(mn=Vn+We*An)/Gr(mn))-wi(Vn))/sn)/fr;var mn},Nn=(on(1)-Vn)/We;if(Math.abs(fr)<1e-6||!isFinite(Nn)){if(Math.abs(er-br)<1e-6)return this.easeTo(c,m);var On=br<er?-1:1;Nn=Math.abs(Math.log(br/er))/We,Zn=function(){return 0},ti=function(An){return Math.exp(On*We*An)}}return c.duration="duration"in c?+c.duration:1e3*Nn/("screenSpeed"in c?+c.screenSpeed/We:+c.speed),c.maxDuration&&c.duration>c.maxDuration&&(c.duration=0),this._zooming=!0,this._rotating=G!==_t,this._pitching=Xt!==Q,this._padding=!T.isPaddingEqual(Gt),this._prepareEase(m,!1),this._ease(function(An){var mn=An*Nn,Mo=1/ti(mn);T.zoom=1===An?Et:N+T.scaleZoom(Mo),E._rotating&&(T.bearing=s.number(G,_t,An)),E._pitching&&(T.pitch=s.number(Q,Xt,An)),E._padding&&(T.interpolatePadding(yt,Gt,An),ne=T.centerPoint.add(Zt));var Ca=1===An?Ee:T.unproject(Ue.add(Fe.mult(Zn(mn))).mult(Mo));T.setLocationAtPoint(T.renderWorldCopies?Ca.wrap():Ca,ne),E._fireMoveEvents(m)},function(){return E._afterEase(m)},c),this},f.prototype.isEasing=function(){return!!this._easeFrameId},f.prototype.stop=function(){return this._stop()},f.prototype._stop=function(c,m){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){var E=this._onEaseEnd;delete this._onEaseEnd,E.call(this,m)}if(!c){var M=this.handlers;M&&M.stop(!1)}return this},f.prototype._ease=function(c,m,E){!1===E.animate||0===E.duration?(c(1),m()):(this._easeStart=s.browser.now(),this._easeOptions=E,this._onEaseFrame=c,this._onEaseEnd=m,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))},f.prototype._renderFrameCallback=function(){var c=Math.min((s.browser.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(c)),c<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},f.prototype._normalizeBearing=function(c,m){c=s.wrap(c,-180,180);var E=Math.abs(c-m);return Math.abs(c-360-m)<E&&(c-=360),Math.abs(c+360-m)<E&&(c+=360),c},f.prototype._normalizeCenter=function(c){var m=this.transform;if(m.renderWorldCopies&&!m.lngRange){var E=c.lng-m.center.lng;c.lng+=E>180?-360:E<-180?360:0}},f}(s.Evented),Ea=function(l){void 0===l&&(l={}),this.options=l,s.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)};Ea.prototype.getDefaultPosition=function(){return"bottom-right"},Ea.prototype.onAdd=function(l){var f=this.options&&this.options.compact;return this._map=l,this._container=ht.create("div","maplibregl-ctrl maplibregl-ctrl-attrib mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=ht.create("button","maplibregl-ctrl-attrib-button mapboxgl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._compactButton.type="button",this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=ht.create("div","maplibregl-ctrl-attrib-inner mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),f&&this._container.classList.add("maplibregl-compact","mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),void 0===f&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container},Ea.prototype.onRemove=function(){ht.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0},Ea.prototype._setElementTitle=function(l,f){var c=this._map._getUIString("AttributionControl."+f);l.title=c,l.setAttribute("aria-label",c)},Ea.prototype._toggleAttribution=function(){this._container.classList.contains("maplibregl-compact-show")||this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("maplibregl-compact-show","mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","false")):(this._container.classList.add("maplibregl-compact-show","mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","true"))},Ea.prototype._updateEditLink=function(){var l=this._editLink;l||(l=this._editLink=this._container.querySelector(".mapbox-improve-map"));var f=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||s.config.ACCESS_TOKEN}];if(l){var c=f.reduce(function(m,E,M){return E.value&&(m+=E.key+"="+E.value+(M<f.length-1?"&":"")),m},"?");l.href=s.config.FEEDBACK_URL+"/"+c+(this._map._hash?this._map._hash.getHashString(!0):""),l.rel="noopener nofollow",this._setElementTitle(l,"MapFeedback")}},Ea.prototype._updateData=function(l){!l||"metadata"!==l.sourceDataType&&"visibility"!==l.sourceDataType&&"style"!==l.dataType||(this._updateAttributions(),this._updateEditLink())},Ea.prototype._updateAttributions=function(){if(this._map.style){var l=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?l=l.concat(this.options.customAttribution.map(function(N){return"string"!=typeof N?"":N})):"string"==typeof this.options.customAttribution&&l.push(this.options.customAttribution)),this._map.style.stylesheet){var f=this._map.style.stylesheet;this.styleOwner=f.owner,this.styleId=f.id}var c=this._map.style.sourceCaches;for(var m in c){var E=c[m];if(E.used){var M=E.getSource();M.attribution&&l.indexOf(M.attribution)<0&&l.push(M.attribution)}}l.sort(function(N,G){return N.length-G.length});var T=(l=l.filter(function(N,G){for(var Q=G+1;Q<l.length;Q++)if(l[Q].indexOf(N)>=0)return!1;return!0})).join(" | ");T!==this._attribHTML&&(this._attribHTML=T,l.length?(this._innerContainer.innerHTML=T,this._container.classList.remove("maplibregl-attrib-empty","mapboxgl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty","mapboxgl-attrib-empty"),this._editLink=null)}},Ea.prototype._updateCompact=function(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("maplibregl-compact","mapboxgl-compact"):this._container.classList.remove("maplibregl-compact","maplibregl-compact-show","mapboxgl-compact","mapboxgl-compact-show")};var Os=function(){s.bindAll(["_updateLogo"],this),s.bindAll(["_updateCompact"],this)};Os.prototype.onAdd=function(l){this._map=l,this._container=ht.create("div","maplibregl-ctrl mapboxgl-ctrl");var f=ht.create("a","maplibregl-ctrl-logo mapboxgl-ctrl-logo");return f.target="_blank",f.rel="noopener nofollow",f.href="https://maplibre.org/",f.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),f.setAttribute("rel","noopener nofollow"),this._container.appendChild(f),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container},Os.prototype.onRemove=function(){ht.remove(this._container),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)},Os.prototype.getDefaultPosition=function(){return"bottom-left"},Os.prototype._updateLogo=function(l){l&&"metadata"!==l.sourceDataType||(this._container.style.display=this._logoRequired()?"block":"none")},Os.prototype._logoRequired=function(){if(this._map.style){var l=this._map.style.sourceCaches;for(var f in l)if(l[f].getSource().mapbox_logo)return!0;return!1}},Os.prototype._updateCompact=function(){var l=this._container.children;if(l.length){var f=l[0];this._map.getCanvasContainer().offsetWidth<250?f.classList.add("maplibregl-compact","mapboxgl-compact"):f.classList.remove("maplibregl-compact","mapboxgl-compact")}};var Ys=function(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1};Ys.prototype.add=function(l){var f=++this._id;return this._queue.push({callback:l,id:f,cancelled:!1}),f},Ys.prototype.remove=function(l){for(var f=this._currentlyRunning,c=0,m=f?this._queue.concat(f):this._queue;c<m.length;c+=1){var E=m[c];if(E.id===l)return void(E.cancelled=!0)}},Ys.prototype.run=function(l){void 0===l&&(l=0);var f=this._currentlyRunning=this._queue;this._queue=[];for(var c=0,m=f;c<m.length;c+=1){var E=m[c];if(!E.cancelled&&(E.callback(l),this._cleared))break}this._cleared=!1,this._currentlyRunning=!1},Ys.prototype.clear=function(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]};var Sa={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm"},hn=s.window.HTMLImageElement,il=s.window.HTMLElement,bs=s.window.ImageBitmap,Vi={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},yo=function(l){function f(m){var E=this;if(null!=(m=s.extend({},Vi,m)).minZoom&&null!=m.maxZoom&&m.minZoom>m.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(null!=m.minPitch&&null!=m.maxPitch&&m.minPitch>m.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(null!=m.minPitch&&m.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(null!=m.maxPitch&&m.maxPitch>60)throw new Error("maxPitch must be less than or equal to 60");var M=new En(m.minZoom,m.maxZoom,m.minPitch,m.maxPitch,m.renderWorldCopies);if(l.call(this,M,m),this._interactive=m.interactive,this._maxTileCacheSize=m.maxTileCacheSize,this._failIfMajorPerformanceCaveat=m.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=m.preserveDrawingBuffer,this._antialias=m.antialias,this._trackResize=m.trackResize,this._bearingSnap=m.bearingSnap,this._refreshExpiredTiles=m.refreshExpiredTiles,this._fadeDuration=m.fadeDuration,this._crossSourceCollisions=m.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=m.collectResourceTiming,this._renderTaskQueue=new Ys,this._controls=[],this._mapId=s.uniqueId(),this._locale=s.extend({},Sa,m.locale),this._clickTolerance=m.clickTolerance,this._requestManager=new s.RequestManager(m.transformRequest,m.accessToken),"string"==typeof m.container){if(this._container=s.window.document.getElementById(m.container),!this._container)throw new Error("Container '"+m.container+"' not found.")}else{if(!(m.container instanceof il))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=m.container}if(m.maxBounds&&this.setMaxBounds(m.maxBounds),s.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),void 0===this.painter)throw new Error("Failed to initialize WebGL.");this.on("move",function(){return E._update(!1)}),this.on("moveend",function(){return E._update(!1)}),this.on("zoom",function(){return E._update(!0)}),void 0!==s.window&&(s.window.addEventListener("online",this._onWindowOnline,!1),s.window.addEventListener("resize",this._onWindowResize,!1),s.window.addEventListener("orientationchange",this._onWindowResize,!1)),this.handlers=new Dr(this,m),this._hash=m.hash&&new Va("string"==typeof m.hash&&m.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:m.center,zoom:m.zoom,bearing:m.bearing,pitch:m.pitch}),m.bounds&&(this.resize(),this.fitBounds(m.bounds,s.extend({},m.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=m.localIdeographFontFamily,m.style&&this.setStyle(m.style,{localIdeographFontFamily:m.localIdeographFontFamily}),m.attributionControl&&this.addControl(new Ea({customAttribution:m.customAttribution})),this.addControl(new Os,m.logoPosition),this.on("style.load",function(){E.transform.unmodified&&E.jumpTo(E.style.stylesheet)}),this.on("data",function(T){E._update("style"===T.dataType),E.fire(new s.Event(T.dataType+"data",T))}),this.on("dataloading",function(T){E.fire(new s.Event(T.dataType+"dataloading",T))})}l&&(f.__proto__=l),(f.prototype=Object.create(l&&l.prototype)).constructor=f;var c={showTileBoundaries:{configurable:!0},showPadding:{configurable:!0},showCollisionBoxes:{configurable:!0},showOverdrawInspector:{configurable:!0},repaint:{configurable:!0},vertices:{configurable:!0},version:{configurable:!0}};return f.prototype._getMapId=function(){return this._mapId},f.prototype.addControl=function(m,E){if(void 0===E&&(E=m.getDefaultPosition?m.getDefaultPosition():"top-right"),!m||!m.onAdd)return this.fire(new s.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));var M=m.onAdd(this);this._controls.push(m);var T=this._controlPositions[E];return-1!==E.indexOf("bottom")?T.insertBefore(M,T.firstChild):T.appendChild(M),this},f.prototype.removeControl=function(m){if(!m||!m.onRemove)return this.fire(new s.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));var E=this._controls.indexOf(m);return E>-1&&this._controls.splice(E,1),m.onRemove(this),this},f.prototype.hasControl=function(m){return this._controls.indexOf(m)>-1},f.prototype.resize=function(m){var E=this._containerDimensions(),M=E[0],T=E[1];this._resizeCanvas(M,T),this.transform.resize(M,T),this.painter.resize(M,T);var N=!this._moving;return N&&(this.stop(),this.fire(new s.Event("movestart",m)).fire(new s.Event("move",m))),this.fire(new s.Event("resize",m)),N&&this.fire(new s.Event("moveend",m)),this},f.prototype.getBounds=function(){return this.transform.getBounds()},f.prototype.getMaxBounds=function(){return this.transform.getMaxBounds()},f.prototype.setMaxBounds=function(m){return this.transform.setMaxBounds(s.LngLatBounds.convert(m)),this._update()},f.prototype.setMinZoom=function(m){if((m=m??-2)>=-2&&m<=this.transform.maxZoom)return this.transform.minZoom=m,this._update(),this.getZoom()<m&&this.setZoom(m),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")},f.prototype.getMinZoom=function(){return this.transform.minZoom},f.prototype.setMaxZoom=function(m){if((m=m??22)>=this.transform.minZoom)return this.transform.maxZoom=m,this._update(),this.getZoom()>m&&this.setZoom(m),this;throw new Error("maxZoom must be greater than the current minZoom")},f.prototype.getMaxZoom=function(){return this.transform.maxZoom},f.prototype.setMinPitch=function(m){if((m=m??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(m>=0&&m<=this.transform.maxPitch)return this.transform.minPitch=m,this._update(),this.getPitch()<m&&this.setPitch(m),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")},f.prototype.getMinPitch=function(){return this.transform.minPitch},f.prototype.setMaxPitch=function(m){if((m=m??60)>60)throw new Error("maxPitch must be less than or equal to 60");if(m>=this.transform.minPitch)return this.transform.maxPitch=m,this._update(),this.getPitch()>m&&this.setPitch(m),this;throw new Error("maxPitch must be greater than the current minPitch")},f.prototype.getMaxPitch=function(){return this.transform.maxPitch},f.prototype.getRenderWorldCopies=function(){return this.transform.renderWorldCopies},f.prototype.setRenderWorldCopies=function(m){return this.transform.renderWorldCopies=m,this._update()},f.prototype.project=function(m){return this.transform.locationPoint(s.LngLat.convert(m))},f.prototype.unproject=function(m){return this.transform.pointLocation(s.Point.convert(m))},f.prototype.isMoving=function(){return this._moving||this.handlers.isMoving()},f.prototype.isZooming=function(){return this._zooming||this.handlers.isZooming()},f.prototype.isRotating=function(){return this._rotating||this.handlers.isRotating()},f.prototype._createDelegatedListener=function(m,E,M){var T,N=this;if("mouseenter"===m||"mouseover"===m){var G=!1;return{layer:E,listener:M,delegates:{mousemove:function(yt){var Et=N.getLayer(E)?N.queryRenderedFeatures(yt.point,{layers:[E]}):[];Et.length?G||(G=!0,M.call(N,new ao(m,N,yt.originalEvent,{features:Et}))):G=!1},mouseout:function(){G=!1}}}}if("mouseleave"===m||"mouseout"===m){var Q=!1;return{layer:E,listener:M,delegates:{mousemove:function(yt){(N.getLayer(E)?N.queryRenderedFeatures(yt.point,{layers:[E]}):[]).length?Q=!0:Q&&(Q=!1,M.call(N,new ao(m,N,yt.originalEvent)))},mouseout:function(yt){Q&&(Q=!1,M.call(N,new ao(m,N,yt.originalEvent)))}}}}return{layer:E,listener:M,delegates:(T={},T[m]=function(yt){var Et=N.getLayer(E)?N.queryRenderedFeatures(yt.point,{layers:[E]}):[];Et.length&&(yt.features=Et,M.call(N,yt),delete yt.features)},T)}},f.prototype.on=function(m,E,M){if(void 0===M)return l.prototype.on.call(this,m,E);var T=this._createDelegatedListener(m,E,M);for(var N in this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[m]=this._delegatedListeners[m]||[],this._delegatedListeners[m].push(T),T.delegates)this.on(N,T.delegates[N]);return this},f.prototype.once=function(m,E,M){if(void 0===M)return l.prototype.once.call(this,m,E);var T=this._createDelegatedListener(m,E,M);for(var N in T.delegates)this.once(N,T.delegates[N]);return this},f.prototype.off=function(m,E,M){var T=this;return void 0===M?l.prototype.off.call(this,m,E):(this._delegatedListeners&&this._delegatedListeners[m]&&function(N){for(var G=N[m],Q=0;Q<G.length;Q++){var yt=G[Q];if(yt.layer===E&&yt.listener===M){for(var Et in yt.delegates)T.off(Et,yt.delegates[Et]);return G.splice(Q,1),T}}}(this._delegatedListeners),this)},f.prototype.queryRenderedFeatures=function(m,E){if(!this.style)return[];var M;if(void 0!==E||void 0===m||m instanceof s.Point||Array.isArray(m)||(E=m,m=void 0),E=E||{},(m=m||[[0,0],[this.transform.width,this.transform.height]])instanceof s.Point||"number"==typeof m[0])M=[s.Point.convert(m)];else{var T=s.Point.convert(m[0]),N=s.Point.convert(m[1]);M=[T,new s.Point(N.x,T.y),N,new s.Point(T.x,N.y),T]}return this.style.queryRenderedFeatures(M,E,this.transform)},f.prototype.querySourceFeatures=function(m,E){return this.style.querySourceFeatures(m,E)},f.prototype.setStyle=function(m,E){return!1!==(E=s.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},E)).diff&&E.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&m?(this._diffStyle(m,E),this):(this._localIdeographFontFamily=E.localIdeographFontFamily,this._updateStyle(m,E))},f.prototype.setTransformRequest=function(m){return this._requestManager.setTransformRequest(m),this},f.prototype._getUIString=function(m){var E=this._locale[m];if(null==E)throw new Error("Missing UI string '"+m+"'");return E},f.prototype._updateStyle=function(m,E){return this.style&&(this.style.setEventedParent(null),this.style._remove()),m?(this.style=new xo(this,E||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof m?this.style.loadURL(m):this.style.loadJSON(m),this):(delete this.style,this)},f.prototype._lazyInitEmptyStyle=function(){this.style||(this.style=new xo(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())},f.prototype._diffStyle=function(m,E){var M=this;if("string"==typeof m){var T=this._requestManager.normalizeStyleURL(m),N=this._requestManager.transformRequest(T,s.ResourceType.Style);s.getJSON(N,function(G,Q){G?M.fire(new s.ErrorEvent(G)):Q&&M._updateDiff(Q,E)})}else"object"==typeof m&&this._updateDiff(m,E)},f.prototype._updateDiff=function(m,E){try{this.style.setState(m)&&this._update(!0)}catch(M){s.warnOnce("Unable to perform style diff: "+(M.message||M.error||M)+".  Rebuilding the style from scratch."),this._updateStyle(m,E)}},f.prototype.getStyle=function(){if(this.style)return this.style.serialize()},f.prototype.isStyleLoaded=function(){return this.style?this.style.loaded():s.warnOnce("There is no style added to the map.")},f.prototype.addSource=function(m,E){return this._lazyInitEmptyStyle(),this.style.addSource(m,E),this._update(!0)},f.prototype.isSourceLoaded=function(m){var E=this.style&&this.style.sourceCaches[m];if(void 0!==E)return E.loaded();this.fire(new s.ErrorEvent(new Error("There is no source with ID '"+m+"'")))},f.prototype.areTilesLoaded=function(){var m=this.style&&this.style.sourceCaches;for(var E in m){var M=m[E]._tiles;for(var T in M){var N=M[T];if("loaded"!==N.state&&"errored"!==N.state)return!1}}return!0},f.prototype.addSourceType=function(m,E,M){return this._lazyInitEmptyStyle(),this.style.addSourceType(m,E,M)},f.prototype.removeSource=function(m){return this.style.removeSource(m),this._update(!0)},f.prototype.getSource=function(m){return this.style.getSource(m)},f.prototype.addImage=function(m,E,M){void 0===M&&(M={});var T=M.pixelRatio;void 0===T&&(T=1);var N=M.sdf;void 0===N&&(N=!1);var G=M.stretchX,Q=M.stretchY,yt=M.content;if(this._lazyInitEmptyStyle(),E instanceof hn||bs&&E instanceof bs){var Et=s.browser.getImageData(E);this.style.addImage(m,{data:new s.RGBAImage({width:Et.width,height:Et.height},Et.data),pixelRatio:T,stretchX:G,stretchY:Q,content:yt,sdf:N,version:0})}else{if(void 0===E.width||void 0===E.height)return this.fire(new s.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));var _t=E;this.style.addImage(m,{data:new s.RGBAImage({width:E.width,height:E.height},new Uint8Array(E.data)),pixelRatio:T,stretchX:G,stretchY:Q,content:yt,sdf:N,version:0,userImage:_t}),_t.onAdd&&_t.onAdd(this,m)}},f.prototype.updateImage=function(m,E){var M=this.style.getImage(m);if(!M)return this.fire(new s.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));var T=E instanceof hn||bs&&E instanceof bs?s.browser.getImageData(E):E,N=T.width,G=T.height,Q=T.data;return void 0===N||void 0===G?this.fire(new s.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`"))):N!==M.data.width||G!==M.data.height?this.fire(new s.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image"))):(M.data.replace(Q,!(E instanceof hn||bs&&E instanceof bs)),void this.style.updateImage(m,M))},f.prototype.hasImage=function(m){return m?!!this.style.getImage(m):(this.fire(new s.ErrorEvent(new Error("Missing required image id"))),!1)},f.prototype.removeImage=function(m){this.style.removeImage(m)},f.prototype.loadImage=function(m,E){s.getImage(this._requestManager.transformRequest(m,s.ResourceType.Image),E)},f.prototype.listImages=function(){return this.style.listImages()},f.prototype.addLayer=function(m,E){return this._lazyInitEmptyStyle(),this.style.addLayer(m,E),this._update(!0)},f.prototype.moveLayer=function(m,E){return this.style.moveLayer(m,E),this._update(!0)},f.prototype.removeLayer=function(m){return this.style.removeLayer(m),this._update(!0)},f.prototype.getLayer=function(m){return this.style.getLayer(m)},f.prototype.setLayerZoomRange=function(m,E,M){return this.style.setLayerZoomRange(m,E,M),this._update(!0)},f.prototype.setFilter=function(m,E,M){return void 0===M&&(M={}),this.style.setFilter(m,E,M),this._update(!0)},f.prototype.getFilter=function(m){return this.style.getFilter(m)},f.prototype.setPaintProperty=function(m,E,M,T){return void 0===T&&(T={}),this.style.setPaintProperty(m,E,M,T),this._update(!0)},f.prototype.getPaintProperty=function(m,E){return this.style.getPaintProperty(m,E)},f.prototype.setLayoutProperty=function(m,E,M,T){return void 0===T&&(T={}),this.style.setLayoutProperty(m,E,M,T),this._update(!0)},f.prototype.getLayoutProperty=function(m,E){return this.style.getLayoutProperty(m,E)},f.prototype.setLight=function(m,E){return void 0===E&&(E={}),this._lazyInitEmptyStyle(),this.style.setLight(m,E),this._update(!0)},f.prototype.getLight=function(){return this.style.getLight()},f.prototype.setFeatureState=function(m,E){return this.style.setFeatureState(m,E),this._update()},f.prototype.removeFeatureState=function(m,E){return this.style.removeFeatureState(m,E),this._update()},f.prototype.getFeatureState=function(m){return this.style.getFeatureState(m)},f.prototype.getContainer=function(){return this._container},f.prototype.getCanvasContainer=function(){return this._canvasContainer},f.prototype.getCanvas=function(){return this._canvas},f.prototype._containerDimensions=function(){var m=0,E=0;return this._container&&(m=this._container.clientWidth||400,E=this._container.clientHeight||300),[m,E]},f.prototype._setupContainer=function(){var m=this._container;m.classList.add("maplibregl-map","mapboxgl-map");var E=this._canvasContainer=ht.create("div","maplibregl-canvas-container mapboxgl-canvas-container",m);this._interactive&&E.classList.add("maplibregl-interactive","mapboxgl-interactive"),this._canvas=ht.create("canvas","maplibregl-canvas mapboxgl-canvas",E),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");var M=this._containerDimensions();this._resizeCanvas(M[0],M[1]);var T=this._controlContainer=ht.create("div","maplibregl-control-container mapboxgl-control-container",m),N=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(function(G){N[G]=ht.create("div","maplibregl-ctrl-"+G+" mapboxgl-ctrl-"+G,T)}),this._container.addEventListener("scroll",this._onMapScroll,!1)},f.prototype._resizeCanvas=function(m,E){var M=s.browser.devicePixelRatio||1;this._canvas.width=M*m,this._canvas.height=M*E,this._canvas.style.width=m+"px",this._canvas.style.height=E+"px"},f.prototype._setupPainter=function(){var m=s.extend({},lt.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),E=this._canvas.getContext("webgl",m)||this._canvas.getContext("experimental-webgl",m);E?(this.painter=new si(E,this.transform),s.webpSupported.testSupport(E)):this.fire(new s.ErrorEvent(new Error("Failed to initialize WebGL")))},f.prototype._contextLost=function(m){m.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new s.Event("webglcontextlost",{originalEvent:m}))},f.prototype._contextRestored=function(m){this._setupPainter(),this.resize(),this._update(),this.fire(new s.Event("webglcontextrestored",{originalEvent:m}))},f.prototype._onMapScroll=function(m){if(m.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},f.prototype.loaded=function(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()},f.prototype._update=function(m){return this.style?(this._styleDirty=this._styleDirty||m,this._sourcesDirty=!0,this.triggerRepaint(),this):this},f.prototype._requestRenderFrame=function(m){return this._update(),this._renderTaskQueue.add(m)},f.prototype._cancelRenderFrame=function(m){this._renderTaskQueue.remove(m)},f.prototype._render=function(m){var E,M=this,T=0,N=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(E=N.createQueryEXT(),N.beginQueryEXT(N.TIME_ELAPSED_EXT,E),T=s.browser.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(m),!this._removed){var G=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;var Q=this.transform.zoom,yt=s.browser.now();this.style.zoomHistory.update(Q,yt);var Et=new s.EvaluationParameters(Q,{now:yt,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),_t=Et.crossFadingFactor();1===_t&&_t===this._crossFadingFactor||(G=!0,this._crossFadingFactor=_t),this.style.update(Et)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new s.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new s.Event("load"))),this.style&&(this.style.hasTransitions()||G)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){var Xt=s.browser.now()-T;N.endQueryEXT(N.TIME_ELAPSED_EXT,E),setTimeout(function(){var Zt=N.getQueryObjectEXT(E,N.QUERY_RESULT_EXT)/1e6;N.deleteQueryEXT(E),M.fire(new s.Event("gpu-timing-frame",{cpuTime:Xt,gpuTime:Zt}))},50)}if(this.listens("gpu-timing-layer")){var Gt=this.painter.collectGpuTimers();setTimeout(function(){var Zt=M.painter.queryGpuTimers(Gt);M.fire(new s.Event("gpu-timing-layer",{layerTimes:Zt}))},50)}var ie=this._sourcesDirty||this._styleDirty||this._placementDirty;return ie||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new s.Event("idle")),!this._loaded||this._fullyLoaded||ie||(this._fullyLoaded=!0),this}},f.prototype.remove=function(){this._hash&&this._hash.remove();for(var m=0,E=this._controls;m<E.length;m+=1)E[m].onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),void 0!==s.window&&(s.window.removeEventListener("resize",this._onWindowResize,!1),s.window.removeEventListener("orientationchange",this._onWindowResize,!1),s.window.removeEventListener("online",this._onWindowOnline,!1));var M=this.painter.context.gl.getExtension("WEBGL_lose_context");M&&M.loseContext(),cc(this._canvasContainer),cc(this._controlContainer),this._container.classList.remove("maplibregl-map","mapboxgl-map"),this._removed=!0,this.fire(new s.Event("remove"))},f.prototype.triggerRepaint=function(){var m=this;this.style&&!this._frame&&(this._frame=s.browser.frame(function(E){m._frame=null,m._render(E)}))},f.prototype._onWindowOnline=function(){this._update()},f.prototype._onWindowResize=function(m){this._trackResize&&this.resize({originalEvent:m})._update()},c.showTileBoundaries.get=function(){return!!this._showTileBoundaries},c.showTileBoundaries.set=function(m){this._showTileBoundaries!==m&&(this._showTileBoundaries=m,this._update())},c.showPadding.get=function(){return!!this._showPadding},c.showPadding.set=function(m){this._showPadding!==m&&(this._showPadding=m,this._update())},c.showCollisionBoxes.get=function(){return!!this._showCollisionBoxes},c.showCollisionBoxes.set=function(m){this._showCollisionBoxes!==m&&(this._showCollisionBoxes=m,m?this.style._generateCollisionBoxes():this._update())},c.showOverdrawInspector.get=function(){return!!this._showOverdrawInspector},c.showOverdrawInspector.set=function(m){this._showOverdrawInspector!==m&&(this._showOverdrawInspector=m,this._update())},c.repaint.get=function(){return!!this._repaint},c.repaint.set=function(m){this._repaint!==m&&(this._repaint=m,this.triggerRepaint())},c.vertices.get=function(){return!!this._vertices},c.vertices.set=function(m){this._vertices=m,this._update()},f.prototype._setCacheLimits=function(m,E){s.setCacheLimits(m,E)},c.version.get=function(){return s.version},Object.defineProperties(f.prototype,c),f}(cn);function cc(l){l.parentNode&&l.parentNode.removeChild(l)}var fs={showCompass:!0,showZoom:!0,visualizePitch:!1},Io=function(l){var f=this;this.options=s.extend({},fs,l),this._container=ht.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",function(c){return c.preventDefault()}),this.options.showZoom&&(s.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in mapboxgl-ctrl-zoom-in",function(c){return f._map.zoomIn({},{originalEvent:c})}),ht.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden",!0),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out mapboxgl-ctrl-zoom-out",function(c){return f._map.zoomOut({},{originalEvent:c})}),ht.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden",!0)),this.options.showCompass&&(s.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("maplibregl-ctrl-compass mapboxgl-ctrl-compass",function(c){f.options.visualizePitch?f._map.resetNorthPitch({},{originalEvent:c}):f._map.resetNorth({},{originalEvent:c})}),this._compassIcon=ht.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden",!0))};Io.prototype._updateZoomButtons=function(){var l=this._map.getZoom(),f=l===this._map.getMaxZoom(),c=l===this._map.getMinZoom();this._zoomInButton.disabled=f,this._zoomOutButton.disabled=c,this._zoomInButton.setAttribute("aria-disabled",f.toString()),this._zoomOutButton.setAttribute("aria-disabled",c.toString())},Io.prototype._rotateCompassArrow=function(){var l=this.options.visualizePitch?"scale("+1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)+") rotateX("+this._map.transform.pitch+"deg) rotateZ("+this._map.transform.angle*(180/Math.PI)+"deg)":"rotate("+this._map.transform.angle*(180/Math.PI)+"deg)";this._compassIcon.style.transform=l},Io.prototype.onAdd=function(l){return this._map=l,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Js(this._map,this._compass,this.options.visualizePitch)),this._container},Io.prototype.onRemove=function(){ht.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map},Io.prototype._createButton=function(l,f){var c=ht.create("button",l,this._container);return c.type="button",c.addEventListener("click",f),c},Io.prototype._setButtonTitle=function(l,f){var c=this._map._getUIString("NavigationControl."+f);l.title=c,l.setAttribute("aria-label",c)};var Js=function(l,f,c){void 0===c&&(c=!1),this._clickTolerance=10,this.element=f,this.mouseRotate=new Vo({clickTolerance:l.dragRotate._mouseRotate._clickTolerance}),this.map=l,c&&(this.mousePitch=new jl({clickTolerance:l.dragRotate._mousePitch._clickTolerance})),s.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),ht.addEventListener(f,"mousedown",this.mousedown),ht.addEventListener(f,"touchstart",this.touchstart,{passive:!1}),ht.addEventListener(f,"touchmove",this.touchmove),ht.addEventListener(f,"touchend",this.touchend),ht.addEventListener(f,"touchcancel",this.reset)};function ll(l,f,c){if(l=new s.LngLat(l.lng,l.lat),f){var m=new s.LngLat(l.lng-360,l.lat),E=new s.LngLat(l.lng+360,l.lat),M=c.locationPoint(l).distSqr(f);c.locationPoint(m).distSqr(f)<M?l=m:c.locationPoint(E).distSqr(f)<M&&(l=E)}for(;Math.abs(l.lng-c.center.lng)>180;){var T=c.locationPoint(l);if(T.x>=0&&T.y>=0&&T.x<=c.width&&T.y<=c.height)break;l.lng>c.center.lng?l.lng-=360:l.lng+=360}return l}Js.prototype.down=function(l,f){this.mouseRotate.mousedown(l,f),this.mousePitch&&this.mousePitch.mousedown(l,f),ht.disableDrag()},Js.prototype.move=function(l,f){var c=this.map,m=this.mouseRotate.mousemoveWindow(l,f);if(m&&m.bearingDelta&&c.setBearing(c.getBearing()+m.bearingDelta),this.mousePitch){var E=this.mousePitch.mousemoveWindow(l,f);E&&E.pitchDelta&&c.setPitch(c.getPitch()+E.pitchDelta)}},Js.prototype.off=function(){var l=this.element;ht.removeEventListener(l,"mousedown",this.mousedown),ht.removeEventListener(l,"touchstart",this.touchstart,{passive:!1}),ht.removeEventListener(l,"touchmove",this.touchmove),ht.removeEventListener(l,"touchend",this.touchend),ht.removeEventListener(l,"touchcancel",this.reset),this.offTemp()},Js.prototype.offTemp=function(){ht.enableDrag(),ht.removeEventListener(s.window,"mousemove",this.mousemove),ht.removeEventListener(s.window,"mouseup",this.mouseup)},Js.prototype.mousedown=function(l){this.down(s.extend({},l,{ctrlKey:!0,preventDefault:function(){return l.preventDefault()}}),ht.mousePos(this.element,l)),ht.addEventListener(s.window,"mousemove",this.mousemove),ht.addEventListener(s.window,"mouseup",this.mouseup)},Js.prototype.mousemove=function(l){this.move(l,ht.mousePos(this.element,l))},Js.prototype.mouseup=function(l){this.mouseRotate.mouseupWindow(l),this.mousePitch&&this.mousePitch.mouseupWindow(l),this.offTemp()},Js.prototype.touchstart=function(l){1!==l.targetTouches.length?this.reset():(this._startPos=this._lastPos=ht.touchPos(this.element,l.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:function(){return l.preventDefault()}},this._startPos))},Js.prototype.touchmove=function(l){1!==l.targetTouches.length?this.reset():(this._lastPos=ht.touchPos(this.element,l.targetTouches)[0],this.move({preventDefault:function(){return l.preventDefault()}},this._lastPos))},Js.prototype.touchend=function(l){0===l.targetTouches.length&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()},Js.prototype.reset=function(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()};var e={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function i(l,f,c){var m=l.classList;for(var E in e)m.remove("maplibregl-"+c+"-anchor-"+E,"mapboxgl-"+c+"-anchor-"+E);m.add("maplibregl-"+c+"-anchor-"+f,"mapboxgl-"+c+"-anchor-"+f)}var h,d=function(l){function f(c,m){if(l.call(this),(c instanceof s.window.HTMLElement||m)&&(c=s.extend({element:c},m)),s.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=c&&c.anchor||"center",this._color=c&&c.color||"#3FB1CE",this._scale=c&&c.scale||1,this._draggable=c&&c.draggable||!1,this._clickTolerance=c&&c.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=c&&c.rotation||0,this._rotationAlignment=c&&c.rotationAlignment||"auto",this._pitchAlignment=c&&c.pitchAlignment&&"auto"!==c.pitchAlignment?c.pitchAlignment:this._rotationAlignment,c&&c.element)this._element=c.element,this._offset=s.Point.convert(c&&c.offset||[0,0]);else{this._defaultMarker=!0,this._element=ht.create("div"),this._element.setAttribute("aria-label","Map marker");var E=ht.createNS("http://www.w3.org/2000/svg","svg");E.setAttributeNS(null,"display","block"),E.setAttributeNS(null,"height","41px"),E.setAttributeNS(null,"width","27px"),E.setAttributeNS(null,"viewBox","0 0 27 41");var M=ht.createNS("http://www.w3.org/2000/svg","g");M.setAttributeNS(null,"stroke","none"),M.setAttributeNS(null,"stroke-width","1"),M.setAttributeNS(null,"fill","none"),M.setAttributeNS(null,"fill-rule","evenodd");var T=ht.createNS("http://www.w3.org/2000/svg","g");T.setAttributeNS(null,"fill-rule","nonzero");var N=ht.createNS("http://www.w3.org/2000/svg","g");N.setAttributeNS(null,"transform","translate(3.0, 29.0)"),N.setAttributeNS(null,"fill","#000000");for(var G=0,Q=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];G<Q.length;G+=1){var yt=Q[G],Et=ht.createNS("http://www.w3.org/2000/svg","ellipse");Et.setAttributeNS(null,"opacity","0.04"),Et.setAttributeNS(null,"cx","10.5"),Et.setAttributeNS(null,"cy","5.80029008"),Et.setAttributeNS(null,"rx",yt.rx),Et.setAttributeNS(null,"ry",yt.ry),N.appendChild(Et)}var _t=ht.createNS("http://www.w3.org/2000/svg","g");_t.setAttributeNS(null,"fill",this._color);var Xt=ht.createNS("http://www.w3.org/2000/svg","path");Xt.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),_t.appendChild(Xt);var Gt=ht.createNS("http://www.w3.org/2000/svg","g");Gt.setAttributeNS(null,"opacity","0.25"),Gt.setAttributeNS(null,"fill","#000000");var ie=ht.createNS("http://www.w3.org/2000/svg","path");ie.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),Gt.appendChild(ie);var Zt=ht.createNS("http://www.w3.org/2000/svg","g");Zt.setAttributeNS(null,"transform","translate(6.0, 7.0)"),Zt.setAttributeNS(null,"fill","#FFFFFF");var ne=ht.createNS("http://www.w3.org/2000/svg","g");ne.setAttributeNS(null,"transform","translate(8.0, 8.0)");var ge=ht.createNS("http://www.w3.org/2000/svg","circle");ge.setAttributeNS(null,"fill","#000000"),ge.setAttributeNS(null,"opacity","0.25"),ge.setAttributeNS(null,"cx","5.5"),ge.setAttributeNS(null,"cy","5.5"),ge.setAttributeNS(null,"r","5.4999962");var Ee=ht.createNS("http://www.w3.org/2000/svg","circle");Ee.setAttributeNS(null,"fill","#FFFFFF"),Ee.setAttributeNS(null,"cx","5.5"),Ee.setAttributeNS(null,"cy","5.5"),Ee.setAttributeNS(null,"r","5.4999962"),ne.appendChild(ge),ne.appendChild(Ee),T.appendChild(N),T.appendChild(_t),T.appendChild(Gt),T.appendChild(Zt),T.appendChild(ne),E.appendChild(T),E.setAttributeNS(null,"height",41*this._scale+"px"),E.setAttributeNS(null,"width",27*this._scale+"px"),this._element.appendChild(E),this._offset=s.Point.convert(c&&c.offset||[0,-14])}this._element.classList.add("maplibregl-marker","mapboxgl-marker"),this._element.addEventListener("dragstart",function(Ue){Ue.preventDefault()}),this._element.addEventListener("mousedown",function(Ue){Ue.preventDefault()}),i(this._element,this._anchor,"marker"),this._popup=null}return l&&(f.__proto__=l),(f.prototype=Object.create(l&&l.prototype)).constructor=f,f.prototype.addTo=function(c){return this.remove(),this._map=c,c.getCanvasContainer().appendChild(this._element),c.on("move",this._update),c.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this},f.prototype.remove=function(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),ht.remove(this._element),this._popup&&this._popup.remove(),this},f.prototype.getLngLat=function(){return this._lngLat},f.prototype.setLngLat=function(c){return this._lngLat=s.LngLat.convert(c),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this},f.prototype.getElement=function(){return this._element},f.prototype.setPopup=function(c){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),c){if(!("offset"in c.options)){var m=Math.sqrt(Math.pow(13.5,2)/2);c.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[m,-1*(24.6+m)],"bottom-right":[-m,-1*(24.6+m)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=c,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this},f.prototype._onKeyPress=function(c){var m=c.code,E=c.charCode||c.keyCode;"Space"!==m&&"Enter"!==m&&32!==E&&13!==E||this.togglePopup()},f.prototype._onMapClick=function(c){var m=c.originalEvent.target,E=this._element;this._popup&&(m===E||E.contains(m))&&this.togglePopup()},f.prototype.getPopup=function(){return this._popup},f.prototype.togglePopup=function(){var c=this._popup;return c?(c.isOpen()?c.remove():c.addTo(this._map),this):this},f.prototype._update=function(c){if(this._map){this._map.transform.renderWorldCopies&&(this._lngLat=ll(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);var m="";"viewport"===this._rotationAlignment||"auto"===this._rotationAlignment?m="rotateZ("+this._rotation+"deg)":"map"===this._rotationAlignment&&(m="rotateZ("+(this._rotation-this._map.getBearing())+"deg)");var E="";"viewport"===this._pitchAlignment||"auto"===this._pitchAlignment?E="rotateX(0deg)":"map"===this._pitchAlignment&&(E="rotateX("+this._map.getPitch()+"deg)"),c&&"moveend"!==c.type||(this._pos=this._pos.round()),ht.setTransform(this._element,e[this._anchor]+" translate("+this._pos.x+"px, "+this._pos.y+"px) "+E+" "+m)}},f.prototype.getOffset=function(){return this._offset},f.prototype.setOffset=function(c){return this._offset=s.Point.convert(c),this._update(),this},f.prototype._onMove=function(c){if(!this._isDragging){var m=this._clickTolerance||this._map._clickTolerance;this._isDragging=c.point.dist(this._pointerdownPos)>=m}this._isDragging&&(this._pos=c.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new s.Event("dragstart"))),this.fire(new s.Event("drag")))},f.prototype._onUp=function(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),"active"===this._state&&this.fire(new s.Event("dragend")),this._state="inactive"},f.prototype._addDragHandler=function(c){this._element.contains(c.originalEvent.target)&&(c.preventDefault(),this._positionDelta=c.point.sub(this._pos).add(this._offset),this._pointerdownPos=c.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},f.prototype.setDraggable=function(c){return this._draggable=!!c,this._map&&(c?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this},f.prototype.isDraggable=function(){return this._draggable},f.prototype.setRotation=function(c){return this._rotation=c||0,this._update(),this},f.prototype.getRotation=function(){return this._rotation},f.prototype.setRotationAlignment=function(c){return this._rotationAlignment=c||"auto",this._update(),this},f.prototype.getRotationAlignment=function(){return this._rotationAlignment},f.prototype.setPitchAlignment=function(c){return this._pitchAlignment=c&&"auto"!==c?c:this._rotationAlignment,this._update(),this},f.prototype.getPitchAlignment=function(){return this._pitchAlignment},f}(s.Evented),x={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0},D=0,F=!1,$=function(l){function f(c){l.call(this),this.options=s.extend({},x,c),s.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}return l&&(f.__proto__=l),(f.prototype=Object.create(l&&l.prototype)).constructor=f,f.prototype.onAdd=function(c){var m;return this._map=c,this._container=ht.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),m=this._setupUI,void 0!==h?m(h):void 0!==s.window.navigator.permissions?s.window.navigator.permissions.query({name:"geolocation"}).then(function(E){m(h="denied"!==E.state)}):m(h=!!s.window.navigator.geolocation),this._container},f.prototype.onRemove=function(){void 0!==this._geolocationWatchID&&(s.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),ht.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,D=0,F=!1},f.prototype._isOutOfMapMaxBounds=function(c){var m=this._map.getMaxBounds(),E=c.coords;return m&&(E.longitude<m.getWest()||E.longitude>m.getEast()||E.latitude<m.getSouth()||E.latitude>m.getNorth())},f.prototype._setErrorState=function(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting")}},f.prototype._onSuccess=function(c){if(this._map){if(this._isOutOfMapMaxBounds(c))return this._setErrorState(),this.fire(new s.Event("outofmaxbounds",c)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=c,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(c),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(c),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale","mapboxgl-user-location-dot-stale"),this.fire(new s.Event("geolocate",c)),this._finish()}},f.prototype._updateCamera=function(c){var m=new s.LngLat(c.coords.longitude,c.coords.latitude),E=c.coords.accuracy,M=this._map.getBearing(),T=s.extend({bearing:M},this.options.fitBoundsOptions);this._map.fitBounds(m.toBounds(E),T,{geolocateSource:!0})},f.prototype._updateMarker=function(c){if(c){var m=new s.LngLat(c.coords.longitude,c.coords.latitude);this._accuracyCircleMarker.setLngLat(m).addTo(this._map),this._userLocationDotMarker.setLngLat(m).addTo(this._map),this._accuracy=c.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},f.prototype._updateCircleRadius=function(){var c=this._map._container.clientHeight/2,m=this._map.unproject([0,c]),E=this._map.unproject([1,c]),M=m.distanceTo(E),T=Math.ceil(2*this._accuracy/M);this._circleElement.style.width=T+"px",this._circleElement.style.height=T+"px"},f.prototype._onZoom=function(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},f.prototype._onError=function(c){if(this._map){if(this.options.trackUserLocation)if(1===c.code){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;var m=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=m,this._geolocateButton.setAttribute("aria-label",m),void 0!==this._geolocationWatchID&&this._clearWatch()}else{if(3===c.code&&F)return;this._setErrorState()}"OFF"!==this._watchState&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale","mapboxgl-user-location-dot-stale"),this.fire(new s.Event("error",c)),this._finish()}},f.prototype._finish=function(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},f.prototype._setupUI=function(c){var m=this;if(this._container.addEventListener("contextmenu",function(T){return T.preventDefault()}),this._geolocateButton=ht.create("button","maplibregl-ctrl-geolocate mapboxgl-ctrl-geolocate",this._container),ht.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden",!0),this._geolocateButton.type="button",!1===c){s.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");var E=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=E,this._geolocateButton.setAttribute("aria-label",E)}else{var M=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=M,this._geolocateButton.setAttribute("aria-label",M)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=ht.create("div","maplibregl-user-location-dot mapboxgl-user-location-dot"),this._userLocationDotMarker=new d(this._dotElement),this._circleElement=ht.create("div","maplibregl-user-location-accuracy-circle mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new d({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",function(T){T.geolocateSource||"ACTIVE_LOCK"!==m._watchState||T.originalEvent&&"resize"===T.originalEvent.type||(m._watchState="BACKGROUND",m._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),m._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),m.fire(new s.Event("trackuserlocationend")))})},f.prototype.trigger=function(){if(!this._setup)return s.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new s.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":D--,F=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this.fire(new s.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new s.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error")}if("OFF"===this._watchState&&void 0!==this._geolocationWatchID)this._clearWatch();else if(void 0===this._geolocationWatchID){var c;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),++D>1?(c={maximumAge:6e5,timeout:0},F=!0):(c=this.options.positionOptions,F=!1),this._geolocationWatchID=s.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,c)}}else s.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0},f.prototype._clearWatch=function(){s.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)},f}(s.Evented),Ct={maxWidth:100,unit:"metric"},te=function(l){this.options=s.extend({},Ct,l),s.bindAll(["_onMove","setUnit"],this)};function Ne(l,f,c){var m=c&&c.maxWidth||100,E=l._container.clientHeight/2,M=l.unproject([0,E]),T=l.unproject([m,E]),N=M.distanceTo(T);if(c&&"imperial"===c.unit){var G=3.2808*N;G>5280?Ve(f,m,G/5280,l._getUIString("ScaleControl.Miles")):Ve(f,m,G,l._getUIString("ScaleControl.Feet"))}else c&&"nautical"===c.unit?Ve(f,m,N/1852,l._getUIString("ScaleControl.NauticalMiles")):N>=1e3?Ve(f,m,N/1e3,l._getUIString("ScaleControl.Kilometers")):Ve(f,m,N,l._getUIString("ScaleControl.Meters"))}function Ve(l,f,c,m){var E,M,T,G,Q,N=(E=c,(M=Math.pow(10,(""+Math.floor(E)).length-1))*(T=(T=E/M)>=10?10:T>=5?5:T>=3?3:T>=2?2:T>=1?1:(G=T,Q=Math.pow(10,Math.ceil(-Math.log(G)/Math.LN10)),Math.round(G*Q)/Q)));l.style.width=f*(N/c)+"px",l.innerHTML=N+"&nbsp;"+m}te.prototype.getDefaultPosition=function(){return"bottom-left"},te.prototype._onMove=function(){Ne(this._map,this._container,this.options)},te.prototype.onAdd=function(l){return this._map=l,this._container=ht.create("div","maplibregl-ctrl maplibregl-ctrl-scale mapboxgl-ctrl mapboxgl-ctrl-scale",l.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container},te.prototype.onRemove=function(){ht.remove(this._container),this._map.off("move",this._onMove),this._map=void 0},te.prototype.setUnit=function(l){this.options.unit=l,Ne(this._map,this._container,this.options)};var gr=function(l){this._fullscreen=!1,l&&l.container&&(l.container instanceof s.window.HTMLElement?this._container=l.container:s.warnOnce("Full screen control 'container' must be a DOM element.")),s.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in s.window.document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in s.window.document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in s.window.document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in s.window.document&&(this._fullscreenchange="MSFullscreenChange")};gr.prototype.onAdd=function(l){return this._map=l,this._container||(this._container=this._map.getContainer()),this._controlContainer=ht.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",s.warnOnce("This device does not support fullscreen mode.")),this._controlContainer},gr.prototype.onRemove=function(){ht.remove(this._controlContainer),this._map=null,s.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)},gr.prototype._checkFullscreenSupport=function(){return!!(s.window.document.fullscreenEnabled||s.window.document.mozFullScreenEnabled||s.window.document.msFullscreenEnabled||s.window.document.webkitFullscreenEnabled)},gr.prototype._setupUI=function(){var l=this._fullscreenButton=ht.create("button","maplibregl-ctrl-fullscreen mapboxgl-ctrl-fullscreen",this._controlContainer);ht.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",l).setAttribute("aria-hidden",!0),l.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),s.window.document.addEventListener(this._fullscreenchange,this._changeIcon)},gr.prototype._updateTitle=function(){var l=this._getTitle();this._fullscreenButton.setAttribute("aria-label",l),this._fullscreenButton.title=l},gr.prototype._getTitle=function(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")},gr.prototype._isFullscreen=function(){return this._fullscreen},gr.prototype._changeIcon=function(){(s.window.document.fullscreenElement||s.window.document.mozFullScreenElement||s.window.document.webkitFullscreenElement||s.window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())},gr.prototype._onClickFullscreen=function(){this._isFullscreen()?s.window.document.exitFullscreen?s.window.document.exitFullscreen():s.window.document.mozCancelFullScreen?s.window.document.mozCancelFullScreen():s.window.document.msExitFullscreen?s.window.document.msExitFullscreen():s.window.document.webkitCancelFullScreen&&s.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()};var Pr={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},Yr=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", "),an=function(l){function f(c){l.call(this),this.options=s.extend(Object.create(Pr),c),s.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}return l&&(f.__proto__=l),(f.prototype=Object.create(l&&l.prototype)).constructor=f,f.prototype.addTo=function(c){return this._map&&this.remove(),this._map=c,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer","mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new s.Event("open")),this},f.prototype.isOpen=function(){return!!this._map},f.prototype.remove=function(){return this._content&&ht.remove(this._content),this._container&&(ht.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new s.Event("close")),this},f.prototype.getLngLat=function(){return this._lngLat},f.prototype.setLngLat=function(c){return this._lngLat=s.LngLat.convert(c),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer","mapboxgl-track-pointer")),this},f.prototype.trackPointer=function(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer","mapboxgl-track-pointer")),this},f.prototype.getElement=function(){return this._container},f.prototype.setText=function(c){return this.setDOMContent(s.window.document.createTextNode(c))},f.prototype.setHTML=function(c){var m,E=s.window.document.createDocumentFragment(),M=s.window.document.createElement("body");for(M.innerHTML=c;m=M.firstChild;)E.appendChild(m);return this.setDOMContent(E)},f.prototype.getMaxWidth=function(){return this._container&&this._container.style.maxWidth},f.prototype.setMaxWidth=function(c){return this.options.maxWidth=c,this._update(),this},f.prototype.setDOMContent=function(c){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=ht.create("div","maplibregl-popup-content mapboxgl-popup-content",this._container);return this._content.appendChild(c),this._createCloseButton(),this._update(),this._focusFirstElement(),this},f.prototype.addClassName=function(c){this._container&&this._container.classList.add(c)},f.prototype.removeClassName=function(c){this._container&&this._container.classList.remove(c)},f.prototype.setOffset=function(c){return this.options.offset=c,this._update(),this},f.prototype.toggleClassName=function(c){if(this._container)return this._container.classList.toggle(c)},f.prototype._createCloseButton=function(){this.options.closeButton&&(this._closeButton=ht.create("button","maplibregl-popup-close-button mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))},f.prototype._onMouseUp=function(c){this._update(c.point)},f.prototype._onMouseMove=function(c){this._update(c.point)},f.prototype._onDrag=function(c){this._update(c.point)},f.prototype._update=function(c){var m=this;if(this._map&&(this._lngLat||this._trackPointer)&&this._content&&(this._container||(this._container=ht.create("div","maplibregl-popup mapboxgl-popup",this._map.getContainer()),this._tip=ht.create("div","maplibregl-popup-tip mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(function(Et){return m._container.classList.add(Et)}),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=ll(this._lngLat,this._pos,this._map.transform)),!this._trackPointer||c)){var E=this._pos=this._trackPointer&&c?c:this._map.project(this._lngLat),M=this.options.anchor,T=function Et(_t){if(_t){if("number"==typeof _t){var Xt=Math.round(Math.sqrt(.5*Math.pow(_t,2)));return{center:new s.Point(0,0),top:new s.Point(0,_t),"top-left":new s.Point(Xt,Xt),"top-right":new s.Point(-Xt,Xt),bottom:new s.Point(0,-_t),"bottom-left":new s.Point(Xt,-Xt),"bottom-right":new s.Point(-Xt,-Xt),left:new s.Point(_t,0),right:new s.Point(-_t,0)}}if(_t instanceof s.Point||Array.isArray(_t)){var Gt=s.Point.convert(_t);return{center:Gt,top:Gt,"top-left":Gt,"top-right":Gt,bottom:Gt,"bottom-left":Gt,"bottom-right":Gt,left:Gt,right:Gt}}return{center:s.Point.convert(_t.center||[0,0]),top:s.Point.convert(_t.top||[0,0]),"top-left":s.Point.convert(_t["top-left"]||[0,0]),"top-right":s.Point.convert(_t["top-right"]||[0,0]),bottom:s.Point.convert(_t.bottom||[0,0]),"bottom-left":s.Point.convert(_t["bottom-left"]||[0,0]),"bottom-right":s.Point.convert(_t["bottom-right"]||[0,0]),left:s.Point.convert(_t.left||[0,0]),right:s.Point.convert(_t.right||[0,0])}}return Et(new s.Point(0,0))}(this.options.offset);if(!M){var N,G=this._container.offsetWidth,Q=this._container.offsetHeight;N=E.y+T.bottom.y<Q?["top"]:E.y>this._map.transform.height-Q?["bottom"]:[],E.x<G/2?N.push("left"):E.x>this._map.transform.width-G/2&&N.push("right"),M=0===N.length?"bottom":N.join("-")}var yt=E.add(T[M]).round();ht.setTransform(this._container,e[M]+" translate("+yt.x+"px,"+yt.y+"px)"),i(this._container,M,"popup")}},f.prototype._focusFirstElement=function(){if(this.options.focusAfterOpen&&this._container){var c=this._container.querySelector(Yr);c&&c.focus()}},f.prototype._onClose=function(){this.remove()},f}(s.Evented),Mi={version:s.version,supported:lt,setRTLTextPlugin:s.setRTLTextPlugin,getRTLTextPluginStatus:s.getRTLTextPluginStatus,Map:yo,NavigationControl:Io,GeolocateControl:$,AttributionControl:Ea,ScaleControl:te,FullscreenControl:gr,Popup:an,Marker:d,Style:xo,LngLat:s.LngLat,LngLatBounds:s.LngLatBounds,Point:s.Point,MercatorCoordinate:s.MercatorCoordinate,Evented:s.Evented,config:s.config,prewarm:function(){Ar().acquire(Me)},clearPrewarmedResources:function(){var l=pr;l&&(l.isPreloaded()&&1===l.numActive()?(l.release(Me),pr=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return s.config.ACCESS_TOKEN},set accessToken(l){s.config.ACCESS_TOKEN=l},get baseApiUrl(){return s.config.API_URL},set baseApiUrl(l){s.config.API_URL=l},get workerCount(){return qe.workerCount},set workerCount(l){qe.workerCount=l},get maxParallelImageRequests(){return s.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(l){s.config.MAX_PARALLEL_IMAGE_REQUESTS=l},clearStorage:function(l){s.clearTileCache(l)},workerUrl:"",addProtocol:function(l,f){s.config.REGISTERED_PROTOCOLS[l]=f},removeProtocol:function(l){delete s.config.REGISTERED_PROTOCOLS[l]}};return Mi}),gt}()},3990:function(tr,ce,It){var gt,Pt;gt=function(){var s,lt,mt,xt,ye,Lt={},Ft={},Qt={currentLocale:"en",zeroFormat:null,nullFormat:null,defaultFormat:"0,0",scalePercentBy100:!0},qt={currentLocale:Qt.currentLocale,zeroFormat:Qt.zeroFormat,nullFormat:Qt.nullFormat,defaultFormat:Qt.defaultFormat,scalePercentBy100:Qt.scalePercentBy100};function _e(mt,xt){this._input=mt,this._value=xt}return(s=function(mt){var xt,Jt,ye,j;if(s.isNumeral(mt))xt=mt.value();else if(0===mt||typeof mt>"u")xt=0;else if(null===mt||lt.isNaN(mt))xt=null;else if("string"==typeof mt)if(qt.zeroFormat&&mt===qt.zeroFormat)xt=0;else if(qt.nullFormat&&mt===qt.nullFormat||!mt.replace(/[^0-9]+/g,"").length)xt=null;else{for(Jt in Lt)if((j="function"==typeof Lt[Jt].regexps.unformat?Lt[Jt].regexps.unformat():Lt[Jt].regexps.unformat)&&mt.match(j)){ye=Lt[Jt].unformat;break}xt=(ye=ye||s._.stringToNumber)(mt)}else xt=Number(mt)||null;return new _e(mt,xt)}).version="2.0.6",s.isNumeral=function(mt){return mt instanceof _e},s._=lt={numberToFormat:function(mt,xt,Jt){var Wt,St,Ce,Mt,pe,At,$t,K,ye=Ft[s.options.currentLocale],j=!1,it=!1,tt="",X=1e12,nt=1e9,J=1e6,at="",Z=!1;if(mt=mt||0,St=Math.abs(mt),s._.includes(xt,"(")?(j=!0,xt=xt.replace(/[\(|\)]/g,"")):(s._.includes(xt,"+")||s._.includes(xt,"-"))&&(pe=s._.includes(xt,"+")?xt.indexOf("+"):mt<0?xt.indexOf("-"):-1,xt=xt.replace(/[\+|\-]/g,"")),s._.includes(xt,"a")&&(Wt=!!(Wt=xt.match(/a(k|m|b|t)?/))&&Wt[1],s._.includes(xt," a")&&(tt=" "),xt=xt.replace(new RegExp(tt+"a[kmbt]?"),""),St>=X&&!Wt||"t"===Wt?(tt+=ye.abbreviations.trillion,mt/=X):St<X&&St>=nt&&!Wt||"b"===Wt?(tt+=ye.abbreviations.billion,mt/=nt):St<nt&&St>=J&&!Wt||"m"===Wt?(tt+=ye.abbreviations.million,mt/=J):(St<J&&St>=1e3&&!Wt||"k"===Wt)&&(tt+=ye.abbreviations.thousand,mt/=1e3)),s._.includes(xt,"[.]")&&(it=!0,xt=xt.replace("[.]",".")),Ce=mt.toString().split(".")[0],Mt=xt.split(".")[1],At=xt.indexOf(","),K=(xt.split(".")[0].split(",")[0].match(/0/g)||[]).length,Mt?(s._.includes(Mt,"[")?(Mt=(Mt=Mt.replace("]","")).split("["),at=s._.toFixed(mt,Mt[0].length+Mt[1].length,Jt,Mt[1].length)):at=s._.toFixed(mt,Mt.length,Jt),Ce=at.split(".")[0],at=s._.includes(at,".")?ye.delimiters.decimal+at.split(".")[1]:"",it&&0===Number(at.slice(1))&&(at="")):Ce=s._.toFixed(mt,0,Jt),tt&&!Wt&&Number(Ce)>=1e3&&tt!==ye.abbreviations.trillion)switch(Ce=String(Number(Ce)/1e3),tt){case ye.abbreviations.thousand:tt=ye.abbreviations.million;break;case ye.abbreviations.million:tt=ye.abbreviations.billion;break;case ye.abbreviations.billion:tt=ye.abbreviations.trillion}if(s._.includes(Ce,"-")&&(Ce=Ce.slice(1),Z=!0),Ce.length<K)for(var fe=K-Ce.length;fe>0;fe--)Ce="0"+Ce;return At>-1&&(Ce=Ce.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+ye.delimiters.thousands)),0===xt.indexOf(".")&&(Ce=""),$t=Ce+at+(tt||""),j?$t=(j&&Z?"(":"")+$t+(j&&Z?")":""):pe>=0?$t=0===pe?(Z?"-":"+")+$t:$t+(Z?"-":"+"):Z&&($t="-"+$t),$t},stringToNumber:function(mt){var j,it,tt,xt=Ft[qt.currentLocale],Jt=mt,ye={thousand:3,million:6,billion:9,trillion:12};if(qt.zeroFormat&&mt===qt.zeroFormat)it=0;else if(qt.nullFormat&&mt===qt.nullFormat||!mt.replace(/[^0-9]+/g,"").length)it=null;else{for(j in it=1,"."!==xt.delimiters.decimal&&(mt=mt.replace(/\./g,"").replace(xt.delimiters.decimal,".")),ye)if(tt=new RegExp("[^a-zA-Z]"+xt.abbreviations[j]+"(?:\\)|(\\"+xt.currency.symbol+")?(?:\\))?)?$"),Jt.match(tt)){it*=Math.pow(10,ye[j]);break}it*=(mt.split("-").length+Math.min(mt.split("(").length-1,mt.split(")").length-1))%2?1:-1,mt=mt.replace(/[^0-9\.]+/g,""),it*=Number(mt)}return it},isNaN:function(mt){return"number"==typeof mt&&isNaN(mt)},includes:function(mt,xt){return-1!==mt.indexOf(xt)},insert:function(mt,xt,Jt){return mt.slice(0,Jt)+xt+mt.slice(Jt)},reduce:function(mt,xt){if(null===this)throw new TypeError("Array.prototype.reduce called on null or undefined");if("function"!=typeof xt)throw new TypeError(xt+" is not a function");var it,Jt=Object(mt),ye=Jt.length>>>0,j=0;if(3===arguments.length)it=arguments[2];else{for(;j<ye&&!(j in Jt);)j++;if(j>=ye)throw new TypeError("Reduce of empty array with no initial value");it=Jt[j++]}for(;j<ye;j++)j in Jt&&(it=xt(it,Jt[j],j,Jt));return it},multiplier:function(mt){var xt=mt.toString().split(".");return xt.length<2?1:Math.pow(10,xt[1].length)},correctionFactor:function(){return Array.prototype.slice.call(arguments).reduce(function(xt,Jt){var ye=lt.multiplier(Jt);return xt>ye?xt:ye},1)},toFixed:function(mt,xt,Jt,ye){var K,tt,X,nt,j=mt.toString().split("."),it=xt-(ye||0);return K=2===j.length?Math.min(Math.max(j[1].length,it),xt):it,X=Math.pow(10,K),nt=(Jt(mt+"e+"+K)/X).toFixed(K),ye>xt-K&&(tt=new RegExp("\\.?0{1,"+(ye-(xt-K))+"}$"),nt=nt.replace(tt,"")),nt}},s.options=qt,s.formats=Lt,s.locales=Ft,s.locale=function(mt){return mt&&(qt.currentLocale=mt.toLowerCase()),qt.currentLocale},s.localeData=function(mt){if(!mt)return Ft[qt.currentLocale];if(mt=mt.toLowerCase(),!Ft[mt])throw new Error("Unknown locale : "+mt);return Ft[mt]},s.reset=function(){for(var mt in Qt)qt[mt]=Qt[mt]},s.zeroFormat=function(mt){qt.zeroFormat="string"==typeof mt?mt:null},s.nullFormat=function(mt){qt.nullFormat="string"==typeof mt?mt:null},s.defaultFormat=function(mt){qt.defaultFormat="string"==typeof mt?mt:"0.0"},s.register=function(mt,xt,Jt){if(xt=xt.toLowerCase(),this[mt+"s"][xt])throw new TypeError(xt+" "+mt+" already registered.");return this[mt+"s"][xt]=Jt,Jt},s.validate=function(mt,xt){var Jt,ye,j,it,K,tt,X,nt;if("string"!=typeof mt&&(mt+="",console.warn&&console.warn("Numeral.js: Value is not string. It has been co-erced to: ",mt)),(mt=mt.trim()).match(/^\d+$/))return!0;if(""===mt)return!1;try{X=s.localeData(xt)}catch{X=s.localeData(s.locale())}return j=X.currency.symbol,K=X.abbreviations,Jt=X.delimiters.decimal,ye="."===X.delimiters.thousands?"\\.":X.delimiters.thousands,!(null!==(nt=mt.match(/^[^\d]+/))&&(mt=mt.substr(1),nt[0]!==j)||null!==(nt=mt.match(/[^\d]+$/))&&(mt=mt.slice(0,-1),nt[0]!==K.thousand&&nt[0]!==K.million&&nt[0]!==K.billion&&nt[0]!==K.trillion)||(tt=new RegExp(ye+"{2}"),mt.match(/[^\d.,]/g)||(it=mt.split(Jt)).length>2||(it.length<2?!it[0].match(/^\d+.*\d$/)||it[0].match(tt):1===it[0].length?!it[0].match(/^\d+$/)||it[0].match(tt)||!it[1].match(/^\d+$/):!it[0].match(/^\d+.*\d$/)||it[0].match(tt)||!it[1].match(/^\d+$/))))},s.fn=_e.prototype={clone:function(){return s(this)},format:function(mt,xt){var j,it,K,Jt=this._value,ye=mt||qt.defaultFormat;if(xt=xt||Math.round,0===Jt&&null!==qt.zeroFormat)it=qt.zeroFormat;else if(null===Jt&&null!==qt.nullFormat)it=qt.nullFormat;else{for(j in Lt)if(ye.match(Lt[j].regexps.format)){K=Lt[j].format;break}it=(K=K||s._.numberToFormat)(Jt,ye,xt)}return it},value:function(){return this._value},input:function(){return this._input},set:function(mt){return this._value=Number(mt),this},add:function(mt){var xt=lt.correctionFactor.call(null,this._value,mt);return this._value=lt.reduce([this._value,mt],function Jt(ye,j,it,K){return ye+Math.round(xt*j)},0)/xt,this},subtract:function(mt){var xt=lt.correctionFactor.call(null,this._value,mt);return this._value=lt.reduce([mt],function Jt(ye,j,it,K){return ye-Math.round(xt*j)},Math.round(this._value*xt))/xt,this},multiply:function(mt){return this._value=lt.reduce([this._value,mt],function xt(Jt,ye,j,it){var K=lt.correctionFactor(Jt,ye);return Math.round(Jt*K)*Math.round(ye*K)/Math.round(K*K)},1),this},divide:function(mt){return this._value=lt.reduce([this._value,mt],function xt(Jt,ye,j,it){var K=lt.correctionFactor(Jt,ye);return Math.round(Jt*K)/Math.round(ye*K)}),this},difference:function(mt){return Math.abs(s(this._value).subtract(mt).value())}},s.register("locale","en",{delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function(mt){var xt=mt%10;return 1==~~(mt%100/10)?"th":1===xt?"st":2===xt?"nd":3===xt?"rd":"th"},currency:{symbol:"$"}}),s.register("format","bps",{regexps:{format:/(BPS)/,unformat:/(BPS)/},format:function(mt,xt,Jt){var j,ye=s._.includes(xt," BPS")?" ":"";return mt*=1e4,xt=xt.replace(/\s?BPS/,""),j=s._.numberToFormat(mt,xt,Jt),s._.includes(j,")")?((j=j.split("")).splice(-1,0,ye+"BPS"),j=j.join("")):j=j+ye+"BPS",j},unformat:function(mt){return+(1e-4*s._.stringToNumber(mt)).toFixed(15)}}),ye="("+(ye=(mt={base:1e3,suffixes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"]}).suffixes.concat((xt={base:1024,suffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"]}).suffixes.filter(function(j){return mt.suffixes.indexOf(j)<0})).join("|")).replace("B","B(?!PS)")+")",s.register("format","bytes",{regexps:{format:/([0\s]i?b)/,unformat:new RegExp(ye)},format:function(j,it,K){var J,et,at,X=s._.includes(it,"ib")?xt:mt,nt=s._.includes(it," b")||s._.includes(it," ib")?" ":"";for(it=it.replace(/\s?i?b/,""),J=0;J<=X.suffixes.length;J++)if(et=Math.pow(X.base,J),at=Math.pow(X.base,J+1),null===j||0===j||j>=et&&j<at){nt+=X.suffixes[J],et>0&&(j/=et);break}return s._.numberToFormat(j,it,K)+nt},unformat:function(j){var K,tt,it=s._.stringToNumber(j);if(it){for(K=mt.suffixes.length-1;K>=0;K--){if(s._.includes(j,mt.suffixes[K])){tt=Math.pow(mt.base,K);break}if(s._.includes(j,xt.suffixes[K])){tt=Math.pow(xt.base,K);break}}it*=tt||1}return it}}),s.register("format","currency",{regexps:{format:/(\$)/},format:function(mt,xt,Jt){var it,K,tt,ye=s.locales[s.options.currentLocale],j={before:xt.match(/^([\+|\-|\(|\s|\$]*)/)[0],after:xt.match(/([\+|\-|\)|\s|\$]*)$/)[0]};for(xt=xt.replace(/\s?\$\s?/,""),it=s._.numberToFormat(mt,xt,Jt),mt>=0?(j.before=j.before.replace(/[\-\(]/,""),j.after=j.after.replace(/[\-\)]/,"")):mt<0&&!s._.includes(j.before,"-")&&!s._.includes(j.before,"(")&&(j.before="-"+j.before),tt=0;tt<j.before.length;tt++)switch(K=j.before[tt],K){case"$":it=s._.insert(it,ye.currency.symbol,tt);break;case" ":it=s._.insert(it," ",tt+ye.currency.symbol.length-1)}for(tt=j.after.length-1;tt>=0;tt--)switch(K=j.after[tt],K){case"$":it=tt===j.after.length-1?it+ye.currency.symbol:s._.insert(it,ye.currency.symbol,-(j.after.length-(1+tt)));break;case" ":it=tt===j.after.length-1?it+" ":s._.insert(it," ",-(j.after.length-(1+tt)+ye.currency.symbol.length-1))}return it}}),s.register("format","exponential",{regexps:{format:/(e\+|e-)/,unformat:/(e\+|e-)/},format:function(mt,xt,Jt){var it=("number"!=typeof mt||s._.isNaN(mt)?"0e+0":mt.toExponential()).split("e");return xt=xt.replace(/e[\+|\-]{1}0/,""),s._.numberToFormat(Number(it[0]),xt,Jt)+"e"+it[1]},unformat:function(mt){var xt=s._.includes(mt,"e+")?mt.split("e+"):mt.split("e-"),Jt=Number(xt[0]),ye=Number(xt[1]);return ye=s._.includes(mt,"e-")?ye*=-1:ye,s._.reduce([Jt,Math.pow(10,ye)],function j(it,K,tt,X){var nt=s._.correctionFactor(it,K);return it*nt*(K*nt)/(nt*nt)},1)}}),s.register("format","ordinal",{regexps:{format:/(o)/},format:function(mt,xt,Jt){var ye=s.locales[s.options.currentLocale],it=s._.includes(xt," o")?" ":"";return xt=xt.replace(/\s?o/,""),it+=ye.ordinal(mt),s._.numberToFormat(mt,xt,Jt)+it}}),s.register("format","percentage",{regexps:{format:/(%)/,unformat:/(%)/},format:function(mt,xt,Jt){var j,ye=s._.includes(xt," %")?" ":"";return s.options.scalePercentBy100&&(mt*=100),xt=xt.replace(/\s?\%/,""),j=s._.numberToFormat(mt,xt,Jt),s._.includes(j,")")?((j=j.split("")).splice(-1,0,ye+"%"),j=j.join("")):j=j+ye+"%",j},unformat:function(mt){var xt=s._.stringToNumber(mt);return s.options.scalePercentBy100?.01*xt:xt}}),s.register("format","time",{regexps:{format:/(:)/,unformat:/(:)/},format:function(mt,xt,Jt){var ye=Math.floor(mt/60/60),j=Math.floor((mt-60*ye*60)/60),it=Math.round(mt-60*ye*60-60*j);return ye+":"+(j<10?"0"+j:j)+":"+(it<10?"0"+it:it)},unformat:function(mt){var xt=mt.split(":"),Jt=0;return 3===xt.length?(Jt+=60*Number(xt[0])*60,Jt+=60*Number(xt[1]),Jt+=Number(xt[2])):2===xt.length&&(Jt+=60*Number(xt[0]),Jt+=Number(xt[1])),Number(Jt)}}),s},void 0!==(Pt=gt.call(ce,It,ce,tr))&&(tr.exports=Pt)},5943:tr=>{"use strict";var ce=Object.getOwnPropertySymbols,It=Object.prototype.hasOwnProperty,gt=Object.prototype.propertyIsEnumerable;function Pt(lt){if(null==lt)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(lt)}tr.exports=function s(){try{if(!Object.assign)return!1;var lt=new String("abc");if(lt[5]="de","5"===Object.getOwnPropertyNames(lt)[0])return!1;for(var ht={},Lt=0;Lt<10;Lt++)ht["_"+String.fromCharCode(Lt)]=Lt;if("0123456789"!==Object.getOwnPropertyNames(ht).map(function(qt){return ht[qt]}).join(""))return!1;var Qt={};return"abcdefghijklmnopqrst".split("").forEach(function(qt){Qt[qt]=qt}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},Qt)).join("")}catch{return!1}}()?Object.assign:function(lt,ht){for(var Lt,Qt,Ft=Pt(lt),qt=1;qt<arguments.length;qt++){for(var _e in Lt=Object(arguments[qt]))It.call(Lt,_e)&&(Ft[_e]=Lt[_e]);if(ce){Qt=ce(Lt);for(var mt=0;mt<Qt.length;mt++)gt.call(Lt,Qt[mt])&&(Ft[Qt[mt]]=Lt[Qt[mt]])}}return Ft}},1175:tr=>{"use strict";var ce=function(It){return It!=It};tr.exports=function(gt,Pt){return 0===gt&&0===Pt?1/gt==1/Pt:!!(gt===Pt||ce(gt)&&ce(Pt))}},2e3:(tr,ce,It)=>{"use strict";var gt=It(2358),Pt=It(5685),s=It(1175),lt=It(6305),ht=It(3859),Lt=Pt(lt(),Object);gt(Lt,{getPolyfill:lt,implementation:s,shim:ht}),tr.exports=Lt},6305:(tr,ce,It)=>{"use strict";var gt=It(1175);tr.exports=function(){return"function"==typeof Object.is?Object.is:gt}},3859:(tr,ce,It)=>{"use strict";var gt=It(6305),Pt=It(2358);tr.exports=function(){var lt=gt();return Pt(Object,{is:lt},{is:function(){return Object.is!==lt}}),lt}},2450:(tr,ce,It)=>{"use strict";var gt;if(!Object.keys){var Pt=Object.prototype.hasOwnProperty,s=Object.prototype.toString,lt=It(9978),ht=Object.prototype.propertyIsEnumerable,Lt=!ht.call({toString:null},"toString"),Ft=ht.call(function(){},"prototype"),Qt=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],qt=function(Jt){var ye=Jt.constructor;return ye&&ye.prototype===Jt},_e={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},mt=function(){if(typeof window>"u")return!1;for(var Jt in window)try{if(!_e["$"+Jt]&&Pt.call(window,Jt)&&null!==window[Jt]&&"object"==typeof window[Jt])try{qt(window[Jt])}catch{return!0}}catch{return!0}return!1}();gt=function(ye){var j=null!==ye&&"object"==typeof ye,it="[object Function]"===s.call(ye),K=lt(ye),tt=j&&"[object String]"===s.call(ye),X=[];if(!j&&!it&&!K)throw new TypeError("Object.keys called on a non-object");var nt=Ft&&it;if(tt&&ye.length>0&&!Pt.call(ye,0))for(var J=0;J<ye.length;++J)X.push(String(J));if(K&&ye.length>0)for(var et=0;et<ye.length;++et)X.push(String(et));else for(var at in ye)(!nt||"prototype"!==at)&&Pt.call(ye,at)&&X.push(String(at));if(Lt)for(var Z=function(Jt){if(typeof window>"u"||!mt)return qt(Jt);try{return qt(Jt)}catch{return!1}}(ye),Wt=0;Wt<Qt.length;++Wt)(!Z||"constructor"!==Qt[Wt])&&Pt.call(ye,Qt[Wt])&&X.push(Qt[Wt]);return X}}tr.exports=gt},1356:(tr,ce,It)=>{"use strict";var gt=Array.prototype.slice,Pt=It(9978),s=Object.keys,lt=s?function(Ft){return s(Ft)}:It(2450),ht=Object.keys;lt.shim=function(){if(Object.keys){var Ft=function(){var Qt=Object.keys(arguments);return Qt&&Qt.length===arguments.length}(1,2);Ft||(Object.keys=function(qt){return Pt(qt)?ht(gt.call(qt)):ht(qt)})}else Object.keys=lt;return Object.keys||lt},tr.exports=lt},9978:tr=>{"use strict";var ce=Object.prototype.toString;tr.exports=function(gt){var Pt=ce.call(gt),s="[object Arguments]"===Pt;return s||(s="[object Array]"!==Pt&&null!==gt&&"object"==typeof gt&&"number"==typeof gt.length&&gt.length>=0&&"[object Function]"===ce.call(gt.callee)),s}},1766:tr=>{tr.exports=function(It,gt,Pt,s){var lt=It[0],ht=It[1],Lt=!1;void 0===Pt&&(Pt=0),void 0===s&&(s=gt.length);for(var Ft=(s-Pt)/2,Qt=0,qt=Ft-1;Qt<Ft;qt=Qt++){var _e=gt[Pt+2*Qt+0],mt=gt[Pt+2*Qt+1],Jt=gt[Pt+2*qt+1];mt>ht!=Jt>ht&&lt<(gt[Pt+2*qt+0]-_e)*(ht-mt)/(Jt-mt)+_e&&(Lt=!Lt)}return Lt}},3870:(tr,ce,It)=>{var gt=It(1766),Pt=It(2260);tr.exports=function(lt,ht,Lt,Ft){return ht.length>0&&Array.isArray(ht[0])?Pt(lt,ht,Lt,Ft):gt(lt,ht,Lt,Ft)},tr.exports.nested=Pt,tr.exports.flat=gt},2260:tr=>{tr.exports=function(It,gt,Pt,s){var lt=It[0],ht=It[1],Lt=!1;void 0===Pt&&(Pt=0),void 0===s&&(s=gt.length);for(var Ft=s-Pt,Qt=0,qt=Ft-1;Qt<Ft;qt=Qt++){var _e=gt[Qt+Pt][0],mt=gt[Qt+Pt][1],Jt=gt[qt+Pt][1];mt>ht!=Jt>ht&&lt<(gt[qt+Pt][0]-_e)*(ht-mt)/(Jt-mt)+_e&&(Lt=!Lt)}return Lt}},9855:function(tr){tr.exports=function(){"use strict";function ce(Kt,ut){if(!(Kt instanceof ut))throw new TypeError("Cannot call a class as a function")}function It(Kt,ut){for(var rt=0;rt<ut.length;rt++){var ot=ut[rt];ot.enumerable=ot.enumerable||!1,ot.configurable=!0,"value"in ot&&(ot.writable=!0),Object.defineProperty(Kt,ot.key,ot)}}function gt(Kt,ut,rt){return ut&&It(Kt.prototype,ut),rt&&It(Kt,rt),Kt}var Pt=function Kt(ut,rt){this.next=null,this.key=ut,this.data=rt,this.left=null,this.right=null};function s(Kt,ut){return Kt>ut?1:Kt<ut?-1:0}function lt(Kt,ut,rt){for(var ot=new Pt(null,null),Nt=ot,le=ot;;){var Oe=rt(Kt,ut.key);if(Oe<0){if(null===ut.left)break;if(rt(Kt,ut.left.key)<0&&(ut.left=(Qe=ut.left).right,Qe.right=ut,null===(ut=Qe).left))break;le.left=ut,le=ut,ut=ut.left}else{if(!(Oe>0))break;if(null===ut.right)break;var Qe;if(rt(Kt,ut.right.key)>0&&(ut.right=(Qe=ut.right).left,Qe.left=ut,null===(ut=Qe).right))break;Nt.right=ut,Nt=ut,ut=ut.right}}return Nt.right=ut.left,le.left=ut.right,ut.left=ot.right,ut.right=ot.left,ut}function ht(Kt,ut,rt,ot){var Nt=new Pt(Kt,ut);if(null===rt)return Nt.left=Nt.right=null,Nt;var le=ot(Kt,(rt=lt(Kt,rt,ot)).key);return le<0?(Nt.left=rt.left,Nt.right=rt,rt.left=null):le>=0&&(Nt.right=rt.right,Nt.left=rt,rt.right=null),Nt}function Lt(Kt,ut,rt){var ot=null,Nt=null;if(ut){var le=rt((ut=lt(Kt,ut,rt)).key,Kt);0===le?(ot=ut.left,Nt=ut.right):le<0?(Nt=ut.right,ut.right=null,ot=ut):(ot=ut.left,ut.left=null,Nt=ut)}return{left:ot,right:Nt}}function Qt(Kt,ut,rt,ot,Nt){if(Kt){ot(ut+(rt?"\u2514\u2500\u2500 ":"\u251c\u2500\u2500 ")+Nt(Kt)+"\n");var le=ut+(rt?"    ":"\u2502   ");Kt.left&&Qt(Kt.left,le,!1,ot,Nt),Kt.right&&Qt(Kt.right,le,!0,ot,Nt)}}var qt=function(){function Kt(ut){void 0===ut&&(ut=s),this._root=null,this._size=0,this._comparator=ut}return Kt.prototype.insert=function(ut,rt){return this._size++,this._root=ht(ut,rt,this._root,this._comparator)},Kt.prototype.add=function(ut,rt){var ot=new Pt(ut,rt);null===this._root&&(ot.left=ot.right=null,this._size++,this._root=ot);var Nt=this._comparator,le=lt(ut,this._root,Nt),Oe=Nt(ut,le.key);return 0===Oe?this._root=le:(Oe<0?(ot.left=le.left,ot.right=le,le.left=null):Oe>0&&(ot.right=le.right,ot.left=le,le.right=null),this._size++,this._root=ot),this._root},Kt.prototype.remove=function(ut){this._root=this._remove(ut,this._root,this._comparator)},Kt.prototype._remove=function(ut,rt,ot){var Nt;return null===rt?null:0===ot(ut,(rt=lt(ut,rt,ot)).key)?(null===rt.left?Nt=rt.right:(Nt=lt(ut,rt.left,ot)).right=rt.right,this._size--,Nt):rt},Kt.prototype.pop=function(){var ut=this._root;if(ut){for(;ut.left;)ut=ut.left;return this._root=lt(ut.key,this._root,this._comparator),this._root=this._remove(ut.key,this._root,this._comparator),{key:ut.key,data:ut.data}}return null},Kt.prototype.findStatic=function(ut){for(var rt=this._root,ot=this._comparator;rt;){var Nt=ot(ut,rt.key);if(0===Nt)return rt;rt=Nt<0?rt.left:rt.right}return null},Kt.prototype.find=function(ut){return this._root&&(this._root=lt(ut,this._root,this._comparator),0!==this._comparator(ut,this._root.key))?null:this._root},Kt.prototype.contains=function(ut){for(var rt=this._root,ot=this._comparator;rt;){var Nt=ot(ut,rt.key);if(0===Nt)return!0;rt=Nt<0?rt.left:rt.right}return!1},Kt.prototype.forEach=function(ut,rt){for(var ot=this._root,Nt=[],le=!1;!le;)null!==ot?(Nt.push(ot),ot=ot.left):0!==Nt.length?(ot=Nt.pop(),ut.call(rt,ot),ot=ot.right):le=!0;return this},Kt.prototype.range=function(ut,rt,ot,Nt){for(var le=[],Oe=this._comparator,Qe=this._root;0!==le.length||Qe;)if(Qe)le.push(Qe),Qe=Qe.left;else{if(Oe((Qe=le.pop()).key,rt)>0)break;if(Oe(Qe.key,ut)>=0&&ot.call(Nt,Qe))return this;Qe=Qe.right}return this},Kt.prototype.keys=function(){var ut=[];return this.forEach(function(rt){return ut.push(rt.key)}),ut},Kt.prototype.values=function(){var ut=[];return this.forEach(function(rt){return ut.push(rt.data)}),ut},Kt.prototype.min=function(){return this._root?this.minNode(this._root).key:null},Kt.prototype.max=function(){return this._root?this.maxNode(this._root).key:null},Kt.prototype.minNode=function(ut){if(void 0===ut&&(ut=this._root),ut)for(;ut.left;)ut=ut.left;return ut},Kt.prototype.maxNode=function(ut){if(void 0===ut&&(ut=this._root),ut)for(;ut.right;)ut=ut.right;return ut},Kt.prototype.at=function(ut){for(var rt=this._root,ot=!1,Nt=0,le=[];!ot;)if(rt)le.push(rt),rt=rt.left;else if(le.length>0){if(rt=le.pop(),Nt===ut)return rt;Nt++,rt=rt.right}else ot=!0;return null},Kt.prototype.next=function(ut){var rt=this._root,ot=null;if(ut.right){for(ot=ut.right;ot.left;)ot=ot.left;return ot}for(var Nt=this._comparator;rt;){var le=Nt(ut.key,rt.key);if(0===le)break;le<0?(ot=rt,rt=rt.left):rt=rt.right}return ot},Kt.prototype.prev=function(ut){var rt=this._root,ot=null;if(null!==ut.left){for(ot=ut.left;ot.right;)ot=ot.right;return ot}for(var Nt=this._comparator;rt;){var le=Nt(ut.key,rt.key);if(0===le)break;le<0?rt=rt.left:(ot=rt,rt=rt.right)}return ot},Kt.prototype.clear=function(){return this._root=null,this._size=0,this},Kt.prototype.toList=function(){return function xt(Kt){for(var ut=Kt,rt=[],ot=!1,Nt=new Pt(null,null),le=Nt;!ot;)ut?(rt.push(ut),ut=ut.left):rt.length>0?ut=(ut=le=le.next=rt.pop()).right:ot=!0;return le.next=null,Nt.next}(this._root)},Kt.prototype.load=function(ut,rt,ot){void 0===rt&&(rt=[]),void 0===ot&&(ot=!1);var Nt=ut.length,le=this._comparator;if(ot&&j(ut,rt,0,Nt-1,le),null===this._root)this._root=_e(ut,rt,0,Nt),this._size=Nt;else{var Oe=function ye(Kt,ut,rt){for(var ot=new Pt(null,null),Nt=ot,le=Kt,Oe=ut;null!==le&&null!==Oe;)rt(le.key,Oe.key)<0?(Nt.next=le,le=le.next):(Nt.next=Oe,Oe=Oe.next),Nt=Nt.next;return null!==le?Nt.next=le:null!==Oe&&(Nt.next=Oe),ot.next}(this.toList(),function mt(Kt,ut){for(var rt=new Pt(null,null),ot=rt,Nt=0;Nt<Kt.length;Nt++)ot=ot.next=new Pt(Kt[Nt],ut[Nt]);return ot.next=null,rt.next}(ut,rt),le);this._root=Jt({head:Oe},0,Nt=this._size+Nt)}return this},Kt.prototype.isEmpty=function(){return null===this._root},Object.defineProperty(Kt.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),Object.defineProperty(Kt.prototype,"root",{get:function(){return this._root},enumerable:!0,configurable:!0}),Kt.prototype.toString=function(ut){void 0===ut&&(ut=function(Nt){return String(Nt.key)});var rt=[];return Qt(this._root,"",!0,function(ot){return rt.push(ot)},ut),rt.join("")},Kt.prototype.update=function(ut,rt,ot){var Nt=this._comparator,le=Lt(ut,this._root,Nt),Oe=le.left,Qe=le.right;Nt(ut,rt)<0?Qe=ht(rt,ot,Qe,Nt):Oe=ht(rt,ot,Oe,Nt),this._root=function Ft(Kt,ut,rt){return null===ut?Kt:(null===Kt||((ut=lt(Kt.key,ut,rt)).left=Kt),ut)}(Oe,Qe,Nt)},Kt.prototype.split=function(ut){return Lt(ut,this._root,this._comparator)},Kt}();function _e(Kt,ut,rt,ot){var Nt=ot-rt;if(Nt>0){var le=rt+Math.floor(Nt/2),ir=new Pt(Kt[le],ut[le]);return ir.left=_e(Kt,ut,rt,le),ir.right=_e(Kt,ut,le+1,ot),ir}return null}function Jt(Kt,ut,rt){var ot=rt-ut;if(ot>0){var Nt=ut+Math.floor(ot/2),le=Jt(Kt,ut,Nt),Oe=Kt.head;return Oe.left=le,Kt.head=Kt.head.next,Oe.right=Jt(Kt,Nt+1,rt),Oe}return null}function j(Kt,ut,rt,ot,Nt){if(!(rt>=ot)){for(var le=Kt[rt+ot>>1],Oe=rt-1,Qe=ot+1;;){do{Oe++}while(Nt(Kt[Oe],le)<0);do{Qe--}while(Nt(Kt[Qe],le)>0);if(Oe>=Qe)break;var ir=Kt[Oe];Kt[Oe]=Kt[Qe],Kt[Qe]=ir,ir=ut[Oe],ut[Oe]=ut[Qe],ut[Qe]=ir}j(Kt,ut,rt,Qe,Nt),j(Kt,ut,Qe+1,ot,Nt)}}var it=function(ut,rt){return ut.ll.x<=rt.x&&rt.x<=ut.ur.x&&ut.ll.y<=rt.y&&rt.y<=ut.ur.y},K=function(ut,rt){return rt.ur.x<ut.ll.x||ut.ur.x<rt.ll.x||rt.ur.y<ut.ll.y||ut.ur.y<rt.ll.y?null:{ll:{x:ut.ll.x<rt.ll.x?rt.ll.x:ut.ll.x,y:ut.ll.y<rt.ll.y?rt.ll.y:ut.ll.y},ur:{x:ut.ur.x<rt.ur.x?ut.ur.x:rt.ur.x,y:ut.ur.y<rt.ur.y?ut.ur.y:rt.ur.y}}},tt=Number.EPSILON;void 0===tt&&(tt=Math.pow(2,-52));var X=tt*tt,nt=function(ut,rt){if(-tt<ut&&ut<tt&&-tt<rt&&rt<tt)return 0;var ot=ut-rt;return ot*ot<X*ut*rt?0:ut<rt?-1:1},J=function(){function Kt(){ce(this,Kt),this.reset()}return gt(Kt,[{key:"reset",value:function(){this.xRounder=new et,this.yRounder=new et}},{key:"round",value:function(rt,ot){return{x:this.xRounder.round(rt),y:this.yRounder.round(ot)}}}]),Kt}(),et=function(){function Kt(){ce(this,Kt),this.tree=new qt,this.round(0)}return gt(Kt,[{key:"round",value:function(rt){var ot=this.tree.add(rt),Nt=this.tree.prev(ot);if(null!==Nt&&0===nt(ot.key,Nt.key))return this.tree.remove(rt),Nt.key;var le=this.tree.next(ot);return null!==le&&0===nt(ot.key,le.key)?(this.tree.remove(rt),le.key):rt}}]),Kt}(),at=new J,Z=function(ut,rt){return ut.x*rt.y-ut.y*rt.x},Wt=function(ut,rt){return ut.x*rt.x+ut.y*rt.y},St=function(ut,rt,ot){var Oe=Z({x:rt.x-ut.x,y:rt.y-ut.y},{x:ot.x-ut.x,y:ot.y-ut.y});return nt(Oe,0)},kt=function(ut){return Math.sqrt(Wt(ut,ut))},dt=function(ut,rt,ot){var Nt={x:rt.x-ut.x,y:rt.y-ut.y},le={x:ot.x-ut.x,y:ot.y-ut.y};return Z(le,Nt)/kt(le)/kt(Nt)},je=function(ut,rt,ot){var Nt={x:rt.x-ut.x,y:rt.y-ut.y},le={x:ot.x-ut.x,y:ot.y-ut.y};return Wt(le,Nt)/kt(le)/kt(Nt)},Ce=function(ut,rt,ot){return 0===rt.y?null:{x:ut.x+rt.x/rt.y*(ot-ut.y),y:ot}},Mt=function(ut,rt,ot){return 0===rt.x?null:{x:ot,y:ut.y+rt.y/rt.x*(ot-ut.x)}},At=function(){function Kt(ut,rt){ce(this,Kt),void 0===ut.events?ut.events=[this]:ut.events.push(this),this.point=ut,this.isLeft=rt}return gt(Kt,null,[{key:"compare",value:function(rt,ot){var Nt=Kt.comparePoints(rt.point,ot.point);return 0!==Nt?Nt:(rt.point!==ot.point&&rt.link(ot),rt.isLeft!==ot.isLeft?rt.isLeft?1:-1:fe.compare(rt.segment,ot.segment))}},{key:"comparePoints",value:function(rt,ot){return rt.x<ot.x?-1:rt.x>ot.x?1:rt.y<ot.y?-1:rt.y>ot.y?1:0}}]),gt(Kt,[{key:"link",value:function(rt){if(rt.point===this.point)throw new Error("Tried to link already linked events");for(var ot=rt.point.events,Nt=0,le=ot.length;Nt<le;Nt++){var Oe=ot[Nt];this.point.events.push(Oe),Oe.point=this.point}this.checkForConsuming()}},{key:"checkForConsuming",value:function(){for(var rt=this.point.events.length,ot=0;ot<rt;ot++){var Nt=this.point.events[ot];if(void 0===Nt.segment.consumedBy)for(var le=ot+1;le<rt;le++){var Oe=this.point.events[le];void 0===Oe.consumedBy&&Nt.otherSE.point.events===Oe.otherSE.point.events&&Nt.segment.consume(Oe.segment)}}}},{key:"getAvailableLinkedEvents",value:function(){for(var rt=[],ot=0,Nt=this.point.events.length;ot<Nt;ot++){var le=this.point.events[ot];le!==this&&!le.segment.ringOut&&le.segment.isInResult()&&rt.push(le)}return rt}},{key:"getLeftmostComparator",value:function(rt){var ot=this,Nt=new Map,le=function(Qe){var ir=Qe.otherSE;Nt.set(Qe,{sine:dt(ot.point,rt.point,ir.point),cosine:je(ot.point,rt.point,ir.point)})};return function(Oe,Qe){Nt.has(Oe)||le(Oe),Nt.has(Qe)||le(Qe);var ir=Nt.get(Oe),Ge=ir.sine,fn=ir.cosine,en=Nt.get(Qe),hr=en.sine,gn=en.cosine;return Ge>=0&&hr>=0?fn<gn?1:fn>gn?-1:0:Ge<0&&hr<0?fn<gn?-1:fn>gn?1:0:hr<Ge?-1:hr>Ge?1:0}}}]),Kt}(),$t=0,fe=function(){function Kt(ut,rt,ot,Nt){ce(this,Kt),this.id=++$t,this.leftSE=ut,ut.segment=this,ut.otherSE=rt,this.rightSE=rt,rt.segment=this,rt.otherSE=ut,this.rings=ot,this.windings=Nt}return gt(Kt,null,[{key:"compare",value:function(rt,ot){var Nt=rt.leftSE.point.x,le=ot.leftSE.point.x,Oe=rt.rightSE.point.x,Qe=ot.rightSE.point.x;if(Qe<Nt)return 1;if(Oe<le)return-1;var ir=rt.leftSE.point.y,Ge=ot.leftSE.point.y,fn=rt.rightSE.point.y,en=ot.rightSE.point.y;if(Nt<le){if(Ge<ir&&Ge<fn)return 1;if(Ge>ir&&Ge>fn)return-1;var hr=rt.comparePoint(ot.leftSE.point);if(hr<0)return 1;if(hr>0)return-1;var gn=ot.comparePoint(rt.rightSE.point);return 0!==gn?gn:-1}if(Nt>le){if(ir<Ge&&ir<en)return-1;if(ir>Ge&&ir>en)return 1;var Yn=ot.comparePoint(rt.leftSE.point);if(0!==Yn)return Yn;var Jn=rt.comparePoint(ot.rightSE.point);return Jn<0?1:Jn>0?-1:1}if(ir<Ge)return-1;if(ir>Ge)return 1;if(Oe<Qe){var Sn=ot.comparePoint(rt.rightSE.point);if(0!==Sn)return Sn}if(Oe>Qe){var ri=rt.comparePoint(ot.rightSE.point);if(ri<0)return 1;if(ri>0)return-1}if(Oe!==Qe){var Br=fn-ir,Xo=Oe-Nt,zo=en-Ge,Yo=Qe-le;if(Br>Xo&&zo<Yo)return 1;if(Br<Xo&&zo>Yo)return-1}return Oe>Qe?1:Oe<Qe||fn<en?-1:fn>en?1:rt.id<ot.id?-1:rt.id>ot.id?1:0}}]),gt(Kt,[{key:"replaceRightSE",value:function(rt){this.rightSE=rt,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}},{key:"bbox",value:function(){var rt=this.leftSE.point.y,ot=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:rt<ot?rt:ot},ur:{x:this.rightSE.point.x,y:rt>ot?rt:ot}}}},{key:"vector",value:function(){return{x:this.rightSE.point.x-this.leftSE.point.x,y:this.rightSE.point.y-this.leftSE.point.y}}},{key:"isAnEndpoint",value:function(rt){return rt.x===this.leftSE.point.x&&rt.y===this.leftSE.point.y||rt.x===this.rightSE.point.x&&rt.y===this.rightSE.point.y}},{key:"comparePoint",value:function(rt){if(this.isAnEndpoint(rt))return 0;var ot=this.leftSE.point,Nt=this.rightSE.point,le=this.vector();if(ot.x===Nt.x)return rt.x===ot.x?0:rt.x<ot.x?1:-1;if(rt.x===ot.x+(rt.y-ot.y)/le.y*le.x)return 0;var Ge=ot.y+(rt.x-ot.x)/le.x*le.y;return rt.y===Ge?0:rt.y<Ge?-1:1}},{key:"getIntersection",value:function(rt){var ot=this.bbox(),Nt=rt.bbox(),le=K(ot,Nt);if(null===le)return null;var Oe=this.leftSE.point,Qe=this.rightSE.point,ir=rt.leftSE.point,Ge=rt.rightSE.point,fn=it(ot,ir)&&0===this.comparePoint(ir),en=it(Nt,Oe)&&0===rt.comparePoint(Oe),hr=it(ot,Ge)&&0===this.comparePoint(Ge),gn=it(Nt,Qe)&&0===rt.comparePoint(Qe);if(en&&fn)return gn&&!hr?Qe:!gn&&hr?Ge:null;if(en)return hr&&Oe.x===Ge.x&&Oe.y===Ge.y?null:Oe;if(fn)return gn&&Qe.x===ir.x&&Qe.y===ir.y?null:ir;if(gn&&hr)return null;if(gn)return Qe;if(hr)return Ge;var Yn=function(ut,rt,ot,Nt){if(0===rt.x)return Mt(ot,Nt,ut.x);if(0===Nt.x)return Mt(ut,rt,ot.x);if(0===rt.y)return Ce(ot,Nt,ut.y);if(0===Nt.y)return Ce(ut,rt,ot.y);var le=Z(rt,Nt);if(0==le)return null;var Oe={x:ot.x-ut.x,y:ot.y-ut.y},Qe=Z(Oe,rt)/le,ir=Z(Oe,Nt)/le;return{x:(ut.x+ir*rt.x+(ot.x+Qe*Nt.x))/2,y:(ut.y+ir*rt.y+(ot.y+Qe*Nt.y))/2}}(Oe,this.vector(),ir,rt.vector());return null!==Yn&&it(le,Yn)?at.round(Yn.x,Yn.y):null}},{key:"split",value:function(rt){var ot=[],Nt=void 0!==rt.events,le=new At(rt,!0),Oe=new At(rt,!1),Qe=this.rightSE;this.replaceRightSE(Oe),ot.push(Oe),ot.push(le);var ir=new Kt(le,Qe,this.rings.slice(),this.windings.slice());return At.comparePoints(ir.leftSE.point,ir.rightSE.point)>0&&ir.swapEvents(),At.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),Nt&&(le.checkForConsuming(),Oe.checkForConsuming()),ot}},{key:"swapEvents",value:function(){var rt=this.rightSE;this.rightSE=this.leftSE,this.leftSE=rt,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(var ot=0,Nt=this.windings.length;ot<Nt;ot++)this.windings[ot]*=-1}},{key:"consume",value:function(rt){for(var ot=this,Nt=rt;ot.consumedBy;)ot=ot.consumedBy;for(;Nt.consumedBy;)Nt=Nt.consumedBy;var le=Kt.compare(ot,Nt);if(0!==le){if(le>0){var Oe=ot;ot=Nt,Nt=Oe}if(ot.prev===Nt){var Qe=ot;ot=Nt,Nt=Qe}for(var ir=0,Ge=Nt.rings.length;ir<Ge;ir++){var fn=Nt.rings[ir],en=Nt.windings[ir],hr=ot.rings.indexOf(fn);-1===hr?(ot.rings.push(fn),ot.windings.push(en)):ot.windings[hr]+=en}Nt.rings=null,Nt.windings=null,Nt.consumedBy=ot,Nt.leftSE.consumedBy=ot.leftSE,Nt.rightSE.consumedBy=ot.rightSE}}},{key:"prevInResult",value:function(){return void 0!==this._prevInResult||(this._prevInResult=this.prev?this.prev.isInResult()?this.prev:this.prev.prevInResult():null),this._prevInResult}},{key:"beforeState",value:function(){return void 0!==this._beforeState||(this._beforeState=this.prev?(this.prev.consumedBy||this.prev).afterState():{rings:[],windings:[],multiPolys:[]}),this._beforeState}},{key:"afterState",value:function(){if(void 0!==this._afterState)return this._afterState;var rt=this.beforeState();this._afterState={rings:rt.rings.slice(0),windings:rt.windings.slice(0),multiPolys:[]};for(var ot=this._afterState.rings,Nt=this._afterState.windings,le=this._afterState.multiPolys,Oe=0,Qe=this.rings.length;Oe<Qe;Oe++){var ir=this.rings[Oe],Ge=this.windings[Oe],fn=ot.indexOf(ir);-1===fn?(ot.push(ir),Nt.push(Ge)):Nt[fn]+=Ge}for(var en=[],hr=[],gn=0,Yn=ot.length;gn<Yn;gn++)if(0!==Nt[gn]){var Jn=ot[gn],Sn=Jn.poly;if(-1===hr.indexOf(Sn))if(Jn.isExterior)en.push(Sn);else{-1===hr.indexOf(Sn)&&hr.push(Sn);var ri=en.indexOf(Jn.poly);-1!==ri&&en.splice(ri,1)}}for(var Br=0,Xo=en.length;Br<Xo;Br++){var zo=en[Br].multiPoly;-1===le.indexOf(zo)&&le.push(zo)}return this._afterState}},{key:"isInResult",value:function(){if(this.consumedBy)return!1;if(void 0!==this._isInResult)return this._isInResult;var rt=this.beforeState().multiPolys,ot=this.afterState().multiPolys;switch(He.type){case"union":this._isInResult=0===rt.length!=(0===ot.length);break;case"intersection":var Oe,Qe;rt.length<ot.length?(Oe=rt.length,Qe=ot.length):(Oe=ot.length,Qe=rt.length),this._isInResult=Qe===He.numMultiPolys&&Oe<Qe;break;case"xor":var ir=Math.abs(rt.length-ot.length);this._isInResult=ir%2==1;break;case"difference":var Ge=function(en){return 1===en.length&&en[0].isSubject};this._isInResult=Ge(rt)!==Ge(ot);break;default:throw new Error("Unrecognized operation type found ".concat(He.type))}return this._isInResult}}],[{key:"fromRing",value:function(rt,ot,Nt){var le,Oe,Qe,ir=At.comparePoints(rt,ot);if(ir<0)le=rt,Oe=ot,Qe=1;else{if(!(ir>0))throw new Error("Tried to create degenerate segment at [".concat(rt.x,", ").concat(rt.y,"]"));le=ot,Oe=rt,Qe=-1}return new Kt(new At(le,!0),new At(Oe,!1),[Nt],[Qe])}}]),Kt}(),Ot=function(){function Kt(ut,rt,ot){if(ce(this,Kt),!Array.isArray(ut)||0===ut.length)throw new Error("Input geometry is not a valid Polygon or MultiPolygon");if(this.poly=rt,this.isExterior=ot,this.segments=[],"number"!=typeof ut[0][0]||"number"!=typeof ut[0][1])throw new Error("Input geometry is not a valid Polygon or MultiPolygon");var Nt=at.round(ut[0][0],ut[0][1]);this.bbox={ll:{x:Nt.x,y:Nt.y},ur:{x:Nt.x,y:Nt.y}};for(var le=Nt,Oe=1,Qe=ut.length;Oe<Qe;Oe++){if("number"!=typeof ut[Oe][0]||"number"!=typeof ut[Oe][1])throw new Error("Input geometry is not a valid Polygon or MultiPolygon");var ir=at.round(ut[Oe][0],ut[Oe][1]);ir.x===le.x&&ir.y===le.y||(this.segments.push(fe.fromRing(le,ir,this)),ir.x<this.bbox.ll.x&&(this.bbox.ll.x=ir.x),ir.y<this.bbox.ll.y&&(this.bbox.ll.y=ir.y),ir.x>this.bbox.ur.x&&(this.bbox.ur.x=ir.x),ir.y>this.bbox.ur.y&&(this.bbox.ur.y=ir.y),le=ir)}(Nt.x!==le.x||Nt.y!==le.y)&&this.segments.push(fe.fromRing(le,Nt,this))}return gt(Kt,[{key:"getSweepEvents",value:function(){for(var rt=[],ot=0,Nt=this.segments.length;ot<Nt;ot++){var le=this.segments[ot];rt.push(le.leftSE),rt.push(le.rightSE)}return rt}}]),Kt}(),Be=function(){function Kt(ut,rt){if(ce(this,Kt),!Array.isArray(ut))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new Ot(ut[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(var ot=1,Nt=ut.length;ot<Nt;ot++){var le=new Ot(ut[ot],this,!1);le.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=le.bbox.ll.x),le.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=le.bbox.ll.y),le.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=le.bbox.ur.x),le.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=le.bbox.ur.y),this.interiorRings.push(le)}this.multiPoly=rt}return gt(Kt,[{key:"getSweepEvents",value:function(){for(var rt=this.exteriorRing.getSweepEvents(),ot=0,Nt=this.interiorRings.length;ot<Nt;ot++)for(var le=this.interiorRings[ot].getSweepEvents(),Oe=0,Qe=le.length;Oe<Qe;Oe++)rt.push(le[Oe]);return rt}}]),Kt}(),De=function(){function Kt(ut,rt){if(ce(this,Kt),!Array.isArray(ut))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");try{"number"==typeof ut[0][0][0]&&(ut=[ut])}catch{}this.polys=[],this.bbox={ll:{x:Number.POSITIVE_INFINITY,y:Number.POSITIVE_INFINITY},ur:{x:Number.NEGATIVE_INFINITY,y:Number.NEGATIVE_INFINITY}};for(var ot=0,Nt=ut.length;ot<Nt;ot++){var le=new Be(ut[ot],this);le.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=le.bbox.ll.x),le.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=le.bbox.ll.y),le.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=le.bbox.ur.x),le.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=le.bbox.ur.y),this.polys.push(le)}this.isSubject=rt}return gt(Kt,[{key:"getSweepEvents",value:function(){for(var rt=[],ot=0,Nt=this.polys.length;ot<Nt;ot++)for(var le=this.polys[ot].getSweepEvents(),Oe=0,Qe=le.length;Oe<Qe;Oe++)rt.push(le[Oe]);return rt}}]),Kt}(),sr=function(){function Kt(ut){ce(this,Kt),this.events=ut;for(var rt=0,ot=ut.length;rt<ot;rt++)ut[rt].segment.ringOut=this;this.poly=null}return gt(Kt,null,[{key:"factory",value:function(rt){for(var ot=[],Nt=0,le=rt.length;Nt<le;Nt++){var Oe=rt[Nt];if(Oe.isInResult()&&!Oe.ringOut){for(var Qe=null,ir=Oe.leftSE,Ge=Oe.rightSE,fn=[ir],en=ir.point,hr=[];Qe=ir,fn.push(ir=Ge),ir.point!==en;)for(;;){var gn=ir.getAvailableLinkedEvents();if(0===gn.length){var Yn=fn[0].point,Jn=fn[fn.length-1].point;throw new Error("Unable to complete output ring starting at [".concat(Yn.x,",")+" ".concat(Yn.y,"]. Last matching segment found ends at")+" [".concat(Jn.x,", ").concat(Jn.y,"]."))}if(1===gn.length){Ge=gn[0].otherSE;break}for(var Sn=null,ri=0,Br=hr.length;ri<Br;ri++)if(hr[ri].point===ir.point){Sn=ri;break}if(null===Sn){hr.push({index:fn.length,point:ir.point});var Yo=ir.getLeftmostComparator(Qe);Ge=gn.sort(Yo)[0].otherSE;break}var Xo=hr.splice(Sn)[0],zo=fn.splice(Xo.index);zo.unshift(zo[0].otherSE),ot.push(new Kt(zo.reverse()))}ot.push(new Kt(fn))}}return ot}}]),gt(Kt,[{key:"getGeom",value:function(){for(var rt=this.events[0].point,ot=[rt],Nt=1,le=this.events.length-1;Nt<le;Nt++){var Oe=this.events[Nt].point;0!==St(Oe,rt,this.events[Nt+1].point)&&(ot.push(Oe),rt=Oe)}if(1===ot.length)return null;0===St(ot[0],rt,ot[1])&&ot.shift(),ot.push(ot[0]);for(var fn=this.isExteriorRing()?1:-1,en=this.isExteriorRing()?0:ot.length-1,hr=this.isExteriorRing()?ot.length:-1,gn=[],Yn=en;Yn!=hr;Yn+=fn)gn.push([ot[Yn].x,ot[Yn].y]);return gn}},{key:"isExteriorRing",value:function(){if(void 0===this._isExteriorRing){var rt=this.enclosingRing();this._isExteriorRing=!rt||!rt.isExteriorRing()}return this._isExteriorRing}},{key:"enclosingRing",value:function(){return void 0===this._enclosingRing&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}},{key:"_calcEnclosingRing",value:function(){for(var rt=this.events[0],ot=1,Nt=this.events.length;ot<Nt;ot++){var le=this.events[ot];At.compare(rt,le)>0&&(rt=le)}for(var Oe=rt.segment.prevInResult(),Qe=Oe?Oe.prevInResult():null;;){if(!Oe)return null;if(!Qe)return Oe.ringOut;if(Qe.ringOut!==Oe.ringOut)return Qe.ringOut.enclosingRing()!==Oe.ringOut?Oe.ringOut:Oe.ringOut.enclosingRing();Oe=Qe.prevInResult(),Qe=Oe?Oe.prevInResult():null}}}]),Kt}(),Ie=function(){function Kt(ut){ce(this,Kt),this.exteriorRing=ut,ut.poly=this,this.interiorRings=[]}return gt(Kt,[{key:"addInterior",value:function(rt){this.interiorRings.push(rt),rt.poly=this}},{key:"getGeom",value:function(){var rt=[this.exteriorRing.getGeom()];if(null===rt[0])return null;for(var ot=0,Nt=this.interiorRings.length;ot<Nt;ot++){var le=this.interiorRings[ot].getGeom();null!==le&&rt.push(le)}return rt}}]),Kt}(),Sr=function(){function Kt(ut){ce(this,Kt),this.rings=ut,this.polys=this._composePolys(ut)}return gt(Kt,[{key:"getGeom",value:function(){for(var rt=[],ot=0,Nt=this.polys.length;ot<Nt;ot++){var le=this.polys[ot].getGeom();null!==le&&rt.push(le)}return rt}},{key:"_composePolys",value:function(rt){for(var ot=[],Nt=0,le=rt.length;Nt<le;Nt++){var Oe=rt[Nt];if(!Oe.poly)if(Oe.isExteriorRing())ot.push(new Ie(Oe));else{var Qe=Oe.enclosingRing();Qe.poly||ot.push(new Ie(Qe)),Qe.poly.addInterior(Oe)}}return ot}}]),Kt}(),mr=function(){function Kt(ut){var rt=arguments.length>1&&void 0!==arguments[1]?arguments[1]:fe.compare;ce(this,Kt),this.queue=ut,this.tree=new qt(rt),this.segments=[]}return gt(Kt,[{key:"process",value:function(rt){var ot=rt.segment,Nt=[];if(rt.consumedBy)return rt.isLeft?this.queue.remove(rt.otherSE):this.tree.remove(ot),Nt;var le=rt.isLeft?this.tree.insert(ot):this.tree.find(ot);if(!le)throw new Error("Unable to find segment #".concat(ot.id," ")+"[".concat(ot.leftSE.point.x,", ").concat(ot.leftSE.point.y,"] -> ")+"[".concat(ot.rightSE.point.x,", ").concat(ot.rightSE.point.y,"] ")+"in SweepLine tree. Please submit a bug report.");for(var Oe=le,Qe=le,ir=void 0,Ge=void 0;void 0===ir;)null===(Oe=this.tree.prev(Oe))?ir=null:void 0===Oe.key.consumedBy&&(ir=Oe.key);for(;void 0===Ge;)null===(Qe=this.tree.next(Qe))?Ge=null:void 0===Qe.key.consumedBy&&(Ge=Qe.key);if(rt.isLeft){var fn=null;if(ir){var en=ir.getIntersection(ot);if(null!==en&&(ot.isAnEndpoint(en)||(fn=en),!ir.isAnEndpoint(en)))for(var hr=this._splitSafely(ir,en),gn=0,Yn=hr.length;gn<Yn;gn++)Nt.push(hr[gn])}var Jn=null;if(Ge){var Sn=Ge.getIntersection(ot);if(null!==Sn&&(ot.isAnEndpoint(Sn)||(Jn=Sn),!Ge.isAnEndpoint(Sn)))for(var ri=this._splitSafely(Ge,Sn),Br=0,Xo=ri.length;Br<Xo;Br++)Nt.push(ri[Br])}if(null!==fn||null!==Jn){var zo;zo=null===fn?Jn:null===Jn||At.comparePoints(fn,Jn)<=0?fn:Jn,this.queue.remove(ot.rightSE),Nt.push(ot.rightSE);for(var Gn=ot.split(zo),xa=0,xn=Gn.length;xa<xn;xa++)Nt.push(Gn[xa])}Nt.length>0?(this.tree.remove(ot),Nt.push(rt)):(this.segments.push(ot),ot.prev=ir)}else{if(ir&&Ge){var cr=ir.getIntersection(Ge);if(null!==cr){if(!ir.isAnEndpoint(cr))for(var oi=this._splitSafely(ir,cr),Y=0,W=oi.length;Y<W;Y++)Nt.push(oi[Y]);if(!Ge.isAnEndpoint(cr))for(var ft=this._splitSafely(Ge,cr),bt=0,zt=ft.length;bt<zt;bt++)Nt.push(ft[bt])}}this.tree.remove(ot)}return Nt}},{key:"_splitSafely",value:function(rt,ot){this.tree.remove(rt);var Nt=rt.rightSE;this.queue.remove(Nt);var le=rt.split(ot);return le.push(Nt),void 0===rt.consumedBy&&this.tree.insert(rt),le}}]),Kt}(),Ur=typeof process<"u"&&process.env.POLYGON_CLIPPING_MAX_QUEUE_SIZE||1e6,jr=typeof process<"u"&&process.env.POLYGON_CLIPPING_MAX_SWEEPLINE_SEGMENTS||1e6,He=new(function(){function Kt(){ce(this,Kt)}return gt(Kt,[{key:"run",value:function(rt,ot,Nt){He.type=rt,at.reset();for(var le=[new De(ot,!0)],Oe=0,Qe=Nt.length;Oe<Qe;Oe++)le.push(new De(Nt[Oe],!1));if(He.numMultiPolys=le.length,"difference"===He.type)for(var ir=le[0],Ge=1;Ge<le.length;)null!==K(le[Ge].bbox,ir.bbox)?Ge++:le.splice(Ge,1);if("intersection"===He.type)for(var fn=0,en=le.length;fn<en;fn++)for(var hr=le[fn],gn=fn+1,Yn=le.length;gn<Yn;gn++)if(null===K(hr.bbox,le[gn].bbox))return[];for(var Jn=new qt(At.compare),Sn=0,ri=le.length;Sn<ri;Sn++)for(var Br=le[Sn].getSweepEvents(),Xo=0,zo=Br.length;Xo<zo;Xo++)if(Jn.insert(Br[Xo]),Jn.size>Ur)throw new Error("Infinite loop when putting segment endpoints in a priority queue (queue size too big). Please file a bug report.");for(var Yo=new mr(Jn),Gn=Jn.size,xa=Jn.pop();xa;){var xn=xa.key;if(Jn.size===Gn){var cr=xn.segment;throw new Error("Unable to pop() ".concat(xn.isLeft?"left":"right"," SweepEvent ")+"[".concat(xn.point.x,", ").concat(xn.point.y,"] from segment #").concat(cr.id," ")+"[".concat(cr.leftSE.point.x,", ").concat(cr.leftSE.point.y,"] -> ")+"[".concat(cr.rightSE.point.x,", ").concat(cr.rightSE.point.y,"] from queue. ")+"Please file a bug report.")}if(Jn.size>Ur)throw new Error("Infinite loop when passing sweep line over endpoints (queue size too big). Please file a bug report.");if(Yo.segments.length>jr)throw new Error("Infinite loop when passing sweep line over endpoints (too many sweep line segments). Please file a bug report.");for(var oi=Yo.process(xn),Y=0,W=oi.length;Y<W;Y++){var ft=oi[Y];void 0===ft.consumedBy&&Jn.insert(ft)}Gn=Jn.size,xa=Jn.pop()}at.reset();var bt=sr.factory(Yo.segments);return new Sr(bt).getGeom()}}]),Kt}());return{union:function(ut){for(var rt=arguments.length,ot=new Array(rt>1?rt-1:0),Nt=1;Nt<rt;Nt++)ot[Nt-1]=arguments[Nt];return He.run("union",ut,ot)},intersection:function(ut){for(var rt=arguments.length,ot=new Array(rt>1?rt-1:0),Nt=1;Nt<rt;Nt++)ot[Nt-1]=arguments[Nt];return He.run("intersection",ut,ot)},xor:function(ut){for(var rt=arguments.length,ot=new Array(rt>1?rt-1:0),Nt=1;Nt<rt;Nt++)ot[Nt-1]=arguments[Nt];return He.run("xor",ut,ot)},difference:function(ut){for(var rt=arguments.length,ot=new Array(rt>1?rt-1:0),Nt=1;Nt<rt;Nt++)ot[Nt-1]=arguments[Nt];return He.run("difference",ut,ot)}}}()},3544:(tr,ce,It)=>{"use strict";tr.exports=Pt,tr.exports.default=Pt;var gt=It(6709);function Pt(K,tt){if(!(this instanceof Pt))return new Pt(K,tt);this._maxEntries=Math.max(4,K||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),tt&&this._initFormat(tt),this.clear()}function s(K,tt,X){if(!X)return tt.indexOf(K);for(var nt=0;nt<tt.length;nt++)if(X(K,tt[nt]))return nt;return-1}function lt(K,tt){ht(K,0,K.children.length,tt,K)}function ht(K,tt,X,nt,J){J||(J=j(null)),J.minX=1/0,J.minY=1/0,J.maxX=-1/0,J.maxY=-1/0;for(var at,et=tt;et<X;et++)at=K.children[et],Lt(J,K.leaf?nt(at):at);return J}function Lt(K,tt){return K.minX=Math.min(K.minX,tt.minX),K.minY=Math.min(K.minY,tt.minY),K.maxX=Math.max(K.maxX,tt.maxX),K.maxY=Math.max(K.maxY,tt.maxY),K}function Ft(K,tt){return K.minX-tt.minX}function Qt(K,tt){return K.minY-tt.minY}function qt(K){return(K.maxX-K.minX)*(K.maxY-K.minY)}function _e(K){return K.maxX-K.minX+(K.maxY-K.minY)}function mt(K,tt){return(Math.max(tt.maxX,K.maxX)-Math.min(tt.minX,K.minX))*(Math.max(tt.maxY,K.maxY)-Math.min(tt.minY,K.minY))}function xt(K,tt){var X=Math.max(K.minX,tt.minX),nt=Math.max(K.minY,tt.minY),J=Math.min(K.maxX,tt.maxX),et=Math.min(K.maxY,tt.maxY);return Math.max(0,J-X)*Math.max(0,et-nt)}function Jt(K,tt){return K.minX<=tt.minX&&K.minY<=tt.minY&&tt.maxX<=K.maxX&&tt.maxY<=K.maxY}function ye(K,tt){return tt.minX<=K.maxX&&tt.minY<=K.maxY&&tt.maxX>=K.minX&&tt.maxY>=K.minY}function j(K){return{children:K,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function it(K,tt,X,nt,J){for(var at,et=[tt,X];et.length;)!((X=et.pop())-(tt=et.pop())<=nt)&&(at=tt+Math.ceil((X-tt)/nt/2)*nt,gt(K,at,tt,X,J),et.push(tt,at,at,X))}Pt.prototype={all:function(){return this._all(this.data,[])},search:function(K){var tt=this.data,X=[],nt=this.toBBox;if(!ye(K,tt))return X;for(var et,at,Z,Wt,J=[];tt;){for(et=0,at=tt.children.length;et<at;et++)Z=tt.children[et],ye(K,Wt=tt.leaf?nt(Z):Z)&&(tt.leaf?X.push(Z):Jt(K,Wt)?this._all(Z,X):J.push(Z));tt=J.pop()}return X},collides:function(K){var tt=this.data,X=this.toBBox;if(!ye(K,tt))return!1;for(var J,et,at,Z,nt=[];tt;){for(J=0,et=tt.children.length;J<et;J++)if(at=tt.children[J],ye(K,Z=tt.leaf?X(at):at)){if(tt.leaf||Jt(K,Z))return!0;nt.push(at)}tt=nt.pop()}return!1},load:function(K){if(!K||!K.length)return this;if(K.length<this._minEntries){for(var tt=0,X=K.length;tt<X;tt++)this.insert(K[tt]);return this}var nt=this._build(K.slice(),0,K.length-1,0);if(this.data.children.length)if(this.data.height===nt.height)this._splitRoot(this.data,nt);else{if(this.data.height<nt.height){var J=this.data;this.data=nt,nt=J}this._insert(nt,this.data.height-nt.height-1,!0)}else this.data=nt;return this},insert:function(K){return K&&this._insert(K,this.data.height-1),this},clear:function(){return this.data=j([]),this},remove:function(K,tt){if(!K)return this;for(var at,Z,Wt,St,X=this.data,nt=this.toBBox(K),J=[],et=[];X||J.length;){if(X||(X=J.pop(),Z=J[J.length-1],at=et.pop(),St=!0),X.leaf&&-1!==(Wt=s(K,X.children,tt)))return X.children.splice(Wt,1),J.push(X),this._condense(J),this;St||X.leaf||!Jt(X,nt)?Z?(at++,X=Z.children[at],St=!1):X=null:(J.push(X),et.push(at),at=0,Z=X,X=X.children[0])}return this},toBBox:function(K){return K},compareMinX:Ft,compareMinY:Qt,toJSON:function(){return this.data},fromJSON:function(K){return this.data=K,this},_all:function(K,tt){for(var X=[];K;)K.leaf?tt.push.apply(tt,K.children):X.push.apply(X,K.children),K=X.pop();return tt},_build:function(K,tt,X,nt){var at,J=X-tt+1,et=this._maxEntries;if(J<=et)return lt(at=j(K.slice(tt,X+1)),this.toBBox),at;nt||(nt=Math.ceil(Math.log(J)/Math.log(et)),et=Math.ceil(J/Math.pow(et,nt-1))),(at=j([])).leaf=!1,at.height=nt;var St,kt,dt,je,Z=Math.ceil(J/et),Wt=Z*Math.ceil(Math.sqrt(et));for(it(K,tt,X,Wt,this.compareMinX),St=tt;St<=X;St+=Wt)for(it(K,St,dt=Math.min(St+Wt-1,X),Z,this.compareMinY),kt=St;kt<=dt;kt+=Z)je=Math.min(kt+Z-1,dt),at.children.push(this._build(K,kt,je,nt-1));return lt(at,this.toBBox),at},_chooseSubtree:function(K,tt,X,nt){for(var J,et,at,Z,Wt,St,kt,dt;nt.push(tt),!tt.leaf&&nt.length-1!==X;){for(kt=dt=1/0,J=0,et=tt.children.length;J<et;J++)Wt=qt(at=tt.children[J]),(St=mt(K,at)-Wt)<dt?(dt=St,kt=Wt<kt?Wt:kt,Z=at):St===dt&&Wt<kt&&(kt=Wt,Z=at);tt=Z||tt.children[0]}return tt},_insert:function(K,tt,X){var J=X?K:(0,this.toBBox)(K),et=[],at=this._chooseSubtree(J,this.data,tt,et);for(at.children.push(K),Lt(at,J);tt>=0&&et[tt].children.length>this._maxEntries;)this._split(et,tt),tt--;this._adjustParentBBoxes(J,et,tt)},_split:function(K,tt){var X=K[tt],nt=X.children.length,J=this._minEntries;this._chooseSplitAxis(X,J,nt);var et=this._chooseSplitIndex(X,J,nt),at=j(X.children.splice(et,X.children.length-et));at.height=X.height,at.leaf=X.leaf,lt(X,this.toBBox),lt(at,this.toBBox),tt?K[tt-1].children.push(at):this._splitRoot(X,at)},_splitRoot:function(K,tt){this.data=j([K,tt]),this.data.height=K.height+1,this.data.leaf=!1,lt(this.data,this.toBBox)},_chooseSplitIndex:function(K,tt,X){var nt,J,et,at,Z,Wt,St,kt;for(Wt=St=1/0,nt=tt;nt<=X-tt;nt++)at=xt(J=ht(K,0,nt,this.toBBox),et=ht(K,nt,X,this.toBBox)),Z=qt(J)+qt(et),at<Wt?(Wt=at,kt=nt,St=Z<St?Z:St):at===Wt&&Z<St&&(St=Z,kt=nt);return kt},_chooseSplitAxis:function(K,tt,X){var nt=K.leaf?this.compareMinX:Ft,J=K.leaf?this.compareMinY:Qt;this._allDistMargin(K,tt,X,nt)<this._allDistMargin(K,tt,X,J)&&K.children.sort(nt)},_allDistMargin:function(K,tt,X,nt){K.children.sort(nt);var Wt,St,J=this.toBBox,et=ht(K,0,tt,J),at=ht(K,X-tt,X,J),Z=_e(et)+_e(at);for(Wt=tt;Wt<X-tt;Wt++)St=K.children[Wt],Lt(et,K.leaf?J(St):St),Z+=_e(et);for(Wt=X-tt-1;Wt>=tt;Wt--)St=K.children[Wt],Lt(at,K.leaf?J(St):St),Z+=_e(at);return Z},_adjustParentBBoxes:function(K,tt,X){for(var nt=X;nt>=0;nt--)Lt(tt[nt],K)},_condense:function(K){for(var X,tt=K.length-1;tt>=0;tt--)0===K[tt].children.length?tt>0?(X=K[tt-1].children).splice(X.indexOf(K[tt]),1):this.clear():lt(K[tt],this.toBBox)},_initFormat:function(K){var tt=["return a"," - b",";"];this.compareMinX=new Function("a","b",tt.join(K[0])),this.compareMinY=new Function("a","b",tt.join(K[1])),this.toBBox=new Function("a","return {minX: a"+K[0]+", minY: a"+K[1]+", maxX: a"+K[2]+", maxY: a"+K[3]+"};")}}},6709:function(tr){tr.exports=function(){"use strict";function It(s,lt,ht,Lt,Ft){for(;Lt>ht;){if(Lt-ht>600){var Qt=Lt-ht+1,qt=lt-ht+1,_e=Math.log(Qt),mt=.5*Math.exp(2*_e/3),xt=.5*Math.sqrt(_e*mt*(Qt-mt)/Qt)*(qt-Qt/2<0?-1:1);It(s,lt,Math.max(ht,Math.floor(lt-qt*mt/Qt+xt)),Math.min(Lt,Math.floor(lt+(Qt-qt)*mt/Qt+xt)),Ft)}var j=s[lt],it=ht,K=Lt;for(gt(s,ht,lt),Ft(s[Lt],j)>0&&gt(s,ht,Lt);it<K;){for(gt(s,it,K),it++,K--;Ft(s[it],j)<0;)it++;for(;Ft(s[K],j)>0;)K--}0===Ft(s[ht],j)?gt(s,ht,K):gt(s,++K,Lt),K<=lt&&(ht=K+1),lt<=K&&(Lt=K-1)}}function gt(s,lt,ht){var Lt=s[lt];s[lt]=s[ht],s[ht]=Lt}function Pt(s,lt){return s<lt?-1:s>lt?1:0}return function ce(s,lt,ht,Lt,Ft){It(s,lt,ht||0,Lt||s.length-1,Ft||Pt)}}()},4468:(tr,ce,It)=>{"use strict";var gt=It(9582).functionsHaveConfigurableNames(),Pt=Object,s=TypeError;tr.exports=function(){if(null!=this&&this!==Pt(this))throw new s("RegExp.prototype.flags getter called on non-object");var ht="";return this.hasIndices&&(ht+="d"),this.global&&(ht+="g"),this.ignoreCase&&(ht+="i"),this.multiline&&(ht+="m"),this.dotAll&&(ht+="s"),this.unicode&&(ht+="u"),this.sticky&&(ht+="y"),ht},gt&&Object.defineProperty&&Object.defineProperty(tr.exports,"name",{value:"get flags"})},9235:(tr,ce,It)=>{"use strict";var gt=It(2358),Pt=It(5685),s=It(4468),lt=It(6343),ht=It(1956),Lt=Pt(lt());gt(Lt,{getPolyfill:lt,implementation:s,shim:ht}),tr.exports=Lt},6343:(tr,ce,It)=>{"use strict";var gt=It(4468),Pt=It(2358).supportsDescriptors,s=Object.getOwnPropertyDescriptor;tr.exports=function(){if(Pt&&"gim"===/a/gim.flags){var ht=s(RegExp.prototype,"flags");if(ht&&"function"==typeof ht.get&&"boolean"==typeof RegExp.prototype.dotAll&&"boolean"==typeof RegExp.prototype.hasIndices){var Lt="",Ft={};if(Object.defineProperty(Ft,"hasIndices",{get:function(){Lt+="d"}}),Object.defineProperty(Ft,"sticky",{get:function(){Lt+="y"}}),"dy"===Lt)return ht.get}}return gt}},1956:(tr,ce,It)=>{"use strict";var gt=It(2358).supportsDescriptors,Pt=It(6343),s=Object.getOwnPropertyDescriptor,lt=Object.defineProperty,ht=TypeError,Lt=Object.getPrototypeOf,Ft=/a/;tr.exports=function(){if(!gt||!Lt)throw new ht("RegExp.prototype.flags requires a true ES5 environment that supports property descriptors");var qt=Pt(),_e=Lt(Ft),mt=s(_e,"flags");return(!mt||mt.get!==qt)&&lt(_e,"flags",{configurable:!0,enumerable:!1,get:qt}),qt}},7563:function(tr,ce){!function(It){"use strict";function s(Jt,ye,j,it,K){let tt,X,nt,J,et=ye[0],at=it[0],Z=0,Wt=0;at>et==at>-et?(tt=et,et=ye[++Z]):(tt=at,at=it[++Wt]);let St=0;if(Z<Jt&&Wt<j)for(at>et==at>-et?(nt=tt-((X=et+tt)-et),et=ye[++Z]):(nt=tt-((X=at+tt)-at),at=it[++Wt]),tt=X,0!==nt&&(K[St++]=nt);Z<Jt&&Wt<j;)at>et==at>-et?(nt=tt-((X=tt+et)-(J=X-tt))+(et-J),et=ye[++Z]):(nt=tt-((X=tt+at)-(J=X-tt))+(at-J),at=it[++Wt]),tt=X,0!==nt&&(K[St++]=nt);for(;Z<Jt;)nt=tt-((X=tt+et)-(J=X-tt))+(et-J),et=ye[++Z],tt=X,0!==nt&&(K[St++]=nt);for(;Wt<j;)nt=tt-((X=tt+at)-(J=X-tt))+(at-J),at=it[++Wt],tt=X,0!==nt&&(K[St++]=nt);return 0===tt&&0!==St||(K[St++]=tt),St}function lt(Jt){return new Float64Array(Jt)}const Qt=lt(4),qt=lt(8),_e=lt(12),mt=lt(16),xt=lt(4);It.orient2d=function(Jt,ye,j,it,K,tt){const X=(ye-tt)*(j-K),nt=(Jt-K)*(it-tt),J=X-nt;if(0===X||0===nt||X>0!=nt>0)return J;const et=Math.abs(X+nt);return Math.abs(J)>=33306690738754716e-32*et?J:-function(at,Z,Wt,St,kt,dt,je){let Ce,Mt,pe,At,$t,fe,Ot,Be,De,sr,Ie,Sr,mr,Ur,jr,Er,He,ei;const _n=at-kt,zn=Wt-kt,se=Z-dt,Ze=St-dt;$t=(jr=(Be=_n-(Ot=(fe=134217729*_n)-(fe-_n)))*(sr=Ze-(De=(fe=134217729*Ze)-(fe-Ze)))-((Ur=_n*Ze)-Ot*De-Be*De-Ot*sr))-(Ie=jr-(He=(Be=se-(Ot=(fe=134217729*se)-(fe-se)))*(sr=zn-(De=(fe=134217729*zn)-(fe-zn)))-((Er=se*zn)-Ot*De-Be*De-Ot*sr))),Qt[0]=jr-(Ie+$t)+($t-He),$t=(mr=Ur-((Sr=Ur+Ie)-($t=Sr-Ur))+(Ie-$t))-(Ie=mr-Er),Qt[1]=mr-(Ie+$t)+($t-Er),$t=(ei=Sr+Ie)-Sr,Qt[2]=Sr-(ei-$t)+(Ie-$t),Qt[3]=ei;let Kt=function(le,Oe){let Qe=Oe[0];for(let ir=1;ir<4;ir++)Qe+=Oe[ir];return Qe}(0,Qt),ut=22204460492503146e-32*je;if(Kt>=ut||-Kt>=ut||(Ce=at-(_n+($t=at-_n))+($t-kt),pe=Wt-(zn+($t=Wt-zn))+($t-kt),Mt=Z-(se+($t=Z-se))+($t-dt),At=St-(Ze+($t=St-Ze))+($t-dt),0===Ce&&0===Mt&&0===pe&&0===At)||(ut=11093356479670487e-47*je+33306690738754706e-32*Math.abs(Kt),(Kt+=_n*At+Ze*Ce-(se*pe+zn*Mt))>=ut||-Kt>=ut))return Kt;$t=(jr=(Be=Ce-(Ot=(fe=134217729*Ce)-(fe-Ce)))*(sr=Ze-(De=(fe=134217729*Ze)-(fe-Ze)))-((Ur=Ce*Ze)-Ot*De-Be*De-Ot*sr))-(Ie=jr-(He=(Be=Mt-(Ot=(fe=134217729*Mt)-(fe-Mt)))*(sr=zn-(De=(fe=134217729*zn)-(fe-zn)))-((Er=Mt*zn)-Ot*De-Be*De-Ot*sr))),xt[0]=jr-(Ie+$t)+($t-He),$t=(mr=Ur-((Sr=Ur+Ie)-($t=Sr-Ur))+(Ie-$t))-(Ie=mr-Er),xt[1]=mr-(Ie+$t)+($t-Er),$t=(ei=Sr+Ie)-Sr,xt[2]=Sr-(ei-$t)+(Ie-$t),xt[3]=ei;const rt=s(4,Qt,4,xt,qt);$t=(jr=(Be=_n-(Ot=(fe=134217729*_n)-(fe-_n)))*(sr=At-(De=(fe=134217729*At)-(fe-At)))-((Ur=_n*At)-Ot*De-Be*De-Ot*sr))-(Ie=jr-(He=(Be=se-(Ot=(fe=134217729*se)-(fe-se)))*(sr=pe-(De=(fe=134217729*pe)-(fe-pe)))-((Er=se*pe)-Ot*De-Be*De-Ot*sr))),xt[0]=jr-(Ie+$t)+($t-He),$t=(mr=Ur-((Sr=Ur+Ie)-($t=Sr-Ur))+(Ie-$t))-(Ie=mr-Er),xt[1]=mr-(Ie+$t)+($t-Er),$t=(ei=Sr+Ie)-Sr,xt[2]=Sr-(ei-$t)+(Ie-$t),xt[3]=ei;const ot=s(rt,qt,4,xt,_e);$t=(jr=(Be=Ce-(Ot=(fe=134217729*Ce)-(fe-Ce)))*(sr=At-(De=(fe=134217729*At)-(fe-At)))-((Ur=Ce*At)-Ot*De-Be*De-Ot*sr))-(Ie=jr-(He=(Be=Mt-(Ot=(fe=134217729*Mt)-(fe-Mt)))*(sr=pe-(De=(fe=134217729*pe)-(fe-pe)))-((Er=Mt*pe)-Ot*De-Be*De-Ot*sr))),xt[0]=jr-(Ie+$t)+($t-He),$t=(mr=Ur-((Sr=Ur+Ie)-($t=Sr-Ur))+(Ie-$t))-(Ie=mr-Er),xt[1]=mr-(Ie+$t)+($t-Er),$t=(ei=Sr+Ie)-Sr,xt[2]=Sr-(ei-$t)+(Ie-$t),xt[3]=ei;const Nt=s(ot,_e,4,xt,mt);return mt[Nt-1]}(Jt,ye,j,it,K,tt,et)},It.orient2dfast=function(Jt,ye,j,it,K,tt){return(ye-tt)*(j-K)-(Jt-K)*(it-tt)},Object.defineProperty(It,"__esModule",{value:!0})}(ce)},9231:tr=>{"use strict";tr.exports={eudist:function(It,gt,Pt){for(var s=It.length,lt=0,ht=0;ht<s;ht++){var Lt=(It[ht]||0)-(gt[ht]||0);lt+=Lt*Lt}return Pt?Math.sqrt(lt):lt},mandist:function(It,gt,Pt){for(var s=It.length,lt=0,ht=0;ht<s;ht++)lt+=Math.abs((It[ht]||0)-(gt[ht]||0));return Pt?Math.sqrt(lt):lt},dist:function(It,gt,Pt){var s=Math.abs(It-gt);return Pt?s:s*s}}},5561:(tr,ce,It)=>{"use strict";var gt=It(9231),Pt=gt.eudist,s=gt.dist;tr.exports={kmrand:function(ht,Lt){for(var Ft={},Qt=[],qt=Lt<<2,_e=ht.length,mt=ht[0].length>0;Qt.length<Lt&&qt-- >0;){var xt=ht[Math.floor(Math.random()*_e)],Jt=mt?xt.join("_"):""+xt;Ft[Jt]||(Ft[Jt]=!0,Qt.push(xt))}if(Qt.length<Lt)throw new Error("Error initializating clusters");return Qt},kmpp:function(ht,Lt){var Ft=ht[0].length?Pt:s,Qt=[],qt=ht.length,_e=ht[0].length>0,xt=ht[Math.floor(Math.random()*qt)];for(_e&&xt.join("_"),Qt.push(xt);Qt.length<Lt;){for(var ye=[],j=Qt.length,it=0,K=[],tt=0;tt<qt;tt++){for(var X=1/0,nt=0;nt<j;nt++){var J=Ft(ht[tt],Qt[nt]);J<=X&&(X=J)}ye[tt]=X}for(var et=0;et<qt;et++)it+=ye[et];for(var at=0;at<qt;at++)K[at]={i:at,v:ht[at],pr:ye[at]/it,cs:0};K.sort(function(kt,dt){return kt.pr-dt.pr}),K[0].cs=K[0].pr;for(var Z=1;Z<qt;Z++)K[Z].cs=K[Z-1].cs+K[Z].pr;for(var Wt=Math.random(),St=0;St<qt-1&&K[St++].cs<Wt;);Qt.push(K[St-1].v)}return Qt}}},9475:(tr,ce,It)=>{"use strict";var gt=It(9231),Pt=It(5561),s=gt.eudist,Lt=Pt.kmrand,Ft=Pt.kmpp;function qt(mt,xt,Jt){Jt=Jt||[];for(var ye=0;ye<mt;ye++)Jt[ye]=xt;return Jt}tr.exports=function _e(mt,xt,Jt,ye){var j=[],it=[],K=[],tt=[],X=!1,nt=ye||1e4,J=mt.length,et=mt[0].length,at=et>0,Z=[];if(Jt)j="kmrand"==Jt?Lt(mt,xt):"kmpp"==Jt?Ft(mt,xt):Jt;else for(var Wt={};j.length<xt;){var St=Math.floor(Math.random()*J);Wt[St]||(Wt[St]=!0,j.push(mt[St]))}do{qt(xt,0,Z);for(var kt=0;kt<J;kt++){for(var dt=1/0,je=0,Ce=0;Ce<xt;Ce++)(tt=at?s(mt[kt],j[Ce]):Math.abs(mt[kt]-j[Ce]))<=dt&&(dt=tt,je=Ce);K[kt]=je,Z[je]++}for(var Mt=[],At=(it=[],0);At<xt;At++)Mt[At]=at?qt(et,0,Mt[At]):0,it[At]=j[At];if(at){for(var $t=0;$t<xt;$t++)j[$t]=[];for(var fe=0;fe<J;fe++)for(var Be=Mt[K[fe]],De=mt[fe],sr=0;sr<et;sr++)Be[sr]+=De[sr];X=!0;for(var Ie=0;Ie<xt;Ie++){for(var Sr=j[Ie],mr=Mt[Ie],Ur=it[Ie],jr=Z[Ie],Er=0;Er<et;Er++)Sr[Er]=mr[Er]/jr||0;if(X)for(var He=0;He<et;He++)if(Ur[He]!=Sr[He]){X=!1;break}}}else{for(var ei=0;ei<J;ei++)Mt[K[ei]]+=mt[ei];for(var zn=0;zn<xt;zn++)j[zn]=Mt[zn]/Z[zn]||0;X=!0;for(var se=0;se<xt;se++)if(it[se]!=j[se]){X=!1;break}}X=X||--nt<=0}while(!X);return{it:1e4-nt,k:xt,idxs:K,centroids:j}}},7253:(tr,ce,It)=>{"use strict";It.r(ce),It.d(ce,{default:()=>gt});class gt{constructor(lt=[],ht=Pt){if(this.data=lt,this.length=this.data.length,this.compare=ht,this.length>0)for(let Lt=(this.length>>1)-1;Lt>=0;Lt--)this._down(Lt)}push(lt){this.data.push(lt),this.length++,this._up(this.length-1)}pop(){if(0===this.length)return;const lt=this.data[0],ht=this.data.pop();return this.length--,this.length>0&&(this.data[0]=ht,this._down(0)),lt}peek(){return this.data[0]}_up(lt){const{data:ht,compare:Lt}=this,Ft=ht[lt];for(;lt>0;){const Qt=lt-1>>1,qt=ht[Qt];if(Lt(Ft,qt)>=0)break;ht[lt]=qt,lt=Qt}ht[lt]=Ft}_down(lt){const{data:ht,compare:Lt}=this,Ft=this.length>>1,Qt=ht[lt];for(;lt<Ft;){let qt=1+(lt<<1),_e=ht[qt];const mt=qt+1;if(mt<this.length&&Lt(ht[mt],_e)<0&&(qt=mt,_e=ht[mt]),Lt(_e,Qt)>=0)break;ht[lt]=_e,lt=qt}ht[lt]=Qt}}function Pt(s,lt){return s<lt?-1:s>lt?1:0}},770:function(tr,ce){!function(It){"use strict";function gt(){}function Pt(e){this.message=e||""}function s(e){this.message=e||""}function lt(e){this.message=e||""}function ht(){}function Lt(e){return null===e?Ht:e.color}function Ft(e){return null===e?null:e.parent}function Qt(e,i){null!==e&&(e.color=i)}function qt(e){return null===e?null:e.left}function _e(e){return null===e?null:e.right}function mt(){this.root_=null,this.size_=0}function xt(){}function Jt(){this.array_=[],arguments[0]instanceof Gn&&this.addAll(arguments[0])}function ye(){}function j(e){this.message=e||""}function it(){this.array_=[]}"fill"in Array.prototype||Object.defineProperty(Array.prototype,"fill",{configurable:!0,value:function(e){if(null==this)throw new TypeError(this+" is not an object");var i=Object(this),h=Math.max(Math.min(i.length,9007199254740991),0)||0,d=1 in arguments&&parseInt(Number(arguments[1]),10)||0;d=d<0?Math.max(h+d,0):Math.min(d,h);var x=2 in arguments&&void 0!==arguments[2]?parseInt(Number(arguments[2]),10)||0:h;for(x=x<0?Math.max(h+arguments[2],0):Math.min(x,h);d<x;)i[d]=e,++d;return i},writable:!0}),Number.isFinite=Number.isFinite||function(e){return"number"==typeof e&&isFinite(e)},Number.isInteger=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e},Number.parseFloat=Number.parseFloat||parseFloat,Number.isNaN=Number.isNaN||function(e){return e!=e},Math.trunc=Math.trunc||function(e){return e<0?Math.ceil(e):Math.floor(e)};var K=function(){};K.prototype.interfaces_=function(){return[]},K.prototype.getClass=function(){return K},K.prototype.equalsWithTolerance=function(e,i,h){return Math.abs(e-i)<=h};var tt=function(e){function i(h){e.call(this,h),this.name="IllegalArgumentException",this.message=h,this.stack=(new e).stack}return e&&(i.__proto__=e),(i.prototype=Object.create(e&&e.prototype)).constructor=i,i}(Error),X=function(){},nt={MAX_VALUE:{configurable:!0}};X.isNaN=function(e){return Number.isNaN(e)},X.doubleToLongBits=function(e){return e},X.longBitsToDouble=function(e){return e},X.isInfinite=function(e){return!Number.isFinite(e)},nt.MAX_VALUE.get=function(){return Number.MAX_VALUE},Object.defineProperties(X,nt);var J=function(){},et=function(){},at=function(){},Z=function e(){if(this.x=null,this.y=null,this.z=null,0===arguments.length)this.x=0,this.y=0,this.z=e.NULL_ORDINATE;else if(1===arguments.length){var i=arguments[0];this.x=i.x,this.y=i.y,this.z=i.z}else 2===arguments.length?(this.x=arguments[0],this.y=arguments[1],this.z=e.NULL_ORDINATE):3===arguments.length&&(this.x=arguments[0],this.y=arguments[1],this.z=arguments[2])},Wt={DimensionalComparator:{configurable:!0},serialVersionUID:{configurable:!0},NULL_ORDINATE:{configurable:!0},X:{configurable:!0},Y:{configurable:!0},Z:{configurable:!0}};Z.prototype.setOrdinate=function(e,i){switch(e){case Z.X:this.x=i;break;case Z.Y:this.y=i;break;case Z.Z:this.z=i;break;default:throw new tt("Invalid ordinate index: "+e)}},Z.prototype.equals2D=function(){if(1===arguments.length){var e=arguments[0];return this.x===e.x&&this.y===e.y}if(2===arguments.length){var i=arguments[0],h=arguments[1];return!!K.equalsWithTolerance(this.x,i.x,h)&&!!K.equalsWithTolerance(this.y,i.y,h)}},Z.prototype.getOrdinate=function(e){switch(e){case Z.X:return this.x;case Z.Y:return this.y;case Z.Z:return this.z}throw new tt("Invalid ordinate index: "+e)},Z.prototype.equals3D=function(e){return this.x===e.x&&this.y===e.y&&(this.z===e.z||X.isNaN(this.z))&&X.isNaN(e.z)},Z.prototype.equals=function(e){return e instanceof Z&&this.equals2D(e)},Z.prototype.equalInZ=function(e,i){return K.equalsWithTolerance(this.z,e.z,i)},Z.prototype.compareTo=function(e){return this.x<e.x?-1:this.x>e.x?1:this.y<e.y?-1:this.y>e.y?1:0},Z.prototype.clone=function(){},Z.prototype.copy=function(){return new Z(this)},Z.prototype.toString=function(){return"("+this.x+", "+this.y+", "+this.z+")"},Z.prototype.distance3D=function(e){var i=this.x-e.x,h=this.y-e.y,d=this.z-e.z;return Math.sqrt(i*i+h*h+d*d)},Z.prototype.distance=function(e){var i=this.x-e.x,h=this.y-e.y;return Math.sqrt(i*i+h*h)},Z.prototype.hashCode=function(){var e=17;return 37*(e=37*e+Z.hashCode(this.x))+Z.hashCode(this.y)},Z.prototype.setCoordinate=function(e){this.x=e.x,this.y=e.y,this.z=e.z},Z.prototype.interfaces_=function(){return[J,et,gt]},Z.prototype.getClass=function(){return Z},Z.hashCode=function(){if(1===arguments.length){var i=X.doubleToLongBits(arguments[0]);return Math.trunc((i^i)>>>32)}},Wt.DimensionalComparator.get=function(){return St},Wt.serialVersionUID.get=function(){return 0x5cbf2c235c7e5800},Wt.NULL_ORDINATE.get=function(){return X.NaN},Wt.X.get=function(){return 0},Wt.Y.get=function(){return 1},Wt.Z.get=function(){return 2},Object.defineProperties(Z,Wt);var St=function(e){if(this._dimensionsToTest=2,0!==arguments.length&&1===arguments.length){var i=arguments[0];if(2!==i&&3!==i)throw new tt("only 2 or 3 dimensions may be specified");this._dimensionsToTest=i}};St.prototype.compare=function(e,i){var h=e,d=i,x=St.compare(h.x,d.x);if(0!==x)return x;var D=St.compare(h.y,d.y);return 0!==D?D:this._dimensionsToTest<=2?0:St.compare(h.z,d.z)},St.prototype.interfaces_=function(){return[at]},St.prototype.getClass=function(){return St},St.compare=function(e,i){return e<i?-1:e>i?1:X.isNaN(e)?X.isNaN(i)?0:-1:X.isNaN(i)?1:0};var kt=function(){};kt.prototype.create=function(){},kt.prototype.interfaces_=function(){return[]},kt.prototype.getClass=function(){return kt};var dt=function(){},je={INTERIOR:{configurable:!0},BOUNDARY:{configurable:!0},EXTERIOR:{configurable:!0},NONE:{configurable:!0}};dt.prototype.interfaces_=function(){return[]},dt.prototype.getClass=function(){return dt},dt.toLocationSymbol=function(e){switch(e){case dt.EXTERIOR:return"e";case dt.BOUNDARY:return"b";case dt.INTERIOR:return"i";case dt.NONE:return"-"}throw new tt("Unknown location value: "+e)},je.INTERIOR.get=function(){return 0},je.BOUNDARY.get=function(){return 1},je.EXTERIOR.get=function(){return 2},je.NONE.get=function(){return-1},Object.defineProperties(dt,je);var Ce=function(e,i){return e.interfaces_&&e.interfaces_().indexOf(i)>-1},Mt=function(){},pe={LOG_10:{configurable:!0}};Mt.prototype.interfaces_=function(){return[]},Mt.prototype.getClass=function(){return Mt},Mt.log10=function(e){var i=Math.log(e);return X.isInfinite(i)||X.isNaN(i)?i:i/Mt.LOG_10},Mt.min=function(e,i,h,d){var x=e;return i<x&&(x=i),h<x&&(x=h),d<x&&(x=d),x},Mt.clamp=function(){if("number"==typeof arguments[2]&&"number"==typeof arguments[0]&&"number"==typeof arguments[1]){var e=arguments[0],i=arguments[1],h=arguments[2];return e<i?i:e>h?h:e}if(Number.isInteger(arguments[2])&&Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var d=arguments[0],x=arguments[1],D=arguments[2];return d<x?x:d>D?D:d}},Mt.wrap=function(e,i){return e<0?i- -e%i:e%i},Mt.max=function(){if(3===arguments.length){var i=arguments[1],h=arguments[2],d=arguments[0];return i>d&&(d=i),h>d&&(d=h),d}if(4===arguments.length){var D=arguments[1],F=arguments[2],$=arguments[3],Ct=arguments[0];return D>Ct&&(Ct=D),F>Ct&&(Ct=F),$>Ct&&(Ct=$),Ct}},Mt.average=function(e,i){return(e+i)/2},pe.LOG_10.get=function(){return Math.log(10)},Object.defineProperties(Mt,pe);var At=function(e){this.str=e};At.prototype.append=function(e){this.str+=e},At.prototype.setCharAt=function(e,i){this.str=this.str.substr(0,e)+i+this.str.substr(e+1)},At.prototype.toString=function(e){return this.str};var $t=function(e){this.value=e};$t.prototype.intValue=function(){return this.value},$t.prototype.compareTo=function(e){return this.value<e?-1:this.value>e?1:0},$t.isNaN=function(e){return Number.isNaN(e)};var fe=function(){};fe.isWhitespace=function(e){return e<=32&&e>=0||127===e},fe.toUpperCase=function(e){return e.toUpperCase()};var Ot=function e(){this._hi=0,this._lo=0,0===arguments.length?this.init(0):1===arguments.length?"number"==typeof arguments[0]||arguments[0]instanceof e?this.init(arguments[0]):"string"==typeof arguments[0]&&e.call(this,e.parse(arguments[0])):2===arguments.length&&this.init(arguments[0],arguments[1])},Be={PI:{configurable:!0},TWO_PI:{configurable:!0},PI_2:{configurable:!0},E:{configurable:!0},NaN:{configurable:!0},EPS:{configurable:!0},SPLIT:{configurable:!0},MAX_PRINT_DIGITS:{configurable:!0},TEN:{configurable:!0},ONE:{configurable:!0},SCI_NOT_EXPONENT_CHAR:{configurable:!0},SCI_NOT_ZERO:{configurable:!0}};Ot.prototype.le=function(e){return(this._hi<e._hi||this._hi===e._hi)&&this._lo<=e._lo},Ot.prototype.extractSignificantDigits=function(e,i){var h=this.abs(),d=Ot.magnitude(h._hi),x=Ot.TEN.pow(d);(h=h.divide(x)).gt(Ot.TEN)?(h=h.divide(Ot.TEN),d+=1):h.lt(Ot.ONE)&&(h=h.multiply(Ot.TEN),d-=1);for(var D=d+1,F=new At,$=Ot.MAX_PRINT_DIGITS-1,Ct=0;Ct<=$;Ct++){e&&Ct===D&&F.append(".");var te=Math.trunc(h._hi);if(te<0)break;var Ne=!1,Ve=0;te>9?(Ne=!0,Ve="9"):Ve="0"+te,F.append(Ve),h=h.subtract(Ot.valueOf(te)).multiply(Ot.TEN),Ne&&h.selfAdd(Ot.TEN);var gr=!0,Pr=Ot.magnitude(h._hi);if(Pr<0&&Math.abs(Pr)>=$-Ct&&(gr=!1),!gr)break}return i[0]=d,F.toString()},Ot.prototype.sqr=function(){return this.multiply(this)},Ot.prototype.doubleValue=function(){return this._hi+this._lo},Ot.prototype.subtract=function(){return arguments[0]instanceof Ot?this.add(arguments[0].negate()):"number"==typeof arguments[0]?this.add(-arguments[0]):void 0},Ot.prototype.equals=function(){if(1===arguments.length){var e=arguments[0];return this._hi===e._hi&&this._lo===e._lo}},Ot.prototype.isZero=function(){return 0===this._hi&&0===this._lo},Ot.prototype.selfSubtract=function(){if(arguments[0]instanceof Ot){var e=arguments[0];return this.isNaN()?this:this.selfAdd(-e._hi,-e._lo)}if("number"==typeof arguments[0]){var i=arguments[0];return this.isNaN()?this:this.selfAdd(-i,0)}},Ot.prototype.getSpecialNumberString=function(){return this.isZero()?"0.0":this.isNaN()?"NaN ":null},Ot.prototype.min=function(e){return this.le(e)?this:e},Ot.prototype.selfDivide=function(){if(1===arguments.length){if(arguments[0]instanceof Ot){var e=arguments[0];return this.selfDivide(e._hi,e._lo)}if("number"==typeof arguments[0])return this.selfDivide(arguments[0],0)}else if(2===arguments.length){var h=arguments[0],x=null,D=null,F=null,$=null,Ct=null,te=null,Ne=null,Ve=null;return this._hi=Ve=(Ct=this._hi/h)+(te=(this._hi-(Ne=Ct*h)-(Ve=(x=(te=Ot.SPLIT*Ct)-(x=te-Ct))*(F=(Ve=Ot.SPLIT*h)-(F=Ve-h))-Ne+x*($=h-F)+(D=Ct-x)*F+D*$)+this._lo-Ct*arguments[1])/h),this._lo=Ct-Ve+te,this}},Ot.prototype.dump=function(){return"DD<"+this._hi+", "+this._lo+">"},Ot.prototype.divide=function(){if(arguments[0]instanceof Ot){var e=arguments[0],i=null,h=null,d=null,x=null,D=null,F=null,$=null,Ct=null;return h=(D=this._hi/e._hi)-(i=(F=Ot.SPLIT*D)-(i=F-D)),Ct=i*(d=(Ct=Ot.SPLIT*e._hi)-(d=Ct-e._hi))-($=D*e._hi)+i*(x=e._hi-d)+h*d+h*x,new Ot(Ct=D+(F=(this._hi-$-Ct+this._lo-D*e._lo)/e._hi),D-Ct+F)}if("number"==typeof arguments[0]){var te=arguments[0];return X.isNaN(te)?Ot.createNaN():Ot.copy(this).selfDivide(te,0)}},Ot.prototype.ge=function(e){return(this._hi>e._hi||this._hi===e._hi)&&this._lo>=e._lo},Ot.prototype.pow=function(e){if(0===e)return Ot.valueOf(1);var i=new Ot(this),h=Ot.valueOf(1),d=Math.abs(e);if(d>1)for(;d>0;)d%2==1&&h.selfMultiply(i),(d/=2)>0&&(i=i.sqr());else h=i;return e<0?h.reciprocal():h},Ot.prototype.ceil=function(){if(this.isNaN())return Ot.NaN;var e=Math.ceil(this._hi),i=0;return e===this._hi&&(i=Math.ceil(this._lo)),new Ot(e,i)},Ot.prototype.compareTo=function(e){return this._hi<e._hi?-1:this._hi>e._hi?1:this._lo<e._lo?-1:this._lo>e._lo?1:0},Ot.prototype.rint=function(){return this.isNaN()?this:this.add(.5).floor()},Ot.prototype.setValue=function(){return arguments[0]instanceof Ot||"number"==typeof arguments[0]?(this.init(arguments[0]),this):void 0},Ot.prototype.max=function(e){return this.ge(e)?this:e},Ot.prototype.sqrt=function(){if(this.isZero())return Ot.valueOf(0);if(this.isNegative())return Ot.NaN;var e=1/Math.sqrt(this._hi),h=Ot.valueOf(this._hi*e),d=this.subtract(h.sqr())._hi*(.5*e);return h.add(d)},Ot.prototype.selfAdd=function(){if(1===arguments.length){if(arguments[0]instanceof Ot){var e=arguments[0];return this.selfAdd(e._hi,e._lo)}if("number"==typeof arguments[0]){var i=arguments[0],h=null,d=null,x=null,F=null,$=null;return this._hi=(h=(x=this._hi+i)+($=i-(F=x-this._hi)+(this._hi-(x-F))+this._lo))+(d=$+(x-h)),this._lo=d+(h-this._hi),this}}else if(2===arguments.length){var Ct=arguments[0],te=arguments[1],Ne=null,Ve=null,gr=null,Pr=null,Yr=null,an=null,Mi=null;Yr=(Pr=this._hi+Ct)-(an=Pr-this._hi),gr=(Ve=this._lo+te)-(Mi=Ve-this._lo);var l=(Ne=Pr+(an=(Yr=Ct-an+(this._hi-Yr))+Ve))+(an=(gr=te-Mi+(this._lo-gr))+(an+(Pr-Ne))),f=an+(Ne-l);return this._hi=l,this._lo=f,this}},Ot.prototype.selfMultiply=function(){if(1===arguments.length){if(arguments[0]instanceof Ot){var e=arguments[0];return this.selfMultiply(e._hi,e._lo)}if("number"==typeof arguments[0])return this.selfMultiply(arguments[0],0)}else if(2===arguments.length){var h=arguments[0],x=null,D=null,F=null,$=null,Ct=null,te=null;x=(Ct=Ot.SPLIT*this._hi)-this._hi,x=Ct-x;var Ne=(Ct=this._hi*h)+(te=x*(F=(te=Ot.SPLIT*h)-(F=te-h))-Ct+x*($=h-F)+(D=this._hi-x)*F+D*$+(this._hi*arguments[1]+this._lo*h)),Ve=te+(x=Ct-Ne);return this._hi=Ne,this._lo=Ve,this}},Ot.prototype.selfSqr=function(){return this.selfMultiply(this)},Ot.prototype.floor=function(){if(this.isNaN())return Ot.NaN;var e=Math.floor(this._hi),i=0;return e===this._hi&&(i=Math.floor(this._lo)),new Ot(e,i)},Ot.prototype.negate=function(){return this.isNaN()?this:new Ot(-this._hi,-this._lo)},Ot.prototype.clone=function(){},Ot.prototype.multiply=function(){if(arguments[0]instanceof Ot){var e=arguments[0];return e.isNaN()?Ot.createNaN():Ot.copy(this).selfMultiply(e)}if("number"==typeof arguments[0]){var i=arguments[0];return X.isNaN(i)?Ot.createNaN():Ot.copy(this).selfMultiply(i,0)}},Ot.prototype.isNaN=function(){return X.isNaN(this._hi)},Ot.prototype.intValue=function(){return Math.trunc(this._hi)},Ot.prototype.toString=function(){var e=Ot.magnitude(this._hi);return e>=-3&&e<=20?this.toStandardNotation():this.toSciNotation()},Ot.prototype.toStandardNotation=function(){var e=this.getSpecialNumberString();if(null!==e)return e;var i=new Array(1).fill(null),h=this.extractSignificantDigits(!0,i),d=i[0]+1,x=h;return"."===h.charAt(0)?x="0"+h:d<0?x="0."+Ot.stringOfChar("0",-d)+h:-1===h.indexOf(".")&&(x=h+Ot.stringOfChar("0",d-h.length)+".0"),this.isNegative()?"-"+x:x},Ot.prototype.reciprocal=function(){var i,d,x,F,e=null,h=null,D=null,$=null;i=(x=1/this._hi)-(e=(D=Ot.SPLIT*x)-(e=D-x)),h=($=Ot.SPLIT*this._hi)-this._hi;var Ct=x+(D=(1-(F=x*this._hi)-($=e*(h=$-h)-F+e*(d=this._hi-h)+i*h+i*d)-x*this._lo)/this._hi);return new Ot(Ct,x-Ct+D)},Ot.prototype.toSciNotation=function(){if(this.isZero())return Ot.SCI_NOT_ZERO;var e=this.getSpecialNumberString();if(null!==e)return e;var i=new Array(1).fill(null),h=this.extractSignificantDigits(!1,i),d=Ot.SCI_NOT_EXPONENT_CHAR+i[0];if("0"===h.charAt(0))throw new Error("Found leading zero: "+h);var x="";h.length>1&&(x=h.substring(1));var D=h.charAt(0)+"."+x;return this.isNegative()?"-"+D+d:D+d},Ot.prototype.abs=function(){return this.isNaN()?Ot.NaN:this.isNegative()?this.negate():new Ot(this)},Ot.prototype.isPositive=function(){return(this._hi>0||0===this._hi)&&this._lo>0},Ot.prototype.lt=function(e){return(this._hi<e._hi||this._hi===e._hi)&&this._lo<e._lo},Ot.prototype.add=function(){if(arguments[0]instanceof Ot){var e=arguments[0];return Ot.copy(this).selfAdd(e)}if("number"==typeof arguments[0]){var i=arguments[0];return Ot.copy(this).selfAdd(i)}},Ot.prototype.init=function(){if(1===arguments.length){if("number"==typeof arguments[0])this._hi=arguments[0],this._lo=0;else if(arguments[0]instanceof Ot){var i=arguments[0];this._hi=i._hi,this._lo=i._lo}}else if(2===arguments.length){var d=arguments[1];this._hi=arguments[0],this._lo=d}},Ot.prototype.gt=function(e){return(this._hi>e._hi||this._hi===e._hi)&&this._lo>e._lo},Ot.prototype.isNegative=function(){return(this._hi<0||0===this._hi)&&this._lo<0},Ot.prototype.trunc=function(){return this.isNaN()?Ot.NaN:this.isPositive()?this.floor():this.ceil()},Ot.prototype.signum=function(){return this._hi>0?1:this._hi<0?-1:this._lo>0?1:this._lo<0?-1:0},Ot.prototype.interfaces_=function(){return[gt,J,et]},Ot.prototype.getClass=function(){return Ot},Ot.sqr=function(e){return Ot.valueOf(e).selfMultiply(e)},Ot.valueOf=function(){return"string"==typeof arguments[0]?Ot.parse(arguments[0]):"number"==typeof arguments[0]?new Ot(arguments[0]):void 0},Ot.sqrt=function(e){return Ot.valueOf(e).sqrt()},Ot.parse=function(e){for(var i=0,h=e.length;fe.isWhitespace(e.charAt(i));)i++;var d=!1;if(i<h){var x=e.charAt(i);"-"!==x&&"+"!==x||(i++,"-"===x&&(d=!0))}for(var D=new Ot,F=0,$=0,Ct=0;!(i>=h);){var te=e.charAt(i);if(i++,fe.isDigit(te)){var Ne=te-"0";D.selfMultiply(Ot.TEN),D.selfAdd(Ne),F++}else{if("."!==te){if("e"===te||"E"===te){var Ve=e.substring(i);try{Ct=$t.parseInt(Ve)}catch(Mi){throw Mi instanceof Error?new Error("Invalid exponent "+Ve+" in string "+e):Mi}break}throw new Error("Unexpected character '"+te+"' at position "+i+" in string "+e)}$=F}}var gr=D,Pr=F-$-Ct;if(0===Pr)gr=D;else if(Pr>0){var Yr=Ot.TEN.pow(Pr);gr=D.divide(Yr)}else if(Pr<0){var an=Ot.TEN.pow(-Pr);gr=D.multiply(an)}return d?gr.negate():gr},Ot.createNaN=function(){return new Ot(X.NaN,X.NaN)},Ot.copy=function(e){return new Ot(e)},Ot.magnitude=function(e){var i=Math.abs(e),h=Math.log(i)/Math.log(10),d=Math.trunc(Math.floor(h));return 10*Math.pow(10,d)<=i&&(d+=1),d},Ot.stringOfChar=function(e,i){for(var h=new At,d=0;d<i;d++)h.append(e);return h.toString()},Be.PI.get=function(){return new Ot(3.141592653589793,12246467991473532e-32)},Be.TWO_PI.get=function(){return new Ot(6.283185307179586,24492935982947064e-32)},Be.PI_2.get=function(){return new Ot(1.5707963267948966,6123233995736766e-32)},Be.E.get=function(){return new Ot(2.718281828459045,14456468917292502e-32)},Be.NaN.get=function(){return new Ot(X.NaN,X.NaN)},Be.EPS.get=function(){return 123259516440783e-46},Be.SPLIT.get=function(){return 134217729},Be.MAX_PRINT_DIGITS.get=function(){return 32},Be.TEN.get=function(){return Ot.valueOf(10)},Be.ONE.get=function(){return Ot.valueOf(1)},Be.SCI_NOT_EXPONENT_CHAR.get=function(){return"E"},Be.SCI_NOT_ZERO.get=function(){return"0.0E0"},Object.defineProperties(Ot,Be);var De=function(){},sr={DP_SAFE_EPSILON:{configurable:!0}};De.prototype.interfaces_=function(){return[]},De.prototype.getClass=function(){return De},De.orientationIndex=function(e,i,h){var d=De.orientationIndexFilter(e,i,h);if(d<=1)return d;var x=Ot.valueOf(i.x).selfAdd(-e.x),D=Ot.valueOf(i.y).selfAdd(-e.y),F=Ot.valueOf(h.x).selfAdd(-i.x),$=Ot.valueOf(h.y).selfAdd(-i.y);return x.selfMultiply($).selfSubtract(D.selfMultiply(F)).signum()},De.signOfDet2x2=function(e,i,h,d){return e.multiply(d).selfSubtract(i.multiply(h)).signum()},De.intersection=function(e,i,h,d){var x=Ot.valueOf(d.y).selfSubtract(h.y).selfMultiply(Ot.valueOf(i.x).selfSubtract(e.x)),D=Ot.valueOf(d.x).selfSubtract(h.x).selfMultiply(Ot.valueOf(i.y).selfSubtract(e.y)),F=x.subtract(D),$=Ot.valueOf(d.x).selfSubtract(h.x).selfMultiply(Ot.valueOf(e.y).selfSubtract(h.y)),Ct=Ot.valueOf(d.y).selfSubtract(h.y).selfMultiply(Ot.valueOf(e.x).selfSubtract(h.x)),te=$.subtract(Ct).selfDivide(F).doubleValue(),Ne=Ot.valueOf(e.x).selfAdd(Ot.valueOf(i.x).selfSubtract(e.x).selfMultiply(te)).doubleValue(),Ve=Ot.valueOf(i.x).selfSubtract(e.x).selfMultiply(Ot.valueOf(e.y).selfSubtract(h.y)),gr=Ot.valueOf(i.y).selfSubtract(e.y).selfMultiply(Ot.valueOf(e.x).selfSubtract(h.x)),Pr=Ve.subtract(gr).selfDivide(F).doubleValue(),Yr=Ot.valueOf(h.y).selfAdd(Ot.valueOf(d.y).selfSubtract(h.y).selfMultiply(Pr)).doubleValue();return new Z(Ne,Yr)},De.orientationIndexFilter=function(e,i,h){var d=null,x=(e.x-h.x)*(i.y-h.y),D=(e.y-h.y)*(i.x-h.x),F=x-D;if(x>0){if(D<=0)return De.signum(F);d=x+D}else{if(!(x<0)||D>=0)return De.signum(F);d=-x-D}var $=De.DP_SAFE_EPSILON*d;return F>=$||-F>=$?De.signum(F):2},De.signum=function(e){return e>0?1:e<0?-1:0},sr.DP_SAFE_EPSILON.get=function(){return 1e-15},Object.defineProperties(De,sr);var Ie=function(){},Sr={X:{configurable:!0},Y:{configurable:!0},Z:{configurable:!0},M:{configurable:!0}};Sr.X.get=function(){return 0},Sr.Y.get=function(){return 1},Sr.Z.get=function(){return 2},Sr.M.get=function(){return 3},Ie.prototype.setOrdinate=function(e,i,h){},Ie.prototype.size=function(){},Ie.prototype.getOrdinate=function(e,i){},Ie.prototype.getCoordinate=function(){},Ie.prototype.getCoordinateCopy=function(e){},Ie.prototype.getDimension=function(){},Ie.prototype.getX=function(e){},Ie.prototype.clone=function(){},Ie.prototype.expandEnvelope=function(e){},Ie.prototype.copy=function(){},Ie.prototype.getY=function(e){},Ie.prototype.toCoordinateArray=function(){},Ie.prototype.interfaces_=function(){return[et]},Ie.prototype.getClass=function(){return Ie},Object.defineProperties(Ie,Sr);var mr=function(){},Ur=function(e){function i(){e.call(this,"Projective point not representable on the Cartesian plane.")}return e&&(i.__proto__=e),(i.prototype=Object.create(e&&e.prototype)).constructor=i,i.prototype.interfaces_=function(){return[]},i.prototype.getClass=function(){return i},i}(mr),jr=function(){};jr.arraycopy=function(e,i,h,d,x){for(var D=0,F=i;F<i+x;F++)h[d+D]=e[F],D++},jr.getProperty=function(e){return{"line.separator":"\n"}[e]};var Er=function e(){if(this.x=null,this.y=null,this.w=null,0===arguments.length)this.x=0,this.y=0,this.w=1;else if(1===arguments.length){var i=arguments[0];this.x=i.x,this.y=i.y,this.w=1}else if(2===arguments.length){if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){var d=arguments[1];this.x=arguments[0],this.y=d,this.w=1}else if(arguments[0]instanceof e&&arguments[1]instanceof e){var x=arguments[0],D=arguments[1];this.x=x.y*D.w-D.y*x.w,this.y=D.x*x.w-x.x*D.w,this.w=x.x*D.y-D.x*x.y}else if(arguments[0]instanceof Z&&arguments[1]instanceof Z){var F=arguments[0],$=arguments[1];this.x=F.y-$.y,this.y=$.x-F.x,this.w=F.x*$.y-$.x*F.y}}else if(3===arguments.length){var te=arguments[1],Ne=arguments[2];this.x=arguments[0],this.y=te,this.w=Ne}else if(4===arguments.length){var Ve=arguments[0],gr=arguments[1],Pr=arguments[2],Yr=arguments[3],an=Ve.y-gr.y,Mi=gr.x-Ve.x,l=Ve.x*gr.y-gr.x*Ve.y,f=Pr.y-Yr.y,c=Yr.x-Pr.x,m=Pr.x*Yr.y-Yr.x*Pr.y;this.x=Mi*m-c*l,this.y=f*l-an*m,this.w=an*c-f*Mi}};Er.prototype.getY=function(){var e=this.y/this.w;if(X.isNaN(e)||X.isInfinite(e))throw new Ur;return e},Er.prototype.getX=function(){var e=this.x/this.w;if(X.isNaN(e)||X.isInfinite(e))throw new Ur;return e},Er.prototype.getCoordinate=function(){var e=new Z;return e.x=this.getX(),e.y=this.getY(),e},Er.prototype.interfaces_=function(){return[]},Er.prototype.getClass=function(){return Er},Er.intersection=function(e,i,h,d){var x=e.y-i.y,D=i.x-e.x,F=e.x*i.y-i.x*e.y,$=h.y-d.y,Ct=d.x-h.x,te=h.x*d.y-d.x*h.y,Ne=x*Ct-$*D,Ve=(D*te-Ct*F)/Ne,gr=($*F-x*te)/Ne;if(X.isNaN(Ve)||X.isInfinite(Ve)||X.isNaN(gr)||X.isInfinite(gr))throw new Ur;return new Z(Ve,gr)};var He=function e(){if(this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,0===arguments.length)this.init();else if(1===arguments.length)if(arguments[0]instanceof Z){var i=arguments[0];this.init(i.x,i.x,i.y,i.y)}else arguments[0]instanceof e&&this.init(arguments[0]);else if(2===arguments.length){var d=arguments[0],x=arguments[1];this.init(d.x,x.x,d.y,x.y)}else 4===arguments.length&&this.init(arguments[0],arguments[1],arguments[2],arguments[3])},ei={serialVersionUID:{configurable:!0}};He.prototype.getArea=function(){return this.getWidth()*this.getHeight()},He.prototype.equals=function(e){if(!(e instanceof He))return!1;var i=e;return this.isNull()?i.isNull():this._maxx===i.getMaxX()&&this._maxy===i.getMaxY()&&this._minx===i.getMinX()&&this._miny===i.getMinY()},He.prototype.intersection=function(e){return this.isNull()||e.isNull()||!this.intersects(e)?new He:new He(this._minx>e._minx?this._minx:e._minx,this._maxx<e._maxx?this._maxx:e._maxx,this._miny>e._miny?this._miny:e._miny,this._maxy<e._maxy?this._maxy:e._maxy)},He.prototype.isNull=function(){return this._maxx<this._minx},He.prototype.getMaxX=function(){return this._maxx},He.prototype.covers=function(){if(1===arguments.length){if(arguments[0]instanceof Z){var e=arguments[0];return this.covers(e.x,e.y)}if(arguments[0]instanceof He){var i=arguments[0];return!this.isNull()&&!i.isNull()&&i.getMinX()>=this._minx&&i.getMaxX()<=this._maxx&&i.getMinY()>=this._miny&&i.getMaxY()<=this._maxy}}else if(2===arguments.length){var h=arguments[0],d=arguments[1];return!this.isNull()&&h>=this._minx&&h<=this._maxx&&d>=this._miny&&d<=this._maxy}},He.prototype.intersects=function(){if(1===arguments.length){if(arguments[0]instanceof He){var e=arguments[0];return!this.isNull()&&!e.isNull()&&!(e._minx>this._maxx||e._maxx<this._minx||e._miny>this._maxy||e._maxy<this._miny)}if(arguments[0]instanceof Z){var i=arguments[0];return this.intersects(i.x,i.y)}}else if(2===arguments.length){var h=arguments[0],d=arguments[1];return!this.isNull()&&!(h>this._maxx||h<this._minx||d>this._maxy||d<this._miny)}},He.prototype.getMinY=function(){return this._miny},He.prototype.getMinX=function(){return this._minx},He.prototype.expandToInclude=function(){if(1===arguments.length){if(arguments[0]instanceof Z){var e=arguments[0];this.expandToInclude(e.x,e.y)}else if(arguments[0]instanceof He){var i=arguments[0];if(i.isNull())return null;this.isNull()?(this._minx=i.getMinX(),this._maxx=i.getMaxX(),this._miny=i.getMinY(),this._maxy=i.getMaxY()):(i._minx<this._minx&&(this._minx=i._minx),i._maxx>this._maxx&&(this._maxx=i._maxx),i._miny<this._miny&&(this._miny=i._miny),i._maxy>this._maxy&&(this._maxy=i._maxy))}}else if(2===arguments.length){var h=arguments[0],d=arguments[1];this.isNull()?(this._minx=h,this._maxx=h,this._miny=d,this._maxy=d):(h<this._minx&&(this._minx=h),h>this._maxx&&(this._maxx=h),d<this._miny&&(this._miny=d),d>this._maxy&&(this._maxy=d))}},He.prototype.minExtent=function(){if(this.isNull())return 0;var e=this.getWidth(),i=this.getHeight();return e<i?e:i},He.prototype.getWidth=function(){return this.isNull()?0:this._maxx-this._minx},He.prototype.compareTo=function(e){var i=e;return this.isNull()?i.isNull()?0:-1:i.isNull()?1:this._minx<i._minx?-1:this._minx>i._minx?1:this._miny<i._miny?-1:this._miny>i._miny?1:this._maxx<i._maxx?-1:this._maxx>i._maxx?1:this._maxy<i._maxy?-1:this._maxy>i._maxy?1:0},He.prototype.translate=function(e,i){if(this.isNull())return null;this.init(this.getMinX()+e,this.getMaxX()+e,this.getMinY()+i,this.getMaxY()+i)},He.prototype.toString=function(){return"Env["+this._minx+" : "+this._maxx+", "+this._miny+" : "+this._maxy+"]"},He.prototype.setToNull=function(){this._minx=0,this._maxx=-1,this._miny=0,this._maxy=-1},He.prototype.getHeight=function(){return this.isNull()?0:this._maxy-this._miny},He.prototype.maxExtent=function(){if(this.isNull())return 0;var e=this.getWidth(),i=this.getHeight();return e>i?e:i},He.prototype.expandBy=function(){if(1===arguments.length){var e=arguments[0];this.expandBy(e,e)}else if(2===arguments.length){var i=arguments[0],h=arguments[1];if(this.isNull())return null;this._minx-=i,this._maxx+=i,this._miny-=h,this._maxy+=h,(this._minx>this._maxx||this._miny>this._maxy)&&this.setToNull()}},He.prototype.contains=function(){if(1===arguments.length){if(arguments[0]instanceof He)return this.covers(arguments[0]);if(arguments[0]instanceof Z)return this.covers(arguments[0])}else if(2===arguments.length)return this.covers(arguments[0],arguments[1])},He.prototype.centre=function(){return this.isNull()?null:new Z((this.getMinX()+this.getMaxX())/2,(this.getMinY()+this.getMaxY())/2)},He.prototype.init=function(){if(0===arguments.length)this.setToNull();else if(1===arguments.length){if(arguments[0]instanceof Z){var e=arguments[0];this.init(e.x,e.x,e.y,e.y)}else if(arguments[0]instanceof He){var i=arguments[0];this._minx=i._minx,this._maxx=i._maxx,this._miny=i._miny,this._maxy=i._maxy}}else if(2===arguments.length){var h=arguments[0],d=arguments[1];this.init(h.x,d.x,h.y,d.y)}else if(4===arguments.length){var x=arguments[0],D=arguments[1],F=arguments[2],$=arguments[3];x<D?(this._minx=x,this._maxx=D):(this._minx=D,this._maxx=x),F<$?(this._miny=F,this._maxy=$):(this._miny=$,this._maxy=F)}},He.prototype.getMaxY=function(){return this._maxy},He.prototype.distance=function(e){if(this.intersects(e))return 0;var i=0;this._maxx<e._minx?i=e._minx-this._maxx:this._minx>e._maxx&&(i=this._minx-e._maxx);var h=0;return this._maxy<e._miny?h=e._miny-this._maxy:this._miny>e._maxy&&(h=this._miny-e._maxy),0===i?h:0===h?i:Math.sqrt(i*i+h*h)},He.prototype.hashCode=function(){var e=17;return 37*(e=37*(e=37*(e=37*e+Z.hashCode(this._minx))+Z.hashCode(this._maxx))+Z.hashCode(this._miny))+Z.hashCode(this._maxy)},He.prototype.interfaces_=function(){return[J,gt]},He.prototype.getClass=function(){return He},He.intersects=function(){if(3===arguments.length){var e=arguments[0],i=arguments[1],h=arguments[2];return h.x>=(e.x<i.x?e.x:i.x)&&h.x<=(e.x>i.x?e.x:i.x)&&h.y>=(e.y<i.y?e.y:i.y)&&h.y<=(e.y>i.y?e.y:i.y)}if(4===arguments.length){var d=arguments[0],x=arguments[1],D=arguments[2],F=arguments[3],$=Math.min(D.x,F.x),Ct=Math.max(D.x,F.x),te=Math.min(d.x,x.x),Ne=Math.max(d.x,x.x);return!(te>Ct||Ne<$||($=Math.min(D.y,F.y),Ct=Math.max(D.y,F.y),te=Math.min(d.y,x.y),Ne=Math.max(d.y,x.y),te>Ct||Ne<$))}},ei.serialVersionUID.get=function(){return 0x51845cd552189800},Object.defineProperties(He,ei);var _n={typeStr:/^\s*(\w+)\s*\(\s*(.*)\s*\)\s*$/,emptyTypeStr:/^\s*(\w+)\s*EMPTY\s*$/,spaces:/\s+/,parenComma:/\)\s*,\s*\(/,doubleParenComma:/\)\s*\)\s*,\s*\(\s*\(/,trimParens:/^\s*\(?(.*?)\)?\s*$/},zn=function(e){this.geometryFactory=e||new wn};zn.prototype.read=function(e){var i,h;e=e.replace(/[\n\r]/g," ");var x=_n.typeStr.exec(e);if(-1!==e.search("EMPTY")&&((x=_n.emptyTypeStr.exec(e))[2]=void 0),x&&(h=x[1].toLowerCase(),Ze[h]&&(i=Ze[h].apply(this,[x[2]]))),void 0===i)throw new Error("Could not parse WKT "+e);return i},zn.prototype.write=function(e){return this.extractGeometry(e)},zn.prototype.extractGeometry=function(e){var i=e.getGeometryType().toLowerCase();if(!se[i])return null;var h=i.toUpperCase();return e.isEmpty()?h+" EMPTY":h+"("+se[i].apply(this,[e])+")"};var se={coordinate:function(e){return e.x+" "+e.y},point:function(e){return se.coordinate.call(this,e._coordinates._coordinates[0])},multipoint:function(e){for(var i=[],h=0,d=e._geometries.length;h<d;++h)i.push("("+se.point.apply(this,[e._geometries[h]])+")");return i.join(",")},linestring:function(e){for(var i=[],h=0,d=e._points._coordinates.length;h<d;++h)i.push(se.coordinate.apply(this,[e._points._coordinates[h]]));return i.join(",")},linearring:function(e){for(var i=[],h=0,d=e._points._coordinates.length;h<d;++h)i.push(se.coordinate.apply(this,[e._points._coordinates[h]]));return i.join(",")},multilinestring:function(e){for(var i=[],h=0,d=e._geometries.length;h<d;++h)i.push("("+se.linestring.apply(this,[e._geometries[h]])+")");return i.join(",")},polygon:function(e){var i=[];i.push("("+se.linestring.apply(this,[e._shell])+")");for(var h=0,d=e._holes.length;h<d;++h)i.push("("+se.linestring.apply(this,[e._holes[h]])+")");return i.join(",")},multipolygon:function(e){for(var i=[],h=0,d=e._geometries.length;h<d;++h)i.push("("+se.polygon.apply(this,[e._geometries[h]])+")");return i.join(",")},geometrycollection:function(e){for(var i=[],h=0,d=e._geometries.length;h<d;++h)i.push(this.extractGeometry(e._geometries[h]));return i.join(",")}},Ze={point:function(e){if(void 0===e)return this.geometryFactory.createPoint();var i=e.trim().split(_n.spaces);return this.geometryFactory.createPoint(new Z(Number.parseFloat(i[0]),Number.parseFloat(i[1])))},multipoint:function(e){if(void 0===e)return this.geometryFactory.createMultiPoint();for(var i,h=e.trim().split(","),d=[],x=0,D=h.length;x<D;++x)i=h[x].replace(_n.trimParens,"$1"),d.push(Ze.point.apply(this,[i]));return this.geometryFactory.createMultiPoint(d)},linestring:function(e){if(void 0===e)return this.geometryFactory.createLineString();for(var i,h=e.trim().split(","),d=[],x=0,D=h.length;x<D;++x)i=h[x].trim().split(_n.spaces),d.push(new Z(Number.parseFloat(i[0]),Number.parseFloat(i[1])));return this.geometryFactory.createLineString(d)},linearring:function(e){if(void 0===e)return this.geometryFactory.createLinearRing();for(var i,h=e.trim().split(","),d=[],x=0,D=h.length;x<D;++x)i=h[x].trim().split(_n.spaces),d.push(new Z(Number.parseFloat(i[0]),Number.parseFloat(i[1])));return this.geometryFactory.createLinearRing(d)},multilinestring:function(e){if(void 0===e)return this.geometryFactory.createMultiLineString();for(var i,h=e.trim().split(_n.parenComma),d=[],x=0,D=h.length;x<D;++x)i=h[x].replace(_n.trimParens,"$1"),d.push(Ze.linestring.apply(this,[i]));return this.geometryFactory.createMultiLineString(d)},polygon:function(e){if(void 0===e)return this.geometryFactory.createPolygon();for(var i,h,d,x,D=e.trim().split(_n.parenComma),F=[],$=0,Ct=D.length;$<Ct;++$)i=D[$].replace(_n.trimParens,"$1"),h=Ze.linestring.apply(this,[i]),d=this.geometryFactory.createLinearRing(h._points),0===$?x=d:F.push(d);return this.geometryFactory.createPolygon(x,F)},multipolygon:function(e){if(void 0===e)return this.geometryFactory.createMultiPolygon();for(var i,h=e.trim().split(_n.doubleParenComma),d=[],x=0,D=h.length;x<D;++x)i=h[x].replace(_n.trimParens,"$1"),d.push(Ze.polygon.apply(this,[i]));return this.geometryFactory.createMultiPolygon(d)},geometrycollection:function(e){if(void 0===e)return this.geometryFactory.createGeometryCollection();for(var i=(e=e.replace(/,\s*([A-Za-z])/g,"|$1")).trim().split("|"),h=[],d=0,x=i.length;d<x;++d)h.push(this.read(i[d]));return this.geometryFactory.createGeometryCollection(h)}},Kt=function(e){this.parser=new zn(e)};Kt.prototype.write=function(e){return this.parser.write(e)},Kt.toLineString=function(e,i){if(2!==arguments.length)throw new Error("Not implemented");return"LINESTRING ( "+e.x+" "+e.y+", "+i.x+" "+i.y+" )"};var ut=function(e){function i(h){e.call(this,h),this.name="RuntimeException",this.message=h,this.stack=(new e).stack}return e&&(i.__proto__=e),(i.prototype=Object.create(e&&e.prototype)).constructor=i,i}(Error),rt=function(e){function i(){e.call(this),0===arguments.length?e.call(this):1===arguments.length&&e.call(this,arguments[0])}return e&&(i.__proto__=e),(i.prototype=Object.create(e&&e.prototype)).constructor=i,i.prototype.interfaces_=function(){return[]},i.prototype.getClass=function(){return i},i}(ut),ot=function(){};ot.prototype.interfaces_=function(){return[]},ot.prototype.getClass=function(){return ot},ot.shouldNeverReachHere=function(){if(0===arguments.length)ot.shouldNeverReachHere(null);else if(1===arguments.length){var e=arguments[0];throw new rt("Should never reach here"+(null!==e?": "+e:""))}},ot.isTrue=function(){var i;if(1===arguments.length)ot.isTrue(arguments[0],null);else if(2===arguments.length&&(i=arguments[1],!arguments[0]))throw null===i?new rt:new rt(i)},ot.equals=function(){var e,i,h;if(2===arguments.length)ot.equals(e=arguments[0],i=arguments[1],null);else if(3===arguments.length&&(h=arguments[2],!(i=arguments[1]).equals(e=arguments[0])))throw new rt("Expected "+e+" but encountered "+i+(null!==h?": "+h:""))};var Nt=function(){this._result=null,this._inputLines=Array(2).fill().map(function(){return Array(2)}),this._intPt=new Array(2).fill(null),this._intLineIndex=null,this._isProper=null,this._pa=null,this._pb=null,this._precisionModel=null,this._intPt[0]=new Z,this._intPt[1]=new Z,this._pa=this._intPt[0],this._pb=this._intPt[1],this._result=0},le={DONT_INTERSECT:{configurable:!0},DO_INTERSECT:{configurable:!0},COLLINEAR:{configurable:!0},NO_INTERSECTION:{configurable:!0},POINT_INTERSECTION:{configurable:!0},COLLINEAR_INTERSECTION:{configurable:!0}};Nt.prototype.getIndexAlongSegment=function(e,i){return this.computeIntLineIndex(),this._intLineIndex[e][i]},Nt.prototype.getTopologySummary=function(){var e=new At;return this.isEndPoint()&&e.append(" endpoint"),this._isProper&&e.append(" proper"),this.isCollinear()&&e.append(" collinear"),e.toString()},Nt.prototype.computeIntersection=function(e,i,h,d){this._inputLines[0][0]=e,this._inputLines[0][1]=i,this._inputLines[1][0]=h,this._inputLines[1][1]=d,this._result=this.computeIntersect(e,i,h,d)},Nt.prototype.getIntersectionNum=function(){return this._result},Nt.prototype.computeIntLineIndex=function(){if(0===arguments.length)null===this._intLineIndex&&(this._intLineIndex=Array(2).fill().map(function(){return Array(2)}),this.computeIntLineIndex(0),this.computeIntLineIndex(1));else if(1===arguments.length){var e=arguments[0];this.getEdgeDistance(e,0)>this.getEdgeDistance(e,1)?(this._intLineIndex[e][0]=0,this._intLineIndex[e][1]=1):(this._intLineIndex[e][0]=1,this._intLineIndex[e][1]=0)}},Nt.prototype.isProper=function(){return this.hasIntersection()&&this._isProper},Nt.prototype.setPrecisionModel=function(e){this._precisionModel=e},Nt.prototype.isInteriorIntersection=function(){if(0===arguments.length)return!!this.isInteriorIntersection(0)||!!this.isInteriorIntersection(1);if(1===arguments.length){for(var e=arguments[0],i=0;i<this._result;i++)if(!this._intPt[i].equals2D(this._inputLines[e][0])&&!this._intPt[i].equals2D(this._inputLines[e][1]))return!0;return!1}},Nt.prototype.getIntersection=function(e){return this._intPt[e]},Nt.prototype.isEndPoint=function(){return this.hasIntersection()&&!this._isProper},Nt.prototype.hasIntersection=function(){return this._result!==Nt.NO_INTERSECTION},Nt.prototype.getEdgeDistance=function(e,i){return Nt.computeEdgeDistance(this._intPt[i],this._inputLines[e][0],this._inputLines[e][1])},Nt.prototype.isCollinear=function(){return this._result===Nt.COLLINEAR_INTERSECTION},Nt.prototype.toString=function(){return Kt.toLineString(this._inputLines[0][0],this._inputLines[0][1])+" - "+Kt.toLineString(this._inputLines[1][0],this._inputLines[1][1])+this.getTopologySummary()},Nt.prototype.getEndpoint=function(e,i){return this._inputLines[e][i]},Nt.prototype.isIntersection=function(e){for(var i=0;i<this._result;i++)if(this._intPt[i].equals2D(e))return!0;return!1},Nt.prototype.getIntersectionAlongSegment=function(e,i){return this.computeIntLineIndex(),this._intPt[this._intLineIndex[e][i]]},Nt.prototype.interfaces_=function(){return[]},Nt.prototype.getClass=function(){return Nt},Nt.computeEdgeDistance=function(e,i,h){var d=Math.abs(h.x-i.x),x=Math.abs(h.y-i.y),D=-1;if(e.equals(i))D=0;else if(e.equals(h))D=d>x?d:x;else{var F=Math.abs(e.x-i.x),$=Math.abs(e.y-i.y);0!==(D=d>x?F:$)||e.equals(i)||(D=Math.max(F,$))}return ot.isTrue(!(0===D&&!e.equals(i)),"Bad distance calculation"),D},Nt.nonRobustComputeEdgeDistance=function(e,i,h){var d=e.x-i.x,x=e.y-i.y,D=Math.sqrt(d*d+x*x);return ot.isTrue(!(0===D&&!e.equals(i)),"Invalid distance calculation"),D},le.DONT_INTERSECT.get=function(){return 0},le.DO_INTERSECT.get=function(){return 1},le.COLLINEAR.get=function(){return 2},le.NO_INTERSECTION.get=function(){return 0},le.POINT_INTERSECTION.get=function(){return 1},le.COLLINEAR_INTERSECTION.get=function(){return 2},Object.defineProperties(Nt,le);var Oe=function(e){function i(){e.apply(this,arguments)}return e&&(i.__proto__=e),(i.prototype=Object.create(e&&e.prototype)).constructor=i,i.prototype.isInSegmentEnvelopes=function(h){var d=new He(this._inputLines[0][0],this._inputLines[0][1]),x=new He(this._inputLines[1][0],this._inputLines[1][1]);return d.contains(h)&&x.contains(h)},i.prototype.computeIntersection=function(){if(3!==arguments.length)return e.prototype.computeIntersection.apply(this,arguments);var h=arguments[0],d=arguments[1],x=arguments[2];if(this._isProper=!1,He.intersects(d,x,h)&&0===Ge.orientationIndex(d,x,h)&&0===Ge.orientationIndex(x,d,h))return this._isProper=!0,(h.equals(d)||h.equals(x))&&(this._isProper=!1),this._result=e.POINT_INTERSECTION,null;this._result=e.NO_INTERSECTION},i.prototype.normalizeToMinimum=function(h,d,x,D,F){F.x=this.smallestInAbsValue(h.x,d.x,x.x,D.x),F.y=this.smallestInAbsValue(h.y,d.y,x.y,D.y),h.x-=F.x,h.y-=F.y,d.x-=F.x,d.y-=F.y,x.x-=F.x,x.y-=F.y,D.x-=F.x,D.y-=F.y},i.prototype.safeHCoordinateIntersection=function(h,d,x,D){var F=null;try{F=Er.intersection(h,d,x,D)}catch($){if(!($ instanceof Ur))throw $;F=i.nearestEndpoint(h,d,x,D)}return F},i.prototype.intersection=function(h,d,x,D){var F=this.intersectionWithNormalization(h,d,x,D);return this.isInSegmentEnvelopes(F)||(F=new Z(i.nearestEndpoint(h,d,x,D))),null!==this._precisionModel&&this._precisionModel.makePrecise(F),F},i.prototype.smallestInAbsValue=function(h,d,x,D){var F=h,$=Math.abs(F);return Math.abs(d)<$&&(F=d,$=Math.abs(d)),Math.abs(x)<$&&(F=x,$=Math.abs(x)),Math.abs(D)<$&&(F=D),F},i.prototype.checkDD=function(h,d,x,D,F){var $=De.intersection(h,d,x,D),Ct=this.isInSegmentEnvelopes($);jr.out.println("DD in env = "+Ct+"  --------------------- "+$),F.distance($)>1e-4&&jr.out.println("Distance = "+F.distance($))},i.prototype.intersectionWithNormalization=function(h,d,x,D){var F=new Z(h),$=new Z(d),Ct=new Z(x),te=new Z(D),Ne=new Z;this.normalizeToEnvCentre(F,$,Ct,te,Ne);var Ve=this.safeHCoordinateIntersection(F,$,Ct,te);return Ve.x+=Ne.x,Ve.y+=Ne.y,Ve},i.prototype.computeCollinearIntersection=function(h,d,x,D){var F=He.intersects(h,d,x),$=He.intersects(h,d,D),Ct=He.intersects(x,D,h),te=He.intersects(x,D,d);return F&&$?(this._intPt[0]=x,this._intPt[1]=D,e.COLLINEAR_INTERSECTION):Ct&&te?(this._intPt[0]=h,this._intPt[1]=d,e.COLLINEAR_INTERSECTION):F&&Ct?(this._intPt[0]=x,this._intPt[1]=h,!x.equals(h)||$||te?e.COLLINEAR_INTERSECTION:e.POINT_INTERSECTION):F&&te?(this._intPt[0]=x,this._intPt[1]=d,!x.equals(d)||$||Ct?e.COLLINEAR_INTERSECTION:e.POINT_INTERSECTION):$&&Ct?(this._intPt[0]=D,this._intPt[1]=h,!D.equals(h)||F||te?e.COLLINEAR_INTERSECTION:e.POINT_INTERSECTION):$&&te?(this._intPt[0]=D,this._intPt[1]=d,!D.equals(d)||F||Ct?e.COLLINEAR_INTERSECTION:e.POINT_INTERSECTION):e.NO_INTERSECTION},i.prototype.normalizeToEnvCentre=function(h,d,x,D,F){var $=h.x<d.x?h.x:d.x,Ct=h.y<d.y?h.y:d.y,te=h.x>d.x?h.x:d.x,Ne=h.y>d.y?h.y:d.y,Ve=x.x<D.x?x.x:D.x,gr=x.y<D.y?x.y:D.y,Pr=x.x>D.x?x.x:D.x,Yr=x.y>D.y?x.y:D.y,Mi=((Ct>gr?Ct:gr)+(Ne<Yr?Ne:Yr))/2;F.x=(($>Ve?$:Ve)+(te<Pr?te:Pr))/2,F.y=Mi,h.x-=F.x,h.y-=F.y,d.x-=F.x,d.y-=F.y,x.x-=F.x,x.y-=F.y,D.x-=F.x,D.y-=F.y},i.prototype.computeIntersect=function(h,d,x,D){if(this._isProper=!1,!He.intersects(h,d,x,D))return e.NO_INTERSECTION;var F=Ge.orientationIndex(h,d,x),$=Ge.orientationIndex(h,d,D);if(F>0&&$>0||F<0&&$<0)return e.NO_INTERSECTION;var Ct=Ge.orientationIndex(x,D,h),te=Ge.orientationIndex(x,D,d);return Ct>0&&te>0||Ct<0&&te<0?e.NO_INTERSECTION:0===F&&0===$&&0===Ct&&0===te?this.computeCollinearIntersection(h,d,x,D):(0===F||0===$||0===Ct||0===te?(this._isProper=!1,h.equals2D(x)||h.equals2D(D)?this._intPt[0]=h:d.equals2D(x)||d.equals2D(D)?this._intPt[0]=d:0===F?this._intPt[0]=new Z(x):0===$?this._intPt[0]=new Z(D):0===Ct?this._intPt[0]=new Z(h):0===te&&(this._intPt[0]=new Z(d))):(this._isProper=!0,this._intPt[0]=this.intersection(h,d,x,D)),e.POINT_INTERSECTION)},i.prototype.interfaces_=function(){return[]},i.prototype.getClass=function(){return i},i.nearestEndpoint=function(h,d,x,D){var F=h,$=Ge.distancePointLine(h,x,D),Ct=Ge.distancePointLine(d,x,D);return Ct<$&&($=Ct,F=d),(Ct=Ge.distancePointLine(x,h,d))<$&&($=Ct,F=x),(Ct=Ge.distancePointLine(D,h,d))<$&&($=Ct,F=D),F},i}(Nt),Qe=function(){};Qe.prototype.interfaces_=function(){return[]},Qe.prototype.getClass=function(){return Qe},Qe.orientationIndex=function(e,i,h){return Qe.signOfDet2x2(i.x-e.x,i.y-e.y,h.x-i.x,h.y-i.y)},Qe.signOfDet2x2=function(e,i,h,d){var x=null,D=null,F=null;if(x=1,0===e||0===d)return 0===i||0===h?0:i>0?h>0?-x:x:h>0?x:-x;if(0===i||0===h)return d>0?e>0?x:-x:e>0?-x:x;if(i>0?d>0?i<=d||(x=-x,D=e,e=h,h=D,D=i,i=d,d=D):i<=-d?(x=-x,h=-h,d=-d):(D=e,e=-h,h=D,D=i,i=-d,d=D):d>0?-i<=d?(x=-x,e=-e,i=-i):(D=-e,e=h,h=D,D=-i,i=d,d=D):i>=d?(e=-e,i=-i,h=-h,d=-d):(x=-x,D=-e,e=-h,h=D,D=-i,i=-d,d=D),e>0){if(!(h>0&&e<=h))return x}else{if(h>0||!(e>=h))return-x;x=-x,e=-e,h=-h}for(;;){if((d-=(F=Math.floor(h/e))*i)<0)return-x;if(d>i)return x;if(e>(h-=F*e)+h){if(i<d+d)return x}else{if(i>d+d)return-x;h=e-h,d=i-d,x=-x}if(0===d)return 0===h?0:-x;if(0===h||(e-=(F=Math.floor(e/h))*h,(i-=F*d)<0))return x;if(i>d)return-x;if(h>e+e){if(d<i+i)return-x}else{if(d>i+i)return x;e=h-e,i=d-i,x=-x}if(0===i)return 0===e?0:x;if(0===e)return-x}};var ir=function(){this._p=null,this._crossingCount=0,this._isPointOnSegment=!1,this._p=arguments[0]};ir.prototype.countSegment=function(e,i){if(e.x<this._p.x&&i.x<this._p.x)return null;if(this._p.x===i.x&&this._p.y===i.y)return this._isPointOnSegment=!0,null;if(e.y===this._p.y&&i.y===this._p.y){var h=e.x,d=i.x;return h>d&&(h=i.x,d=e.x),this._p.x>=h&&this._p.x<=d&&(this._isPointOnSegment=!0),null}if(e.y>this._p.y&&i.y<=this._p.y||i.y>this._p.y&&e.y<=this._p.y){var D=e.y-this._p.y,$=i.y-this._p.y,Ct=Qe.signOfDet2x2(e.x-this._p.x,D,i.x-this._p.x,$);if(0===Ct)return this._isPointOnSegment=!0,null;$<D&&(Ct=-Ct),Ct>0&&this._crossingCount++}},ir.prototype.isPointInPolygon=function(){return this.getLocation()!==dt.EXTERIOR},ir.prototype.getLocation=function(){return this._isPointOnSegment?dt.BOUNDARY:this._crossingCount%2==1?dt.INTERIOR:dt.EXTERIOR},ir.prototype.isOnSegment=function(){return this._isPointOnSegment},ir.prototype.interfaces_=function(){return[]},ir.prototype.getClass=function(){return ir},ir.locatePointInRing=function(){if(arguments[0]instanceof Z&&Ce(arguments[1],Ie)){for(var i=arguments[1],h=new ir(arguments[0]),d=new Z,x=new Z,D=1;D<i.size();D++)if(i.getCoordinate(D,d),i.getCoordinate(D-1,x),h.countSegment(d,x),h.isOnSegment())return h.getLocation();return h.getLocation()}if(arguments[0]instanceof Z&&arguments[1]instanceof Array){for(var $=arguments[1],Ct=new ir(arguments[0]),te=1;te<$.length;te++)if(Ct.countSegment($[te],$[te-1]),Ct.isOnSegment())return Ct.getLocation();return Ct.getLocation()}};var Ge=function(){},fn={CLOCKWISE:{configurable:!0},RIGHT:{configurable:!0},COUNTERCLOCKWISE:{configurable:!0},LEFT:{configurable:!0},COLLINEAR:{configurable:!0},STRAIGHT:{configurable:!0}};Ge.prototype.interfaces_=function(){return[]},Ge.prototype.getClass=function(){return Ge},Ge.orientationIndex=function(e,i,h){return De.orientationIndex(e,i,h)},Ge.signedArea=function(){if(arguments[0]instanceof Array){var e=arguments[0];if(e.length<3)return 0;for(var i=0,h=e[0].x,d=1;d<e.length-1;d++)i+=(e[d].x-h)*(e[d-1].y-e[d+1].y);return i/2}if(Ce(arguments[0],Ie)){var F=arguments[0],$=F.size();if($<3)return 0;var Ct=new Z,te=new Z,Ne=new Z;F.getCoordinate(0,te),F.getCoordinate(1,Ne);var Ve=te.x;Ne.x-=Ve;for(var gr=0,Pr=1;Pr<$-1;Pr++)Ct.y=te.y,te.x=Ne.x,te.y=Ne.y,F.getCoordinate(Pr+1,Ne),Ne.x-=Ve,gr+=te.x*(Ct.y-Ne.y);return gr/2}},Ge.distanceLineLine=function(e,i,h,d){if(e.equals(i))return Ge.distancePointLine(e,h,d);if(h.equals(d))return Ge.distancePointLine(d,e,i);var x=!1;if(He.intersects(e,i,h,d)){var D=(i.x-e.x)*(d.y-h.y)-(i.y-e.y)*(d.x-h.x);if(0===D)x=!0;else{var $=((e.y-h.y)*(i.x-e.x)-(e.x-h.x)*(i.y-e.y))/D,Ct=((e.y-h.y)*(d.x-h.x)-(e.x-h.x)*(d.y-h.y))/D;(Ct<0||Ct>1||$<0||$>1)&&(x=!0)}}else x=!0;return x?Mt.min(Ge.distancePointLine(e,h,d),Ge.distancePointLine(i,h,d),Ge.distancePointLine(h,e,i),Ge.distancePointLine(d,e,i)):0},Ge.isPointInRing=function(e,i){return Ge.locatePointInRing(e,i)!==dt.EXTERIOR},Ge.computeLength=function(e){var i=e.size();if(i<=1)return 0;var h=0,d=new Z;e.getCoordinate(0,d);for(var x=d.x,D=d.y,F=1;F<i;F++){e.getCoordinate(F,d);var $=d.x,Ct=d.y,te=$-x,Ne=Ct-D;h+=Math.sqrt(te*te+Ne*Ne),x=$,D=Ct}return h},Ge.isCCW=function(e){var i=e.length-1;if(i<3)throw new tt("Ring has fewer than 4 points, so orientation cannot be determined");for(var h=e[0],d=0,x=1;x<=i;x++){var D=e[x];D.y>h.y&&(h=D,d=x)}var F=d;do{(F-=1)<0&&(F=i)}while(e[F].equals2D(h)&&F!==d);var $=d;do{$=($+1)%i}while(e[$].equals2D(h)&&$!==d);var Ct=e[F],te=e[$];if(Ct.equals2D(h)||te.equals2D(h)||Ct.equals2D(te))return!1;var Ne=Ge.computeOrientation(Ct,h,te);return 0===Ne?Ct.x>te.x:Ne>0},Ge.locatePointInRing=function(e,i){return ir.locatePointInRing(e,i)},Ge.distancePointLinePerpendicular=function(e,i,h){var d=(h.x-i.x)*(h.x-i.x)+(h.y-i.y)*(h.y-i.y);return Math.abs(((i.y-e.y)*(h.x-i.x)-(i.x-e.x)*(h.y-i.y))/d)*Math.sqrt(d)},Ge.computeOrientation=function(e,i,h){return Ge.orientationIndex(e,i,h)},Ge.distancePointLine=function(){if(2===arguments.length){var e=arguments[0],i=arguments[1];if(0===i.length)throw new tt("Line array must contain at least one vertex");for(var h=e.distance(i[0]),d=0;d<i.length-1;d++){var x=Ge.distancePointLine(e,i[d],i[d+1]);x<h&&(h=x)}return h}if(3===arguments.length){var D=arguments[0],F=arguments[1],$=arguments[2];if(F.x===$.x&&F.y===$.y)return D.distance(F);var Ct=($.x-F.x)*($.x-F.x)+($.y-F.y)*($.y-F.y),te=((D.x-F.x)*($.x-F.x)+(D.y-F.y)*($.y-F.y))/Ct;return te<=0?D.distance(F):te>=1?D.distance($):Math.abs(((F.y-D.y)*($.x-F.x)-(F.x-D.x)*($.y-F.y))/Ct)*Math.sqrt(Ct)}},Ge.isOnLine=function(e,i){for(var h=new Oe,d=1;d<i.length;d++)if(h.computeIntersection(e,i[d-1],i[d]),h.hasIntersection())return!0;return!1},fn.CLOCKWISE.get=function(){return-1},fn.RIGHT.get=function(){return Ge.CLOCKWISE},fn.COUNTERCLOCKWISE.get=function(){return 1},fn.LEFT.get=function(){return Ge.COUNTERCLOCKWISE},fn.COLLINEAR.get=function(){return 0},fn.STRAIGHT.get=function(){return Ge.COLLINEAR},Object.defineProperties(Ge,fn);var en=function(){};en.prototype.filter=function(e){},en.prototype.interfaces_=function(){return[]},en.prototype.getClass=function(){return en};var hr=function(){var e=arguments[0];this._envelope=null,this._factory=null,this._SRID=null,this._userData=null,this._factory=e,this._SRID=e.getSRID()},gn={serialVersionUID:{configurable:!0},SORTINDEX_POINT:{configurable:!0},SORTINDEX_MULTIPOINT:{configurable:!0},SORTINDEX_LINESTRING:{configurable:!0},SORTINDEX_LINEARRING:{configurable:!0},SORTINDEX_MULTILINESTRING:{configurable:!0},SORTINDEX_POLYGON:{configurable:!0},SORTINDEX_MULTIPOLYGON:{configurable:!0},SORTINDEX_GEOMETRYCOLLECTION:{configurable:!0},geometryChangedFilter:{configurable:!0}};hr.prototype.isGeometryCollection=function(){return this.getSortIndex()===hr.SORTINDEX_GEOMETRYCOLLECTION},hr.prototype.getFactory=function(){return this._factory},hr.prototype.getGeometryN=function(e){return this},hr.prototype.getArea=function(){return 0},hr.prototype.isRectangle=function(){return!1},hr.prototype.equals=function(){if(arguments[0]instanceof hr){var e=arguments[0];return null!==e&&this.equalsTopo(e)}if(arguments[0]instanceof Object){var i=arguments[0];return i instanceof hr&&this.equalsExact(i)}},hr.prototype.equalsExact=function(e){return this===e||this.equalsExact(e,0)},hr.prototype.geometryChanged=function(){this.apply(hr.geometryChangedFilter)},hr.prototype.geometryChangedAction=function(){this._envelope=null},hr.prototype.equalsNorm=function(e){return null!==e&&this.norm().equalsExact(e.norm())},hr.prototype.getLength=function(){return 0},hr.prototype.getNumGeometries=function(){return 1},hr.prototype.compareTo=function(){if(1===arguments.length){var e=arguments[0],i=e;return this.getSortIndex()!==i.getSortIndex()?this.getSortIndex()-i.getSortIndex():this.isEmpty()&&i.isEmpty()?0:this.isEmpty()?-1:i.isEmpty()?1:this.compareToSameClass(e)}if(2===arguments.length){var h=arguments[0],d=arguments[1];return this.getSortIndex()!==h.getSortIndex()?this.getSortIndex()-h.getSortIndex():this.isEmpty()&&h.isEmpty()?0:this.isEmpty()?-1:h.isEmpty()?1:this.compareToSameClass(h,d)}},hr.prototype.getUserData=function(){return this._userData},hr.prototype.getSRID=function(){return this._SRID},hr.prototype.getEnvelope=function(){return this.getFactory().toGeometry(this.getEnvelopeInternal())},hr.prototype.checkNotGeometryCollection=function(e){if(e.getSortIndex()===hr.SORTINDEX_GEOMETRYCOLLECTION)throw new tt("This method does not support GeometryCollection arguments")},hr.prototype.equal=function(e,i,h){return 0===h?e.equals(i):e.distance(i)<=h},hr.prototype.norm=function(){var e=this.copy();return e.normalize(),e},hr.prototype.getPrecisionModel=function(){return this._factory.getPrecisionModel()},hr.prototype.getEnvelopeInternal=function(){return null===this._envelope&&(this._envelope=this.computeEnvelopeInternal()),new He(this._envelope)},hr.prototype.setSRID=function(e){this._SRID=e},hr.prototype.setUserData=function(e){this._userData=e},hr.prototype.compare=function(e,i){for(var h=e.iterator(),d=i.iterator();h.hasNext()&&d.hasNext();){var x=h.next(),D=d.next(),F=x.compareTo(D);if(0!==F)return F}return h.hasNext()?1:d.hasNext()?-1:0},hr.prototype.hashCode=function(){return this.getEnvelopeInternal().hashCode()},hr.prototype.isGeometryCollectionOrDerived=function(){return this.getSortIndex()===hr.SORTINDEX_GEOMETRYCOLLECTION||this.getSortIndex()===hr.SORTINDEX_MULTIPOINT||this.getSortIndex()===hr.SORTINDEX_MULTILINESTRING||this.getSortIndex()===hr.SORTINDEX_MULTIPOLYGON},hr.prototype.interfaces_=function(){return[et,J,gt]},hr.prototype.getClass=function(){return hr},hr.hasNonEmptyElements=function(e){for(var i=0;i<e.length;i++)if(!e[i].isEmpty())return!0;return!1},hr.hasNullElements=function(e){for(var i=0;i<e.length;i++)if(null===e[i])return!0;return!1},gn.serialVersionUID.get=function(){return 0x799ea46522854c00},gn.SORTINDEX_POINT.get=function(){return 0},gn.SORTINDEX_MULTIPOINT.get=function(){return 1},gn.SORTINDEX_LINESTRING.get=function(){return 2},gn.SORTINDEX_LINEARRING.get=function(){return 3},gn.SORTINDEX_MULTILINESTRING.get=function(){return 4},gn.SORTINDEX_POLYGON.get=function(){return 5},gn.SORTINDEX_MULTIPOLYGON.get=function(){return 6},gn.SORTINDEX_GEOMETRYCOLLECTION.get=function(){return 7},gn.geometryChangedFilter.get=function(){return Yn},Object.defineProperties(hr,gn);var Yn=function(){};Yn.interfaces_=function(){return[en]},Yn.filter=function(e){e.geometryChangedAction()};var Jn=function(){};Jn.prototype.filter=function(e){},Jn.prototype.interfaces_=function(){return[]},Jn.prototype.getClass=function(){return Jn};var Sn=function(){},ri={Mod2BoundaryNodeRule:{configurable:!0},EndPointBoundaryNodeRule:{configurable:!0},MultiValentEndPointBoundaryNodeRule:{configurable:!0},MonoValentEndPointBoundaryNodeRule:{configurable:!0},MOD2_BOUNDARY_RULE:{configurable:!0},ENDPOINT_BOUNDARY_RULE:{configurable:!0},MULTIVALENT_ENDPOINT_BOUNDARY_RULE:{configurable:!0},MONOVALENT_ENDPOINT_BOUNDARY_RULE:{configurable:!0},OGC_SFS_BOUNDARY_RULE:{configurable:!0}};Sn.prototype.isInBoundary=function(e){},Sn.prototype.interfaces_=function(){return[]},Sn.prototype.getClass=function(){return Sn},ri.Mod2BoundaryNodeRule.get=function(){return Br},ri.EndPointBoundaryNodeRule.get=function(){return Xo},ri.MultiValentEndPointBoundaryNodeRule.get=function(){return zo},ri.MonoValentEndPointBoundaryNodeRule.get=function(){return Yo},ri.MOD2_BOUNDARY_RULE.get=function(){return new Br},ri.ENDPOINT_BOUNDARY_RULE.get=function(){return new Xo},ri.MULTIVALENT_ENDPOINT_BOUNDARY_RULE.get=function(){return new zo},ri.MONOVALENT_ENDPOINT_BOUNDARY_RULE.get=function(){return new Yo},ri.OGC_SFS_BOUNDARY_RULE.get=function(){return Sn.MOD2_BOUNDARY_RULE},Object.defineProperties(Sn,ri);var Br=function(){};Br.prototype.isInBoundary=function(e){return e%2==1},Br.prototype.interfaces_=function(){return[Sn]},Br.prototype.getClass=function(){return Br};var Xo=function(){};Xo.prototype.isInBoundary=function(e){return e>0},Xo.prototype.interfaces_=function(){return[Sn]},Xo.prototype.getClass=function(){return Xo};var zo=function(){};zo.prototype.isInBoundary=function(e){return e>1},zo.prototype.interfaces_=function(){return[Sn]},zo.prototype.getClass=function(){return zo};var Yo=function(){};Yo.prototype.isInBoundary=function(e){return 1===e},Yo.prototype.interfaces_=function(){return[Sn]},Yo.prototype.getClass=function(){return Yo};var Gn=function(){};Gn.prototype.add=function(){},Gn.prototype.addAll=function(){},Gn.prototype.isEmpty=function(){},Gn.prototype.iterator=function(){},Gn.prototype.size=function(){},Gn.prototype.toArray=function(){},Gn.prototype.remove=function(){},(Pt.prototype=new Error).name="IndexOutOfBoundsException";var xa=function(){};xa.prototype.hasNext=function(){},xa.prototype.next=function(){},xa.prototype.remove=function(){};var xn=function(e){function i(){e.apply(this,arguments)}return e&&(i.__proto__=e),(i.prototype=Object.create(e&&e.prototype)).constructor=i,i.prototype.get=function(){},i.prototype.set=function(){},i.prototype.isEmpty=function(){},i}(Gn);(s.prototype=new Error).name="NoSuchElementException";var cr=function(e){function i(){e.call(this),this.array_=[],arguments[0]instanceof Gn&&this.addAll(arguments[0])}return e&&(i.__proto__=e),(i.prototype=Object.create(e&&e.prototype)).constructor=i,i.prototype.ensureCapacity=function(){},i.prototype.interfaces_=function(){return[e,Gn]},i.prototype.add=function(h){return 1===arguments.length?this.array_.push(h):this.array_.splice(arguments[0],arguments[1]),!0},i.prototype.clear=function(){this.array_=[]},i.prototype.addAll=function(h){for(var d=h.iterator();d.hasNext();)this.add(d.next());return!0},i.prototype.set=function(h,d){var x=this.array_[h];return this.array_[h]=d,x},i.prototype.iterator=function(){return new oi(this)},i.prototype.get=function(h){if(h<0||h>=this.size())throw new Pt;return this.array_[h]},i.prototype.isEmpty=function(){return 0===this.array_.length},i.prototype.size=function(){return this.array_.length},i.prototype.toArray=function(){for(var h=[],d=0,x=this.array_.length;d<x;d++)h.push(this.array_[d]);return h},i.prototype.remove=function(h){for(var d=!1,x=0,D=this.array_.length;x<D;x++)if(this.array_[x]===h){this.array_.splice(x,1),d=!0;break}return d},i}(xn),oi=function(e){function i(h){e.call(this),this.arrayList_=h,this.position_=0}return e&&(i.__proto__=e),(i.prototype=Object.create(e&&e.prototype)).constructor=i,i.prototype.next=function(){if(this.position_===this.arrayList_.size())throw new s;return this.arrayList_.get(this.position_++)},i.prototype.hasNext=function(){return this.position_<this.arrayList_.size()},i.prototype.set=function(h){return this.arrayList_.set(this.position_-1,h)},i.prototype.remove=function(){this.arrayList_.remove(this.arrayList_.get(this.position_))},i}(xa),Y=function(e){function i(){if(e.call(this),0!==arguments.length)if(1===arguments.length){var d=arguments[0];this.ensureCapacity(d.length),this.add(d,!0)}else if(2===arguments.length){var x=arguments[0],D=arguments[1];this.ensureCapacity(x.length),this.add(x,D)}}e&&(i.__proto__=e),(i.prototype=Object.create(e&&e.prototype)).constructor=i;var h={coordArrayType:{configurable:!0}};return h.coordArrayType.get=function(){return new Array(0).fill(null)},i.prototype.getCoordinate=function(d){return this.get(d)},i.prototype.addAll=function(){if(2===arguments.length){for(var x=arguments[1],D=!1,F=arguments[0].iterator();F.hasNext();)this.add(F.next(),x),D=!0;return D}return e.prototype.addAll.apply(this,arguments)},i.prototype.clone=function(){for(var d=e.prototype.clone.call(this),x=0;x<this.size();x++)d.add(x,this.get(x).copy());return d},i.prototype.toCoordinateArray=function(){return this.toArray(i.coordArrayType)},i.prototype.add=function(){if(1===arguments.length)e.prototype.add.call(this,arguments[0]);else if(2===arguments.length){if(arguments[0]instanceof Array&&"boolean"==typeof arguments[1])return this.add(arguments[0],arguments[1],!0),!0;if(arguments[0]instanceof Z&&"boolean"==typeof arguments[1]){var F=arguments[0];if(!arguments[1]&&this.size()>=1&&this.get(this.size()-1).equals2D(F))return null;e.prototype.add.call(this,F)}else if(arguments[0]instanceof Object&&"boolean"==typeof arguments[1])return this.add(arguments[0],arguments[1]),!0}else if(3===arguments.length){if("boolean"==typeof arguments[2]&&arguments[0]instanceof Array&&"boolean"==typeof arguments[1]){var te=arguments[0],Ne=arguments[1];if(arguments[2])for(var Ve=0;Ve<te.length;Ve++)this.add(te[Ve],Ne);else for(var gr=te.length-1;gr>=0;gr--)this.add(te[gr],Ne);return!0}if("boolean"==typeof arguments[2]&&Number.isInteger(arguments[0])&&arguments[1]instanceof Z){var Pr=arguments[0],Yr=arguments[1];if(!arguments[2]){var an=this.size();if(an>0&&(Pr>0&&this.get(Pr-1).equals2D(Yr)||Pr<an&&this.get(Pr).equals2D(Yr)))return null}e.prototype.add.call(this,Pr,Yr)}}else if(4===arguments.length){var Mi=arguments[0],l=arguments[1],f=arguments[2],c=arguments[3],m=1;f>c&&(m=-1);for(var E=f;E!==c;E+=m)this.add(Mi[E],l);return!0}},i.prototype.closeRing=function(){this.size()>0&&this.add(new Z(this.get(0)),!1)},i.prototype.interfaces_=function(){return[]},i.prototype.getClass=function(){return i},Object.defineProperties(i,h),i}(cr),W=function(){},ft={ForwardComparator:{configurable:!0},BidirectionalComparator:{configurable:!0},coordArrayType:{configurable:!0}};ft.ForwardComparator.get=function(){return bt},ft.BidirectionalComparator.get=function(){return zt},ft.coordArrayType.get=function(){return new Array(0).fill(null)},W.prototype.interfaces_=function(){return[]},W.prototype.getClass=function(){return W},W.isRing=function(e){return!(e.length<4||!e[0].equals2D(e[e.length-1]))},W.ptNotInList=function(e,i){for(var h=0;h<e.length;h++){var d=e[h];if(W.indexOf(d,i)<0)return d}return null},W.scroll=function(e,i){var h=W.indexOf(i,e);if(h<0)return null;var d=new Array(e.length).fill(null);jr.arraycopy(e,h,d,0,e.length-h),jr.arraycopy(e,0,d,e.length-h,h),jr.arraycopy(d,0,e,0,e.length)},W.equals=function(){if(2===arguments.length){var e=arguments[0],i=arguments[1];if(e===i)return!0;if(null===e||null===i||e.length!==i.length)return!1;for(var h=0;h<e.length;h++)if(!e[h].equals(i[h]))return!1;return!0}if(3===arguments.length){var d=arguments[0],x=arguments[1],D=arguments[2];if(d===x)return!0;if(null===d||null===x||d.length!==x.length)return!1;for(var F=0;F<d.length;F++)if(0!==D.compare(d[F],x[F]))return!1;return!0}},W.intersection=function(e,i){for(var h=new Y,d=0;d<e.length;d++)i.intersects(e[d])&&h.add(e[d],!0);return h.toCoordinateArray()},W.hasRepeatedPoints=function(e){for(var i=1;i<e.length;i++)if(e[i-1].equals(e[i]))return!0;return!1},W.removeRepeatedPoints=function(e){return W.hasRepeatedPoints(e)?new Y(e,!1).toCoordinateArray():e},W.reverse=function(e){for(var i=e.length-1,h=Math.trunc(i/2),d=0;d<=h;d++){var x=e[d];e[d]=e[i-d],e[i-d]=x}},W.removeNull=function(e){for(var i=0,h=0;h<e.length;h++)null!==e[h]&&i++;var d=new Array(i).fill(null);if(0===i)return d;for(var x=0,D=0;D<e.length;D++)null!==e[D]&&(d[x++]=e[D]);return d},W.copyDeep=function(){if(1===arguments.length){for(var e=arguments[0],i=new Array(e.length).fill(null),h=0;h<e.length;h++)i[h]=new Z(e[h]);return i}if(5===arguments.length)for(var d=arguments[0],x=arguments[1],D=arguments[2],F=arguments[3],$=arguments[4],Ct=0;Ct<$;Ct++)D[F+Ct]=new Z(d[x+Ct])},W.isEqualReversed=function(e,i){for(var h=0;h<e.length;h++)if(0!==e[h].compareTo(i[e.length-h-1]))return!1;return!0},W.envelope=function(e){for(var i=new He,h=0;h<e.length;h++)i.expandToInclude(e[h]);return i},W.toCoordinateArray=function(e){return e.toArray(W.coordArrayType)},W.atLeastNCoordinatesOrNothing=function(e,i){return i.length>=e?i:[]},W.indexOf=function(e,i){for(var h=0;h<i.length;h++)if(e.equals(i[h]))return h;return-1},W.increasingDirection=function(e){for(var i=0;i<Math.trunc(e.length/2);i++){var d=e[i].compareTo(e[e.length-1-i]);if(0!==d)return d}return 1},W.compare=function(e,i){for(var h=0;h<e.length&&h<i.length;){var d=e[h].compareTo(i[h]);if(0!==d)return d;h++}return h<i.length?-1:h<e.length?1:0},W.minCoordinate=function(e){for(var i=null,h=0;h<e.length;h++)(null===i||i.compareTo(e[h])>0)&&(i=e[h]);return i},W.extract=function(e,i,h){i=Mt.clamp(i,0,e.length);var d=(h=Mt.clamp(h,-1,e.length))-i+1;h<0&&(d=0),i>=e.length&&(d=0),h<i&&(d=0);var x=new Array(d).fill(null);if(0===d)return x;for(var D=0,F=i;F<=h;F++)x[D++]=e[F];return x},Object.defineProperties(W,ft);var bt=function(){};bt.prototype.compare=function(e,i){return W.compare(e,i)},bt.prototype.interfaces_=function(){return[at]},bt.prototype.getClass=function(){return bt};var zt=function(){};zt.prototype.compare=function(e,i){var h=e,d=i;if(h.length<d.length)return-1;if(h.length>d.length)return 1;if(0===h.length)return 0;var x=W.compare(h,d);return W.isEqualReversed(h,d)?0:x},zt.prototype.OLDcompare=function(e,i){var h=e,d=i;if(h.length<d.length)return-1;if(h.length>d.length)return 1;if(0===h.length)return 0;for(var x=W.increasingDirection(h),D=W.increasingDirection(d),F=x>0?0:h.length-1,$=D>0?0:h.length-1,Ct=0;Ct<h.length;Ct++){var te=h[F].compareTo(d[$]);if(0!==te)return te;F+=x,$+=D}return 0},zt.prototype.interfaces_=function(){return[at]},zt.prototype.getClass=function(){return zt};var ae=function(){};ae.prototype.get=function(){},ae.prototype.put=function(){},ae.prototype.size=function(){},ae.prototype.values=function(){},ae.prototype.entrySet=function(){};var me=function(e){function i(){e.apply(this,arguments)}return e&&(i.__proto__=e),(i.prototype=Object.create(e&&e.prototype)).constructor=i,i}(ae);(lt.prototype=new Error).name="OperationNotSupported",(ht.prototype=new Gn).contains=function(){};var ue=function(e){function i(){e.call(this),this.array_=[],arguments[0]instanceof Gn&&this.addAll(arguments[0])}return e&&(i.__proto__=e),(i.prototype=Object.create(e&&e.prototype)).constructor=i,i.prototype.contains=function(h){for(var d=0,x=this.array_.length;d<x;d++)if(this.array_[d]===h)return!0;return!1},i.prototype.add=function(h){return!this.contains(h)&&(this.array_.push(h),!0)},i.prototype.addAll=function(h){for(var d=h.iterator();d.hasNext();)this.add(d.next());return!0},i.prototype.remove=function(h){throw new Error},i.prototype.size=function(){return this.array_.length},i.prototype.isEmpty=function(){return 0===this.array_.length},i.prototype.toArray=function(){for(var h=[],d=0,x=this.array_.length;d<x;d++)h.push(this.array_[d]);return h},i.prototype.iterator=function(){return new Dt(this)},i}(ht),Dt=function(e){function i(h){e.call(this),this.hashSet_=h,this.position_=0}return e&&(i.__proto__=e),(i.prototype=Object.create(e&&e.prototype)).constructor=i,i.prototype.next=function(){if(this.position_===this.hashSet_.size())throw new s;return this.hashSet_.array_[this.position_++]},i.prototype.hasNext=function(){return this.position_<this.hashSet_.size()},i.prototype.remove=function(){throw new lt},i}(xa),Ht=0;(mt.prototype=new me).get=function(e){for(var i=this.root_;null!==i;){var h=e.compareTo(i.key);if(h<0)i=i.left;else{if(!(h>0))return i.value;i=i.right}}return null},mt.prototype.put=function(e,i){if(null===this.root_)return this.root_={key:e,value:i,left:null,right:null,parent:null,color:Ht,getValue:function(){return this.value},getKey:function(){return this.key}},this.size_=1,null;var h,d,x=this.root_;do{if(h=x,(d=e.compareTo(x.key))<0)x=x.left;else{if(!(d>0)){var D=x.value;return x.value=i,D}x=x.right}}while(null!==x);var F={key:e,left:null,right:null,value:i,parent:h,color:Ht,getValue:function(){return this.value},getKey:function(){return this.key}};return d<0?h.left=F:h.right=F,this.fixAfterInsertion(F),this.size_++,null},mt.prototype.fixAfterInsertion=function(e){for(e.color=1;null!=e&&e!==this.root_&&1===e.parent.color;)if(Ft(e)===qt(Ft(Ft(e)))){var i=_e(Ft(Ft(e)));1===Lt(i)?(Qt(Ft(e),Ht),Qt(i,Ht),Qt(Ft(Ft(e)),1),e=Ft(Ft(e))):(e===_e(Ft(e))&&(e=Ft(e),this.rotateLeft(e)),Qt(Ft(e),Ht),Qt(Ft(Ft(e)),1),this.rotateRight(Ft(Ft(e))))}else{var h=qt(Ft(Ft(e)));1===Lt(h)?(Qt(Ft(e),Ht),Qt(h,Ht),Qt(Ft(Ft(e)),1),e=Ft(Ft(e))):(e===qt(Ft(e))&&(e=Ft(e),this.rotateRight(e)),Qt(Ft(e),Ht),Qt(Ft(Ft(e)),1),this.rotateLeft(Ft(Ft(e))))}this.root_.color=Ht},mt.prototype.values=function(){var e=new cr,i=this.getFirstEntry();if(null!==i)for(e.add(i.value);null!==(i=mt.successor(i));)e.add(i.value);return e},mt.prototype.entrySet=function(){var e=new ue,i=this.getFirstEntry();if(null!==i)for(e.add(i);null!==(i=mt.successor(i));)e.add(i);return e},mt.prototype.rotateLeft=function(e){if(null!=e){var i=e.right;e.right=i.left,null!=i.left&&(i.left.parent=e),i.parent=e.parent,null===e.parent?this.root_=i:e.parent.left===e?e.parent.left=i:e.parent.right=i,i.left=e,e.parent=i}},mt.prototype.rotateRight=function(e){if(null!=e){var i=e.left;e.left=i.right,null!=i.right&&(i.right.parent=e),i.parent=e.parent,null===e.parent?this.root_=i:e.parent.right===e?e.parent.right=i:e.parent.left=i,i.right=e,e.parent=i}},mt.prototype.getFirstEntry=function(){var e=this.root_;if(null!=e)for(;null!=e.left;)e=e.left;return e},mt.successor=function(e){if(null===e)return null;if(null!==e.right){for(var i=e.right;null!==i.left;)i=i.left;return i}for(var h=e.parent,d=e;null!==h&&d===h.right;)d=h,h=h.parent;return h},mt.prototype.size=function(){return this.size_};var nr=function(){};nr.prototype.interfaces_=function(){return[]},nr.prototype.getClass=function(){return nr},xt.prototype=new ht,(Jt.prototype=new xt).contains=function(e){for(var i=0,h=this.array_.length;i<h;i++)if(0===this.array_[i].compareTo(e))return!0;return!1},Jt.prototype.add=function(e){if(this.contains(e))return!1;for(var i=0,h=this.array_.length;i<h;i++)if(1===this.array_[i].compareTo(e))return this.array_.splice(i,0,e),!0;return this.array_.push(e),!0},Jt.prototype.addAll=function(e){for(var i=e.iterator();i.hasNext();)this.add(i.next());return!0},Jt.prototype.remove=function(e){throw new lt},Jt.prototype.size=function(){return this.array_.length},Jt.prototype.isEmpty=function(){return 0===this.array_.length},Jt.prototype.toArray=function(){for(var e=[],i=0,h=this.array_.length;i<h;i++)e.push(this.array_[i]);return e},Jt.prototype.iterator=function(){return new xr(this)};var xr=function(e){this.treeSet_=e,this.position_=0};xr.prototype.next=function(){if(this.position_===this.treeSet_.size())throw new s;return this.treeSet_.array_[this.position_++]},xr.prototype.hasNext=function(){return this.position_<this.treeSet_.size()},xr.prototype.remove=function(){throw new lt};var Me=function(){};Me.sort=function(){var e,i,h,x=arguments[0];if(1===arguments.length)x.sort(function(F,$){return F.compareTo($)});else if(2===arguments.length)h=arguments[1],x.sort(function(F,$){return h.compare(F,$)});else if(3===arguments.length){(i=x.slice(arguments[1],arguments[2])).sort();var D=x.slice(0,arguments[1]).concat(i,x.slice(arguments[2],x.length));for(x.splice(0,x.length),e=0;e<D.length;e++)x.push(D[e])}else if(4===arguments.length)for(i=x.slice(arguments[1],arguments[2]),h=arguments[3],i.sort(function(F,$){return h.compare(F,$)}),D=x.slice(0,arguments[1]).concat(i,x.slice(arguments[2],x.length)),x.splice(0,x.length),e=0;e<D.length;e++)x.push(D[e])},Me.asList=function(e){for(var i=new cr,h=0,d=e.length;h<d;h++)i.add(e[h]);return i};var qe=function(){},pr={P:{configurable:!0},L:{configurable:!0},A:{configurable:!0},FALSE:{configurable:!0},TRUE:{configurable:!0},DONTCARE:{configurable:!0},SYM_FALSE:{configurable:!0},SYM_TRUE:{configurable:!0},SYM_DONTCARE:{configurable:!0},SYM_P:{configurable:!0},SYM_L:{configurable:!0},SYM_A:{configurable:!0}};pr.P.get=function(){return 0},pr.L.get=function(){return 1},pr.A.get=function(){return 2},pr.FALSE.get=function(){return-1},pr.TRUE.get=function(){return-2},pr.DONTCARE.get=function(){return-3},pr.SYM_FALSE.get=function(){return"F"},pr.SYM_TRUE.get=function(){return"T"},pr.SYM_DONTCARE.get=function(){return"*"},pr.SYM_P.get=function(){return"0"},pr.SYM_L.get=function(){return"1"},pr.SYM_A.get=function(){return"2"},qe.prototype.interfaces_=function(){return[]},qe.prototype.getClass=function(){return qe},qe.toDimensionSymbol=function(e){switch(e){case qe.FALSE:return qe.SYM_FALSE;case qe.TRUE:return qe.SYM_TRUE;case qe.DONTCARE:return qe.SYM_DONTCARE;case qe.P:return qe.SYM_P;case qe.L:return qe.SYM_L;case qe.A:return qe.SYM_A}throw new tt("Unknown dimension value: "+e)},qe.toDimensionValue=function(e){switch(fe.toUpperCase(e)){case qe.SYM_FALSE:return qe.FALSE;case qe.SYM_TRUE:return qe.TRUE;case qe.SYM_DONTCARE:return qe.DONTCARE;case qe.SYM_P:return qe.P;case qe.SYM_L:return qe.L;case qe.SYM_A:return qe.A}throw new tt("Unknown dimension symbol: "+e)},Object.defineProperties(qe,pr);var wr=function(){};wr.prototype.filter=function(e){},wr.prototype.interfaces_=function(){return[]},wr.prototype.getClass=function(){return wr};var Ar=function(){};Ar.prototype.filter=function(e,i){},Ar.prototype.isDone=function(){},Ar.prototype.isGeometryChanged=function(){},Ar.prototype.interfaces_=function(){return[]},Ar.prototype.getClass=function(){return Ar};var Xe=function(e){function i(d,x){if(e.call(this,x),this._geometries=d||[],e.hasNullElements(this._geometries))throw new tt("geometries must not contain null elements")}e&&(i.__proto__=e),(i.prototype=Object.create(e&&e.prototype)).constructor=i;var h={serialVersionUID:{configurable:!0}};return i.prototype.computeEnvelopeInternal=function(){for(var d=new He,x=0;x<this._geometries.length;x++)d.expandToInclude(this._geometries[x].getEnvelopeInternal());return d},i.prototype.getGeometryN=function(d){return this._geometries[d]},i.prototype.getSortIndex=function(){return e.SORTINDEX_GEOMETRYCOLLECTION},i.prototype.getCoordinates=function(){for(var d=new Array(this.getNumPoints()).fill(null),x=-1,D=0;D<this._geometries.length;D++)for(var F=this._geometries[D].getCoordinates(),$=0;$<F.length;$++)d[++x]=F[$];return d},i.prototype.getArea=function(){for(var d=0,x=0;x<this._geometries.length;x++)d+=this._geometries[x].getArea();return d},i.prototype.equalsExact=function(){if(2===arguments.length){var d=arguments[0],x=arguments[1];if(!this.isEquivalentClass(d))return!1;var D=d;if(this._geometries.length!==D._geometries.length)return!1;for(var F=0;F<this._geometries.length;F++)if(!this._geometries[F].equalsExact(D._geometries[F],x))return!1;return!0}return e.prototype.equalsExact.apply(this,arguments)},i.prototype.normalize=function(){for(var d=0;d<this._geometries.length;d++)this._geometries[d].normalize();Me.sort(this._geometries)},i.prototype.getCoordinate=function(){return this.isEmpty()?null:this._geometries[0].getCoordinate()},i.prototype.getBoundaryDimension=function(){for(var d=qe.FALSE,x=0;x<this._geometries.length;x++)d=Math.max(d,this._geometries[x].getBoundaryDimension());return d},i.prototype.getDimension=function(){for(var d=qe.FALSE,x=0;x<this._geometries.length;x++)d=Math.max(d,this._geometries[x].getDimension());return d},i.prototype.getLength=function(){for(var d=0,x=0;x<this._geometries.length;x++)d+=this._geometries[x].getLength();return d},i.prototype.getNumPoints=function(){for(var d=0,x=0;x<this._geometries.length;x++)d+=this._geometries[x].getNumPoints();return d},i.prototype.getNumGeometries=function(){return this._geometries.length},i.prototype.reverse=function(){for(var x=new Array(this._geometries.length).fill(null),D=0;D<this._geometries.length;D++)x[D]=this._geometries[D].reverse();return this.getFactory().createGeometryCollection(x)},i.prototype.compareToSameClass=function(){if(1===arguments.length){var d=arguments[0],x=new Jt(Me.asList(this._geometries)),D=new Jt(Me.asList(d._geometries));return this.compare(x,D)}if(2===arguments.length){for(var $=arguments[1],Ct=arguments[0],te=this.getNumGeometries(),Ne=Ct.getNumGeometries(),Ve=0;Ve<te&&Ve<Ne;){var gr=this.getGeometryN(Ve),Pr=Ct.getGeometryN(Ve),Yr=gr.compareToSameClass(Pr,$);if(0!==Yr)return Yr;Ve++}return Ve<te?1:Ve<Ne?-1:0}},i.prototype.apply=function(){if(Ce(arguments[0],Jn))for(var d=arguments[0],x=0;x<this._geometries.length;x++)this._geometries[x].apply(d);else if(Ce(arguments[0],Ar)){var D=arguments[0];if(0===this._geometries.length)return null;for(var F=0;F<this._geometries.length&&(this._geometries[F].apply(D),!D.isDone());F++);D.isGeometryChanged()&&this.geometryChanged()}else if(Ce(arguments[0],wr)){var $=arguments[0];$.filter(this);for(var Ct=0;Ct<this._geometries.length;Ct++)this._geometries[Ct].apply($)}else if(Ce(arguments[0],en)){var te=arguments[0];te.filter(this);for(var Ne=0;Ne<this._geometries.length;Ne++)this._geometries[Ne].apply(te)}},i.prototype.getBoundary=function(){return this.checkNotGeometryCollection(this),ot.shouldNeverReachHere(),null},i.prototype.clone=function(){var d=e.prototype.clone.call(this);d._geometries=new Array(this._geometries.length).fill(null);for(var x=0;x<this._geometries.length;x++)d._geometries[x]=this._geometries[x].clone();return d},i.prototype.getGeometryType=function(){return"GeometryCollection"},i.prototype.copy=function(){for(var d=new Array(this._geometries.length).fill(null),x=0;x<d.length;x++)d[x]=this._geometries[x].copy();return new i(d,this._factory)},i.prototype.isEmpty=function(){for(var d=0;d<this._geometries.length;d++)if(!this._geometries[d].isEmpty())return!1;return!0},i.prototype.interfaces_=function(){return[]},i.prototype.getClass=function(){return i},h.serialVersionUID.get=function(){return-0x4f07bcb1f857d800},Object.defineProperties(i,h),i}(hr),vr=function(e){function i(){e.apply(this,arguments)}e&&(i.__proto__=e),(i.prototype=Object.create(e&&e.prototype)).constructor=i;var h={serialVersionUID:{configurable:!0}};return i.prototype.getSortIndex=function(){return hr.SORTINDEX_MULTILINESTRING},i.prototype.equalsExact=function(){if(2===arguments.length){var d=arguments[0],x=arguments[1];return!!this.isEquivalentClass(d)&&e.prototype.equalsExact.call(this,d,x)}return e.prototype.equalsExact.apply(this,arguments)},i.prototype.getBoundaryDimension=function(){return this.isClosed()?qe.FALSE:0},i.prototype.isClosed=function(){if(this.isEmpty())return!1;for(var d=0;d<this._geometries.length;d++)if(!this._geometries[d].isClosed())return!1;return!0},i.prototype.getDimension=function(){return 1},i.prototype.reverse=function(){for(var d=this._geometries.length,x=new Array(d).fill(null),D=0;D<this._geometries.length;D++)x[d-1-D]=this._geometries[D].reverse();return this.getFactory().createMultiLineString(x)},i.prototype.getBoundary=function(){return new Ke(this).getBoundary()},i.prototype.getGeometryType=function(){return"MultiLineString"},i.prototype.copy=function(){for(var d=new Array(this._geometries.length).fill(null),x=0;x<d.length;x++)d[x]=this._geometries[x].copy();return new i(d,this._factory)},i.prototype.interfaces_=function(){return[nr]},i.prototype.getClass=function(){return i},h.serialVersionUID.get=function(){return 0x7155d2ab4afa8000},Object.defineProperties(i,h),i}(Xe),Ke=function(){if(this._geom=null,this._geomFact=null,this._bnRule=null,this._endpointMap=null,1===arguments.length){var e=arguments[0],i=Sn.MOD2_BOUNDARY_RULE;this._geom=e,this._geomFact=e.getFactory(),this._bnRule=i}else if(2===arguments.length){var h=arguments[0],d=arguments[1];this._geom=h,this._geomFact=h.getFactory(),this._bnRule=d}};Ke.prototype.boundaryMultiLineString=function(e){if(this._geom.isEmpty())return this.getEmptyMultiPoint();var i=this.computeBoundaryCoordinates(e);return 1===i.length?this._geomFact.createPoint(i[0]):this._geomFact.createMultiPointFromCoords(i)},Ke.prototype.getBoundary=function(){return this._geom instanceof Nr?this.boundaryLineString(this._geom):this._geom instanceof vr?this.boundaryMultiLineString(this._geom):this._geom.getBoundary()},Ke.prototype.boundaryLineString=function(e){return this._geom.isEmpty()?this.getEmptyMultiPoint():e.isClosed()?this._bnRule.isInBoundary(2)?e.getStartPoint():this._geomFact.createMultiPoint():this._geomFact.createMultiPoint([e.getStartPoint(),e.getEndPoint()])},Ke.prototype.getEmptyMultiPoint=function(){return this._geomFact.createMultiPoint()},Ke.prototype.computeBoundaryCoordinates=function(e){var i=new cr;this._endpointMap=new mt;for(var h=0;h<e.getNumGeometries();h++){var d=e.getGeometryN(h);0!==d.getNumPoints()&&(this.addEndpoint(d.getCoordinateN(0)),this.addEndpoint(d.getCoordinateN(d.getNumPoints()-1)))}for(var x=this._endpointMap.entrySet().iterator();x.hasNext();){var D=x.next(),F=D.getValue().count;this._bnRule.isInBoundary(F)&&i.add(D.getKey())}return W.toCoordinateArray(i)},Ke.prototype.addEndpoint=function(e){var i=this._endpointMap.get(e);null===i&&(i=new bn,this._endpointMap.put(e,i)),i.count++},Ke.prototype.interfaces_=function(){return[]},Ke.prototype.getClass=function(){return Ke},Ke.getBoundary=function(){return 1===arguments.length?new Ke(arguments[0]).getBoundary():2===arguments.length?new Ke(arguments[0],arguments[1]).getBoundary():void 0};var bn=function(){this.count=null};bn.prototype.interfaces_=function(){return[]},bn.prototype.getClass=function(){return bn};var $r=function(){},Lr={NEWLINE:{configurable:!0},SIMPLE_ORDINATE_FORMAT:{configurable:!0}};$r.prototype.interfaces_=function(){return[]},$r.prototype.getClass=function(){return $r},$r.chars=function(e,i){for(var h=new Array(i).fill(null),d=0;d<i;d++)h[d]=e;return String(h)},$r.getStackTrace=function(){if(1===arguments.length){var e=arguments[0],i=new function(){},h=new function(){}(i);return e.printStackTrace(h),i.toString()}if(2===arguments.length){for(var x=arguments[1],D="",F=new function(){}(new function(){}($r.getStackTrace(arguments[0]))),$=0;$<x;$++)try{D+=F.readLine()+$r.NEWLINE}catch(Ct){if(!(Ct instanceof ye))throw Ct;ot.shouldNeverReachHere()}return D}},$r.split=function(e,i){for(var h=i.length,d=new cr,x=""+e,D=x.indexOf(i);D>=0;){var F=x.substring(0,D);d.add(F),D=(x=x.substring(D+h)).indexOf(i)}x.length>0&&d.add(x);for(var $=new Array(d.size()).fill(null),Ct=0;Ct<$.length;Ct++)$[Ct]=d.get(Ct);return $},$r.toString=function(){if(1===arguments.length)return $r.SIMPLE_ORDINATE_FORMAT.format(arguments[0])},$r.spaces=function(e){return $r.chars(" ",e)},Lr.NEWLINE.get=function(){return jr.getProperty("line.separator")},Lr.SIMPLE_ORDINATE_FORMAT.get=function(){return new function(){}("0.#")},Object.defineProperties($r,Lr);var Mn=function(){};Mn.prototype.interfaces_=function(){return[]},Mn.prototype.getClass=function(){return Mn},Mn.copyCoord=function(e,i,h,d){for(var x=Math.min(e.getDimension(),h.getDimension()),D=0;D<x;D++)h.setOrdinate(d,D,e.getOrdinate(i,D))},Mn.isRing=function(e){var i=e.size();return 0===i||!(i<=3)&&e.getOrdinate(0,Ie.X)===e.getOrdinate(i-1,Ie.X)&&e.getOrdinate(0,Ie.Y)===e.getOrdinate(i-1,Ie.Y)},Mn.isEqual=function(e,i){var h=e.size();if(h!==i.size())return!1;for(var d=Math.min(e.getDimension(),i.getDimension()),x=0;x<h;x++)for(var D=0;D<d;D++){var F=e.getOrdinate(x,D),$=i.getOrdinate(x,D);if(!(e.getOrdinate(x,D)===i.getOrdinate(x,D)||X.isNaN(F)&&X.isNaN($)))return!1}return!0},Mn.extend=function(e,i,h){var d=e.create(h,i.getDimension()),x=i.size();if(Mn.copy(i,0,d,0,x),x>0)for(var D=x;D<h;D++)Mn.copy(i,x-1,d,D,1);return d},Mn.reverse=function(e){for(var i=e.size()-1,h=Math.trunc(i/2),d=0;d<=h;d++)Mn.swap(e,d,i-d)},Mn.swap=function(e,i,h){if(i===h)return null;for(var d=0;d<e.getDimension();d++){var x=e.getOrdinate(i,d);e.setOrdinate(i,d,e.getOrdinate(h,d)),e.setOrdinate(h,d,x)}},Mn.copy=function(e,i,h,d,x){for(var D=0;D<x;D++)Mn.copyCoord(e,i+D,h,d+D)},Mn.toString=function(){if(1===arguments.length){var e=arguments[0],i=e.size();if(0===i)return"()";var h=e.getDimension(),d=new At;d.append("(");for(var x=0;x<i;x++){x>0&&d.append(" ");for(var D=0;D<h;D++)D>0&&d.append(","),d.append($r.toString(e.getOrdinate(x,D)))}return d.append(")"),d.toString()}},Mn.ensureValidRing=function(e,i){var h=i.size();return 0===h?i:h<=3?Mn.createClosedRing(e,i,4):i.getOrdinate(0,Ie.X)===i.getOrdinate(h-1,Ie.X)&&i.getOrdinate(0,Ie.Y)===i.getOrdinate(h-1,Ie.Y)?i:Mn.createClosedRing(e,i,h+1)},Mn.createClosedRing=function(e,i,h){var d=e.create(h,i.getDimension()),x=i.size();Mn.copy(i,0,d,0,x);for(var D=x;D<h;D++)Mn.copy(i,0,d,D,1);return d};var Nr=function(e){function i(d,x){e.call(this,x),this._points=null,this.init(d)}e&&(i.__proto__=e),(i.prototype=Object.create(e&&e.prototype)).constructor=i;var h={serialVersionUID:{configurable:!0}};return i.prototype.computeEnvelopeInternal=function(){return this.isEmpty()?new He:this._points.expandEnvelope(new He)},i.prototype.isRing=function(){return this.isClosed()&&this.isSimple()},i.prototype.getSortIndex=function(){return e.SORTINDEX_LINESTRING},i.prototype.getCoordinates=function(){return this._points.toCoordinateArray()},i.prototype.equalsExact=function(){if(2===arguments.length){var d=arguments[0],x=arguments[1];if(!this.isEquivalentClass(d))return!1;var D=d;if(this._points.size()!==D._points.size())return!1;for(var F=0;F<this._points.size();F++)if(!this.equal(this._points.getCoordinate(F),D._points.getCoordinate(F),x))return!1;return!0}return e.prototype.equalsExact.apply(this,arguments)},i.prototype.normalize=function(){for(var d=0;d<Math.trunc(this._points.size()/2);d++){var x=this._points.size()-1-d;if(!this._points.getCoordinate(d).equals(this._points.getCoordinate(x)))return this._points.getCoordinate(d).compareTo(this._points.getCoordinate(x))>0&&Mn.reverse(this._points),null}},i.prototype.getCoordinate=function(){return this.isEmpty()?null:this._points.getCoordinate(0)},i.prototype.getBoundaryDimension=function(){return this.isClosed()?qe.FALSE:0},i.prototype.isClosed=function(){return!this.isEmpty()&&this.getCoordinateN(0).equals2D(this.getCoordinateN(this.getNumPoints()-1))},i.prototype.getEndPoint=function(){return this.isEmpty()?null:this.getPointN(this.getNumPoints()-1)},i.prototype.getDimension=function(){return 1},i.prototype.getLength=function(){return Ge.computeLength(this._points)},i.prototype.getNumPoints=function(){return this._points.size()},i.prototype.reverse=function(){var d=this._points.copy();return Mn.reverse(d),this.getFactory().createLineString(d)},i.prototype.compareToSameClass=function(){if(1===arguments.length){for(var d=arguments[0],x=0,D=0;x<this._points.size()&&D<d._points.size();){var F=this._points.getCoordinate(x).compareTo(d._points.getCoordinate(D));if(0!==F)return F;x++,D++}return x<this._points.size()?1:D<d._points.size()?-1:0}if(2===arguments.length)return arguments[1].compare(this._points,arguments[0]._points)},i.prototype.apply=function(){if(Ce(arguments[0],Jn))for(var d=arguments[0],x=0;x<this._points.size();x++)d.filter(this._points.getCoordinate(x));else if(Ce(arguments[0],Ar)){var D=arguments[0];if(0===this._points.size())return null;for(var F=0;F<this._points.size()&&(D.filter(this._points,F),!D.isDone());F++);D.isGeometryChanged()&&this.geometryChanged()}else(Ce(arguments[0],wr)||Ce(arguments[0],en))&&arguments[0].filter(this)},i.prototype.getBoundary=function(){return new Ke(this).getBoundary()},i.prototype.isEquivalentClass=function(d){return d instanceof i},i.prototype.clone=function(){var d=e.prototype.clone.call(this);return d._points=this._points.clone(),d},i.prototype.getCoordinateN=function(d){return this._points.getCoordinate(d)},i.prototype.getGeometryType=function(){return"LineString"},i.prototype.copy=function(){return new i(this._points.copy(),this._factory)},i.prototype.getCoordinateSequence=function(){return this._points},i.prototype.isEmpty=function(){return 0===this._points.size()},i.prototype.init=function(d){if(null===d&&(d=this.getFactory().getCoordinateSequenceFactory().create([])),1===d.size())throw new tt("Invalid number of points in LineString (found "+d.size()+" - must be 0 or >= 2)");this._points=d},i.prototype.isCoordinate=function(d){for(var x=0;x<this._points.size();x++)if(this._points.getCoordinate(x).equals(d))return!0;return!1},i.prototype.getStartPoint=function(){return this.isEmpty()?null:this.getPointN(0)},i.prototype.getPointN=function(d){return this.getFactory().createPoint(this._points.getCoordinate(d))},i.prototype.interfaces_=function(){return[nr]},i.prototype.getClass=function(){return i},h.serialVersionUID.get=function(){return 0x2b2b51ba435c8e00},Object.defineProperties(i,h),i}(hr),Oi=function(){};Oi.prototype.interfaces_=function(){return[]},Oi.prototype.getClass=function(){return Oi};var ai=function(e){function i(d,x){e.call(this,x),this._coordinates=d||null,this.init(this._coordinates)}e&&(i.__proto__=e),(i.prototype=Object.create(e&&e.prototype)).constructor=i;var h={serialVersionUID:{configurable:!0}};return i.prototype.computeEnvelopeInternal=function(){if(this.isEmpty())return new He;var d=new He;return d.expandToInclude(this._coordinates.getX(0),this._coordinates.getY(0)),d},i.prototype.getSortIndex=function(){return e.SORTINDEX_POINT},i.prototype.getCoordinates=function(){return this.isEmpty()?[]:[this.getCoordinate()]},i.prototype.equalsExact=function(){if(2===arguments.length){var d=arguments[0],x=arguments[1];return!!this.isEquivalentClass(d)&&(!(!this.isEmpty()||!d.isEmpty())||this.isEmpty()===d.isEmpty()&&this.equal(d.getCoordinate(),this.getCoordinate(),x))}return e.prototype.equalsExact.apply(this,arguments)},i.prototype.normalize=function(){},i.prototype.getCoordinate=function(){return 0!==this._coordinates.size()?this._coordinates.getCoordinate(0):null},i.prototype.getBoundaryDimension=function(){return qe.FALSE},i.prototype.getDimension=function(){return 0},i.prototype.getNumPoints=function(){return this.isEmpty()?0:1},i.prototype.reverse=function(){return this.copy()},i.prototype.getX=function(){if(null===this.getCoordinate())throw new Error("getX called on empty Point");return this.getCoordinate().x},i.prototype.compareToSameClass=function(){if(1===arguments.length){var d=arguments[0];return this.getCoordinate().compareTo(d.getCoordinate())}if(2===arguments.length)return arguments[1].compare(this._coordinates,arguments[0]._coordinates)},i.prototype.apply=function(){if(Ce(arguments[0],Jn)){var d=arguments[0];if(this.isEmpty())return null;d.filter(this.getCoordinate())}else if(Ce(arguments[0],Ar)){var x=arguments[0];if(this.isEmpty())return null;x.filter(this._coordinates,0),x.isGeometryChanged()&&this.geometryChanged()}else(Ce(arguments[0],wr)||Ce(arguments[0],en))&&arguments[0].filter(this)},i.prototype.getBoundary=function(){return this.getFactory().createGeometryCollection(null)},i.prototype.clone=function(){var d=e.prototype.clone.call(this);return d._coordinates=this._coordinates.clone(),d},i.prototype.getGeometryType=function(){return"Point"},i.prototype.copy=function(){return new i(this._coordinates.copy(),this._factory)},i.prototype.getCoordinateSequence=function(){return this._coordinates},i.prototype.getY=function(){if(null===this.getCoordinate())throw new Error("getY called on empty Point");return this.getCoordinate().y},i.prototype.isEmpty=function(){return 0===this._coordinates.size()},i.prototype.init=function(d){null===d&&(d=this.getFactory().getCoordinateSequenceFactory().create([])),ot.isTrue(d.size()<=1),this._coordinates=d},i.prototype.isSimple=function(){return!0},i.prototype.interfaces_=function(){return[Oi]},i.prototype.getClass=function(){return i},h.serialVersionUID.get=function(){return 0x44077bad161cbc00},Object.defineProperties(i,h),i}(hr),kn=function(){};kn.prototype.interfaces_=function(){return[]},kn.prototype.getClass=function(){return kn};var Tn=function(e){function i(d,x,D){if(e.call(this,D),this._shell=null,this._holes=null,null===d&&(d=this.getFactory().createLinearRing()),null===x&&(x=[]),e.hasNullElements(x))throw new tt("holes must not contain null elements");if(d.isEmpty()&&e.hasNonEmptyElements(x))throw new tt("shell is empty but holes are not");this._shell=d,this._holes=x}e&&(i.__proto__=e),(i.prototype=Object.create(e&&e.prototype)).constructor=i;var h={serialVersionUID:{configurable:!0}};return i.prototype.computeEnvelopeInternal=function(){return this._shell.getEnvelopeInternal()},i.prototype.getSortIndex=function(){return e.SORTINDEX_POLYGON},i.prototype.getCoordinates=function(){if(this.isEmpty())return[];for(var d=new Array(this.getNumPoints()).fill(null),x=-1,D=this._shell.getCoordinates(),F=0;F<D.length;F++)d[++x]=D[F];for(var $=0;$<this._holes.length;$++)for(var Ct=this._holes[$].getCoordinates(),te=0;te<Ct.length;te++)d[++x]=Ct[te];return d},i.prototype.getArea=function(){var d=0;d+=Math.abs(Ge.signedArea(this._shell.getCoordinateSequence()));for(var x=0;x<this._holes.length;x++)d-=Math.abs(Ge.signedArea(this._holes[x].getCoordinateSequence()));return d},i.prototype.isRectangle=function(){if(0!==this.getNumInteriorRing()||null===this._shell||5!==this._shell.getNumPoints())return!1;for(var d=this._shell.getCoordinateSequence(),x=this.getEnvelopeInternal(),D=0;D<5;D++){var F=d.getX(D);if(F!==x.getMinX()&&F!==x.getMaxX())return!1;var $=d.getY(D);if($!==x.getMinY()&&$!==x.getMaxY())return!1}for(var Ct=d.getX(0),te=d.getY(0),Ne=1;Ne<=4;Ne++){var Ve=d.getX(Ne),gr=d.getY(Ne);if(Ve!==Ct==(gr!==te))return!1;Ct=Ve,te=gr}return!0},i.prototype.equalsExact=function(){if(2===arguments.length){var d=arguments[0],x=arguments[1];if(!this.isEquivalentClass(d))return!1;var D=d;if(!this._shell.equalsExact(D._shell,x)||this._holes.length!==D._holes.length)return!1;for(var Ct=0;Ct<this._holes.length;Ct++)if(!this._holes[Ct].equalsExact(D._holes[Ct],x))return!1;return!0}return e.prototype.equalsExact.apply(this,arguments)},i.prototype.normalize=function(){if(0===arguments.length){this.normalize(this._shell,!0);for(var d=0;d<this._holes.length;d++)this.normalize(this._holes[d],!1);Me.sort(this._holes)}else if(2===arguments.length){var x=arguments[0],D=arguments[1];if(x.isEmpty())return null;var F=new Array(x.getCoordinates().length-1).fill(null);jr.arraycopy(x.getCoordinates(),0,F,0,F.length);var $=W.minCoordinate(x.getCoordinates());W.scroll(F,$),jr.arraycopy(F,0,x.getCoordinates(),0,F.length),x.getCoordinates()[F.length]=F[0],Ge.isCCW(x.getCoordinates())===D&&W.reverse(x.getCoordinates())}},i.prototype.getCoordinate=function(){return this._shell.getCoordinate()},i.prototype.getNumInteriorRing=function(){return this._holes.length},i.prototype.getBoundaryDimension=function(){return 1},i.prototype.getDimension=function(){return 2},i.prototype.getLength=function(){var d=0;d+=this._shell.getLength();for(var x=0;x<this._holes.length;x++)d+=this._holes[x].getLength();return d},i.prototype.getNumPoints=function(){for(var d=this._shell.getNumPoints(),x=0;x<this._holes.length;x++)d+=this._holes[x].getNumPoints();return d},i.prototype.reverse=function(){var d=this.copy();d._shell=this._shell.copy().reverse(),d._holes=new Array(this._holes.length).fill(null);for(var x=0;x<this._holes.length;x++)d._holes[x]=this._holes[x].copy().reverse();return d},i.prototype.convexHull=function(){return this.getExteriorRing().convexHull()},i.prototype.compareToSameClass=function(){if(1===arguments.length)return this._shell.compareToSameClass(arguments[0]._shell);if(2===arguments.length){var $=arguments[1],Ct=arguments[0],Ve=this._shell.compareToSameClass(Ct._shell,$);if(0!==Ve)return Ve;for(var gr=this.getNumInteriorRing(),Pr=Ct.getNumInteriorRing(),Yr=0;Yr<gr&&Yr<Pr;){var an=this.getInteriorRingN(Yr),Mi=Ct.getInteriorRingN(Yr),l=an.compareToSameClass(Mi,$);if(0!==l)return l;Yr++}return Yr<gr?1:Yr<Pr?-1:0}},i.prototype.apply=function(d){if(Ce(d,Jn)){this._shell.apply(d);for(var x=0;x<this._holes.length;x++)this._holes[x].apply(d)}else if(Ce(d,Ar)){if(this._shell.apply(d),!d.isDone())for(var D=0;D<this._holes.length&&(this._holes[D].apply(d),!d.isDone());D++);d.isGeometryChanged()&&this.geometryChanged()}else if(Ce(d,wr))d.filter(this);else if(Ce(d,en)){d.filter(this),this._shell.apply(d);for(var F=0;F<this._holes.length;F++)this._holes[F].apply(d)}},i.prototype.getBoundary=function(){if(this.isEmpty())return this.getFactory().createMultiLineString();var d=new Array(this._holes.length+1).fill(null);d[0]=this._shell;for(var x=0;x<this._holes.length;x++)d[x+1]=this._holes[x];return d.length<=1?this.getFactory().createLinearRing(d[0].getCoordinateSequence()):this.getFactory().createMultiLineString(d)},i.prototype.clone=function(){var d=e.prototype.clone.call(this);d._shell=this._shell.clone(),d._holes=new Array(this._holes.length).fill(null);for(var x=0;x<this._holes.length;x++)d._holes[x]=this._holes[x].clone();return d},i.prototype.getGeometryType=function(){return"Polygon"},i.prototype.copy=function(){for(var d=this._shell.copy(),x=new Array(this._holes.length).fill(null),D=0;D<x.length;D++)x[D]=this._holes[D].copy();return new i(d,x,this._factory)},i.prototype.getExteriorRing=function(){return this._shell},i.prototype.isEmpty=function(){return this._shell.isEmpty()},i.prototype.getInteriorRingN=function(d){return this._holes[d]},i.prototype.interfaces_=function(){return[kn]},i.prototype.getClass=function(){return i},h.serialVersionUID.get=function(){return-0x307ffefd8dc97200},Object.defineProperties(i,h),i}(hr),co=function(e){function i(){e.apply(this,arguments)}e&&(i.__proto__=e),(i.prototype=Object.create(e&&e.prototype)).constructor=i;var h={serialVersionUID:{configurable:!0}};return i.prototype.getSortIndex=function(){return hr.SORTINDEX_MULTIPOINT},i.prototype.isValid=function(){return!0},i.prototype.equalsExact=function(){if(2===arguments.length){var d=arguments[0],x=arguments[1];return!!this.isEquivalentClass(d)&&e.prototype.equalsExact.call(this,d,x)}return e.prototype.equalsExact.apply(this,arguments)},i.prototype.getCoordinate=function(){return 1===arguments.length?this._geometries[arguments[0]].getCoordinate():e.prototype.getCoordinate.apply(this,arguments)},i.prototype.getBoundaryDimension=function(){return qe.FALSE},i.prototype.getDimension=function(){return 0},i.prototype.getBoundary=function(){return this.getFactory().createGeometryCollection(null)},i.prototype.getGeometryType=function(){return"MultiPoint"},i.prototype.copy=function(){for(var d=new Array(this._geometries.length).fill(null),x=0;x<d.length;x++)d[x]=this._geometries[x].copy();return new i(d,this._factory)},i.prototype.interfaces_=function(){return[Oi]},i.prototype.getClass=function(){return i},h.serialVersionUID.get=function(){return-0x6fb1ed4162e0fc00},Object.defineProperties(i,h),i}(Xe),ni=function(e){function i(d,x){d instanceof Z&&x instanceof wn&&(d=x.getCoordinateSequenceFactory().create(d)),e.call(this,d,x),this.validateConstruction()}e&&(i.__proto__=e),(i.prototype=Object.create(e&&e.prototype)).constructor=i;var h={MINIMUM_VALID_SIZE:{configurable:!0},serialVersionUID:{configurable:!0}};return i.prototype.getSortIndex=function(){return hr.SORTINDEX_LINEARRING},i.prototype.getBoundaryDimension=function(){return qe.FALSE},i.prototype.isClosed=function(){return!!this.isEmpty()||e.prototype.isClosed.call(this)},i.prototype.reverse=function(){var d=this._points.copy();return Mn.reverse(d),this.getFactory().createLinearRing(d)},i.prototype.validateConstruction=function(){if(!this.isEmpty()&&!e.prototype.isClosed.call(this))throw new tt("Points of LinearRing do not form a closed linestring");if(this.getCoordinateSequence().size()>=1&&this.getCoordinateSequence().size()<i.MINIMUM_VALID_SIZE)throw new tt("Invalid number of points in LinearRing (found "+this.getCoordinateSequence().size()+" - must be 0 or >= 4)")},i.prototype.getGeometryType=function(){return"LinearRing"},i.prototype.copy=function(){return new i(this._points.copy(),this._factory)},i.prototype.interfaces_=function(){return[]},i.prototype.getClass=function(){return i},h.MINIMUM_VALID_SIZE.get=function(){return 4},h.serialVersionUID.get=function(){return-0x3b229e262367a600},Object.defineProperties(i,h),i}(Nr),Xr=function(e){function i(){e.apply(this,arguments)}e&&(i.__proto__=e),(i.prototype=Object.create(e&&e.prototype)).constructor=i;var h={serialVersionUID:{configurable:!0}};return i.prototype.getSortIndex=function(){return hr.SORTINDEX_MULTIPOLYGON},i.prototype.equalsExact=function(){if(2===arguments.length){var d=arguments[0],x=arguments[1];return!!this.isEquivalentClass(d)&&e.prototype.equalsExact.call(this,d,x)}return e.prototype.equalsExact.apply(this,arguments)},i.prototype.getBoundaryDimension=function(){return 1},i.prototype.getDimension=function(){return 2},i.prototype.reverse=function(){for(var x=new Array(this._geometries.length).fill(null),D=0;D<this._geometries.length;D++)x[D]=this._geometries[D].reverse();return this.getFactory().createMultiPolygon(x)},i.prototype.getBoundary=function(){if(this.isEmpty())return this.getFactory().createMultiLineString();for(var d=new cr,x=0;x<this._geometries.length;x++)for(var D=this._geometries[x].getBoundary(),F=0;F<D.getNumGeometries();F++)d.add(D.getGeometryN(F));var $=new Array(d.size()).fill(null);return this.getFactory().createMultiLineString(d.toArray($))},i.prototype.getGeometryType=function(){return"MultiPolygon"},i.prototype.copy=function(){for(var d=new Array(this._geometries.length).fill(null),x=0;x<d.length;x++)d[x]=this._geometries[x].copy();return new i(d,this._factory)},i.prototype.interfaces_=function(){return[kn]},i.prototype.getClass=function(){return i},h.serialVersionUID.get=function(){return-0x7a5aa1369171980},Object.defineProperties(i,h),i}(Xe),ca=function(e){this._factory=e||null,this._isUserDataCopied=!1},Hn={NoOpGeometryOperation:{configurable:!0},CoordinateOperation:{configurable:!0},CoordinateSequenceOperation:{configurable:!0}};ca.prototype.setCopyUserData=function(e){this._isUserDataCopied=e},ca.prototype.edit=function(e,i){if(null===e)return null;var h=this.editInternal(e,i);return this._isUserDataCopied&&h.setUserData(e.getUserData()),h},ca.prototype.editInternal=function(e,i){return null===this._factory&&(this._factory=e.getFactory()),e instanceof Xe?this.editGeometryCollection(e,i):e instanceof Tn?this.editPolygon(e,i):e instanceof ai||e instanceof Nr?i.edit(e,this._factory):(ot.shouldNeverReachHere("Unsupported Geometry class: "+e.getClass().getName()),null)},ca.prototype.editGeometryCollection=function(e,i){for(var h=i.edit(e,this._factory),d=new cr,x=0;x<h.getNumGeometries();x++){var D=this.edit(h.getGeometryN(x),i);null===D||D.isEmpty()||d.add(D)}return h.getClass()===co?this._factory.createMultiPoint(d.toArray([])):h.getClass()===vr?this._factory.createMultiLineString(d.toArray([])):h.getClass()===Xr?this._factory.createMultiPolygon(d.toArray([])):this._factory.createGeometryCollection(d.toArray([]))},ca.prototype.editPolygon=function(e,i){var h=i.edit(e,this._factory);if(null===h&&(h=this._factory.createPolygon(null)),h.isEmpty())return h;var d=this.edit(h.getExteriorRing(),i);if(null===d||d.isEmpty())return this._factory.createPolygon();for(var x=new cr,D=0;D<h.getNumInteriorRing();D++){var F=this.edit(h.getInteriorRingN(D),i);null===F||F.isEmpty()||x.add(F)}return this._factory.createPolygon(d,x.toArray([]))},ca.prototype.interfaces_=function(){return[]},ca.prototype.getClass=function(){return ca},ca.GeometryEditorOperation=function(){},Hn.NoOpGeometryOperation.get=function(){return Fa},Hn.CoordinateOperation.get=function(){return za},Hn.CoordinateSequenceOperation.get=function(){return No},Object.defineProperties(ca,Hn);var Fa=function(){};Fa.prototype.edit=function(e,i){return e},Fa.prototype.interfaces_=function(){return[ca.GeometryEditorOperation]},Fa.prototype.getClass=function(){return Fa};var za=function(){};za.prototype.edit=function(e,i){var h=this.editCoordinates(e.getCoordinates(),e);return null===h?e:e instanceof ni?i.createLinearRing(h):e instanceof Nr?i.createLineString(h):e instanceof ai?h.length>0?i.createPoint(h[0]):i.createPoint():e},za.prototype.interfaces_=function(){return[ca.GeometryEditorOperation]},za.prototype.getClass=function(){return za};var No=function(){};No.prototype.edit=function(e,i){return e instanceof ni?i.createLinearRing(this.edit(e.getCoordinateSequence(),e)):e instanceof Nr?i.createLineString(this.edit(e.getCoordinateSequence(),e)):e instanceof ai?i.createPoint(this.edit(e.getCoordinateSequence(),e)):e},No.prototype.interfaces_=function(){return[ca.GeometryEditorOperation]},No.prototype.getClass=function(){return No};var Wn=function(){if(this._dimension=3,this._coordinates=null,1===arguments.length){if(arguments[0]instanceof Array)this._coordinates=arguments[0],this._dimension=3;else if(Number.isInteger(arguments[0])){var e=arguments[0];this._coordinates=new Array(e).fill(null);for(var i=0;i<e;i++)this._coordinates[i]=new Z}else if(Ce(arguments[0],Ie)){var h=arguments[0];if(null===h)return this._coordinates=new Array(0).fill(null),null;this._dimension=h.getDimension(),this._coordinates=new Array(h.size()).fill(null);for(var d=0;d<this._coordinates.length;d++)this._coordinates[d]=h.getCoordinateCopy(d)}}else if(2===arguments.length)if(arguments[0]instanceof Array&&Number.isInteger(arguments[1])){var x=arguments[0],D=arguments[1];this._coordinates=x,this._dimension=D,null===x&&(this._coordinates=new Array(0).fill(null))}else if(Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var F=arguments[0],$=arguments[1];this._coordinates=new Array(F).fill(null),this._dimension=$;for(var Ct=0;Ct<F;Ct++)this._coordinates[Ct]=new Z}},Ws={serialVersionUID:{configurable:!0}};Wn.prototype.setOrdinate=function(e,i,h){switch(i){case Ie.X:this._coordinates[e].x=h;break;case Ie.Y:this._coordinates[e].y=h;break;case Ie.Z:this._coordinates[e].z=h;break;default:throw new tt("invalid ordinateIndex")}},Wn.prototype.size=function(){return this._coordinates.length},Wn.prototype.getOrdinate=function(e,i){switch(i){case Ie.X:return this._coordinates[e].x;case Ie.Y:return this._coordinates[e].y;case Ie.Z:return this._coordinates[e].z}return X.NaN},Wn.prototype.getCoordinate=function(){if(1===arguments.length)return this._coordinates[arguments[0]];if(2===arguments.length){var i=arguments[0],h=arguments[1];h.x=this._coordinates[i].x,h.y=this._coordinates[i].y,h.z=this._coordinates[i].z}},Wn.prototype.getCoordinateCopy=function(e){return new Z(this._coordinates[e])},Wn.prototype.getDimension=function(){return this._dimension},Wn.prototype.getX=function(e){return this._coordinates[e].x},Wn.prototype.clone=function(){for(var e=new Array(this.size()).fill(null),i=0;i<this._coordinates.length;i++)e[i]=this._coordinates[i].clone();return new Wn(e,this._dimension)},Wn.prototype.expandEnvelope=function(e){for(var i=0;i<this._coordinates.length;i++)e.expandToInclude(this._coordinates[i]);return e},Wn.prototype.copy=function(){for(var e=new Array(this.size()).fill(null),i=0;i<this._coordinates.length;i++)e[i]=this._coordinates[i].copy();return new Wn(e,this._dimension)},Wn.prototype.toString=function(){if(this._coordinates.length>0){var e=new At(17*this._coordinates.length);e.append("("),e.append(this._coordinates[0]);for(var i=1;i<this._coordinates.length;i++)e.append(", "),e.append(this._coordinates[i]);return e.append(")"),e.toString()}return"()"},Wn.prototype.getY=function(e){return this._coordinates[e].y},Wn.prototype.toCoordinateArray=function(){return this._coordinates},Wn.prototype.interfaces_=function(){return[Ie,gt]},Wn.prototype.getClass=function(){return Wn},Ws.serialVersionUID.get=function(){return-0xcb44a778db18e00},Object.defineProperties(Wn,Ws);var Aa=function(){},aa={serialVersionUID:{configurable:!0},instanceObject:{configurable:!0}};Aa.prototype.readResolve=function(){return Aa.instance()},Aa.prototype.create=function(){if(1===arguments.length){if(arguments[0]instanceof Array)return new Wn(arguments[0]);if(Ce(arguments[0],Ie))return new Wn(arguments[0])}else if(2===arguments.length){var h=arguments[0],d=arguments[1];return d>3&&(d=3),d<2?new Wn(h):new Wn(h,d)}},Aa.prototype.interfaces_=function(){return[kt,gt]},Aa.prototype.getClass=function(){return Aa},Aa.instance=function(){return Aa.instanceObject},aa.serialVersionUID.get=function(){return-0x38e49fa6cf6f2e00},aa.instanceObject.get=function(){return new Aa},Object.defineProperties(Aa,aa);var ss=function(e){function i(){e.call(this),this.map_=new Map}return e&&(i.__proto__=e),(i.prototype=Object.create(e&&e.prototype)).constructor=i,i.prototype.get=function(h){return this.map_.get(h)||null},i.prototype.put=function(h,d){return this.map_.set(h,d),d},i.prototype.values=function(){for(var h=new cr,d=this.map_.values(),x=d.next();!x.done;)h.add(x.value),x=d.next();return h},i.prototype.entrySet=function(){var h=new ue;return this.map_.entries().forEach(function(d){return h.add(d)}),h},i.prototype.size=function(){return this.map_.size()},i}(ae),Bn=function e(){if(this._modelType=null,this._scale=null,0===arguments.length)this._modelType=e.FLOATING;else if(1===arguments.length)if(arguments[0]instanceof Bo){var i=arguments[0];this._modelType=i,i===e.FIXED&&this.setScale(1)}else if("number"==typeof arguments[0]){var h=arguments[0];this._modelType=e.FIXED,this.setScale(h)}else if(arguments[0]instanceof e){var d=arguments[0];this._modelType=d._modelType,this._scale=d._scale}},go={serialVersionUID:{configurable:!0},maximumPreciseValue:{configurable:!0}};Bn.prototype.equals=function(e){return e instanceof Bn&&this._modelType===e._modelType&&this._scale===e._scale},Bn.prototype.compareTo=function(e){var i=e,h=this.getMaximumSignificantDigits(),d=i.getMaximumSignificantDigits();return new $t(h).compareTo(new $t(d))},Bn.prototype.getScale=function(){return this._scale},Bn.prototype.isFloating=function(){return this._modelType===Bn.FLOATING||this._modelType===Bn.FLOATING_SINGLE},Bn.prototype.getType=function(){return this._modelType},Bn.prototype.toString=function(){var e="UNKNOWN";return this._modelType===Bn.FLOATING?e="Floating":this._modelType===Bn.FLOATING_SINGLE?e="Floating-Single":this._modelType===Bn.FIXED&&(e="Fixed (Scale="+this.getScale()+")"),e},Bn.prototype.makePrecise=function(){if("number"==typeof arguments[0]){var e=arguments[0];return X.isNaN(e)||this._modelType===Bn.FLOATING_SINGLE?e:this._modelType===Bn.FIXED?Math.round(e*this._scale)/this._scale:e}if(arguments[0]instanceof Z){var i=arguments[0];if(this._modelType===Bn.FLOATING)return null;i.x=this.makePrecise(i.x),i.y=this.makePrecise(i.y)}},Bn.prototype.getMaximumSignificantDigits=function(){var e=16;return this._modelType===Bn.FLOATING?e=16:this._modelType===Bn.FLOATING_SINGLE?e=6:this._modelType===Bn.FIXED&&(e=1+Math.trunc(Math.ceil(Math.log(this.getScale())/Math.log(10)))),e},Bn.prototype.setScale=function(e){this._scale=Math.abs(e)},Bn.prototype.interfaces_=function(){return[gt,J]},Bn.prototype.getClass=function(){return Bn},Bn.mostPrecise=function(e,i){return e.compareTo(i)>=0?e:i},go.serialVersionUID.get=function(){return 0x6bee6404e9a25c00},go.maximumPreciseValue.get=function(){return 9007199254740992},Object.defineProperties(Bn,go);var Bo=function e(i){this._name=i||null,e.nameToTypeMap.put(i,this)},La={serialVersionUID:{configurable:!0},nameToTypeMap:{configurable:!0}};Bo.prototype.readResolve=function(){return Bo.nameToTypeMap.get(this._name)},Bo.prototype.toString=function(){return this._name},Bo.prototype.interfaces_=function(){return[gt]},Bo.prototype.getClass=function(){return Bo},La.serialVersionUID.get=function(){return-552860263173159e4},La.nameToTypeMap.get=function(){return new ss},Object.defineProperties(Bo,La),Bn.Type=Bo,Bn.FIXED=new Bo("FIXED"),Bn.FLOATING=new Bo("FLOATING"),Bn.FLOATING_SINGLE=new Bo("FLOATING SINGLE");var wn=function e(){this._precisionModel=new Bn,this._SRID=0,this._coordinateSequenceFactory=e.getDefaultCoordinateSequenceFactory(),0===arguments.length||(1===arguments.length?Ce(arguments[0],kt)?this._coordinateSequenceFactory=arguments[0]:arguments[0]instanceof Bn&&(this._precisionModel=arguments[0]):2===arguments.length?(this._precisionModel=arguments[0],this._SRID=arguments[1]):3===arguments.length&&(this._precisionModel=arguments[0],this._SRID=arguments[1],this._coordinateSequenceFactory=arguments[2]))},Tu={serialVersionUID:{configurable:!0}};wn.prototype.toGeometry=function(e){return e.isNull()?this.createPoint(null):e.getMinX()===e.getMaxX()&&e.getMinY()===e.getMaxY()?this.createPoint(new Z(e.getMinX(),e.getMinY())):e.getMinX()===e.getMaxX()||e.getMinY()===e.getMaxY()?this.createLineString([new Z(e.getMinX(),e.getMinY()),new Z(e.getMaxX(),e.getMaxY())]):this.createPolygon(this.createLinearRing([new Z(e.getMinX(),e.getMinY()),new Z(e.getMinX(),e.getMaxY()),new Z(e.getMaxX(),e.getMaxY()),new Z(e.getMaxX(),e.getMinY()),new Z(e.getMinX(),e.getMinY())]),null)},wn.prototype.createLineString=function(e){return e?e instanceof Array?new Nr(this.getCoordinateSequenceFactory().create(e),this):Ce(e,Ie)?new Nr(e,this):void 0:new Nr(this.getCoordinateSequenceFactory().create([]),this)},wn.prototype.createMultiLineString=function(){return 0===arguments.length?new vr(null,this):1===arguments.length?new vr(arguments[0],this):void 0},wn.prototype.buildGeometry=function(e){for(var i=null,h=!1,d=!1,x=e.iterator();x.hasNext();){var D=x.next(),F=D.getClass();null===i&&(i=F),F!==i&&(h=!0),D.isGeometryCollectionOrDerived()&&(d=!0)}if(null===i)return this.createGeometryCollection();if(h||d)return this.createGeometryCollection(wn.toGeometryArray(e));var $=e.iterator().next();if(e.size()>1){if($ instanceof Tn)return this.createMultiPolygon(wn.toPolygonArray(e));if($ instanceof Nr)return this.createMultiLineString(wn.toLineStringArray(e));if($ instanceof ai)return this.createMultiPoint(wn.toPointArray(e));ot.shouldNeverReachHere("Unhandled class: "+$.getClass().getName())}return $},wn.prototype.createMultiPointFromCoords=function(e){return this.createMultiPoint(null!==e?this.getCoordinateSequenceFactory().create(e):null)},wn.prototype.createPoint=function(){if(0===arguments.length)return this.createPoint(this.getCoordinateSequenceFactory().create([]));if(1===arguments.length){if(arguments[0]instanceof Z){var e=arguments[0];return this.createPoint(null!==e?this.getCoordinateSequenceFactory().create([e]):null)}if(Ce(arguments[0],Ie))return new ai(arguments[0],this)}},wn.prototype.getCoordinateSequenceFactory=function(){return this._coordinateSequenceFactory},wn.prototype.createPolygon=function(){if(0===arguments.length)return new Tn(null,null,this);if(1===arguments.length){if(Ce(arguments[0],Ie))return this.createPolygon(this.createLinearRing(arguments[0]));if(arguments[0]instanceof Array)return this.createPolygon(this.createLinearRing(arguments[0]));if(arguments[0]instanceof ni)return this.createPolygon(arguments[0],null)}else if(2===arguments.length)return new Tn(arguments[0],arguments[1],this)},wn.prototype.getSRID=function(){return this._SRID},wn.prototype.createGeometryCollection=function(){return 0===arguments.length?new Xe(null,this):1===arguments.length?new Xe(arguments[0],this):void 0},wn.prototype.createGeometry=function(e){return new ca(this).edit(e,{edit:function(){if(2===arguments.length)return this._coordinateSequenceFactory.create(arguments[0])}})},wn.prototype.getPrecisionModel=function(){return this._precisionModel},wn.prototype.createLinearRing=function(){if(0===arguments.length)return this.createLinearRing(this.getCoordinateSequenceFactory().create([]));if(1===arguments.length){if(arguments[0]instanceof Array){var e=arguments[0];return this.createLinearRing(null!==e?this.getCoordinateSequenceFactory().create(e):null)}if(Ce(arguments[0],Ie))return new ni(arguments[0],this)}},wn.prototype.createMultiPolygon=function(){return 0===arguments.length?new Xr(null,this):1===arguments.length?new Xr(arguments[0],this):void 0},wn.prototype.createMultiPoint=function(){if(0===arguments.length)return new co(null,this);if(1===arguments.length){if(arguments[0]instanceof Array)return new co(arguments[0],this);if(arguments[0]instanceof Array){var i=arguments[0];return this.createMultiPoint(null!==i?this.getCoordinateSequenceFactory().create(i):null)}if(Ce(arguments[0],Ie)){var h=arguments[0];if(null===h)return this.createMultiPoint(new Array(0).fill(null));for(var d=new Array(h.size()).fill(null),x=0;x<h.size();x++){var D=this.getCoordinateSequenceFactory().create(1,h.getDimension());Mn.copy(h,x,D,0,1),d[x]=this.createPoint(D)}return this.createMultiPoint(d)}}},wn.prototype.interfaces_=function(){return[gt]},wn.prototype.getClass=function(){return wn},wn.toMultiPolygonArray=function(e){var i=new Array(e.size()).fill(null);return e.toArray(i)},wn.toGeometryArray=function(e){if(null===e)return null;var i=new Array(e.size()).fill(null);return e.toArray(i)},wn.getDefaultCoordinateSequenceFactory=function(){return Aa.instance()},wn.toMultiLineStringArray=function(e){var i=new Array(e.size()).fill(null);return e.toArray(i)},wn.toLineStringArray=function(e){var i=new Array(e.size()).fill(null);return e.toArray(i)},wn.toMultiPointArray=function(e){var i=new Array(e.size()).fill(null);return e.toArray(i)},wn.toLinearRingArray=function(e){var i=new Array(e.size()).fill(null);return e.toArray(i)},wn.toPointArray=function(e){var i=new Array(e.size()).fill(null);return e.toArray(i)},wn.toPolygonArray=function(e){var i=new Array(e.size()).fill(null);return e.toArray(i)},wn.createPointFromInternalCoord=function(e,i){return i.getPrecisionModel().makePrecise(e),i.getFactory().createPoint(e)},Tu.serialVersionUID.get=function(){return-0x5ea75f2051eeb400},Object.defineProperties(wn,Tu);var El=["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon"],L=function(e){this.geometryFactory=e||new wn};L.prototype.read=function(e){var i,h=(i="string"==typeof e?JSON.parse(e):e).type;if(!U[h])throw new Error("Unknown GeoJSON type: "+i.type);return-1!==El.indexOf(h)?U[h].apply(this,[i.coordinates]):U[h].apply(this,"GeometryCollection"===h?[i.geometries]:[i])},L.prototype.write=function(e){var i=e.getGeometryType();if(!ct[i])throw new Error("Geometry is not supported");return ct[i].apply(this,[e])};var U={Feature:function(e){var i={};for(var h in e)i[h]=e[h];if(e.geometry){if(!U[e.geometry.type])throw new Error("Unknown GeoJSON type: "+e.type);i.geometry=this.read(e.geometry)}return e.bbox&&(i.bbox=U.bbox.apply(this,[e.bbox])),i},FeatureCollection:function(e){var i={};if(e.features){i.features=[];for(var h=0;h<e.features.length;++h)i.features.push(this.read(e.features[h]))}return e.bbox&&(i.bbox=this.parse.bbox.apply(this,[e.bbox])),i},coordinates:function(e){for(var i=[],h=0;h<e.length;++h){var d=e[h];i.push(new Z(d[0],d[1]))}return i},bbox:function(e){return this.geometryFactory.createLinearRing([new Z(e[0],e[1]),new Z(e[2],e[1]),new Z(e[2],e[3]),new Z(e[0],e[3]),new Z(e[0],e[1])])},Point:function(e){var i=new Z(e[0],e[1]);return this.geometryFactory.createPoint(i)},MultiPoint:function(e){for(var i=[],h=0;h<e.length;++h)i.push(U.Point.apply(this,[e[h]]));return this.geometryFactory.createMultiPoint(i)},LineString:function(e){var i=U.coordinates.apply(this,[e]);return this.geometryFactory.createLineString(i)},MultiLineString:function(e){for(var i=[],h=0;h<e.length;++h)i.push(U.LineString.apply(this,[e[h]]));return this.geometryFactory.createMultiLineString(i)},Polygon:function(e){for(var i=U.coordinates.apply(this,[e[0]]),h=this.geometryFactory.createLinearRing(i),d=[],x=1;x<e.length;++x){var F=U.coordinates.apply(this,[e[x]]),$=this.geometryFactory.createLinearRing(F);d.push($)}return this.geometryFactory.createPolygon(h,d)},MultiPolygon:function(e){for(var i=[],h=0;h<e.length;++h)i.push(U.Polygon.apply(this,[e[h]]));return this.geometryFactory.createMultiPolygon(i)},GeometryCollection:function(e){for(var i=[],h=0;h<e.length;++h)i.push(this.read(e[h]));return this.geometryFactory.createGeometryCollection(i)}},ct={coordinate:function(e){return[e.x,e.y]},Point:function(e){return{type:"Point",coordinates:ct.coordinate.apply(this,[e.getCoordinate()])}},MultiPoint:function(e){for(var i=[],h=0;h<e._geometries.length;++h){var x=ct.Point.apply(this,[e._geometries[h]]);i.push(x.coordinates)}return{type:"MultiPoint",coordinates:i}},LineString:function(e){for(var i=[],h=e.getCoordinates(),d=0;d<h.length;++d)i.push(ct.coordinate.apply(this,[h[d]]));return{type:"LineString",coordinates:i}},MultiLineString:function(e){for(var i=[],h=0;h<e._geometries.length;++h){var x=ct.LineString.apply(this,[e._geometries[h]]);i.push(x.coordinates)}return{type:"MultiLineString",coordinates:i}},Polygon:function(e){var i=[],h=ct.LineString.apply(this,[e._shell]);i.push(h.coordinates);for(var d=0;d<e._holes.length;++d){var D=ct.LineString.apply(this,[e._holes[d]]);i.push(D.coordinates)}return{type:"Polygon",coordinates:i}},MultiPolygon:function(e){for(var i=[],h=0;h<e._geometries.length;++h){var x=ct.Polygon.apply(this,[e._geometries[h]]);i.push(x.coordinates)}return{type:"MultiPolygon",coordinates:i}},GeometryCollection:function(e){for(var i=[],h=0;h<e._geometries.length;++h){var d=e._geometries[h],x=d.getGeometryType();i.push(ct[x].apply(this,[d]))}return{type:"GeometryCollection",geometries:i}}},oe=function(e){this.geometryFactory=e||new wn,this.precisionModel=this.geometryFactory.getPrecisionModel(),this.parser=new L(this.geometryFactory)};oe.prototype.read=function(e){var i=this.parser.read(e);return this.precisionModel.getType()===Bn.FIXED&&this.reducePrecision(i),i},oe.prototype.reducePrecision=function(e){var i,h;if(e.coordinate)this.precisionModel.makePrecise(e.coordinate);else if(e.points)for(i=0,h=e.points.length;i<h;i++)this.precisionModel.makePrecise(e.points[i]);else if(e.geometries)for(i=0,h=e.geometries.length;i<h;i++)this.reducePrecision(e.geometries[i])};var Se=function(){this.parser=new L(this.geometryFactory)};Se.prototype.write=function(e){return this.parser.write(e)};var Bt=function(){},Te={ON:{configurable:!0},LEFT:{configurable:!0},RIGHT:{configurable:!0}};Bt.prototype.interfaces_=function(){return[]},Bt.prototype.getClass=function(){return Bt},Bt.opposite=function(e){return e===Bt.LEFT?Bt.RIGHT:e===Bt.RIGHT?Bt.LEFT:e},Te.ON.get=function(){return 0},Te.LEFT.get=function(){return 1},Te.RIGHT.get=function(){return 2},Object.defineProperties(Bt,Te),(j.prototype=new Error).name="EmptyStackException",(it.prototype=new xn).add=function(e){return this.array_.push(e),!0},it.prototype.get=function(e){if(e<0||e>=this.size())throw new Error;return this.array_[e]},it.prototype.push=function(e){return this.array_.push(e),e},it.prototype.pop=function(e){if(0===this.array_.length)throw new j;return this.array_.pop()},it.prototype.peek=function(){if(0===this.array_.length)throw new j;return this.array_[this.array_.length-1]},it.prototype.empty=function(){return 0===this.array_.length},it.prototype.isEmpty=function(){return this.empty()},it.prototype.search=function(e){return this.array_.indexOf(e)},it.prototype.size=function(){return this.array_.length},it.prototype.toArray=function(){for(var e=[],i=0,h=this.array_.length;i<h;i++)e.push(this.array_[i]);return e};var ur=function(){this._minIndex=-1,this._minCoord=null,this._minDe=null,this._orientedDe=null};ur.prototype.getCoordinate=function(){return this._minCoord},ur.prototype.getRightmostSide=function(e,i){var h=this.getRightmostSideOfSegment(e,i);return h<0&&(h=this.getRightmostSideOfSegment(e,i-1)),h<0&&(this._minCoord=null,this.checkForRightmostCoordinate(e)),h},ur.prototype.findRightmostEdgeAtVertex=function(){var e=this._minDe.getEdge().getCoordinates();ot.isTrue(this._minIndex>0&&this._minIndex<e.length,"rightmost point expected to be interior vertex of edge");var i=e[this._minIndex-1],h=e[this._minIndex+1],d=Ge.computeOrientation(this._minCoord,h,i),x=!1;(i.y<this._minCoord.y&&h.y<this._minCoord.y&&d===Ge.COUNTERCLOCKWISE||i.y>this._minCoord.y&&h.y>this._minCoord.y&&d===Ge.CLOCKWISE)&&(x=!0),x&&(this._minIndex=this._minIndex-1)},ur.prototype.getRightmostSideOfSegment=function(e,i){var h=e.getEdge().getCoordinates();if(i<0||i+1>=h.length||h[i].y===h[i+1].y)return-1;var d=Bt.LEFT;return h[i].y<h[i+1].y&&(d=Bt.RIGHT),d},ur.prototype.getEdge=function(){return this._orientedDe},ur.prototype.checkForRightmostCoordinate=function(e){for(var i=e.getEdge().getCoordinates(),h=0;h<i.length-1;h++)(null===this._minCoord||i[h].x>this._minCoord.x)&&(this._minDe=e,this._minIndex=h,this._minCoord=i[h])},ur.prototype.findRightmostEdgeAtNode=function(){var e=this._minDe.getNode().getEdges();this._minDe=e.getRightmostEdge(),this._minDe.isForward()||(this._minDe=this._minDe.getSym(),this._minIndex=this._minDe.getEdge().getCoordinates().length-1)},ur.prototype.findEdge=function(e){for(var i=e.iterator();i.hasNext();){var h=i.next();h.isForward()&&this.checkForRightmostCoordinate(h)}ot.isTrue(0!==this._minIndex||this._minCoord.equals(this._minDe.getCoordinate()),"inconsistency in rightmost processing"),0===this._minIndex?this.findRightmostEdgeAtNode():this.findRightmostEdgeAtVertex(),this._orientedDe=this._minDe,this.getRightmostSide(this._minDe,this._minIndex)===Bt.LEFT&&(this._orientedDe=this._minDe.getSym())},ur.prototype.interfaces_=function(){return[]},ur.prototype.getClass=function(){return ur};var ar=function(e){function i(h,d){e.call(this,i.msgWithCoord(h,d)),this.pt=d?new Z(d):null,this.name="TopologyException"}return e&&(i.__proto__=e),(i.prototype=Object.create(e&&e.prototype)).constructor=i,i.prototype.getCoordinate=function(){return this.pt},i.prototype.interfaces_=function(){return[]},i.prototype.getClass=function(){return i},i.msgWithCoord=function(h,d){return d?h:h+" [ "+d+" ]"},i}(ut),kr=function(){this.array_=[]};kr.prototype.addLast=function(e){this.array_.push(e)},kr.prototype.removeFirst=function(){return this.array_.shift()},kr.prototype.isEmpty=function(){return 0===this.array_.length};var Ae=function(){this._finder=null,this._dirEdgeList=new cr,this._nodes=new cr,this._rightMostCoord=null,this._env=null,this._finder=new ur};Ae.prototype.clearVisitedEdges=function(){for(var e=this._dirEdgeList.iterator();e.hasNext();)e.next().setVisited(!1)},Ae.prototype.getRightmostCoordinate=function(){return this._rightMostCoord},Ae.prototype.computeNodeDepth=function(e){for(var i=null,h=e.getEdges().iterator();h.hasNext();){var d=h.next();if(d.isVisited()||d.getSym().isVisited()){i=d;break}}if(null===i)throw new ar("unable to find edge to compute depths at "+e.getCoordinate());e.getEdges().computeDepths(i);for(var x=e.getEdges().iterator();x.hasNext();){var D=x.next();D.setVisited(!0),this.copySymDepths(D)}},Ae.prototype.computeDepth=function(e){this.clearVisitedEdges();var i=this._finder.getEdge();i.setEdgeDepths(Bt.RIGHT,e),this.copySymDepths(i),this.computeDepths(i)},Ae.prototype.create=function(e){this.addReachable(e),this._finder.findEdge(this._dirEdgeList),this._rightMostCoord=this._finder.getCoordinate()},Ae.prototype.findResultEdges=function(){for(var e=this._dirEdgeList.iterator();e.hasNext();){var i=e.next();i.getDepth(Bt.RIGHT)>=1&&i.getDepth(Bt.LEFT)<=0&&!i.isInteriorAreaEdge()&&i.setInResult(!0)}},Ae.prototype.computeDepths=function(e){var i=new ue,h=new kr,d=e.getNode();for(h.addLast(d),i.add(d),e.setVisited(!0);!h.isEmpty();){var x=h.removeFirst();i.add(x),this.computeNodeDepth(x);for(var D=x.getEdges().iterator();D.hasNext();){var F=D.next().getSym();if(!F.isVisited()){var $=F.getNode();i.contains($)||(h.addLast($),i.add($))}}}},Ae.prototype.compareTo=function(e){return this._rightMostCoord.x<e._rightMostCoord.x?-1:this._rightMostCoord.x>e._rightMostCoord.x?1:0},Ae.prototype.getEnvelope=function(){if(null===this._env){for(var e=new He,i=this._dirEdgeList.iterator();i.hasNext();)for(var h=i.next().getEdge().getCoordinates(),d=0;d<h.length-1;d++)e.expandToInclude(h[d]);this._env=e}return this._env},Ae.prototype.addReachable=function(e){var i=new it;for(i.add(e);!i.empty();){var h=i.pop();this.add(h,i)}},Ae.prototype.copySymDepths=function(e){var i=e.getSym();i.setDepth(Bt.LEFT,e.getDepth(Bt.RIGHT)),i.setDepth(Bt.RIGHT,e.getDepth(Bt.LEFT))},Ae.prototype.add=function(e,i){e.setVisited(!0),this._nodes.add(e);for(var h=e.getEdges().iterator();h.hasNext();){var d=h.next();this._dirEdgeList.add(d);var x=d.getSym().getNode();x.isVisited()||i.push(x)}},Ae.prototype.getNodes=function(){return this._nodes},Ae.prototype.getDirectedEdges=function(){return this._dirEdgeList},Ae.prototype.interfaces_=function(){return[J]},Ae.prototype.getClass=function(){return Ae};var or=function e(){if(this.location=null,1===arguments.length){if(arguments[0]instanceof Array)this.init(arguments[0].length);else if(Number.isInteger(arguments[0])){var h=arguments[0];this.init(1),this.location[Bt.ON]=h}else if(arguments[0]instanceof e){var d=arguments[0];if(this.init(d.location.length),null!==d)for(var x=0;x<this.location.length;x++)this.location[x]=d.location[x]}}else if(3===arguments.length){var D=arguments[0],F=arguments[1],$=arguments[2];this.init(3),this.location[Bt.ON]=D,this.location[Bt.LEFT]=F,this.location[Bt.RIGHT]=$}};or.prototype.setAllLocations=function(e){for(var i=0;i<this.location.length;i++)this.location[i]=e},or.prototype.isNull=function(){for(var e=0;e<this.location.length;e++)if(this.location[e]!==dt.NONE)return!1;return!0},or.prototype.setAllLocationsIfNull=function(e){for(var i=0;i<this.location.length;i++)this.location[i]===dt.NONE&&(this.location[i]=e)},or.prototype.isLine=function(){return 1===this.location.length},or.prototype.merge=function(e){if(e.location.length>this.location.length){var i=new Array(3).fill(null);i[Bt.ON]=this.location[Bt.ON],i[Bt.LEFT]=dt.NONE,i[Bt.RIGHT]=dt.NONE,this.location=i}for(var h=0;h<this.location.length;h++)this.location[h]===dt.NONE&&h<e.location.length&&(this.location[h]=e.location[h])},or.prototype.getLocations=function(){return this.location},or.prototype.flip=function(){if(this.location.length<=1)return null;var e=this.location[Bt.LEFT];this.location[Bt.LEFT]=this.location[Bt.RIGHT],this.location[Bt.RIGHT]=e},or.prototype.toString=function(){var e=new At;return this.location.length>1&&e.append(dt.toLocationSymbol(this.location[Bt.LEFT])),e.append(dt.toLocationSymbol(this.location[Bt.ON])),this.location.length>1&&e.append(dt.toLocationSymbol(this.location[Bt.RIGHT])),e.toString()},or.prototype.setLocations=function(e,i,h){this.location[Bt.ON]=e,this.location[Bt.LEFT]=i,this.location[Bt.RIGHT]=h},or.prototype.get=function(e){return e<this.location.length?this.location[e]:dt.NONE},or.prototype.isArea=function(){return this.location.length>1},or.prototype.isAnyNull=function(){for(var e=0;e<this.location.length;e++)if(this.location[e]===dt.NONE)return!0;return!1},or.prototype.setLocation=function(){1===arguments.length?this.setLocation(Bt.ON,arguments[0]):2===arguments.length&&(this.location[arguments[0]]=arguments[1])},or.prototype.init=function(e){this.location=new Array(e).fill(null),this.setAllLocations(dt.NONE)},or.prototype.isEqualOnSide=function(e,i){return this.location[i]===e.location[i]},or.prototype.allPositionsEqual=function(e){for(var i=0;i<this.location.length;i++)if(this.location[i]!==e)return!1;return!0},or.prototype.interfaces_=function(){return[]},or.prototype.getClass=function(){return or};var lr=function e(){if(this.elt=new Array(2).fill(null),1===arguments.length){if(Number.isInteger(arguments[0])){var i=arguments[0];this.elt[0]=new or(i),this.elt[1]=new or(i)}else if(arguments[0]instanceof e){var h=arguments[0];this.elt[0]=new or(h.elt[0]),this.elt[1]=new or(h.elt[1])}}else if(2===arguments.length){var d=arguments[0],x=arguments[1];this.elt[0]=new or(dt.NONE),this.elt[1]=new or(dt.NONE),this.elt[d].setLocation(x)}else if(3===arguments.length){var D=arguments[0],F=arguments[1],$=arguments[2];this.elt[0]=new or(D,F,$),this.elt[1]=new or(D,F,$)}else if(4===arguments.length){var Ct=arguments[0],te=arguments[1],Ne=arguments[2],Ve=arguments[3];this.elt[0]=new or(dt.NONE,dt.NONE,dt.NONE),this.elt[1]=new or(dt.NONE,dt.NONE,dt.NONE),this.elt[Ct].setLocations(te,Ne,Ve)}};lr.prototype.getGeometryCount=function(){var e=0;return this.elt[0].isNull()||e++,this.elt[1].isNull()||e++,e},lr.prototype.setAllLocations=function(e,i){this.elt[e].setAllLocations(i)},lr.prototype.isNull=function(e){return this.elt[e].isNull()},lr.prototype.setAllLocationsIfNull=function(){if(1===arguments.length){var e=arguments[0];this.setAllLocationsIfNull(0,e),this.setAllLocationsIfNull(1,e)}else 2===arguments.length&&this.elt[arguments[0]].setAllLocationsIfNull(arguments[1])},lr.prototype.isLine=function(e){return this.elt[e].isLine()},lr.prototype.merge=function(e){for(var i=0;i<2;i++)null===this.elt[i]&&null!==e.elt[i]?this.elt[i]=new or(e.elt[i]):this.elt[i].merge(e.elt[i])},lr.prototype.flip=function(){this.elt[0].flip(),this.elt[1].flip()},lr.prototype.getLocation=function(){return 1===arguments.length?this.elt[arguments[0]].get(Bt.ON):2===arguments.length?this.elt[arguments[0]].get(arguments[1]):void 0},lr.prototype.toString=function(){var e=new At;return null!==this.elt[0]&&(e.append("A:"),e.append(this.elt[0].toString())),null!==this.elt[1]&&(e.append(" B:"),e.append(this.elt[1].toString())),e.toString()},lr.prototype.isArea=function(){return 0===arguments.length?this.elt[0].isArea()||this.elt[1].isArea():1===arguments.length?this.elt[arguments[0]].isArea():void 0},lr.prototype.isAnyNull=function(e){return this.elt[e].isAnyNull()},lr.prototype.setLocation=function(){2===arguments.length?this.elt[arguments[0]].setLocation(Bt.ON,arguments[1]):3===arguments.length&&this.elt[arguments[0]].setLocation(arguments[1],arguments[2])},lr.prototype.isEqualOnSide=function(e,i){return this.elt[0].isEqualOnSide(e.elt[0],i)&&this.elt[1].isEqualOnSide(e.elt[1],i)},lr.prototype.allPositionsEqual=function(e,i){return this.elt[e].allPositionsEqual(i)},lr.prototype.toLine=function(e){this.elt[e].isArea()&&(this.elt[e]=new or(this.elt[e].location[0]))},lr.prototype.interfaces_=function(){return[]},lr.prototype.getClass=function(){return lr},lr.toLineLabel=function(e){for(var i=new lr(dt.NONE),h=0;h<2;h++)i.setLocation(h,e.getLocation(h));return i};var Rr=function(){this._startDe=null,this._maxNodeDegree=-1,this._edges=new cr,this._pts=new cr,this._label=new lr(dt.NONE),this._ring=null,this._isHole=null,this._shell=null,this._holes=new cr,this._geometryFactory=null;var e=arguments[0];this._geometryFactory=arguments[1],this.computePoints(e),this.computeRing()};Rr.prototype.computeRing=function(){if(null!==this._ring)return null;for(var e=new Array(this._pts.size()).fill(null),i=0;i<this._pts.size();i++)e[i]=this._pts.get(i);this._ring=this._geometryFactory.createLinearRing(e),this._isHole=Ge.isCCW(this._ring.getCoordinates())},Rr.prototype.isIsolated=function(){return 1===this._label.getGeometryCount()},Rr.prototype.computePoints=function(e){this._startDe=e;var i=e,h=!0;do{if(null===i)throw new ar("Found null DirectedEdge");if(i.getEdgeRing()===this)throw new ar("Directed Edge visited twice during ring-building at "+i.getCoordinate());this._edges.add(i);var d=i.getLabel();ot.isTrue(d.isArea()),this.mergeLabel(d),this.addPoints(i.getEdge(),i.isForward(),h),h=!1,this.setEdgeRing(i,this),i=this.getNext(i)}while(i!==this._startDe)},Rr.prototype.getLinearRing=function(){return this._ring},Rr.prototype.getCoordinate=function(e){return this._pts.get(e)},Rr.prototype.computeMaxNodeDegree=function(){this._maxNodeDegree=0;var e=this._startDe;do{var i=e.getNode().getEdges().getOutgoingDegree(this);i>this._maxNodeDegree&&(this._maxNodeDegree=i),e=this.getNext(e)}while(e!==this._startDe);this._maxNodeDegree*=2},Rr.prototype.addPoints=function(e,i,h){var d=e.getCoordinates();if(i){var x=1;h&&(x=0);for(var D=x;D<d.length;D++)this._pts.add(d[D])}else{var F=d.length-2;h&&(F=d.length-1);for(var $=F;$>=0;$--)this._pts.add(d[$])}},Rr.prototype.isHole=function(){return this._isHole},Rr.prototype.setInResult=function(){var e=this._startDe;do{e.getEdge().setInResult(!0),e=e.getNext()}while(e!==this._startDe)},Rr.prototype.containsPoint=function(e){var i=this.getLinearRing();if(!i.getEnvelopeInternal().contains(e)||!Ge.isPointInRing(e,i.getCoordinates()))return!1;for(var h=this._holes.iterator();h.hasNext();)if(h.next().containsPoint(e))return!1;return!0},Rr.prototype.addHole=function(e){this._holes.add(e)},Rr.prototype.isShell=function(){return null===this._shell},Rr.prototype.getLabel=function(){return this._label},Rr.prototype.getEdges=function(){return this._edges},Rr.prototype.getMaxNodeDegree=function(){return this._maxNodeDegree<0&&this.computeMaxNodeDegree(),this._maxNodeDegree},Rr.prototype.getShell=function(){return this._shell},Rr.prototype.mergeLabel=function(){if(1===arguments.length){var e=arguments[0];this.mergeLabel(e,0),this.mergeLabel(e,1)}else if(2===arguments.length){var h=arguments[1],d=arguments[0].getLocation(h,Bt.RIGHT);if(d===dt.NONE)return null;if(this._label.getLocation(h)===dt.NONE)return this._label.setLocation(h,d),null}},Rr.prototype.setShell=function(e){this._shell=e,null!==e&&e.addHole(this)},Rr.prototype.toPolygon=function(e){for(var i=new Array(this._holes.size()).fill(null),h=0;h<this._holes.size();h++)i[h]=this._holes.get(h).getLinearRing();return e.createPolygon(this.getLinearRing(),i)},Rr.prototype.interfaces_=function(){return[]},Rr.prototype.getClass=function(){return Rr};var Cn=function(e){function i(){e.call(this,arguments[0],arguments[1])}return e&&(i.__proto__=e),(i.prototype=Object.create(e&&e.prototype)).constructor=i,i.prototype.setEdgeRing=function(h,d){h.setMinEdgeRing(d)},i.prototype.getNext=function(h){return h.getNextMin()},i.prototype.interfaces_=function(){return[]},i.prototype.getClass=function(){return i},i}(Rr),Jo=function(e){function i(){e.call(this,arguments[0],arguments[1])}return e&&(i.__proto__=e),(i.prototype=Object.create(e&&e.prototype)).constructor=i,i.prototype.buildMinimalRings=function(){var h=new cr,d=this._startDe;do{if(null===d.getMinEdgeRing()){var x=new Cn(d,this._geometryFactory);h.add(x)}d=d.getNext()}while(d!==this._startDe);return h},i.prototype.setEdgeRing=function(h,d){h.setEdgeRing(d)},i.prototype.linkDirectedEdgesForMinimalEdgeRings=function(){var h=this._startDe;do{h.getNode().getEdges().linkMinimalDirectedEdges(this),h=h.getNext()}while(h!==this._startDe)},i.prototype.getNext=function(h){return h.getNext()},i.prototype.interfaces_=function(){return[]},i.prototype.getClass=function(){return i},i}(Rr),$e=function(){this._label=null,this._isInResult=!1,this._isCovered=!1,this._isCoveredSet=!1,this._isVisited=!1,0!==arguments.length&&1===arguments.length&&(this._label=arguments[0])};$e.prototype.setVisited=function(e){this._isVisited=e},$e.prototype.setInResult=function(e){this._isInResult=e},$e.prototype.isCovered=function(){return this._isCovered},$e.prototype.isCoveredSet=function(){return this._isCoveredSet},$e.prototype.setLabel=function(e){this._label=e},$e.prototype.getLabel=function(){return this._label},$e.prototype.setCovered=function(e){this._isCovered=e,this._isCoveredSet=!0},$e.prototype.updateIM=function(e){ot.isTrue(this._label.getGeometryCount()>=2,"found partial label"),this.computeIM(e)},$e.prototype.isInResult=function(){return this._isInResult},$e.prototype.isVisited=function(){return this._isVisited},$e.prototype.interfaces_=function(){return[]},$e.prototype.getClass=function(){return $e};var Vr=function(e){function i(){e.call(this),this._coord=null,this._edges=null;var d=arguments[1];this._coord=arguments[0],this._edges=d,this._label=new lr(0,dt.NONE)}return e&&(i.__proto__=e),(i.prototype=Object.create(e&&e.prototype)).constructor=i,i.prototype.isIncidentEdgeInResult=function(){for(var h=this.getEdges().getEdges().iterator();h.hasNext();)if(h.next().getEdge().isInResult())return!0;return!1},i.prototype.isIsolated=function(){return 1===this._label.getGeometryCount()},i.prototype.getCoordinate=function(){return this._coord},i.prototype.print=function(h){h.println("node "+this._coord+" lbl: "+this._label)},i.prototype.computeIM=function(h){},i.prototype.computeMergedLocation=function(h,d){var x=dt.NONE;if(x=this._label.getLocation(d),!h.isNull(d)){var D=h.getLocation(d);x!==dt.BOUNDARY&&(x=D)}return x},i.prototype.setLabel=function(){if(2!==arguments.length)return e.prototype.setLabel.apply(this,arguments);var h=arguments[0],d=arguments[1];null===this._label?this._label=new lr(h,d):this._label.setLocation(h,d)},i.prototype.getEdges=function(){return this._edges},i.prototype.mergeLabel=function(){if(arguments[0]instanceof i)this.mergeLabel(arguments[0]._label);else if(arguments[0]instanceof lr)for(var d=arguments[0],x=0;x<2;x++){var D=this.computeMergedLocation(d,x);this._label.getLocation(x)===dt.NONE&&this._label.setLocation(x,D)}},i.prototype.add=function(h){this._edges.insert(h),h.setNode(this)},i.prototype.setLabelBoundary=function(h){if(null===this._label)return null;var d=dt.NONE;null!==this._label&&(d=this._label.getLocation(h)),this._label.setLocation(h,d===dt.BOUNDARY?dt.INTERIOR:dt.BOUNDARY)},i.prototype.interfaces_=function(){return[]},i.prototype.getClass=function(){return i},i}($e),Kn=function(){this.nodeMap=new mt,this.nodeFact=null,this.nodeFact=arguments[0]};Kn.prototype.find=function(e){return this.nodeMap.get(e)},Kn.prototype.addNode=function(){if(arguments[0]instanceof Z){var e=arguments[0],i=this.nodeMap.get(e);return null===i&&(i=this.nodeFact.createNode(e),this.nodeMap.put(e,i)),i}if(arguments[0]instanceof Vr){var h=arguments[0],d=this.nodeMap.get(h.getCoordinate());return null===d?(this.nodeMap.put(h.getCoordinate(),h),h):(d.mergeLabel(h),d)}},Kn.prototype.print=function(e){for(var i=this.iterator();i.hasNext();)i.next().print(e)},Kn.prototype.iterator=function(){return this.nodeMap.values().iterator()},Kn.prototype.values=function(){return this.nodeMap.values()},Kn.prototype.getBoundaryNodes=function(e){for(var i=new cr,h=this.iterator();h.hasNext();){var d=h.next();d.getLabel().getLocation(e)===dt.BOUNDARY&&i.add(d)}return i},Kn.prototype.add=function(e){var i=e.getCoordinate();this.addNode(i).add(e)},Kn.prototype.interfaces_=function(){return[]},Kn.prototype.getClass=function(){return Kn};var rn=function(){},ci={NE:{configurable:!0},NW:{configurable:!0},SW:{configurable:!0},SE:{configurable:!0}};rn.prototype.interfaces_=function(){return[]},rn.prototype.getClass=function(){return rn},rn.isNorthern=function(e){return e===rn.NE||e===rn.NW},rn.isOpposite=function(e,i){return e!==i&&(e-i+4)%4==2},rn.commonHalfPlane=function(e,i){if(e===i)return e;if((e-i+4)%4==2)return-1;var h=e<i?e:i;return 0===h&&3===(e>i?e:i)?3:h},rn.isInHalfPlane=function(e,i){return i===rn.SE?e===rn.SE||e===rn.SW:e===i||e===i+1},rn.quadrant=function(){if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){var e=arguments[0],i=arguments[1];if(0===e&&0===i)throw new tt("Cannot compute the quadrant for point ( "+e+", "+i+" )");return e>=0?i>=0?rn.NE:rn.SE:i>=0?rn.NW:rn.SW}if(arguments[0]instanceof Z&&arguments[1]instanceof Z){var h=arguments[0],d=arguments[1];if(d.x===h.x&&d.y===h.y)throw new tt("Cannot compute the quadrant for two identical points "+h);return d.x>=h.x?d.y>=h.y?rn.NE:rn.SE:d.y>=h.y?rn.NW:rn.SW}},ci.NE.get=function(){return 0},ci.NW.get=function(){return 1},ci.SW.get=function(){return 2},ci.SE.get=function(){return 3},Object.defineProperties(rn,ci);var Cr=function(){if(this._edge=null,this._label=null,this._node=null,this._p0=null,this._p1=null,this._dx=null,this._dy=null,this._quadrant=null,1===arguments.length)this._edge=arguments[0];else if(3===arguments.length){var h=arguments[1],d=arguments[2];this._edge=arguments[0],this.init(h,d),this._label=null}else if(4===arguments.length){var D=arguments[1],F=arguments[2],$=arguments[3];this._edge=arguments[0],this.init(D,F),this._label=$}};Cr.prototype.compareDirection=function(e){return this._dx===e._dx&&this._dy===e._dy?0:this._quadrant>e._quadrant?1:this._quadrant<e._quadrant?-1:Ge.computeOrientation(e._p0,e._p1,this._p1)},Cr.prototype.getDy=function(){return this._dy},Cr.prototype.getCoordinate=function(){return this._p0},Cr.prototype.setNode=function(e){this._node=e},Cr.prototype.print=function(e){var i=Math.atan2(this._dy,this._dx),h=this.getClass().getName(),d=h.lastIndexOf("."),x=h.substring(d+1);e.print("  "+x+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+i+"   "+this._label)},Cr.prototype.compareTo=function(e){return this.compareDirection(e)},Cr.prototype.getDirectedCoordinate=function(){return this._p1},Cr.prototype.getDx=function(){return this._dx},Cr.prototype.getLabel=function(){return this._label},Cr.prototype.getEdge=function(){return this._edge},Cr.prototype.getQuadrant=function(){return this._quadrant},Cr.prototype.getNode=function(){return this._node},Cr.prototype.toString=function(){var e=Math.atan2(this._dy,this._dx),i=this.getClass().getName(),h=i.lastIndexOf(".");return"  "+i.substring(h+1)+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+e+"   "+this._label},Cr.prototype.computeLabel=function(e){},Cr.prototype.init=function(e,i){this._p0=e,this._p1=i,this._dx=i.x-e.x,this._dy=i.y-e.y,this._quadrant=rn.quadrant(this._dx,this._dy),ot.isTrue(!(0===this._dx&&0===this._dy),"EdgeEnd with identical endpoints found")},Cr.prototype.interfaces_=function(){return[J]},Cr.prototype.getClass=function(){return Cr};var us=function(e){function i(){var h=arguments[0],d=arguments[1];if(e.call(this,h),this._isForward=null,this._isInResult=!1,this._isVisited=!1,this._sym=null,this._next=null,this._nextMin=null,this._edgeRing=null,this._minEdgeRing=null,this._depth=[0,-999,-999],this._isForward=d,d)this.init(h.getCoordinate(0),h.getCoordinate(1));else{var x=h.getNumPoints()-1;this.init(h.getCoordinate(x),h.getCoordinate(x-1))}this.computeDirectedLabel()}return e&&(i.__proto__=e),(i.prototype=Object.create(e&&e.prototype)).constructor=i,i.prototype.getNextMin=function(){return this._nextMin},i.prototype.getDepth=function(h){return this._depth[h]},i.prototype.setVisited=function(h){this._isVisited=h},i.prototype.computeDirectedLabel=function(){this._label=new lr(this._edge.getLabel()),this._isForward||this._label.flip()},i.prototype.getNext=function(){return this._next},i.prototype.setDepth=function(h,d){if(-999!==this._depth[h]&&this._depth[h]!==d)throw new ar("assigned depths do not match",this.getCoordinate());this._depth[h]=d},i.prototype.isInteriorAreaEdge=function(){for(var h=!0,d=0;d<2;d++)this._label.isArea(d)&&this._label.getLocation(d,Bt.LEFT)===dt.INTERIOR&&this._label.getLocation(d,Bt.RIGHT)===dt.INTERIOR||(h=!1);return h},i.prototype.setNextMin=function(h){this._nextMin=h},i.prototype.print=function(h){e.prototype.print.call(this,h),h.print(" "+this._depth[Bt.LEFT]+"/"+this._depth[Bt.RIGHT]),h.print(" ("+this.getDepthDelta()+")"),this._isInResult&&h.print(" inResult")},i.prototype.setMinEdgeRing=function(h){this._minEdgeRing=h},i.prototype.isLineEdge=function(){var h=this._label.isLine(0)||this._label.isLine(1),d=!this._label.isArea(0)||this._label.allPositionsEqual(0,dt.EXTERIOR),x=!this._label.isArea(1)||this._label.allPositionsEqual(1,dt.EXTERIOR);return h&&d&&x},i.prototype.setEdgeRing=function(h){this._edgeRing=h},i.prototype.getMinEdgeRing=function(){return this._minEdgeRing},i.prototype.getDepthDelta=function(){var h=this._edge.getDepthDelta();return this._isForward||(h=-h),h},i.prototype.setInResult=function(h){this._isInResult=h},i.prototype.getSym=function(){return this._sym},i.prototype.isForward=function(){return this._isForward},i.prototype.getEdge=function(){return this._edge},i.prototype.printEdge=function(h){this.print(h),h.print(" "),this._isForward?this._edge.print(h):this._edge.printReverse(h)},i.prototype.setSym=function(h){this._sym=h},i.prototype.setVisitedEdge=function(h){this.setVisited(h),this._sym.setVisited(h)},i.prototype.setEdgeDepths=function(h,d){var x=this.getEdge().getDepthDelta();this._isForward||(x=-x);var D=1;h===Bt.LEFT&&(D=-1);var F=Bt.opposite(h),$=d+x*D;this.setDepth(h,d),this.setDepth(F,$)},i.prototype.getEdgeRing=function(){return this._edgeRing},i.prototype.isInResult=function(){return this._isInResult},i.prototype.setNext=function(h){this._next=h},i.prototype.isVisited=function(){return this._isVisited},i.prototype.interfaces_=function(){return[]},i.prototype.getClass=function(){return i},i.depthFactor=function(h,d){return h===dt.EXTERIOR&&d===dt.INTERIOR?1:h===dt.INTERIOR&&d===dt.EXTERIOR?-1:0},i}(Cr),ls=function(){};ls.prototype.createNode=function(e){return new Vr(e,null)},ls.prototype.interfaces_=function(){return[]},ls.prototype.getClass=function(){return ls};var qr=function(){this._edges=new cr,this._nodes=null,this._edgeEndList=new cr,0===arguments.length?this._nodes=new Kn(new ls):1===arguments.length&&(this._nodes=new Kn(arguments[0]))};qr.prototype.printEdges=function(e){e.println("Edges:");for(var i=0;i<this._edges.size();i++){e.println("edge "+i+":");var h=this._edges.get(i);h.print(e),h.eiList.print(e)}},qr.prototype.find=function(e){return this._nodes.find(e)},qr.prototype.addNode=function(){return arguments[0]instanceof Vr||arguments[0]instanceof Z?this._nodes.addNode(arguments[0]):void 0},qr.prototype.getNodeIterator=function(){return this._nodes.iterator()},qr.prototype.linkResultDirectedEdges=function(){for(var e=this._nodes.iterator();e.hasNext();)e.next().getEdges().linkResultDirectedEdges()},qr.prototype.debugPrintln=function(e){jr.out.println(e)},qr.prototype.isBoundaryNode=function(e,i){var h=this._nodes.find(i);if(null===h)return!1;var d=h.getLabel();return null!==d&&d.getLocation(e)===dt.BOUNDARY},qr.prototype.linkAllDirectedEdges=function(){for(var e=this._nodes.iterator();e.hasNext();)e.next().getEdges().linkAllDirectedEdges()},qr.prototype.matchInSameDirection=function(e,i,h,d){return!!e.equals(h)&&Ge.computeOrientation(e,i,d)===Ge.COLLINEAR&&rn.quadrant(e,i)===rn.quadrant(h,d)},qr.prototype.getEdgeEnds=function(){return this._edgeEndList},qr.prototype.debugPrint=function(e){jr.out.print(e)},qr.prototype.getEdgeIterator=function(){return this._edges.iterator()},qr.prototype.findEdgeInSameDirection=function(e,i){for(var h=0;h<this._edges.size();h++){var d=this._edges.get(h),x=d.getCoordinates();if(this.matchInSameDirection(e,i,x[0],x[1])||this.matchInSameDirection(e,i,x[x.length-1],x[x.length-2]))return d}return null},qr.prototype.insertEdge=function(e){this._edges.add(e)},qr.prototype.findEdgeEnd=function(e){for(var i=this.getEdgeEnds().iterator();i.hasNext();){var h=i.next();if(h.getEdge()===e)return h}return null},qr.prototype.addEdges=function(e){for(var i=e.iterator();i.hasNext();){var h=i.next();this._edges.add(h);var d=new us(h,!0),x=new us(h,!1);d.setSym(x),x.setSym(d),this.add(d),this.add(x)}},qr.prototype.add=function(e){this._nodes.add(e),this._edgeEndList.add(e)},qr.prototype.getNodes=function(){return this._nodes.values()},qr.prototype.findEdge=function(e,i){for(var h=0;h<this._edges.size();h++){var d=this._edges.get(h),x=d.getCoordinates();if(e.equals(x[0])&&i.equals(x[1]))return d}return null},qr.prototype.interfaces_=function(){return[]},qr.prototype.getClass=function(){return qr},qr.linkResultDirectedEdges=function(e){for(var i=e.iterator();i.hasNext();)i.next().getEdges().linkResultDirectedEdges()};var Bi=function(){this._geometryFactory=null,this._shellList=new cr,this._geometryFactory=arguments[0]};Bi.prototype.sortShellsAndHoles=function(e,i,h){for(var d=e.iterator();d.hasNext();){var x=d.next();x.isHole()?h.add(x):i.add(x)}},Bi.prototype.computePolygons=function(e){for(var i=new cr,h=e.iterator();h.hasNext();){var d=h.next().toPolygon(this._geometryFactory);i.add(d)}return i},Bi.prototype.placeFreeHoles=function(e,i){for(var h=i.iterator();h.hasNext();){var d=h.next();if(null===d.getShell()){var x=this.findEdgeRingContaining(d,e);if(null===x)throw new ar("unable to assign hole to a shell",d.getCoordinate(0));d.setShell(x)}}},Bi.prototype.buildMinimalEdgeRings=function(e,i,h){for(var d=new cr,x=e.iterator();x.hasNext();){var D=x.next();if(D.getMaxNodeDegree()>2){D.linkDirectedEdgesForMinimalEdgeRings();var F=D.buildMinimalRings(),$=this.findShell(F);null!==$?(this.placePolygonHoles($,F),i.add($)):h.addAll(F)}else d.add(D)}return d},Bi.prototype.containsPoint=function(e){for(var i=this._shellList.iterator();i.hasNext();)if(i.next().containsPoint(e))return!0;return!1},Bi.prototype.buildMaximalEdgeRings=function(e){for(var i=new cr,h=e.iterator();h.hasNext();){var d=h.next();if(d.isInResult()&&d.getLabel().isArea()&&null===d.getEdgeRing()){var x=new Jo(d,this._geometryFactory);i.add(x),x.setInResult()}}return i},Bi.prototype.placePolygonHoles=function(e,i){for(var h=i.iterator();h.hasNext();){var d=h.next();d.isHole()&&d.setShell(e)}},Bi.prototype.getPolygons=function(){return this.computePolygons(this._shellList)},Bi.prototype.findEdgeRingContaining=function(e,i){for(var h=e.getLinearRing(),d=h.getEnvelopeInternal(),x=h.getCoordinateN(0),D=null,F=null,$=i.iterator();$.hasNext();){var Ct=$.next(),te=Ct.getLinearRing(),Ne=te.getEnvelopeInternal();null!==D&&(F=D.getLinearRing().getEnvelopeInternal());var Ve=!1;Ne.contains(d)&&Ge.isPointInRing(x,te.getCoordinates())&&(Ve=!0),Ve&&(null===D||F.contains(Ne))&&(D=Ct)}return D},Bi.prototype.findShell=function(e){for(var i=0,h=null,d=e.iterator();d.hasNext();){var x=d.next();x.isHole()||(h=x,i++)}return ot.isTrue(i<=1,"found two shells in MinimalEdgeRing list"),h},Bi.prototype.add=function(){if(1===arguments.length){var e=arguments[0];this.add(e.getEdgeEnds(),e.getNodes())}else if(2===arguments.length){var i=arguments[0];qr.linkResultDirectedEdges(arguments[1]);var d=this.buildMaximalEdgeRings(i),x=new cr,D=this.buildMinimalEdgeRings(d,this._shellList,x);this.sortShellsAndHoles(D,this._shellList,x),this.placeFreeHoles(this._shellList,x)}},Bi.prototype.interfaces_=function(){return[]},Bi.prototype.getClass=function(){return Bi};var xo=function(){};xo.prototype.getBounds=function(){},xo.prototype.interfaces_=function(){return[]},xo.prototype.getClass=function(){return xo};var Uo=function(){this._bounds=null,this._item=null;var i=arguments[1];this._bounds=arguments[0],this._item=i};Uo.prototype.getItem=function(){return this._item},Uo.prototype.getBounds=function(){return this._bounds},Uo.prototype.interfaces_=function(){return[xo,gt]},Uo.prototype.getClass=function(){return Uo};var ho=function(){this._size=null,this._items=null,this._size=0,this._items=new cr,this._items.add(null)};ho.prototype.poll=function(){if(this.isEmpty())return null;var e=this._items.get(1);return this._items.set(1,this._items.get(this._size)),this._size-=1,this.reorder(1),e},ho.prototype.size=function(){return this._size},ho.prototype.reorder=function(e){for(var i=null,h=this._items.get(e);2*e<=this._size&&((i=2*e)!==this._size&&this._items.get(i+1).compareTo(this._items.get(i))<0&&i++,this._items.get(i).compareTo(h)<0);e=i)this._items.set(e,this._items.get(i));this._items.set(e,h)},ho.prototype.clear=function(){this._size=0,this._items.clear()},ho.prototype.isEmpty=function(){return 0===this._size},ho.prototype.add=function(e){this._items.add(null),this._size+=1;var i=this._size;for(this._items.set(0,e);e.compareTo(this._items.get(Math.trunc(i/2)))<0;i/=2)this._items.set(i,this._items.get(Math.trunc(i/2)));this._items.set(i,e)},ho.prototype.interfaces_=function(){return[]},ho.prototype.getClass=function(){return ho};var sa=function(){};sa.prototype.visitItem=function(e){},sa.prototype.interfaces_=function(){return[]},sa.prototype.getClass=function(){return sa};var Ks=function(){};Ks.prototype.insert=function(e,i){},Ks.prototype.remove=function(e,i){},Ks.prototype.query=function(){},Ks.prototype.interfaces_=function(){return[]},Ks.prototype.getClass=function(){return Ks};var Ho=function(){this._childBoundables=new cr,this._bounds=null,this._level=null,0!==arguments.length&&1===arguments.length&&(this._level=arguments[0])},Ui={serialVersionUID:{configurable:!0}};Ho.prototype.getLevel=function(){return this._level},Ho.prototype.size=function(){return this._childBoundables.size()},Ho.prototype.getChildBoundables=function(){return this._childBoundables},Ho.prototype.addChildBoundable=function(e){ot.isTrue(null===this._bounds),this._childBoundables.add(e)},Ho.prototype.isEmpty=function(){return this._childBoundables.isEmpty()},Ho.prototype.getBounds=function(){return null===this._bounds&&(this._bounds=this.computeBounds()),this._bounds},Ho.prototype.interfaces_=function(){return[xo,gt]},Ho.prototype.getClass=function(){return Ho},Ui.serialVersionUID.get=function(){return 0x5a1e55ec41369800},Object.defineProperties(Ho,Ui);var cs=function(){};cs.reverseOrder=function(){return{compare:function(e,i){return i.compareTo(e)}}},cs.min=function(e){return cs.sort(e),e.get(0)},cs.sort=function(e,i){var h=e.toArray();i?Me.sort(h,i):Me.sort(h);for(var d=e.iterator(),x=0,D=h.length;x<D;x++)d.next(),d.set(h[x])},cs.singletonList=function(e){var i=new cr;return i.add(e),i};var bo=function(){this._boundable1=null,this._boundable2=null,this._distance=null,this._itemDistance=null;var i=arguments[1],h=arguments[2];this._boundable1=arguments[0],this._boundable2=i,this._itemDistance=h,this._distance=this.distance()};bo.prototype.expandToQueue=function(e,i){var h=bo.isComposite(this._boundable1),d=bo.isComposite(this._boundable2);if(h&&d)return bo.area(this._boundable1)>bo.area(this._boundable2)?(this.expand(this._boundable1,this._boundable2,e,i),null):(this.expand(this._boundable2,this._boundable1,e,i),null);if(h)return this.expand(this._boundable1,this._boundable2,e,i),null;if(d)return this.expand(this._boundable2,this._boundable1,e,i),null;throw new tt("neither boundable is composite")},bo.prototype.isLeaves=function(){return!(bo.isComposite(this._boundable1)||bo.isComposite(this._boundable2))},bo.prototype.compareTo=function(e){return this._distance<e._distance?-1:this._distance>e._distance?1:0},bo.prototype.expand=function(e,i,h,d){for(var x=e.getChildBoundables().iterator();x.hasNext();){var D=x.next(),F=new bo(D,i,this._itemDistance);F.getDistance()<d&&h.add(F)}},bo.prototype.getBoundable=function(e){return 0===e?this._boundable1:this._boundable2},bo.prototype.getDistance=function(){return this._distance},bo.prototype.distance=function(){return this.isLeaves()?this._itemDistance.distance(this._boundable1,this._boundable2):this._boundable1.getBounds().distance(this._boundable2.getBounds())},bo.prototype.interfaces_=function(){return[J]},bo.prototype.getClass=function(){return bo},bo.area=function(e){return e.getBounds().getArea()},bo.isComposite=function(e){return e instanceof Ho};var qo=function e(){if(this._root=null,this._built=!1,this._itemBoundables=new cr,this._nodeCapacity=null,0===arguments.length)this._nodeCapacity=e.DEFAULT_NODE_CAPACITY;else if(1===arguments.length){var h=arguments[0];ot.isTrue(h>1,"Node capacity must be greater than 1"),this._nodeCapacity=h}},Fu={IntersectsOp:{configurable:!0},serialVersionUID:{configurable:!0},DEFAULT_NODE_CAPACITY:{configurable:!0}};qo.prototype.getNodeCapacity=function(){return this._nodeCapacity},qo.prototype.lastNode=function(e){return e.get(e.size()-1)},qo.prototype.size=function(){if(0===arguments.length)return this.isEmpty()?0:(this.build(),this.size(this._root));if(1===arguments.length){for(var e=0,i=arguments[0].getChildBoundables().iterator();i.hasNext();){var h=i.next();h instanceof Ho?e+=this.size(h):h instanceof Uo&&(e+=1)}return e}},qo.prototype.removeItem=function(e,i){for(var h=null,d=e.getChildBoundables().iterator();d.hasNext();){var x=d.next();x instanceof Uo&&x.getItem()===i&&(h=x)}return null!==h&&(e.getChildBoundables().remove(h),!0)},qo.prototype.itemsTree=function(){if(0===arguments.length){this.build();var e=this.itemsTree(this._root);return null===e?new cr:e}if(1===arguments.length){for(var i=arguments[0],h=new cr,d=i.getChildBoundables().iterator();d.hasNext();){var x=d.next();if(x instanceof Ho){var D=this.itemsTree(x);null!==D&&h.add(D)}else x instanceof Uo?h.add(x.getItem()):ot.shouldNeverReachHere()}return h.size()<=0?null:h}},qo.prototype.insert=function(e,i){ot.isTrue(!this._built,"Cannot insert items into an STR packed R-tree after it has been built."),this._itemBoundables.add(new Uo(e,i))},qo.prototype.boundablesAtLevel=function(){if(1===arguments.length){var e=arguments[0],i=new cr;return this.boundablesAtLevel(e,this._root,i),i}if(3===arguments.length){var h=arguments[0],d=arguments[1],x=arguments[2];if(ot.isTrue(h>-2),d.getLevel()===h)return x.add(d),null;for(var D=d.getChildBoundables().iterator();D.hasNext();){var F=D.next();F instanceof Ho?this.boundablesAtLevel(h,F,x):(ot.isTrue(F instanceof Uo),-1===h&&x.add(F))}return null}},qo.prototype.query=function(){if(1===arguments.length){var e=arguments[0];this.build();var i=new cr;return this.isEmpty()||this.getIntersectsOp().intersects(this._root.getBounds(),e)&&this.query(e,this._root,i),i}if(2===arguments.length){var h=arguments[0],d=arguments[1];if(this.build(),this.isEmpty())return null;this.getIntersectsOp().intersects(this._root.getBounds(),h)&&this.query(h,this._root,d)}else if(3===arguments.length)if(Ce(arguments[2],sa)&&arguments[0]instanceof Object&&arguments[1]instanceof Ho)for(var x=arguments[0],F=arguments[2],$=arguments[1].getChildBoundables(),Ct=0;Ct<$.size();Ct++){var te=$.get(Ct);this.getIntersectsOp().intersects(te.getBounds(),x)&&(te instanceof Ho?this.query(x,te,F):te instanceof Uo?F.visitItem(te.getItem()):ot.shouldNeverReachHere())}else if(Ce(arguments[2],xn)&&arguments[0]instanceof Object&&arguments[1]instanceof Ho)for(var Ne=arguments[0],gr=arguments[2],Pr=arguments[1].getChildBoundables(),Yr=0;Yr<Pr.size();Yr++){var an=Pr.get(Yr);this.getIntersectsOp().intersects(an.getBounds(),Ne)&&(an instanceof Ho?this.query(Ne,an,gr):an instanceof Uo?gr.add(an.getItem()):ot.shouldNeverReachHere())}},qo.prototype.build=function(){if(this._built)return null;this._root=this._itemBoundables.isEmpty()?this.createNode(0):this.createHigherLevels(this._itemBoundables,-1),this._itemBoundables=null,this._built=!0},qo.prototype.getRoot=function(){return this.build(),this._root},qo.prototype.remove=function(){if(2===arguments.length){var e=arguments[0],i=arguments[1];return this.build(),!!this.getIntersectsOp().intersects(this._root.getBounds(),e)&&this.remove(e,this._root,i)}if(3===arguments.length){var h=arguments[0],d=arguments[1],x=arguments[2],D=this.removeItem(d,x);if(D)return!0;for(var F=null,$=d.getChildBoundables().iterator();$.hasNext();){var Ct=$.next();if(this.getIntersectsOp().intersects(Ct.getBounds(),h)&&Ct instanceof Ho&&(D=this.remove(h,Ct,x))){F=Ct;break}}return null!==F&&F.getChildBoundables().isEmpty()&&d.getChildBoundables().remove(F),D}},qo.prototype.createHigherLevels=function(e,i){ot.isTrue(!e.isEmpty());var h=this.createParentBoundables(e,i+1);return 1===h.size()?h.get(0):this.createHigherLevels(h,i+1)},qo.prototype.depth=function(){if(0===arguments.length)return this.isEmpty()?0:(this.build(),this.depth(this._root));if(1===arguments.length){for(var e=0,i=arguments[0].getChildBoundables().iterator();i.hasNext();){var h=i.next();if(h instanceof Ho){var d=this.depth(h);d>e&&(e=d)}}return e+1}},qo.prototype.createParentBoundables=function(e,i){ot.isTrue(!e.isEmpty());var h=new cr;h.add(this.createNode(i));var d=new cr(e);cs.sort(d,this.getComparator());for(var x=d.iterator();x.hasNext();){var D=x.next();this.lastNode(h).getChildBoundables().size()===this.getNodeCapacity()&&h.add(this.createNode(i)),this.lastNode(h).addChildBoundable(D)}return h},qo.prototype.isEmpty=function(){return this._built?this._root.isEmpty():this._itemBoundables.isEmpty()},qo.prototype.interfaces_=function(){return[gt]},qo.prototype.getClass=function(){return qo},qo.compareDoubles=function(e,i){return e>i?1:e<i?-1:0},Fu.IntersectsOp.get=function(){return Sl},Fu.serialVersionUID.get=function(){return-0x35ef64c82d4c5400},Fu.DEFAULT_NODE_CAPACITY.get=function(){return 10},Object.defineProperties(qo,Fu);var Sl=function(){},zs=function(){};zs.prototype.distance=function(e,i){},zs.prototype.interfaces_=function(){return[]},zs.prototype.getClass=function(){return zs};var Ol=function(e){function i(d){e.call(this,d=d||i.DEFAULT_NODE_CAPACITY)}e&&(i.__proto__=e),(i.prototype=Object.create(e&&e.prototype)).constructor=i;var h={STRtreeNode:{configurable:!0},serialVersionUID:{configurable:!0},xComparator:{configurable:!0},yComparator:{configurable:!0},intersectsOp:{configurable:!0},DEFAULT_NODE_CAPACITY:{configurable:!0}};return i.prototype.createParentBoundablesFromVerticalSlices=function(d,x){ot.isTrue(d.length>0);for(var D=new cr,F=0;F<d.length;F++)D.addAll(this.createParentBoundablesFromVerticalSlice(d[F],x));return D},i.prototype.createNode=function(d){return new el(d)},i.prototype.size=function(){return 0===arguments.length?e.prototype.size.call(this):e.prototype.size.apply(this,arguments)},i.prototype.insert=function(){if(2!==arguments.length)return e.prototype.insert.apply(this,arguments);var d=arguments[0],x=arguments[1];if(d.isNull())return null;e.prototype.insert.call(this,d,x)},i.prototype.getIntersectsOp=function(){return i.intersectsOp},i.prototype.verticalSlices=function(d,x){for(var D=Math.trunc(Math.ceil(d.size()/x)),F=new Array(x).fill(null),$=d.iterator(),Ct=0;Ct<x;Ct++){F[Ct]=new cr;for(var te=0;$.hasNext()&&te<D;){var Ne=$.next();F[Ct].add(Ne),te++}}return F},i.prototype.query=function(){if(1===arguments.length)return e.prototype.query.call(this,arguments[0]);2===arguments.length?e.prototype.query.call(this,arguments[0],arguments[1]):3===arguments.length&&(Ce(arguments[2],sa)&&arguments[0]instanceof Object&&arguments[1]instanceof Ho||Ce(arguments[2],xn)&&arguments[0]instanceof Object&&arguments[1]instanceof Ho)&&e.prototype.query.call(this,arguments[0],arguments[1],arguments[2])},i.prototype.getComparator=function(){return i.yComparator},i.prototype.createParentBoundablesFromVerticalSlice=function(d,x){return e.prototype.createParentBoundables.call(this,d,x)},i.prototype.remove=function(){return 2===arguments.length?e.prototype.remove.call(this,arguments[0],arguments[1]):e.prototype.remove.apply(this,arguments)},i.prototype.depth=function(){return 0===arguments.length?e.prototype.depth.call(this):e.prototype.depth.apply(this,arguments)},i.prototype.createParentBoundables=function(d,x){ot.isTrue(!d.isEmpty());var D=Math.trunc(Math.ceil(d.size()/this.getNodeCapacity())),F=new cr(d);cs.sort(F,i.xComparator);var $=this.verticalSlices(F,Math.trunc(Math.ceil(Math.sqrt(D))));return this.createParentBoundablesFromVerticalSlices($,x)},i.prototype.nearestNeighbour=function(){if(1===arguments.length){if(Ce(arguments[0],zs)){var d=arguments[0],x=new bo(this.getRoot(),this.getRoot(),d);return this.nearestNeighbour(x)}if(arguments[0]instanceof bo)return this.nearestNeighbour(arguments[0],X.POSITIVE_INFINITY)}else if(2===arguments.length){if(arguments[0]instanceof i&&Ce(arguments[1],zs)){var F=arguments[0],$=arguments[1],Ct=new bo(this.getRoot(),F.getRoot(),$);return this.nearestNeighbour(Ct)}if(arguments[0]instanceof bo&&"number"==typeof arguments[1]){var te=arguments[0],Ne=arguments[1],Ve=null,gr=new ho;for(gr.add(te);!gr.isEmpty()&&Ne>0;){var Pr=gr.poll(),Yr=Pr.getDistance();if(Yr>=Ne)break;Pr.isLeaves()?(Ne=Yr,Ve=Pr):Pr.expandToQueue(gr,Ne)}return[Ve.getBoundable(0).getItem(),Ve.getBoundable(1).getItem()]}}else if(3===arguments.length){var l=arguments[2],f=new Uo(arguments[0],arguments[1]),c=new bo(this.getRoot(),f,l);return this.nearestNeighbour(c)[0]}},i.prototype.interfaces_=function(){return[Ks,gt]},i.prototype.getClass=function(){return i},i.centreX=function(d){return i.avg(d.getMinX(),d.getMaxX())},i.avg=function(d,x){return(d+x)/2},i.centreY=function(d){return i.avg(d.getMinY(),d.getMaxY())},h.STRtreeNode.get=function(){return el},h.serialVersionUID.get=function(){return 0x39920f7d5f261e0},h.xComparator.get=function(){return{interfaces_:function(){return[at]},compare:function(d,x){return e.compareDoubles(i.centreX(d.getBounds()),i.centreX(x.getBounds()))}}},h.yComparator.get=function(){return{interfaces_:function(){return[at]},compare:function(d,x){return e.compareDoubles(i.centreY(d.getBounds()),i.centreY(x.getBounds()))}}},h.intersectsOp.get=function(){return{interfaces_:function(){return[e.IntersectsOp]},intersects:function(d,x){return d.intersects(x)}}},h.DEFAULT_NODE_CAPACITY.get=function(){return 10},Object.defineProperties(i,h),i}(qo),el=function(e){function i(){e.call(this,arguments[0])}return e&&(i.__proto__=e),(i.prototype=Object.create(e&&e.prototype)).constructor=i,i.prototype.computeBounds=function(){for(var h=null,d=this.getChildBoundables().iterator();d.hasNext();){var x=d.next();null===h?h=new He(x.getBounds()):h.expandToInclude(x.getBounds())}return h},i.prototype.interfaces_=function(){return[]},i.prototype.getClass=function(){return i},i}(Ho),ha=function(){};ha.prototype.interfaces_=function(){return[]},ha.prototype.getClass=function(){return ha},ha.relativeSign=function(e,i){return e<i?-1:e>i?1:0},ha.compare=function(e,i,h){if(i.equals2D(h))return 0;var d=ha.relativeSign(i.x,h.x),x=ha.relativeSign(i.y,h.y);switch(e){case 0:return ha.compareValue(d,x);case 1:return ha.compareValue(x,d);case 2:return ha.compareValue(x,-d);case 3:return ha.compareValue(-d,x);case 4:return ha.compareValue(-d,-x);case 5:return ha.compareValue(-x,-d);case 6:return ha.compareValue(-x,d);case 7:return ha.compareValue(d,-x)}return ot.shouldNeverReachHere("invalid octant value"),0},ha.compareValue=function(e,i){return e<0?-1:e>0?1:i<0?-1:i>0?1:0};var hu=function(){this._segString=null,this.coord=null,this.segmentIndex=null,this._segmentOctant=null,this._isInterior=null;var e=arguments[0],i=arguments[1],h=arguments[2],d=arguments[3];this._segString=e,this.coord=new Z(i),this.segmentIndex=h,this._segmentOctant=d,this._isInterior=!i.equals2D(e.getCoordinate(h))};hu.prototype.getCoordinate=function(){return this.coord},hu.prototype.print=function(e){e.print(this.coord),e.print(" seg # = "+this.segmentIndex)},hu.prototype.compareTo=function(e){var i=e;return this.segmentIndex<i.segmentIndex?-1:this.segmentIndex>i.segmentIndex?1:this.coord.equals2D(i.coord)?0:ha.compare(this._segmentOctant,this.coord,i.coord)},hu.prototype.isEndPoint=function(e){return 0===this.segmentIndex&&!this._isInterior||this.segmentIndex===e},hu.prototype.isInterior=function(){return this._isInterior},hu.prototype.interfaces_=function(){return[J]},hu.prototype.getClass=function(){return hu};var gi=function(){this._nodeMap=new mt,this._edge=null,this._edge=arguments[0]};gi.prototype.getSplitCoordinates=function(){var e=new Y;this.addEndpoints();for(var i=this.iterator(),h=i.next();i.hasNext();){var d=i.next();this.addEdgeCoordinates(h,d,e),h=d}return e.toCoordinateArray()},gi.prototype.addCollapsedNodes=function(){var e=new cr;this.findCollapsesFromInsertedNodes(e),this.findCollapsesFromExistingVertices(e);for(var i=e.iterator();i.hasNext();){var h=i.next().intValue();this.add(this._edge.getCoordinate(h),h)}},gi.prototype.print=function(e){e.println("Intersections:");for(var i=this.iterator();i.hasNext();)i.next().print(e)},gi.prototype.findCollapsesFromExistingVertices=function(e){for(var i=0;i<this._edge.size()-2;i++){var h=this._edge.getCoordinate(i),d=this._edge.getCoordinate(i+2);h.equals2D(d)&&e.add(new $t(i+1))}},gi.prototype.addEdgeCoordinates=function(e,i,h){var d=this._edge.getCoordinate(i.segmentIndex),x=i.isInterior()||!i.coord.equals2D(d);h.add(new Z(e.coord),!1);for(var D=e.segmentIndex+1;D<=i.segmentIndex;D++)h.add(this._edge.getCoordinate(D));x&&h.add(new Z(i.coord))},gi.prototype.iterator=function(){return this._nodeMap.values().iterator()},gi.prototype.addSplitEdges=function(e){this.addEndpoints(),this.addCollapsedNodes();for(var i=this.iterator(),h=i.next();i.hasNext();){var d=i.next(),x=this.createSplitEdge(h,d);e.add(x),h=d}},gi.prototype.findCollapseIndex=function(e,i,h){if(!e.coord.equals2D(i.coord))return!1;var d=i.segmentIndex-e.segmentIndex;return i.isInterior()||d--,1===d&&(h[0]=e.segmentIndex+1,!0)},gi.prototype.findCollapsesFromInsertedNodes=function(e){for(var i=new Array(1).fill(null),h=this.iterator(),d=h.next();h.hasNext();){var x=h.next();this.findCollapseIndex(d,x,i)&&e.add(new $t(i[0])),d=x}},gi.prototype.getEdge=function(){return this._edge},gi.prototype.addEndpoints=function(){var e=this._edge.size()-1;this.add(this._edge.getCoordinate(0),0),this.add(this._edge.getCoordinate(e),e)},gi.prototype.createSplitEdge=function(e,i){var h=i.segmentIndex-e.segmentIndex+2,d=this._edge.getCoordinate(i.segmentIndex),x=i.isInterior()||!i.coord.equals2D(d);x||h--;var D=new Array(h).fill(null),F=0;D[F++]=new Z(e.coord);for(var $=e.segmentIndex+1;$<=i.segmentIndex;$++)D[F++]=this._edge.getCoordinate($);return x&&(D[F]=new Z(i.coord)),new ki(D,this._edge.getData())},gi.prototype.add=function(e,i){var h=new hu(this._edge,e,i,this._edge.getSegmentOctant(i)),d=this._nodeMap.get(h);return null!==d?(ot.isTrue(d.coord.equals2D(e),"Found equal nodes with different coordinates"),d):(this._nodeMap.put(h,h),h)},gi.prototype.checkSplitEdgesCorrectness=function(e){var i=this._edge.getCoordinates(),h=e.get(0).getCoordinate(0);if(!h.equals2D(i[0]))throw new ut("bad split edge start point at "+h);var d=e.get(e.size()-1).getCoordinates(),x=d[d.length-1];if(!x.equals2D(i[i.length-1]))throw new ut("bad split edge end point at "+x)},gi.prototype.interfaces_=function(){return[]},gi.prototype.getClass=function(){return gi};var pu=function(){};pu.prototype.interfaces_=function(){return[]},pu.prototype.getClass=function(){return pu},pu.octant=function(){if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){var e=arguments[0],i=arguments[1];if(0===e&&0===i)throw new tt("Cannot compute the octant for point ( "+e+", "+i+" )");var h=Math.abs(e),d=Math.abs(i);return e>=0?i>=0?h>=d?0:1:h>=d?7:6:i>=0?h>=d?3:2:h>=d?4:5}if(arguments[0]instanceof Z&&arguments[1]instanceof Z){var x=arguments[0],D=arguments[1],F=D.x-x.x,$=D.y-x.y;if(0===F&&0===$)throw new tt("Cannot compute the octant for two identical points "+x);return pu.octant(F,$)}};var Da=function(){};Da.prototype.getCoordinates=function(){},Da.prototype.size=function(){},Da.prototype.getCoordinate=function(e){},Da.prototype.isClosed=function(){},Da.prototype.setData=function(e){},Da.prototype.getData=function(){},Da.prototype.interfaces_=function(){return[]},Da.prototype.getClass=function(){return Da};var Bs=function(){};Bs.prototype.addIntersection=function(e,i){},Bs.prototype.interfaces_=function(){return[Da]},Bs.prototype.getClass=function(){return Bs};var ki=function(){this._nodeList=new gi(this),this._pts=null,this._data=null;var i=arguments[1];this._pts=arguments[0],this._data=i};ki.prototype.getCoordinates=function(){return this._pts},ki.prototype.size=function(){return this._pts.length},ki.prototype.getCoordinate=function(e){return this._pts[e]},ki.prototype.isClosed=function(){return this._pts[0].equals(this._pts[this._pts.length-1])},ki.prototype.getSegmentOctant=function(e){return e===this._pts.length-1?-1:this.safeOctant(this.getCoordinate(e),this.getCoordinate(e+1))},ki.prototype.setData=function(e){this._data=e},ki.prototype.safeOctant=function(e,i){return e.equals2D(i)?0:pu.octant(e,i)},ki.prototype.getData=function(){return this._data},ki.prototype.addIntersection=function(){if(2===arguments.length)this.addIntersectionNode(arguments[0],arguments[1]);else if(4===arguments.length){var d=arguments[1],D=new Z(arguments[0].getIntersection(arguments[3]));this.addIntersection(D,d)}},ki.prototype.toString=function(){return Kt.toLineString(new Wn(this._pts))},ki.prototype.getNodeList=function(){return this._nodeList},ki.prototype.addIntersectionNode=function(e,i){var h=i,d=h+1;return d<this._pts.length&&e.equals2D(this._pts[d])&&(h=d),this._nodeList.add(e,h)},ki.prototype.addIntersections=function(e,i,h){for(var d=0;d<e.getIntersectionNum();d++)this.addIntersection(e,i,h,d)},ki.prototype.interfaces_=function(){return[Bs]},ki.prototype.getClass=function(){return ki},ki.getNodedSubstrings=function(){if(1===arguments.length){var e=arguments[0],i=new cr;return ki.getNodedSubstrings(e,i),i}if(2===arguments.length)for(var d=arguments[1],x=arguments[0].iterator();x.hasNext();)x.next().getNodeList().addSplitEdges(d)};var Hr=function(){if(this.p0=null,this.p1=null,0===arguments.length)this.p0=new Z,this.p1=new Z;else if(1===arguments.length){var e=arguments[0];this.p0=new Z(e.p0),this.p1=new Z(e.p1)}else if(2===arguments.length)this.p0=arguments[0],this.p1=arguments[1];else if(4===arguments.length){var d=arguments[2],x=arguments[3];this.p0=new Z(arguments[0],arguments[1]),this.p1=new Z(d,x)}},bu={serialVersionUID:{configurable:!0}};Hr.prototype.minX=function(){return Math.min(this.p0.x,this.p1.x)},Hr.prototype.orientationIndex=function(){if(arguments[0]instanceof Hr){var e=arguments[0],i=Ge.orientationIndex(this.p0,this.p1,e.p0),h=Ge.orientationIndex(this.p0,this.p1,e.p1);return i>=0&&h>=0||i<=0&&h<=0?Math.max(i,h):0}if(arguments[0]instanceof Z)return Ge.orientationIndex(this.p0,this.p1,arguments[0])},Hr.prototype.toGeometry=function(e){return e.createLineString([this.p0,this.p1])},Hr.prototype.isVertical=function(){return this.p0.x===this.p1.x},Hr.prototype.equals=function(e){if(!(e instanceof Hr))return!1;var i=e;return this.p0.equals(i.p0)&&this.p1.equals(i.p1)},Hr.prototype.intersection=function(e){var i=new Oe;return i.computeIntersection(this.p0,this.p1,e.p0,e.p1),i.hasIntersection()?i.getIntersection(0):null},Hr.prototype.project=function(){if(arguments[0]instanceof Z){var e=arguments[0];if(e.equals(this.p0)||e.equals(this.p1))return new Z(e);var i=this.projectionFactor(e),h=new Z;return h.x=this.p0.x+i*(this.p1.x-this.p0.x),h.y=this.p0.y+i*(this.p1.y-this.p0.y),h}if(arguments[0]instanceof Hr){var d=arguments[0],x=this.projectionFactor(d.p0),D=this.projectionFactor(d.p1);if(x>=1&&D>=1||x<=0&&D<=0)return null;var F=this.project(d.p0);x<0&&(F=this.p0),x>1&&(F=this.p1);var $=this.project(d.p1);return D<0&&($=this.p0),D>1&&($=this.p1),new Hr(F,$)}},Hr.prototype.normalize=function(){this.p1.compareTo(this.p0)<0&&this.reverse()},Hr.prototype.angle=function(){return Math.atan2(this.p1.y-this.p0.y,this.p1.x-this.p0.x)},Hr.prototype.getCoordinate=function(e){return 0===e?this.p0:this.p1},Hr.prototype.distancePerpendicular=function(e){return Ge.distancePointLinePerpendicular(e,this.p0,this.p1)},Hr.prototype.minY=function(){return Math.min(this.p0.y,this.p1.y)},Hr.prototype.midPoint=function(){return Hr.midPoint(this.p0,this.p1)},Hr.prototype.projectionFactor=function(e){if(e.equals(this.p0))return 0;if(e.equals(this.p1))return 1;var i=this.p1.x-this.p0.x,h=this.p1.y-this.p0.y,d=i*i+h*h;return d<=0?X.NaN:((e.x-this.p0.x)*i+(e.y-this.p0.y)*h)/d},Hr.prototype.closestPoints=function(e){var i=this.intersection(e);if(null!==i)return[i,i];var h=new Array(2).fill(null),d=X.MAX_VALUE,x=null,D=this.closestPoint(e.p0);d=D.distance(e.p0),h[0]=D,h[1]=e.p0;var F=this.closestPoint(e.p1);(x=F.distance(e.p1))<d&&(d=x,h[0]=F,h[1]=e.p1);var $=e.closestPoint(this.p0);(x=$.distance(this.p0))<d&&(d=x,h[0]=this.p0,h[1]=$);var Ct=e.closestPoint(this.p1);return(x=Ct.distance(this.p1))<d&&(d=x,h[0]=this.p1,h[1]=Ct),h},Hr.prototype.closestPoint=function(e){var i=this.projectionFactor(e);return i>0&&i<1?this.project(e):this.p0.distance(e)<this.p1.distance(e)?this.p0:this.p1},Hr.prototype.maxX=function(){return Math.max(this.p0.x,this.p1.x)},Hr.prototype.getLength=function(){return this.p0.distance(this.p1)},Hr.prototype.compareTo=function(e){var i=e,h=this.p0.compareTo(i.p0);return 0!==h?h:this.p1.compareTo(i.p1)},Hr.prototype.reverse=function(){var e=this.p0;this.p0=this.p1,this.p1=e},Hr.prototype.equalsTopo=function(e){return this.p0.equals(e.p0)&&(this.p1.equals(e.p1)||this.p0.equals(e.p1))&&this.p1.equals(e.p0)},Hr.prototype.lineIntersection=function(e){try{return Er.intersection(this.p0,this.p1,e.p0,e.p1)}catch(i){if(!(i instanceof Ur))throw i}return null},Hr.prototype.maxY=function(){return Math.max(this.p0.y,this.p1.y)},Hr.prototype.pointAlongOffset=function(e,i){var h=this.p0.x+e*(this.p1.x-this.p0.x),d=this.p0.y+e*(this.p1.y-this.p0.y),x=this.p1.x-this.p0.x,D=this.p1.y-this.p0.y,F=Math.sqrt(x*x+D*D),$=0,Ct=0;if(0!==i){if(F<=0)throw new Error("Cannot compute offset from zero-length line segment");$=i*x/F,Ct=i*D/F}return new Z(h-Ct,d+$)},Hr.prototype.setCoordinates=function(){if(1===arguments.length){var e=arguments[0];this.setCoordinates(e.p0,e.p1)}else if(2===arguments.length){var i=arguments[0],h=arguments[1];this.p0.x=i.x,this.p0.y=i.y,this.p1.x=h.x,this.p1.y=h.y}},Hr.prototype.segmentFraction=function(e){var i=this.projectionFactor(e);return i<0?i=0:(i>1||X.isNaN(i))&&(i=1),i},Hr.prototype.toString=function(){return"LINESTRING( "+this.p0.x+" "+this.p0.y+", "+this.p1.x+" "+this.p1.y+")"},Hr.prototype.isHorizontal=function(){return this.p0.y===this.p1.y},Hr.prototype.distance=function(){if(arguments[0]instanceof Hr){var e=arguments[0];return Ge.distanceLineLine(this.p0,this.p1,e.p0,e.p1)}if(arguments[0]instanceof Z)return Ge.distancePointLine(arguments[0],this.p0,this.p1)},Hr.prototype.pointAlong=function(e){var i=new Z;return i.x=this.p0.x+e*(this.p1.x-this.p0.x),i.y=this.p0.y+e*(this.p1.y-this.p0.y),i},Hr.prototype.hashCode=function(){var e=X.doubleToLongBits(this.p0.x);e^=31*X.doubleToLongBits(this.p0.y);var i=Math.trunc(e)^Math.trunc(e>>32),h=X.doubleToLongBits(this.p1.x);return h^=31*X.doubleToLongBits(this.p1.y),i^Math.trunc(h)^Math.trunc(h>>32)},Hr.prototype.interfaces_=function(){return[J,gt]},Hr.prototype.getClass=function(){return Hr},Hr.midPoint=function(e,i){return new Z((e.x+i.x)/2,(e.y+i.y)/2)},bu.serialVersionUID.get=function(){return 0x2d2172135f411c00},Object.defineProperties(Hr,bu);var fu=function(){this.tempEnv1=new He,this.tempEnv2=new He,this._overlapSeg1=new Hr,this._overlapSeg2=new Hr};fu.prototype.overlap=function(){if(2!==arguments.length&&4===arguments.length){var h=arguments[2],d=arguments[3];arguments[0].getLineSegment(arguments[1],this._overlapSeg1),h.getLineSegment(d,this._overlapSeg2),this.overlap(this._overlapSeg1,this._overlapSeg2)}},fu.prototype.interfaces_=function(){return[]},fu.prototype.getClass=function(){return fu};var pa=function(){this._pts=null,this._start=null,this._end=null,this._env=null,this._context=null,this._id=null;var i=arguments[1],h=arguments[2],d=arguments[3];this._pts=arguments[0],this._start=i,this._end=h,this._context=d};pa.prototype.getLineSegment=function(e,i){i.p0=this._pts[e],i.p1=this._pts[e+1]},pa.prototype.computeSelect=function(e,i,h,d){if(d.tempEnv1.init(this._pts[i],this._pts[h]),h-i==1)return d.select(this,i),null;if(!e.intersects(d.tempEnv1))return null;var F=Math.trunc((i+h)/2);i<F&&this.computeSelect(e,i,F,d),F<h&&this.computeSelect(e,F,h,d)},pa.prototype.getCoordinates=function(){for(var e=new Array(this._end-this._start+1).fill(null),i=0,h=this._start;h<=this._end;h++)e[i++]=this._pts[h];return e},pa.prototype.computeOverlaps=function(e,i){this.computeOverlapsInternal(this._start,this._end,e,e._start,e._end,i)},pa.prototype.setId=function(e){this._id=e},pa.prototype.select=function(e,i){this.computeSelect(e,this._start,this._end,i)},pa.prototype.getEnvelope=function(){return null===this._env&&(this._env=new He(this._pts[this._start],this._pts[this._end])),this._env},pa.prototype.getEndIndex=function(){return this._end},pa.prototype.getStartIndex=function(){return this._start},pa.prototype.getContext=function(){return this._context},pa.prototype.getId=function(){return this._id},pa.prototype.computeOverlapsInternal=function(e,i,h,d,x,D){var F=this._pts[e],$=this._pts[i],Ct=h._pts[d],te=h._pts[x];if(i-e==1&&x-d==1)return D.overlap(this,e,h,d),null;if(D.tempEnv1.init(F,$),D.tempEnv2.init(Ct,te),!D.tempEnv1.intersects(D.tempEnv2))return null;var Ne=Math.trunc((e+i)/2),Ve=Math.trunc((d+x)/2);e<Ne&&(d<Ve&&this.computeOverlapsInternal(e,Ne,h,d,Ve,D),Ve<x&&this.computeOverlapsInternal(e,Ne,h,Ve,x,D)),Ne<i&&(d<Ve&&this.computeOverlapsInternal(Ne,i,h,d,Ve,D),Ve<x&&this.computeOverlapsInternal(Ne,i,h,Ve,x,D))},pa.prototype.interfaces_=function(){return[]},pa.prototype.getClass=function(){return pa};var Ba=function(){};Ba.prototype.interfaces_=function(){return[]},Ba.prototype.getClass=function(){return Ba},Ba.getChainStartIndices=function(e){var i=0,h=new cr;h.add(new $t(i));do{var d=Ba.findChainEnd(e,i);h.add(new $t(d)),i=d}while(i<e.length-1);return Ba.toIntArray(h)},Ba.findChainEnd=function(e,i){for(var h=i;h<e.length-1&&e[h].equals2D(e[h+1]);)h++;if(h>=e.length-1)return e.length-1;for(var d=rn.quadrant(e[h],e[h+1]),x=i+1;x<e.length&&(e[x-1].equals2D(e[x])||rn.quadrant(e[x-1],e[x])===d);)x++;return x-1},Ba.getChains=function(){if(1===arguments.length)return Ba.getChains(arguments[0],null);if(2===arguments.length){for(var i=arguments[0],h=arguments[1],d=new cr,x=Ba.getChainStartIndices(i),D=0;D<x.length-1;D++){var F=new pa(i,x[D],x[D+1],h);d.add(F)}return d}},Ba.toIntArray=function(e){for(var i=new Array(e.size()).fill(null),h=0;h<i.length;h++)i[h]=e.get(h).intValue();return i};var wu=function(){};wu.prototype.computeNodes=function(e){},wu.prototype.getNodedSubstrings=function(){},wu.prototype.interfaces_=function(){return[]},wu.prototype.getClass=function(){return wu};var qi=function(){this._segInt=null,0!==arguments.length&&1===arguments.length&&this.setSegmentIntersector(arguments[0])};qi.prototype.setSegmentIntersector=function(e){this._segInt=e},qi.prototype.interfaces_=function(){return[wu]},qi.prototype.getClass=function(){return qi};var Us=function(e){function i(d){d?e.call(this,d):e.call(this),this._monoChains=new cr,this._index=new Ol,this._idCounter=0,this._nodedSegStrings=null,this._nOverlaps=0}e&&(i.__proto__=e),(i.prototype=Object.create(e&&e.prototype)).constructor=i;var h={SegmentOverlapAction:{configurable:!0}};return i.prototype.getMonotoneChains=function(){return this._monoChains},i.prototype.getNodedSubstrings=function(){return ki.getNodedSubstrings(this._nodedSegStrings)},i.prototype.getIndex=function(){return this._index},i.prototype.add=function(d){for(var x=Ba.getChains(d.getCoordinates(),d).iterator();x.hasNext();){var D=x.next();D.setId(this._idCounter++),this._index.insert(D.getEnvelope(),D),this._monoChains.add(D)}},i.prototype.computeNodes=function(d){this._nodedSegStrings=d;for(var x=d.iterator();x.hasNext();)this.add(x.next());this.intersectChains()},i.prototype.intersectChains=function(){for(var d=new Ms(this._segInt),x=this._monoChains.iterator();x.hasNext();)for(var D=x.next(),F=this._index.query(D.getEnvelope()).iterator();F.hasNext();){var $=F.next();if($.getId()>D.getId()&&(D.computeOverlaps($,d),this._nOverlaps++),this._segInt.isDone())return null}},i.prototype.interfaces_=function(){return[]},i.prototype.getClass=function(){return i},h.SegmentOverlapAction.get=function(){return Ms},Object.defineProperties(i,h),i}(qi),Ms=function(e){function i(){e.call(this),this._si=null,this._si=arguments[0]}return e&&(i.__proto__=e),(i.prototype=Object.create(e&&e.prototype)).constructor=i,i.prototype.overlap=function(){if(4!==arguments.length)return e.prototype.overlap.apply(this,arguments);var d=arguments[1],x=arguments[2],D=arguments[3],F=arguments[0].getContext(),$=x.getContext();this._si.processIntersections(F,d,$,D)},i.prototype.interfaces_=function(){return[]},i.prototype.getClass=function(){return i},i}(fu),$n=function e(){if(this._quadrantSegments=e.DEFAULT_QUADRANT_SEGMENTS,this._endCapStyle=e.CAP_ROUND,this._joinStyle=e.JOIN_ROUND,this._mitreLimit=e.DEFAULT_MITRE_LIMIT,this._isSingleSided=!1,this._simplifyFactor=e.DEFAULT_SIMPLIFY_FACTOR,0!==arguments.length)if(1===arguments.length)this.setQuadrantSegments(arguments[0]);else if(2===arguments.length){var d=arguments[1];this.setQuadrantSegments(arguments[0]),this.setEndCapStyle(d)}else if(4===arguments.length){var D=arguments[1],F=arguments[2],$=arguments[3];this.setQuadrantSegments(arguments[0]),this.setEndCapStyle(D),this.setJoinStyle(F),this.setMitreLimit($)}},Ts={CAP_ROUND:{configurable:!0},CAP_FLAT:{configurable:!0},CAP_SQUARE:{configurable:!0},JOIN_ROUND:{configurable:!0},JOIN_MITRE:{configurable:!0},JOIN_BEVEL:{configurable:!0},DEFAULT_QUADRANT_SEGMENTS:{configurable:!0},DEFAULT_MITRE_LIMIT:{configurable:!0},DEFAULT_SIMPLIFY_FACTOR:{configurable:!0}};$n.prototype.getEndCapStyle=function(){return this._endCapStyle},$n.prototype.isSingleSided=function(){return this._isSingleSided},$n.prototype.setQuadrantSegments=function(e){this._quadrantSegments=e,0===this._quadrantSegments&&(this._joinStyle=$n.JOIN_BEVEL),this._quadrantSegments<0&&(this._joinStyle=$n.JOIN_MITRE,this._mitreLimit=Math.abs(this._quadrantSegments)),e<=0&&(this._quadrantSegments=1),this._joinStyle!==$n.JOIN_ROUND&&(this._quadrantSegments=$n.DEFAULT_QUADRANT_SEGMENTS)},$n.prototype.getJoinStyle=function(){return this._joinStyle},$n.prototype.setJoinStyle=function(e){this._joinStyle=e},$n.prototype.setSimplifyFactor=function(e){this._simplifyFactor=e<0?0:e},$n.prototype.getSimplifyFactor=function(){return this._simplifyFactor},$n.prototype.getQuadrantSegments=function(){return this._quadrantSegments},$n.prototype.setEndCapStyle=function(e){this._endCapStyle=e},$n.prototype.getMitreLimit=function(){return this._mitreLimit},$n.prototype.setMitreLimit=function(e){this._mitreLimit=e},$n.prototype.setSingleSided=function(e){this._isSingleSided=e},$n.prototype.interfaces_=function(){return[]},$n.prototype.getClass=function(){return $n},$n.bufferDistanceError=function(e){var i=Math.PI/2/e;return 1-Math.cos(i/2)},Ts.CAP_ROUND.get=function(){return 1},Ts.CAP_FLAT.get=function(){return 2},Ts.CAP_SQUARE.get=function(){return 3},Ts.JOIN_ROUND.get=function(){return 1},Ts.JOIN_MITRE.get=function(){return 2},Ts.JOIN_BEVEL.get=function(){return 3},Ts.DEFAULT_QUADRANT_SEGMENTS.get=function(){return 8},Ts.DEFAULT_MITRE_LIMIT.get=function(){return 5},Ts.DEFAULT_SIMPLIFY_FACTOR.get=function(){return.01},Object.defineProperties($n,Ts);var Ni=function(e){this._distanceTol=null,this._isDeleted=null,this._angleOrientation=Ge.COUNTERCLOCKWISE,this._inputLine=e||null},sl={INIT:{configurable:!0},DELETE:{configurable:!0},KEEP:{configurable:!0},NUM_PTS_TO_CHECK:{configurable:!0}};Ni.prototype.isDeletable=function(e,i,h,d){var x=this._inputLine[e],D=this._inputLine[i],F=this._inputLine[h];return!!this.isConcave(x,D,F)&&!!this.isShallow(x,D,F,d)&&this.isShallowSampled(x,D,e,h,d)},Ni.prototype.deleteShallowConcavities=function(){for(var e=1,i=this.findNextNonDeletedIndex(e),h=this.findNextNonDeletedIndex(i),d=!1;h<this._inputLine.length;){var x=!1;this.isDeletable(e,i,h,this._distanceTol)&&(this._isDeleted[i]=Ni.DELETE,x=!0,d=!0),i=this.findNextNonDeletedIndex(e=x?h:i),h=this.findNextNonDeletedIndex(i)}return d},Ni.prototype.isShallowConcavity=function(e,i,h,d){return Ge.computeOrientation(e,i,h)===this._angleOrientation&&Ge.distancePointLine(i,e,h)<d},Ni.prototype.isShallowSampled=function(e,i,h,d,x){var D=Math.trunc((d-h)/Ni.NUM_PTS_TO_CHECK);D<=0&&(D=1);for(var F=h;F<d;F+=D)if(!this.isShallow(e,i,this._inputLine[F],x))return!1;return!0},Ni.prototype.isConcave=function(e,i,h){return Ge.computeOrientation(e,i,h)===this._angleOrientation},Ni.prototype.simplify=function(e){this._distanceTol=Math.abs(e),e<0&&(this._angleOrientation=Ge.CLOCKWISE),this._isDeleted=new Array(this._inputLine.length).fill(null);var i=!1;do{i=this.deleteShallowConcavities()}while(i);return this.collapseLine()},Ni.prototype.findNextNonDeletedIndex=function(e){for(var i=e+1;i<this._inputLine.length&&this._isDeleted[i]===Ni.DELETE;)i++;return i},Ni.prototype.isShallow=function(e,i,h,d){return Ge.distancePointLine(i,e,h)<d},Ni.prototype.collapseLine=function(){for(var e=new Y,i=0;i<this._inputLine.length;i++)this._isDeleted[i]!==Ni.DELETE&&e.add(this._inputLine[i]);return e.toCoordinateArray()},Ni.prototype.interfaces_=function(){return[]},Ni.prototype.getClass=function(){return Ni},Ni.simplify=function(e,i){return new Ni(e).simplify(i)},sl.INIT.get=function(){return 0},sl.DELETE.get=function(){return 1},sl.KEEP.get=function(){return 1},sl.NUM_PTS_TO_CHECK.get=function(){return 10},Object.defineProperties(Ni,sl);var fa=function(){this._ptList=null,this._precisionModel=null,this._minimimVertexDistance=0,this._ptList=new cr},qs={COORDINATE_ARRAY_TYPE:{configurable:!0}};fa.prototype.getCoordinates=function(){return this._ptList.toArray(fa.COORDINATE_ARRAY_TYPE)},fa.prototype.setPrecisionModel=function(e){this._precisionModel=e},fa.prototype.addPt=function(e){var i=new Z(e);if(this._precisionModel.makePrecise(i),this.isRedundant(i))return null;this._ptList.add(i)},fa.prototype.revere=function(){},fa.prototype.addPts=function(e,i){if(i)for(var h=0;h<e.length;h++)this.addPt(e[h]);else for(var d=e.length-1;d>=0;d--)this.addPt(e[d])},fa.prototype.isRedundant=function(e){if(this._ptList.size()<1)return!1;var i=this._ptList.get(this._ptList.size()-1);return e.distance(i)<this._minimimVertexDistance},fa.prototype.toString=function(){return(new wn).createLineString(this.getCoordinates()).toString()},fa.prototype.closeRing=function(){if(this._ptList.size()<1)return null;var e=new Z(this._ptList.get(0)),i=this._ptList.get(this._ptList.size()-1);if(e.equals(i))return null;this._ptList.add(e)},fa.prototype.setMinimumVertexDistance=function(e){this._minimimVertexDistance=e},fa.prototype.interfaces_=function(){return[]},fa.prototype.getClass=function(){return fa},qs.COORDINATE_ARRAY_TYPE.get=function(){return new Array(0).fill(null)},Object.defineProperties(fa,qs);var Un=function(){},$s={PI_TIMES_2:{configurable:!0},PI_OVER_2:{configurable:!0},PI_OVER_4:{configurable:!0},COUNTERCLOCKWISE:{configurable:!0},CLOCKWISE:{configurable:!0},NONE:{configurable:!0}};Un.prototype.interfaces_=function(){return[]},Un.prototype.getClass=function(){return Un},Un.toDegrees=function(e){return 180*e/Math.PI},Un.normalize=function(e){for(;e>Math.PI;)e-=Un.PI_TIMES_2;for(;e<=-Math.PI;)e+=Un.PI_TIMES_2;return e},Un.angle=function(){if(1===arguments.length){var e=arguments[0];return Math.atan2(e.y,e.x)}if(2===arguments.length){var i=arguments[0],h=arguments[1];return Math.atan2(h.y-i.y,h.x-i.x)}},Un.isAcute=function(e,i,h){return(e.x-i.x)*(h.x-i.x)+(e.y-i.y)*(h.y-i.y)>0},Un.isObtuse=function(e,i,h){return(e.x-i.x)*(h.x-i.x)+(e.y-i.y)*(h.y-i.y)<0},Un.interiorAngle=function(e,i,h){var d=Un.angle(i,e),x=Un.angle(i,h);return Math.abs(x-d)},Un.normalizePositive=function(e){if(e<0){for(;e<0;)e+=Un.PI_TIMES_2;e>=Un.PI_TIMES_2&&(e=0)}else{for(;e>=Un.PI_TIMES_2;)e-=Un.PI_TIMES_2;e<0&&(e=0)}return e},Un.angleBetween=function(e,i,h){var d=Un.angle(i,e),x=Un.angle(i,h);return Un.diff(d,x)},Un.diff=function(e,i){var h=null;return(h=e<i?i-e:e-i)>Math.PI&&(h=2*Math.PI-h),h},Un.toRadians=function(e){return e*Math.PI/180},Un.getTurn=function(e,i){var h=Math.sin(i-e);return h>0?Un.COUNTERCLOCKWISE:h<0?Un.CLOCKWISE:Un.NONE},Un.angleBetweenOriented=function(e,i,h){var d=Un.angle(i,e),x=Un.angle(i,h)-d;return x<=-Math.PI?x+Un.PI_TIMES_2:x>Math.PI?x-Un.PI_TIMES_2:x},$s.PI_TIMES_2.get=function(){return 2*Math.PI},$s.PI_OVER_2.get=function(){return Math.PI/2},$s.PI_OVER_4.get=function(){return Math.PI/4},$s.COUNTERCLOCKWISE.get=function(){return Ge.COUNTERCLOCKWISE},$s.CLOCKWISE.get=function(){return Ge.CLOCKWISE},$s.NONE.get=function(){return Ge.COLLINEAR},Object.defineProperties(Un,$s);var wo=function e(){this._maxCurveSegmentError=0,this._filletAngleQuantum=null,this._closingSegLengthFactor=1,this._segList=null,this._distance=0,this._precisionModel=null,this._bufParams=null,this._li=null,this._s0=null,this._s1=null,this._s2=null,this._seg0=new Hr,this._seg1=new Hr,this._offset0=new Hr,this._offset1=new Hr,this._side=0,this._hasNarrowConcaveAngle=!1;var h=arguments[1],d=arguments[2];this._precisionModel=arguments[0],this._bufParams=h,this._li=new Oe,this._filletAngleQuantum=Math.PI/2/h.getQuadrantSegments(),h.getQuadrantSegments()>=8&&h.getJoinStyle()===$n.JOIN_ROUND&&(this._closingSegLengthFactor=e.MAX_CLOSING_SEG_LEN_FACTOR),this.init(d)},Wu={OFFSET_SEGMENT_SEPARATION_FACTOR:{configurable:!0},INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR:{configurable:!0},CURVE_VERTEX_SNAP_DISTANCE_FACTOR:{configurable:!0},MAX_CLOSING_SEG_LEN_FACTOR:{configurable:!0}};wo.prototype.addNextSegment=function(e,i){if(this._s0=this._s1,this._s1=this._s2,this._s2=e,this._seg0.setCoordinates(this._s0,this._s1),this.computeOffsetSegment(this._seg0,this._side,this._distance,this._offset0),this._seg1.setCoordinates(this._s1,this._s2),this.computeOffsetSegment(this._seg1,this._side,this._distance,this._offset1),this._s1.equals(this._s2))return null;var h=Ge.computeOrientation(this._s0,this._s1,this._s2),d=h===Ge.CLOCKWISE&&this._side===Bt.LEFT||h===Ge.COUNTERCLOCKWISE&&this._side===Bt.RIGHT;0===h?this.addCollinear(i):d?this.addOutsideTurn(h,i):this.addInsideTurn(h,i)},wo.prototype.addLineEndCap=function(e,i){var h=new Hr(e,i),d=new Hr;this.computeOffsetSegment(h,Bt.LEFT,this._distance,d);var x=new Hr;this.computeOffsetSegment(h,Bt.RIGHT,this._distance,x);var $=Math.atan2(i.y-e.y,i.x-e.x);switch(this._bufParams.getEndCapStyle()){case $n.CAP_ROUND:this._segList.addPt(d.p1),this.addFilletArc(i,$+Math.PI/2,$-Math.PI/2,Ge.CLOCKWISE,this._distance),this._segList.addPt(x.p1);break;case $n.CAP_FLAT:this._segList.addPt(d.p1),this._segList.addPt(x.p1);break;case $n.CAP_SQUARE:var Ct=new Z;Ct.x=Math.abs(this._distance)*Math.cos($),Ct.y=Math.abs(this._distance)*Math.sin($);var te=new Z(d.p1.x+Ct.x,d.p1.y+Ct.y),Ne=new Z(x.p1.x+Ct.x,x.p1.y+Ct.y);this._segList.addPt(te),this._segList.addPt(Ne)}},wo.prototype.getCoordinates=function(){return this._segList.getCoordinates()},wo.prototype.addMitreJoin=function(e,i,h,d){var x=!0,D=null;try{D=Er.intersection(i.p0,i.p1,h.p0,h.p1),(d<=0?1:D.distance(e)/Math.abs(d))>this._bufParams.getMitreLimit()&&(x=!1)}catch(F){if(!(F instanceof Ur))throw F;D=new Z(0,0),x=!1}x?this._segList.addPt(D):this.addLimitedMitreJoin(i,h,d,this._bufParams.getMitreLimit())},wo.prototype.addFilletCorner=function(e,i,h,d,x){var $=Math.atan2(i.y-e.y,i.x-e.x),Ne=Math.atan2(h.y-e.y,h.x-e.x);d===Ge.CLOCKWISE?$<=Ne&&($+=2*Math.PI):$>=Ne&&($-=2*Math.PI),this._segList.addPt(i),this.addFilletArc(e,$,Ne,d,x),this._segList.addPt(h)},wo.prototype.addOutsideTurn=function(e,i){if(this._offset0.p1.distance(this._offset1.p0)<this._distance*wo.OFFSET_SEGMENT_SEPARATION_FACTOR)return this._segList.addPt(this._offset0.p1),null;this._bufParams.getJoinStyle()===$n.JOIN_MITRE?this.addMitreJoin(this._s1,this._offset0,this._offset1,this._distance):this._bufParams.getJoinStyle()===$n.JOIN_BEVEL?this.addBevelJoin(this._offset0,this._offset1):(i&&this._segList.addPt(this._offset0.p1),this.addFilletCorner(this._s1,this._offset0.p1,this._offset1.p0,e,this._distance),this._segList.addPt(this._offset1.p0))},wo.prototype.createSquare=function(e){this._segList.addPt(new Z(e.x+this._distance,e.y+this._distance)),this._segList.addPt(new Z(e.x+this._distance,e.y-this._distance)),this._segList.addPt(new Z(e.x-this._distance,e.y-this._distance)),this._segList.addPt(new Z(e.x-this._distance,e.y+this._distance)),this._segList.closeRing()},wo.prototype.addSegments=function(e,i){this._segList.addPts(e,i)},wo.prototype.addFirstSegment=function(){this._segList.addPt(this._offset1.p0)},wo.prototype.addLastSegment=function(){this._segList.addPt(this._offset1.p1)},wo.prototype.initSideSegments=function(e,i,h){this._s1=e,this._s2=i,this._side=h,this._seg1.setCoordinates(e,i),this.computeOffsetSegment(this._seg1,h,this._distance,this._offset1)},wo.prototype.addLimitedMitreJoin=function(e,i,h,d){var x=this._seg0.p1,D=Un.angle(x,this._seg0.p0),F=Un.angleBetweenOriented(this._seg0.p0,x,this._seg1.p1)/2,$=Un.normalize(D+F),Ct=Un.normalize($+Math.PI),te=d*h,Ne=h-te*Math.abs(Math.sin(F)),Ve=x.x+te*Math.cos(Ct),gr=x.y+te*Math.sin(Ct),Pr=new Z(Ve,gr),Yr=new Hr(x,Pr),an=Yr.pointAlongOffset(1,Ne),Mi=Yr.pointAlongOffset(1,-Ne);this._side===Bt.LEFT?(this._segList.addPt(an),this._segList.addPt(Mi)):(this._segList.addPt(Mi),this._segList.addPt(an))},wo.prototype.computeOffsetSegment=function(e,i,h,d){var x=i===Bt.LEFT?1:-1,D=e.p1.x-e.p0.x,F=e.p1.y-e.p0.y,$=Math.sqrt(D*D+F*F),Ct=x*h*D/$,te=x*h*F/$;d.p0.x=e.p0.x-te,d.p0.y=e.p0.y+Ct,d.p1.x=e.p1.x-te,d.p1.y=e.p1.y+Ct},wo.prototype.addFilletArc=function(e,i,h,d,x){var D=d===Ge.CLOCKWISE?-1:1,F=Math.abs(i-h),$=Math.trunc(F/this._filletAngleQuantum+.5);if($<1)return null;for(var Ct=F/$,te=0,Ne=new Z;te<F;){var Ve=i+D*te;Ne.x=e.x+x*Math.cos(Ve),Ne.y=e.y+x*Math.sin(Ve),this._segList.addPt(Ne),te+=Ct}},wo.prototype.addInsideTurn=function(e,i){if(this._li.computeIntersection(this._offset0.p0,this._offset0.p1,this._offset1.p0,this._offset1.p1),this._li.hasIntersection())this._segList.addPt(this._li.getIntersection(0));else if(this._hasNarrowConcaveAngle=!0,this._offset0.p1.distance(this._offset1.p0)<this._distance*wo.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR)this._segList.addPt(this._offset0.p1);else{if(this._segList.addPt(this._offset0.p1),this._closingSegLengthFactor>0){var h=new Z((this._closingSegLengthFactor*this._offset0.p1.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset0.p1.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(h);var d=new Z((this._closingSegLengthFactor*this._offset1.p0.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset1.p0.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(d)}else this._segList.addPt(this._s1);this._segList.addPt(this._offset1.p0)}},wo.prototype.createCircle=function(e){var i=new Z(e.x+this._distance,e.y);this._segList.addPt(i),this.addFilletArc(e,0,2*Math.PI,-1,this._distance),this._segList.closeRing()},wo.prototype.addBevelJoin=function(e,i){this._segList.addPt(e.p1),this._segList.addPt(i.p0)},wo.prototype.init=function(e){this._distance=e,this._maxCurveSegmentError=e*(1-Math.cos(this._filletAngleQuantum/2)),this._segList=new fa,this._segList.setPrecisionModel(this._precisionModel),this._segList.setMinimumVertexDistance(e*wo.CURVE_VERTEX_SNAP_DISTANCE_FACTOR)},wo.prototype.addCollinear=function(e){this._li.computeIntersection(this._s0,this._s1,this._s1,this._s2),this._li.getIntersectionNum()>=2&&(this._bufParams.getJoinStyle()===$n.JOIN_BEVEL||this._bufParams.getJoinStyle()===$n.JOIN_MITRE?(e&&this._segList.addPt(this._offset0.p1),this._segList.addPt(this._offset1.p0)):this.addFilletCorner(this._s1,this._offset0.p1,this._offset1.p0,Ge.CLOCKWISE,this._distance))},wo.prototype.closeRing=function(){this._segList.closeRing()},wo.prototype.hasNarrowConcaveAngle=function(){return this._hasNarrowConcaveAngle},wo.prototype.interfaces_=function(){return[]},wo.prototype.getClass=function(){return wo},Wu.OFFSET_SEGMENT_SEPARATION_FACTOR.get=function(){return.001},Wu.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR.get=function(){return.001},Wu.CURVE_VERTEX_SNAP_DISTANCE_FACTOR.get=function(){return 1e-6},Wu.MAX_CLOSING_SEG_LEN_FACTOR.get=function(){return 80},Object.defineProperties(wo,Wu);var da=function(){this._distance=0,this._precisionModel=null,this._bufParams=null;var i=arguments[1];this._precisionModel=arguments[0],this._bufParams=i};da.prototype.getOffsetCurve=function(e,i){if(this._distance=i,0===i)return null;var h=i<0,d=Math.abs(i),x=this.getSegGen(d);e.length<=1?this.computePointCurve(e[0],x):this.computeOffsetCurve(e,h,x);var D=x.getCoordinates();return h&&W.reverse(D),D},da.prototype.computeSingleSidedBufferCurve=function(e,i,h){var d=this.simplifyTolerance(this._distance);if(i){h.addSegments(e,!0);var x=Ni.simplify(e,-d),D=x.length-1;h.initSideSegments(x[D],x[D-1],Bt.LEFT),h.addFirstSegment();for(var F=D-2;F>=0;F--)h.addNextSegment(x[F],!0)}else{h.addSegments(e,!1);var $=Ni.simplify(e,d),Ct=$.length-1;h.initSideSegments($[0],$[1],Bt.LEFT),h.addFirstSegment();for(var te=2;te<=Ct;te++)h.addNextSegment($[te],!0)}h.addLastSegment(),h.closeRing()},da.prototype.computeRingBufferCurve=function(e,i,h){var d=this.simplifyTolerance(this._distance);i===Bt.RIGHT&&(d=-d);var x=Ni.simplify(e,d),D=x.length-1;h.initSideSegments(x[D-1],x[0],i);for(var F=1;F<=D;F++)h.addNextSegment(x[F],1!==F);h.closeRing()},da.prototype.computeLineBufferCurve=function(e,i){var h=this.simplifyTolerance(this._distance),d=Ni.simplify(e,h),x=d.length-1;i.initSideSegments(d[0],d[1],Bt.LEFT);for(var D=2;D<=x;D++)i.addNextSegment(d[D],!0);i.addLastSegment(),i.addLineEndCap(d[x-1],d[x]);var F=Ni.simplify(e,-h),$=F.length-1;i.initSideSegments(F[$],F[$-1],Bt.LEFT);for(var Ct=$-2;Ct>=0;Ct--)i.addNextSegment(F[Ct],!0);i.addLastSegment(),i.addLineEndCap(F[1],F[0]),i.closeRing()},da.prototype.computePointCurve=function(e,i){switch(this._bufParams.getEndCapStyle()){case $n.CAP_ROUND:i.createCircle(e);break;case $n.CAP_SQUARE:i.createSquare(e)}},da.prototype.getLineCurve=function(e,i){if(this._distance=i,i<0&&!this._bufParams.isSingleSided()||0===i)return null;var h=Math.abs(i),d=this.getSegGen(h);return e.length<=1?this.computePointCurve(e[0],d):this._bufParams.isSingleSided()?this.computeSingleSidedBufferCurve(e,i<0,d):this.computeLineBufferCurve(e,d),d.getCoordinates()},da.prototype.getBufferParameters=function(){return this._bufParams},da.prototype.simplifyTolerance=function(e){return e*this._bufParams.getSimplifyFactor()},da.prototype.getRingCurve=function(e,i,h){if(this._distance=h,e.length<=2)return this.getLineCurve(e,h);if(0===h)return da.copyCoordinates(e);var d=this.getSegGen(h);return this.computeRingBufferCurve(e,i,d),d.getCoordinates()},da.prototype.computeOffsetCurve=function(e,i,h){var d=this.simplifyTolerance(this._distance);if(i){var x=Ni.simplify(e,-d),D=x.length-1;h.initSideSegments(x[D],x[D-1],Bt.LEFT),h.addFirstSegment();for(var F=D-2;F>=0;F--)h.addNextSegment(x[F],!0)}else{var $=Ni.simplify(e,d),Ct=$.length-1;h.initSideSegments($[0],$[1],Bt.LEFT),h.addFirstSegment();for(var te=2;te<=Ct;te++)h.addNextSegment($[te],!0)}h.addLastSegment()},da.prototype.getSegGen=function(e){return new wo(this._precisionModel,this._bufParams,e)},da.prototype.interfaces_=function(){return[]},da.prototype.getClass=function(){return da},da.copyCoordinates=function(e){for(var i=new Array(e.length).fill(null),h=0;h<i.length;h++)i[h]=new Z(e[h]);return i};var Ka=function(){this._subgraphs=null,this._seg=new Hr,this._cga=new Ge,this._subgraphs=arguments[0]},rl={DepthSegment:{configurable:!0}};Ka.prototype.findStabbedSegments=function(){if(1===arguments.length){for(var e=arguments[0],i=new cr,h=this._subgraphs.iterator();h.hasNext();){var d=h.next(),x=d.getEnvelope();e.y<x.getMinY()||e.y>x.getMaxY()||this.findStabbedSegments(e,d.getDirectedEdges(),i)}return i}if(3===arguments.length)if(Ce(arguments[2],xn)&&arguments[0]instanceof Z&&arguments[1]instanceof us){for(var D=arguments[0],F=arguments[1],$=arguments[2],Ct=F.getEdge().getCoordinates(),te=0;te<Ct.length-1;te++)if(this._seg.p0=Ct[te],this._seg.p1=Ct[te+1],this._seg.p0.y>this._seg.p1.y&&this._seg.reverse(),!(Math.max(this._seg.p0.x,this._seg.p1.x)<D.x||this._seg.isHorizontal()||D.y<this._seg.p0.y||D.y>this._seg.p1.y||Ge.computeOrientation(this._seg.p0,this._seg.p1,D)===Ge.RIGHT)){var Ne=F.getDepth(Bt.LEFT);this._seg.p0.equals(Ct[te])||(Ne=F.getDepth(Bt.RIGHT));var Ve=new Ua(this._seg,Ne);$.add(Ve)}}else if(Ce(arguments[2],xn)&&arguments[0]instanceof Z&&Ce(arguments[1],xn))for(var gr=arguments[0],Yr=arguments[2],an=arguments[1].iterator();an.hasNext();){var Mi=an.next();Mi.isForward()&&this.findStabbedSegments(gr,Mi,Yr)}},Ka.prototype.getDepth=function(e){var i=this.findStabbedSegments(e);return 0===i.size()?0:cs.min(i)._leftDepth},Ka.prototype.interfaces_=function(){return[]},Ka.prototype.getClass=function(){return Ka},rl.DepthSegment.get=function(){return Ua},Object.defineProperties(Ka,rl);var Ua=function(){this._upwardSeg=null,this._leftDepth=null;var i=arguments[1];this._upwardSeg=new Hr(arguments[0]),this._leftDepth=i};Ua.prototype.compareTo=function(e){var i=e;if(this._upwardSeg.minX()>=i._upwardSeg.maxX())return 1;if(this._upwardSeg.maxX()<=i._upwardSeg.minX())return-1;var h=this._upwardSeg.orientationIndex(i._upwardSeg);return 0!==h||0!=(h=-1*i._upwardSeg.orientationIndex(this._upwardSeg))?h:this._upwardSeg.compareTo(i._upwardSeg)},Ua.prototype.compareX=function(e,i){var h=e.p0.compareTo(i.p0);return 0!==h?h:e.p1.compareTo(i.p1)},Ua.prototype.toString=function(){return this._upwardSeg.toString()},Ua.prototype.interfaces_=function(){return[J]},Ua.prototype.getClass=function(){return Ua};var hi=function(e,i,h){this.p0=e||null,this.p1=i||null,this.p2=h||null};hi.prototype.area=function(){return hi.area(this.p0,this.p1,this.p2)},hi.prototype.signedArea=function(){return hi.signedArea(this.p0,this.p1,this.p2)},hi.prototype.interpolateZ=function(e){if(null===e)throw new tt("Supplied point is null.");return hi.interpolateZ(e,this.p0,this.p1,this.p2)},hi.prototype.longestSideLength=function(){return hi.longestSideLength(this.p0,this.p1,this.p2)},hi.prototype.isAcute=function(){return hi.isAcute(this.p0,this.p1,this.p2)},hi.prototype.circumcentre=function(){return hi.circumcentre(this.p0,this.p1,this.p2)},hi.prototype.area3D=function(){return hi.area3D(this.p0,this.p1,this.p2)},hi.prototype.centroid=function(){return hi.centroid(this.p0,this.p1,this.p2)},hi.prototype.inCentre=function(){return hi.inCentre(this.p0,this.p1,this.p2)},hi.prototype.interfaces_=function(){return[]},hi.prototype.getClass=function(){return hi},hi.area=function(e,i,h){return Math.abs(((h.x-e.x)*(i.y-e.y)-(i.x-e.x)*(h.y-e.y))/2)},hi.signedArea=function(e,i,h){return((h.x-e.x)*(i.y-e.y)-(i.x-e.x)*(h.y-e.y))/2},hi.det=function(e,i,h,d){return e*d-i*h},hi.interpolateZ=function(e,i,h,d){var x=i.x,D=i.y,F=h.x-x,$=d.x-x,Ct=h.y-D,te=d.y-D,Ne=F*te-$*Ct,Ve=e.x-x,gr=e.y-D;return i.z+(te*Ve-$*gr)/Ne*(h.z-i.z)+(-Ct*Ve+F*gr)/Ne*(d.z-i.z)},hi.longestSideLength=function(e,i,h){var d=e.distance(i),x=i.distance(h),D=h.distance(e),F=d;return x>F&&(F=x),D>F&&(F=D),F},hi.isAcute=function(e,i,h){return!!Un.isAcute(e,i,h)&&!!Un.isAcute(i,h,e)&&!!Un.isAcute(h,e,i)},hi.circumcentre=function(e,i,h){var d=h.x,x=h.y,D=e.x-d,F=e.y-x,$=i.x-d,Ct=i.y-x,te=2*hi.det(D,F,$,Ct),Ne=hi.det(F,D*D+F*F,Ct,$*$+Ct*Ct),Ve=hi.det(D,D*D+F*F,$,$*$+Ct*Ct);return new Z(d-Ne/te,x+Ve/te)},hi.perpendicularBisector=function(e,i){var h=i.x-e.x,d=i.y-e.y,x=new Er(e.x+h/2,e.y+d/2,1),D=new Er(e.x-d+h/2,e.y+h+d/2,1);return new Er(x,D)},hi.angleBisector=function(e,i,h){var d=i.distance(e),x=d/(d+i.distance(h));return new Z(e.x+x*(h.x-e.x),e.y+x*(h.y-e.y))},hi.area3D=function(e,i,h){var d=i.x-e.x,x=i.y-e.y,D=i.z-e.z,F=h.x-e.x,$=h.y-e.y,Ct=h.z-e.z,te=x*Ct-D*$,Ne=D*F-d*Ct,Ve=d*$-x*F;return Math.sqrt(te*te+Ne*Ne+Ve*Ve)/2},hi.centroid=function(e,i,h){return new Z((e.x+i.x+h.x)/3,(e.y+i.y+h.y)/3)},hi.inCentre=function(e,i,h){var d=i.distance(h),x=e.distance(h),D=e.distance(i),F=d+x+D;return new Z((d*e.x+x*i.x+D*h.x)/F,(d*e.y+x*i.y+D*h.y)/F)};var Wo=function(){this._inputGeom=null,this._distance=null,this._curveBuilder=null,this._curveList=new cr;var i=arguments[1],h=arguments[2];this._inputGeom=arguments[0],this._distance=i,this._curveBuilder=h};Wo.prototype.addPoint=function(e){if(this._distance<=0)return null;var i=e.getCoordinates(),h=this._curveBuilder.getLineCurve(i,this._distance);this.addCurve(h,dt.EXTERIOR,dt.INTERIOR)},Wo.prototype.addPolygon=function(e){var i=this._distance,h=Bt.LEFT;this._distance<0&&(i=-this._distance,h=Bt.RIGHT);var d=e.getExteriorRing(),x=W.removeRepeatedPoints(d.getCoordinates());if(this._distance<0&&this.isErodedCompletely(d,this._distance)||this._distance<=0&&x.length<3)return null;this.addPolygonRing(x,i,h,dt.EXTERIOR,dt.INTERIOR);for(var D=0;D<e.getNumInteriorRing();D++){var F=e.getInteriorRingN(D),$=W.removeRepeatedPoints(F.getCoordinates());this._distance>0&&this.isErodedCompletely(F,-this._distance)||this.addPolygonRing($,i,Bt.opposite(h),dt.INTERIOR,dt.EXTERIOR)}},Wo.prototype.isTriangleErodedCompletely=function(e,i){var h=new hi(e[0],e[1],e[2]),d=h.inCentre();return Ge.distancePointLine(d,h.p0,h.p1)<Math.abs(i)},Wo.prototype.addLineString=function(e){if(this._distance<=0&&!this._curveBuilder.getBufferParameters().isSingleSided())return null;var i=W.removeRepeatedPoints(e.getCoordinates()),h=this._curveBuilder.getLineCurve(i,this._distance);this.addCurve(h,dt.EXTERIOR,dt.INTERIOR)},Wo.prototype.addCurve=function(e,i,h){if(null===e||e.length<2)return null;var d=new ki(e,new lr(0,dt.BOUNDARY,i,h));this._curveList.add(d)},Wo.prototype.getCurves=function(){return this.add(this._inputGeom),this._curveList},Wo.prototype.addPolygonRing=function(e,i,h,d,x){if(0===i&&e.length<ni.MINIMUM_VALID_SIZE)return null;var D=d,F=x;e.length>=ni.MINIMUM_VALID_SIZE&&Ge.isCCW(e)&&(D=x,F=d,h=Bt.opposite(h));var $=this._curveBuilder.getRingCurve(e,h,i);this.addCurve($,D,F)},Wo.prototype.add=function(e){if(e.isEmpty())return null;e instanceof Tn?this.addPolygon(e):e instanceof Nr?this.addLineString(e):e instanceof ai?this.addPoint(e):(e instanceof co||e instanceof vr||e instanceof Xr||e instanceof Xe)&&this.addCollection(e)},Wo.prototype.isErodedCompletely=function(e,i){var h=e.getCoordinates();if(h.length<4)return i<0;if(4===h.length)return this.isTriangleErodedCompletely(h,i);var d=e.getEnvelopeInternal(),x=Math.min(d.getHeight(),d.getWidth());return i<0&&2*Math.abs(i)>x},Wo.prototype.addCollection=function(e){for(var i=0;i<e.getNumGeometries();i++){var h=e.getGeometryN(i);this.add(h)}},Wo.prototype.interfaces_=function(){return[]},Wo.prototype.getClass=function(){return Wo};var Eu=function(){};Eu.prototype.locate=function(e){},Eu.prototype.interfaces_=function(){return[]},Eu.prototype.getClass=function(){return Eu};var Qn=function(){this._parent=null,this._atStart=null,this._max=null,this._index=null,this._subcollectionIterator=null;var e=arguments[0];this._parent=e,this._atStart=!0,this._index=0,this._max=e.getNumGeometries()};Qn.prototype.next=function(){if(this._atStart)return this._atStart=!1,Qn.isAtomic(this._parent)&&this._index++,this._parent;if(null!==this._subcollectionIterator){if(this._subcollectionIterator.hasNext())return this._subcollectionIterator.next();this._subcollectionIterator=null}if(this._index>=this._max)throw new s;var e=this._parent.getGeometryN(this._index++);return e instanceof Xe?(this._subcollectionIterator=new Qn(e),this._subcollectionIterator.next()):e},Qn.prototype.remove=function(){throw new Error(this.getClass().getName())},Qn.prototype.hasNext=function(){if(this._atStart)return!0;if(null!==this._subcollectionIterator){if(this._subcollectionIterator.hasNext())return!0;this._subcollectionIterator=null}return!(this._index>=this._max)},Qn.prototype.interfaces_=function(){return[xa]},Qn.prototype.getClass=function(){return Qn},Qn.isAtomic=function(e){return!(e instanceof Xe)};var qa=function(){this._geom=null,this._geom=arguments[0]};qa.prototype.locate=function(e){return qa.locate(e,this._geom)},qa.prototype.interfaces_=function(){return[Eu]},qa.prototype.getClass=function(){return qa},qa.isPointInRing=function(e,i){return!!i.getEnvelopeInternal().intersects(e)&&Ge.isPointInRing(e,i.getCoordinates())},qa.containsPointInPolygon=function(e,i){if(i.isEmpty())return!1;var h=i.getExteriorRing();if(!qa.isPointInRing(e,h))return!1;for(var d=0;d<i.getNumInteriorRing();d++){var x=i.getInteriorRingN(d);if(qa.isPointInRing(e,x))return!1}return!0},qa.containsPoint=function(e,i){if(i instanceof Tn)return qa.containsPointInPolygon(e,i);if(i instanceof Xe)for(var h=new Qn(i);h.hasNext();){var d=h.next();if(d!==i&&qa.containsPoint(e,d))return!0}return!1},qa.locate=function(e,i){return i.isEmpty()?dt.EXTERIOR:qa.containsPoint(e,i)?dt.INTERIOR:dt.EXTERIOR};var Oa=function(){this._edgeMap=new mt,this._edgeList=null,this._ptInAreaLocation=[dt.NONE,dt.NONE]};Oa.prototype.getNextCW=function(e){this.getEdges();var i=this._edgeList.indexOf(e),h=i-1;return 0===i&&(h=this._edgeList.size()-1),this._edgeList.get(h)},Oa.prototype.propagateSideLabels=function(e){for(var i=dt.NONE,h=this.iterator();h.hasNext();){var d=h.next().getLabel();d.isArea(e)&&d.getLocation(e,Bt.LEFT)!==dt.NONE&&(i=d.getLocation(e,Bt.LEFT))}if(i===dt.NONE)return null;for(var x=i,D=this.iterator();D.hasNext();){var F=D.next(),$=F.getLabel();if($.getLocation(e,Bt.ON)===dt.NONE&&$.setLocation(e,Bt.ON,x),$.isArea(e)){var Ct=$.getLocation(e,Bt.LEFT),te=$.getLocation(e,Bt.RIGHT);if(te!==dt.NONE){if(te!==x)throw new ar("side location conflict",F.getCoordinate());Ct===dt.NONE&&ot.shouldNeverReachHere("found single null side (at "+F.getCoordinate()+")"),x=Ct}else ot.isTrue($.getLocation(e,Bt.LEFT)===dt.NONE,"found single null side"),$.setLocation(e,Bt.RIGHT,x),$.setLocation(e,Bt.LEFT,x)}}},Oa.prototype.getCoordinate=function(){var e=this.iterator();return e.hasNext()?e.next().getCoordinate():null},Oa.prototype.print=function(e){jr.out.println("EdgeEndStar:   "+this.getCoordinate());for(var i=this.iterator();i.hasNext();)i.next().print(e)},Oa.prototype.isAreaLabelsConsistent=function(e){return this.computeEdgeEndLabels(e.getBoundaryNodeRule()),this.checkAreaLabelsConsistent(0)},Oa.prototype.checkAreaLabelsConsistent=function(e){var i=this.getEdges();if(i.size()<=0)return!0;var h=i.size()-1,d=i.get(h).getLabel().getLocation(e,Bt.LEFT);ot.isTrue(d!==dt.NONE,"Found unlabelled area edge");for(var x=d,D=this.iterator();D.hasNext();){var F=D.next().getLabel();ot.isTrue(F.isArea(e),"Found non-area edge");var $=F.getLocation(e,Bt.LEFT),Ct=F.getLocation(e,Bt.RIGHT);if($===Ct||Ct!==x)return!1;x=$}return!0},Oa.prototype.findIndex=function(e){this.iterator();for(var i=0;i<this._edgeList.size();i++)if(this._edgeList.get(i)===e)return i;return-1},Oa.prototype.iterator=function(){return this.getEdges().iterator()},Oa.prototype.getEdges=function(){return null===this._edgeList&&(this._edgeList=new cr(this._edgeMap.values())),this._edgeList},Oa.prototype.getLocation=function(e,i,h){return this._ptInAreaLocation[e]===dt.NONE&&(this._ptInAreaLocation[e]=qa.locate(i,h[e].getGeometry())),this._ptInAreaLocation[e]},Oa.prototype.toString=function(){var e=new At;e.append("EdgeEndStar:   "+this.getCoordinate()),e.append("\n");for(var i=this.iterator();i.hasNext();){var h=i.next();e.append(h),e.append("\n")}return e.toString()},Oa.prototype.computeEdgeEndLabels=function(e){for(var i=this.iterator();i.hasNext();)i.next().computeLabel(e)},Oa.prototype.computeLabelling=function(e){this.computeEdgeEndLabels(e[0].getBoundaryNodeRule()),this.propagateSideLabels(0),this.propagateSideLabels(1);for(var i=[!1,!1],h=this.iterator();h.hasNext();)for(var d=h.next().getLabel(),x=0;x<2;x++)d.isLine(x)&&d.getLocation(x)===dt.BOUNDARY&&(i[x]=!0);for(var D=this.iterator();D.hasNext();)for(var F=D.next(),$=F.getLabel(),Ct=0;Ct<2;Ct++)if($.isAnyNull(Ct)){var te=dt.NONE;if(i[Ct])te=dt.EXTERIOR;else{var Ne=F.getCoordinate();te=this.getLocation(Ct,Ne,e)}$.setAllLocationsIfNull(Ct,te)}},Oa.prototype.getDegree=function(){return this._edgeMap.size()},Oa.prototype.insertEdgeEnd=function(e,i){this._edgeMap.put(e,i),this._edgeList=null},Oa.prototype.interfaces_=function(){return[]},Oa.prototype.getClass=function(){return Oa};var zu=function(e){function i(){e.call(this),this._resultAreaEdgeList=null,this._label=null,this._SCANNING_FOR_INCOMING=1,this._LINKING_TO_OUTGOING=2}return e&&(i.__proto__=e),(i.prototype=Object.create(e&&e.prototype)).constructor=i,i.prototype.linkResultDirectedEdges=function(){this.getResultAreaEdges();for(var h=null,d=null,x=this._SCANNING_FOR_INCOMING,D=0;D<this._resultAreaEdgeList.size();D++){var F=this._resultAreaEdgeList.get(D),$=F.getSym();if(F.getLabel().isArea())switch(null===h&&F.isInResult()&&(h=F),x){case this._SCANNING_FOR_INCOMING:if(!$.isInResult())continue;d=$,x=this._LINKING_TO_OUTGOING;break;case this._LINKING_TO_OUTGOING:if(!F.isInResult())continue;d.setNext(F),x=this._SCANNING_FOR_INCOMING}}if(x===this._LINKING_TO_OUTGOING){if(null===h)throw new ar("no outgoing dirEdge found",this.getCoordinate());ot.isTrue(h.isInResult(),"unable to link last incoming dirEdge"),d.setNext(h)}},i.prototype.insert=function(h){this.insertEdgeEnd(h,h)},i.prototype.getRightmostEdge=function(){var h=this.getEdges(),d=h.size();if(d<1)return null;var x=h.get(0);if(1===d)return x;var D=h.get(d-1),F=x.getQuadrant(),$=D.getQuadrant();return rn.isNorthern(F)&&rn.isNorthern($)?x:rn.isNorthern(F)||rn.isNorthern($)?0!==x.getDy()?x:0!==D.getDy()?D:(ot.shouldNeverReachHere("found two horizontal edges incident on node"),null):D},i.prototype.print=function(h){jr.out.println("DirectedEdgeStar: "+this.getCoordinate());for(var d=this.iterator();d.hasNext();){var x=d.next();h.print("out "),x.print(h),h.println(),h.print("in "),x.getSym().print(h),h.println()}},i.prototype.getResultAreaEdges=function(){if(null!==this._resultAreaEdgeList)return this._resultAreaEdgeList;this._resultAreaEdgeList=new cr;for(var h=this.iterator();h.hasNext();){var d=h.next();(d.isInResult()||d.getSym().isInResult())&&this._resultAreaEdgeList.add(d)}return this._resultAreaEdgeList},i.prototype.updateLabelling=function(h){for(var d=this.iterator();d.hasNext();){var x=d.next().getLabel();x.setAllLocationsIfNull(0,h.getLocation(0)),x.setAllLocationsIfNull(1,h.getLocation(1))}},i.prototype.linkAllDirectedEdges=function(){this.getEdges();for(var h=null,d=null,x=this._edgeList.size()-1;x>=0;x--){var D=this._edgeList.get(x),F=D.getSym();null===d&&(d=F),null!==h&&F.setNext(h),h=D}d.setNext(h)},i.prototype.computeDepths=function(){if(1===arguments.length){var h=arguments[0],d=this.findIndex(h),x=h.getDepth(Bt.LEFT),D=h.getDepth(Bt.RIGHT),F=this.computeDepths(d+1,this._edgeList.size(),x);if(this.computeDepths(0,d,F)!==D)throw new ar("depth mismatch at "+h.getCoordinate())}else if(3===arguments.length){for(var Ct=arguments[1],te=arguments[2],Ne=arguments[0];Ne<Ct;Ne++){var Ve=this._edgeList.get(Ne);Ve.setEdgeDepths(Bt.RIGHT,te),te=Ve.getDepth(Bt.LEFT)}return te}},i.prototype.mergeSymLabels=function(){for(var h=this.iterator();h.hasNext();){var d=h.next();d.getLabel().merge(d.getSym().getLabel())}},i.prototype.linkMinimalDirectedEdges=function(h){for(var d=null,x=null,D=this._SCANNING_FOR_INCOMING,F=this._resultAreaEdgeList.size()-1;F>=0;F--){var $=this._resultAreaEdgeList.get(F),Ct=$.getSym();switch(null===d&&$.getEdgeRing()===h&&(d=$),D){case this._SCANNING_FOR_INCOMING:if(Ct.getEdgeRing()!==h)continue;x=Ct,D=this._LINKING_TO_OUTGOING;break;case this._LINKING_TO_OUTGOING:if($.getEdgeRing()!==h)continue;x.setNextMin($),D=this._SCANNING_FOR_INCOMING}}D===this._LINKING_TO_OUTGOING&&(ot.isTrue(null!==d,"found null for first outgoing dirEdge"),ot.isTrue(d.getEdgeRing()===h,"unable to link last incoming dirEdge"),x.setNextMin(d))},i.prototype.getOutgoingDegree=function(){if(0===arguments.length){for(var h=0,d=this.iterator();d.hasNext();)d.next().isInResult()&&h++;return h}if(1===arguments.length){for(var x=arguments[0],D=0,F=this.iterator();F.hasNext();)F.next().getEdgeRing()===x&&D++;return D}},i.prototype.getLabel=function(){return this._label},i.prototype.findCoveredLineEdges=function(){for(var h=dt.NONE,d=this.iterator();d.hasNext();){var x=d.next(),D=x.getSym();if(!x.isLineEdge()){if(x.isInResult()){h=dt.INTERIOR;break}if(D.isInResult()){h=dt.EXTERIOR;break}}}if(h===dt.NONE)return null;for(var F=h,$=this.iterator();$.hasNext();){var Ct=$.next(),te=Ct.getSym();Ct.isLineEdge()?Ct.getEdge().setCovered(F===dt.INTERIOR):(Ct.isInResult()&&(F=dt.EXTERIOR),te.isInResult()&&(F=dt.INTERIOR))}},i.prototype.computeLabelling=function(h){e.prototype.computeLabelling.call(this,h),this._label=new lr(dt.NONE);for(var d=this.iterator();d.hasNext();)for(var x=d.next().getEdge().getLabel(),D=0;D<2;D++){var F=x.getLocation(D);F!==dt.INTERIOR&&F!==dt.BOUNDARY||this._label.setLocation(D,dt.INTERIOR)}},i.prototype.interfaces_=function(){return[]},i.prototype.getClass=function(){return i},i}(Oa),Cl=function(e){function i(){e.apply(this,arguments)}return e&&(i.__proto__=e),(i.prototype=Object.create(e&&e.prototype)).constructor=i,i.prototype.createNode=function(h){return new Vr(h,new zu)},i.prototype.interfaces_=function(){return[]},i.prototype.getClass=function(){return i},i}(ls),Su=function e(){this._pts=null,this._orientation=null;var i=arguments[0];this._pts=i,this._orientation=e.orientation(i)};Su.prototype.compareTo=function(e){return Su.compareOriented(this._pts,this._orientation,e._pts,e._orientation)},Su.prototype.interfaces_=function(){return[J]},Su.prototype.getClass=function(){return Su},Su.orientation=function(e){return 1===W.increasingDirection(e)},Su.compareOriented=function(e,i,h,d){for(var x=i?1:-1,D=d?1:-1,F=i?e.length:-1,$=d?h.length:-1,Ct=i?0:e.length-1,te=d?0:h.length-1;;){var Ne=e[Ct].compareTo(h[te]);if(0!==Ne)return Ne;var Ve=(Ct+=x)===F,gr=(te+=D)===$;if(Ve&&!gr)return-1;if(!Ve&&gr)return 1;if(Ve&&gr)return 0}};var $a=function(){this._edges=new cr,this._ocaMap=new mt};$a.prototype.print=function(e){e.print("MULTILINESTRING ( ");for(var i=0;i<this._edges.size();i++){var h=this._edges.get(i);i>0&&e.print(","),e.print("(");for(var d=h.getCoordinates(),x=0;x<d.length;x++)x>0&&e.print(","),e.print(d[x].x+" "+d[x].y);e.println(")")}e.print(")  ")},$a.prototype.addAll=function(e){for(var i=e.iterator();i.hasNext();)this.add(i.next())},$a.prototype.findEdgeIndex=function(e){for(var i=0;i<this._edges.size();i++)if(this._edges.get(i).equals(e))return i;return-1},$a.prototype.iterator=function(){return this._edges.iterator()},$a.prototype.getEdges=function(){return this._edges},$a.prototype.get=function(e){return this._edges.get(e)},$a.prototype.findEqualEdge=function(e){var i=new Su(e.getCoordinates());return this._ocaMap.get(i)},$a.prototype.add=function(e){this._edges.add(e);var i=new Su(e.getCoordinates());this._ocaMap.put(i,e)},$a.prototype.interfaces_=function(){return[]},$a.prototype.getClass=function(){return $a};var Au=function(){};Au.prototype.processIntersections=function(e,i,h,d){},Au.prototype.isDone=function(){},Au.prototype.interfaces_=function(){return[]},Au.prototype.getClass=function(){return Au};var Ko=function(){this._hasIntersection=!1,this._hasProper=!1,this._hasProperInterior=!1,this._hasInterior=!1,this._properIntersectionPoint=null,this._li=null,this._isSelfIntersection=null,this.numIntersections=0,this.numInteriorIntersections=0,this.numProperIntersections=0,this.numTests=0,this._li=arguments[0]};Ko.prototype.isTrivialIntersection=function(e,i,h,d){if(e===h&&1===this._li.getIntersectionNum()){if(Ko.isAdjacentSegments(i,d))return!0;if(e.isClosed()){var x=e.size()-1;if(0===i&&d===x||0===d&&i===x)return!0}}return!1},Ko.prototype.getProperIntersectionPoint=function(){return this._properIntersectionPoint},Ko.prototype.hasProperInteriorIntersection=function(){return this._hasProperInterior},Ko.prototype.getLineIntersector=function(){return this._li},Ko.prototype.hasProperIntersection=function(){return this._hasProper},Ko.prototype.processIntersections=function(e,i,h,d){if(e===h&&i===d)return null;this.numTests++;var x=e.getCoordinates()[i],D=e.getCoordinates()[i+1],F=h.getCoordinates()[d],$=h.getCoordinates()[d+1];this._li.computeIntersection(x,D,F,$),this._li.hasIntersection()&&(this.numIntersections++,this._li.isInteriorIntersection()&&(this.numInteriorIntersections++,this._hasInterior=!0),this.isTrivialIntersection(e,i,h,d)||(this._hasIntersection=!0,e.addIntersections(this._li,i,0),h.addIntersections(this._li,d,1),this._li.isProper()&&(this.numProperIntersections++,this._hasProper=!0,this._hasProperInterior=!0)))},Ko.prototype.hasIntersection=function(){return this._hasIntersection},Ko.prototype.isDone=function(){return!1},Ko.prototype.hasInteriorIntersection=function(){return this._hasInterior},Ko.prototype.interfaces_=function(){return[Au]},Ko.prototype.getClass=function(){return Ko},Ko.isAdjacentSegments=function(e,i){return 1===Math.abs(e-i)};var ms=function(){this.coord=null,this.segmentIndex=null,this.dist=null;var i=arguments[1],h=arguments[2];this.coord=new Z(arguments[0]),this.segmentIndex=i,this.dist=h};ms.prototype.getSegmentIndex=function(){return this.segmentIndex},ms.prototype.getCoordinate=function(){return this.coord},ms.prototype.print=function(e){e.print(this.coord),e.print(" seg # = "+this.segmentIndex),e.println(" dist = "+this.dist)},ms.prototype.compareTo=function(e){return this.compare(e.segmentIndex,e.dist)},ms.prototype.isEndPoint=function(e){return 0===this.segmentIndex&&0===this.dist||this.segmentIndex===e},ms.prototype.toString=function(){return this.coord+" seg # = "+this.segmentIndex+" dist = "+this.dist},ms.prototype.getDistance=function(){return this.dist},ms.prototype.compare=function(e,i){return this.segmentIndex<e?-1:this.segmentIndex>e?1:this.dist<i?-1:this.dist>i?1:0},ms.prototype.interfaces_=function(){return[J]},ms.prototype.getClass=function(){return ms};var Gs=function(){this._nodeMap=new mt,this.edge=null,this.edge=arguments[0]};Gs.prototype.print=function(e){e.println("Intersections:");for(var i=this.iterator();i.hasNext();)i.next().print(e)},Gs.prototype.iterator=function(){return this._nodeMap.values().iterator()},Gs.prototype.addSplitEdges=function(e){this.addEndpoints();for(var i=this.iterator(),h=i.next();i.hasNext();){var d=i.next(),x=this.createSplitEdge(h,d);e.add(x),h=d}},Gs.prototype.addEndpoints=function(){var e=this.edge.pts.length-1;this.add(this.edge.pts[0],0,0),this.add(this.edge.pts[e],e,0)},Gs.prototype.createSplitEdge=function(e,i){var h=i.segmentIndex-e.segmentIndex+2,x=i.dist>0||!i.coord.equals2D(this.edge.pts[i.segmentIndex]);x||h--;var D=new Array(h).fill(null),F=0;D[F++]=new Z(e.coord);for(var $=e.segmentIndex+1;$<=i.segmentIndex;$++)D[F++]=this.edge.pts[$];return x&&(D[F]=i.coord),new xi(D,new lr(this.edge._label))},Gs.prototype.add=function(e,i,h){var d=new ms(e,i,h),x=this._nodeMap.get(d);return null!==x?x:(this._nodeMap.put(d,d),d)},Gs.prototype.isIntersection=function(e){for(var i=this.iterator();i.hasNext();)if(i.next().coord.equals(e))return!0;return!1},Gs.prototype.interfaces_=function(){return[]},Gs.prototype.getClass=function(){return Gs};var be=function(){};be.prototype.getChainStartIndices=function(e){var i=0,h=new cr;h.add(new $t(i));do{var d=this.findChainEnd(e,i);h.add(new $t(d)),i=d}while(i<e.length-1);return be.toIntArray(h)},be.prototype.findChainEnd=function(e,i){for(var h=rn.quadrant(e[i],e[i+1]),d=i+1;d<e.length&&rn.quadrant(e[d-1],e[d])===h;)d++;return d-1},be.prototype.interfaces_=function(){return[]},be.prototype.getClass=function(){return be},be.toIntArray=function(e){for(var i=new Array(e.size()).fill(null),h=0;h<i.length;h++)i[h]=e.get(h).intValue();return i};var Ye=function(){this.e=null,this.pts=null,this.startIndex=null,this.env1=new He,this.env2=new He;var e=arguments[0];this.e=e,this.pts=e.getCoordinates();var i=new be;this.startIndex=i.getChainStartIndices(this.pts)};Ye.prototype.getCoordinates=function(){return this.pts},Ye.prototype.getMaxX=function(e){var i=this.pts[this.startIndex[e]].x,h=this.pts[this.startIndex[e+1]].x;return i>h?i:h},Ye.prototype.getMinX=function(e){var i=this.pts[this.startIndex[e]].x,h=this.pts[this.startIndex[e+1]].x;return i<h?i:h},Ye.prototype.computeIntersectsForChain=function(){if(4===arguments.length){var e=arguments[0],i=arguments[1],h=arguments[2];this.computeIntersectsForChain(this.startIndex[e],this.startIndex[e+1],i,i.startIndex[h],i.startIndex[h+1],arguments[3])}else if(6===arguments.length){var x=arguments[0],D=arguments[1],F=arguments[2],$=arguments[3],Ct=arguments[4],te=arguments[5],Ne=this.pts[x],Ve=this.pts[D],gr=F.pts[$],Pr=F.pts[Ct];if(D-x==1&&Ct-$==1)return te.addIntersections(this.e,x,F.e,$),null;if(this.env1.init(Ne,Ve),this.env2.init(gr,Pr),!this.env1.intersects(this.env2))return null;var Yr=Math.trunc((x+D)/2),an=Math.trunc(($+Ct)/2);x<Yr&&($<an&&this.computeIntersectsForChain(x,Yr,F,$,an,te),an<Ct&&this.computeIntersectsForChain(x,Yr,F,an,Ct,te)),Yr<D&&($<an&&this.computeIntersectsForChain(Yr,D,F,$,an,te),an<Ct&&this.computeIntersectsForChain(Yr,D,F,an,Ct,te))}},Ye.prototype.getStartIndexes=function(){return this.startIndex},Ye.prototype.computeIntersects=function(e,i){for(var h=0;h<this.startIndex.length-1;h++)for(var d=0;d<e.startIndex.length-1;d++)this.computeIntersectsForChain(h,e,d,i)},Ye.prototype.interfaces_=function(){return[]},Ye.prototype.getClass=function(){return Ye};var dr=function e(){this._depth=Array(2).fill().map(function(){return Array(3)});for(var i=0;i<2;i++)for(var h=0;h<3;h++)this._depth[i][h]=e.NULL_VALUE},dn={NULL_VALUE:{configurable:!0}};dr.prototype.getDepth=function(e,i){return this._depth[e][i]},dr.prototype.setDepth=function(e,i,h){this._depth[e][i]=h},dr.prototype.isNull=function(){if(0===arguments.length){for(var e=0;e<2;e++)for(var i=0;i<3;i++)if(this._depth[e][i]!==dr.NULL_VALUE)return!1;return!0}return 1===arguments.length?this._depth[arguments[0]][1]===dr.NULL_VALUE:2===arguments.length?this._depth[arguments[0]][arguments[1]]===dr.NULL_VALUE:void 0},dr.prototype.normalize=function(){for(var e=0;e<2;e++)if(!this.isNull(e)){var i=this._depth[e][1];this._depth[e][2]<i&&(i=this._depth[e][2]),i<0&&(i=0);for(var h=1;h<3;h++){var d=0;this._depth[e][h]>i&&(d=1),this._depth[e][h]=d}}},dr.prototype.getDelta=function(e){return this._depth[e][Bt.RIGHT]-this._depth[e][Bt.LEFT]},dr.prototype.getLocation=function(e,i){return this._depth[e][i]<=0?dt.EXTERIOR:dt.INTERIOR},dr.prototype.toString=function(){return"A: "+this._depth[0][1]+","+this._depth[0][2]+" B: "+this._depth[1][1]+","+this._depth[1][2]},dr.prototype.add=function(){if(1===arguments.length)for(var e=arguments[0],i=0;i<2;i++)for(var h=1;h<3;h++){var d=e.getLocation(i,h);d!==dt.EXTERIOR&&d!==dt.INTERIOR||(this.isNull(i,h)?this._depth[i][h]=dr.depthAtLocation(d):this._depth[i][h]+=dr.depthAtLocation(d))}else 3===arguments.length&&arguments[2]===dt.INTERIOR&&this._depth[arguments[0]][arguments[1]]++},dr.prototype.interfaces_=function(){return[]},dr.prototype.getClass=function(){return dr},dr.depthAtLocation=function(e){return e===dt.EXTERIOR?0:e===dt.INTERIOR?1:dr.NULL_VALUE},dn.NULL_VALUE.get=function(){return-1},Object.defineProperties(dr,dn);var xi=function(e){function i(){if(e.call(this),this.pts=null,this._env=null,this.eiList=new Gs(this),this._name=null,this._mce=null,this._isIsolated=!0,this._depth=new dr,this._depthDelta=0,1===arguments.length)i.call(this,arguments[0],null);else if(2===arguments.length){var x=arguments[1];this.pts=arguments[0],this._label=x}}return e&&(i.__proto__=e),(i.prototype=Object.create(e&&e.prototype)).constructor=i,i.prototype.getDepth=function(){return this._depth},i.prototype.getCollapsedEdge=function(){var h=new Array(2).fill(null);return h[0]=this.pts[0],h[1]=this.pts[1],new i(h,lr.toLineLabel(this._label))},i.prototype.isIsolated=function(){return this._isIsolated},i.prototype.getCoordinates=function(){return this.pts},i.prototype.setIsolated=function(h){this._isIsolated=h},i.prototype.setName=function(h){this._name=h},i.prototype.equals=function(h){if(!(h instanceof i))return!1;var d=h;if(this.pts.length!==d.pts.length)return!1;for(var x=!0,D=!0,F=this.pts.length,$=0;$<this.pts.length;$++)if(this.pts[$].equals2D(d.pts[$])||(x=!1),this.pts[$].equals2D(d.pts[--F])||(D=!1),!x&&!D)return!1;return!0},i.prototype.getCoordinate=function(){return 0===arguments.length?this.pts.length>0?this.pts[0]:null:1===arguments.length?this.pts[arguments[0]]:void 0},i.prototype.print=function(h){h.print("edge "+this._name+": "),h.print("LINESTRING (");for(var d=0;d<this.pts.length;d++)d>0&&h.print(","),h.print(this.pts[d].x+" "+this.pts[d].y);h.print(")  "+this._label+" "+this._depthDelta)},i.prototype.computeIM=function(h){i.updateIM(this._label,h)},i.prototype.isCollapsed=function(){return!!this._label.isArea()&&3===this.pts.length&&!!this.pts[0].equals(this.pts[2])},i.prototype.isClosed=function(){return this.pts[0].equals(this.pts[this.pts.length-1])},i.prototype.getMaximumSegmentIndex=function(){return this.pts.length-1},i.prototype.getDepthDelta=function(){return this._depthDelta},i.prototype.getNumPoints=function(){return this.pts.length},i.prototype.printReverse=function(h){h.print("edge "+this._name+": ");for(var d=this.pts.length-1;d>=0;d--)h.print(this.pts[d]+" ");h.println("")},i.prototype.getMonotoneChainEdge=function(){return null===this._mce&&(this._mce=new Ye(this)),this._mce},i.prototype.getEnvelope=function(){if(null===this._env){this._env=new He;for(var h=0;h<this.pts.length;h++)this._env.expandToInclude(this.pts[h])}return this._env},i.prototype.addIntersection=function(h,d,x,D){var F=new Z(h.getIntersection(D)),$=d,Ct=h.getEdgeDistance(x,D),te=$+1;te<this.pts.length&&F.equals2D(this.pts[te])&&($=te,Ct=0),this.eiList.add(F,$,Ct)},i.prototype.toString=function(){var h=new At;h.append("edge "+this._name+": "),h.append("LINESTRING (");for(var d=0;d<this.pts.length;d++)d>0&&h.append(","),h.append(this.pts[d].x+" "+this.pts[d].y);return h.append(")  "+this._label+" "+this._depthDelta),h.toString()},i.prototype.isPointwiseEqual=function(h){if(this.pts.length!==h.pts.length)return!1;for(var d=0;d<this.pts.length;d++)if(!this.pts[d].equals2D(h.pts[d]))return!1;return!0},i.prototype.setDepthDelta=function(h){this._depthDelta=h},i.prototype.getEdgeIntersectionList=function(){return this.eiList},i.prototype.addIntersections=function(h,d,x){for(var D=0;D<h.getIntersectionNum();D++)this.addIntersection(h,d,x,D)},i.prototype.interfaces_=function(){return[]},i.prototype.getClass=function(){return i},i.updateIM=function(){if(2!==arguments.length)return e.prototype.updateIM.apply(this,arguments);var h=arguments[0],d=arguments[1];d.setAtLeastIfValid(h.getLocation(0,Bt.ON),h.getLocation(1,Bt.ON),1),h.isArea()&&(d.setAtLeastIfValid(h.getLocation(0,Bt.LEFT),h.getLocation(1,Bt.LEFT),2),d.setAtLeastIfValid(h.getLocation(0,Bt.RIGHT),h.getLocation(1,Bt.RIGHT),2))},i}($e),Ln=function(e){this._workingPrecisionModel=null,this._workingNoder=null,this._geomFact=null,this._graph=null,this._edgeList=new $a,this._bufParams=e||null};Ln.prototype.setWorkingPrecisionModel=function(e){this._workingPrecisionModel=e},Ln.prototype.insertUniqueEdge=function(e){var i=this._edgeList.findEqualEdge(e);if(null!==i){var h=i.getLabel(),d=e.getLabel();i.isPointwiseEqual(e)||(d=new lr(e.getLabel())).flip(),h.merge(d);var x=Ln.depthDelta(d),D=i.getDepthDelta()+x;i.setDepthDelta(D)}else this._edgeList.add(e),e.setDepthDelta(Ln.depthDelta(e.getLabel()))},Ln.prototype.buildSubgraphs=function(e,i){for(var h=new cr,d=e.iterator();d.hasNext();){var x=d.next(),D=x.getRightmostCoordinate(),F=new Ka(h).getDepth(D);x.computeDepth(F),x.findResultEdges(),h.add(x),i.add(x.getDirectedEdges(),x.getNodes())}},Ln.prototype.createSubgraphs=function(e){for(var i=new cr,h=e.getNodes().iterator();h.hasNext();){var d=h.next();if(!d.isVisited()){var x=new Ae;x.create(d),i.add(x)}}return cs.sort(i,cs.reverseOrder()),i},Ln.prototype.createEmptyResultGeometry=function(){return this._geomFact.createPolygon()},Ln.prototype.getNoder=function(e){if(null!==this._workingNoder)return this._workingNoder;var i=new Us,h=new Oe;return h.setPrecisionModel(e),i.setSegmentIntersector(new Ko(h)),i},Ln.prototype.buffer=function(e,i){var h=this._workingPrecisionModel;null===h&&(h=e.getPrecisionModel()),this._geomFact=e.getFactory();var d=new da(h,this._bufParams),x=new Wo(e,i,d).getCurves();if(x.size()<=0)return this.createEmptyResultGeometry();this.computeNodedEdges(x,h),this._graph=new qr(new Cl),this._graph.addEdges(this._edgeList.getEdges());var D=this.createSubgraphs(this._graph),F=new Bi(this._geomFact);this.buildSubgraphs(D,F);var $=F.getPolygons();return $.size()<=0?this.createEmptyResultGeometry():this._geomFact.buildGeometry($)},Ln.prototype.computeNodedEdges=function(e,i){var h=this.getNoder(i);h.computeNodes(e);for(var d=h.getNodedSubstrings().iterator();d.hasNext();){var x=d.next(),D=x.getCoordinates();if(2!==D.length||!D[0].equals2D(D[1])){var F=x.getData(),$=new xi(x.getCoordinates(),new lr(F));this.insertUniqueEdge($)}}},Ln.prototype.setNoder=function(e){this._workingNoder=e},Ln.prototype.interfaces_=function(){return[]},Ln.prototype.getClass=function(){return Ln},Ln.depthDelta=function(e){var i=e.getLocation(0,Bt.LEFT),h=e.getLocation(0,Bt.RIGHT);return i===dt.INTERIOR&&h===dt.EXTERIOR?1:i===dt.EXTERIOR&&h===dt.INTERIOR?-1:0},Ln.convertSegStrings=function(e){for(var i=new wn,h=new cr;e.hasNext();){var d=e.next(),x=i.createLineString(d.getCoordinates());h.add(x)}return i.buildGeometry(h)};var mo=function(){if(this._noder=null,this._scaleFactor=null,this._offsetX=null,this._offsetY=null,this._isScaled=!1,2===arguments.length){var i=arguments[1];this._noder=arguments[0],this._scaleFactor=i,this._offsetX=0,this._offsetY=0,this._isScaled=!this.isIntegerPrecision()}else if(4===arguments.length){var d=arguments[1],x=arguments[2],D=arguments[3];this._noder=arguments[0],this._scaleFactor=d,this._offsetX=x,this._offsetY=D,this._isScaled=!this.isIntegerPrecision()}};mo.prototype.rescale=function(){if(Ce(arguments[0],Gn))for(var e=arguments[0].iterator();e.hasNext();){var i=e.next();this.rescale(i.getCoordinates())}else if(arguments[0]instanceof Array){for(var h=arguments[0],d=0;d<h.length;d++)h[d].x=h[d].x/this._scaleFactor+this._offsetX,h[d].y=h[d].y/this._scaleFactor+this._offsetY;2===h.length&&h[0].equals2D(h[1])&&jr.out.println(h)}},mo.prototype.scale=function(){if(Ce(arguments[0],Gn)){for(var e=arguments[0],i=new cr,h=e.iterator();h.hasNext();){var d=h.next();i.add(new ki(this.scale(d.getCoordinates()),d.getData()))}return i}if(arguments[0]instanceof Array){for(var x=arguments[0],D=new Array(x.length).fill(null),F=0;F<x.length;F++)D[F]=new Z(Math.round((x[F].x-this._offsetX)*this._scaleFactor),Math.round((x[F].y-this._offsetY)*this._scaleFactor),x[F].z);return W.removeRepeatedPoints(D)}},mo.prototype.isIntegerPrecision=function(){return 1===this._scaleFactor},mo.prototype.getNodedSubstrings=function(){var e=this._noder.getNodedSubstrings();return this._isScaled&&this.rescale(e),e},mo.prototype.computeNodes=function(e){var i=e;this._isScaled&&(i=this.scale(e)),this._noder.computeNodes(i)},mo.prototype.interfaces_=function(){return[wu]},mo.prototype.getClass=function(){return mo};var Gi=function(){this._li=new Oe,this._segStrings=null,this._segStrings=arguments[0]},Ga={fact:{configurable:!0}};Gi.prototype.checkEndPtVertexIntersections=function(){if(0===arguments.length)for(var e=this._segStrings.iterator();e.hasNext();){var i=e.next().getCoordinates();this.checkEndPtVertexIntersections(i[0],this._segStrings),this.checkEndPtVertexIntersections(i[i.length-1],this._segStrings)}else if(2===arguments.length)for(var h=arguments[0],d=arguments[1].iterator();d.hasNext();)for(var x=d.next().getCoordinates(),D=1;D<x.length-1;D++)if(x[D].equals(h))throw new ut("found endpt/interior pt intersection at index "+D+" :pt "+h)},Gi.prototype.checkInteriorIntersections=function(){if(0===arguments.length)for(var e=this._segStrings.iterator();e.hasNext();)for(var i=e.next(),h=this._segStrings.iterator();h.hasNext();){var d=h.next();this.checkInteriorIntersections(i,d)}else if(2===arguments.length)for(var x=arguments[0],D=arguments[1],F=x.getCoordinates(),$=D.getCoordinates(),Ct=0;Ct<F.length-1;Ct++)for(var te=0;te<$.length-1;te++)this.checkInteriorIntersections(x,Ct,D,te);else if(4===arguments.length){var Ne=arguments[0],Ve=arguments[1],gr=arguments[2],Pr=arguments[3];if(Ne===gr&&Ve===Pr)return null;var Yr=Ne.getCoordinates()[Ve],an=Ne.getCoordinates()[Ve+1],Mi=gr.getCoordinates()[Pr],l=gr.getCoordinates()[Pr+1];if(this._li.computeIntersection(Yr,an,Mi,l),this._li.hasIntersection()&&(this._li.isProper()||this.hasInteriorIntersection(this._li,Yr,an)||this.hasInteriorIntersection(this._li,Mi,l)))throw new ut("found non-noded intersection at "+Yr+"-"+an+" and "+Mi+"-"+l)}},Gi.prototype.checkValid=function(){this.checkEndPtVertexIntersections(),this.checkInteriorIntersections(),this.checkCollapses()},Gi.prototype.checkCollapses=function(){if(0===arguments.length)for(var e=this._segStrings.iterator();e.hasNext();){var i=e.next();this.checkCollapses(i)}else if(1===arguments.length)for(var h=arguments[0].getCoordinates(),d=0;d<h.length-2;d++)this.checkCollapse(h[d],h[d+1],h[d+2])},Gi.prototype.hasInteriorIntersection=function(e,i,h){for(var d=0;d<e.getIntersectionNum();d++){var x=e.getIntersection(d);if(!x.equals(i)&&!x.equals(h))return!0}return!1},Gi.prototype.checkCollapse=function(e,i,h){if(e.equals(h))throw new ut("found non-noded collapse at "+Gi.fact.createLineString([e,i,h]))},Gi.prototype.interfaces_=function(){return[]},Gi.prototype.getClass=function(){return Gi},Ga.fact.get=function(){return new wn},Object.defineProperties(Gi,Ga);var mi=function(){this._li=null,this._pt=null,this._originalPt=null,this._ptScaled=null,this._p0Scaled=null,this._p1Scaled=null,this._scaleFactor=null,this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,this._corner=new Array(4).fill(null),this._safeEnv=null;var e=arguments[0],i=arguments[1],h=arguments[2];if(this._originalPt=e,this._pt=e,this._scaleFactor=i,this._li=h,i<=0)throw new tt("Scale factor must be non-zero");1!==i&&(this._pt=new Z(this.scale(e.x),this.scale(e.y)),this._p0Scaled=new Z,this._p1Scaled=new Z),this.initCorners(this._pt)},$o={SAFE_ENV_EXPANSION_FACTOR:{configurable:!0}};mi.prototype.intersectsScaled=function(e,i){var h=Math.min(e.x,i.x),d=Math.max(e.x,i.x),x=Math.min(e.y,i.y),D=Math.max(e.y,i.y),F=this._maxx<h||this._minx>d||this._maxy<x||this._miny>D;if(F)return!1;var $=this.intersectsToleranceSquare(e,i);return ot.isTrue(!(F&&$),"Found bad envelope test"),$},mi.prototype.initCorners=function(e){this._minx=e.x-.5,this._maxx=e.x+.5,this._miny=e.y-.5,this._maxy=e.y+.5,this._corner[0]=new Z(this._maxx,this._maxy),this._corner[1]=new Z(this._minx,this._maxy),this._corner[2]=new Z(this._minx,this._miny),this._corner[3]=new Z(this._maxx,this._miny)},mi.prototype.intersects=function(e,i){return 1===this._scaleFactor?this.intersectsScaled(e,i):(this.copyScaled(e,this._p0Scaled),this.copyScaled(i,this._p1Scaled),this.intersectsScaled(this._p0Scaled,this._p1Scaled))},mi.prototype.scale=function(e){return Math.round(e*this._scaleFactor)},mi.prototype.getCoordinate=function(){return this._originalPt},mi.prototype.copyScaled=function(e,i){i.x=this.scale(e.x),i.y=this.scale(e.y)},mi.prototype.getSafeEnvelope=function(){if(null===this._safeEnv){var e=mi.SAFE_ENV_EXPANSION_FACTOR/this._scaleFactor;this._safeEnv=new He(this._originalPt.x-e,this._originalPt.x+e,this._originalPt.y-e,this._originalPt.y+e)}return this._safeEnv},mi.prototype.intersectsPixelClosure=function(e,i){return this._li.computeIntersection(e,i,this._corner[0],this._corner[1]),!!(this._li.hasIntersection()||(this._li.computeIntersection(e,i,this._corner[1],this._corner[2]),this._li.hasIntersection()||(this._li.computeIntersection(e,i,this._corner[2],this._corner[3]),this._li.hasIntersection()||(this._li.computeIntersection(e,i,this._corner[3],this._corner[0]),this._li.hasIntersection()))))},mi.prototype.intersectsToleranceSquare=function(e,i){var h=!1,d=!1;return this._li.computeIntersection(e,i,this._corner[0],this._corner[1]),!!(this._li.isProper()||(this._li.computeIntersection(e,i,this._corner[1],this._corner[2]),this._li.isProper()||(this._li.hasIntersection()&&(h=!0),this._li.computeIntersection(e,i,this._corner[2],this._corner[3]),this._li.isProper()||(this._li.hasIntersection()&&(d=!0),this._li.computeIntersection(e,i,this._corner[3],this._corner[0]),this._li.isProper()||h&&d||e.equals(this._pt)||i.equals(this._pt)))))},mi.prototype.addSnappedNode=function(e,i){var h=e.getCoordinate(i),d=e.getCoordinate(i+1);return!!this.intersects(h,d)&&(e.addIntersection(this.getCoordinate(),i),!0)},mi.prototype.interfaces_=function(){return[]},mi.prototype.getClass=function(){return mi},$o.SAFE_ENV_EXPANSION_FACTOR.get=function(){return.75},Object.defineProperties(mi,$o);var As=function(){this.tempEnv1=new He,this.selectedSegment=new Hr};As.prototype.select=function(){1!==arguments.length&&2===arguments.length&&(arguments[0].getLineSegment(arguments[1],this.selectedSegment),this.select(this.selectedSegment))},As.prototype.interfaces_=function(){return[]},As.prototype.getClass=function(){return As};var Qa=function(){this._index=null,this._index=arguments[0]},ys={HotPixelSnapAction:{configurable:!0}};Qa.prototype.snap=function(){if(1===arguments.length)return this.snap(arguments[0],null,-1);if(3===arguments.length){var i=arguments[0],h=arguments[1],d=arguments[2],x=i.getSafeEnvelope(),D=new Qs(i,h,d);return this._index.query(x,{interfaces_:function(){return[sa]},visitItem:function(F){F.select(x,D)}}),D.isNodeAdded()}},Qa.prototype.interfaces_=function(){return[]},Qa.prototype.getClass=function(){return Qa},ys.HotPixelSnapAction.get=function(){return Qs},Object.defineProperties(Qa,ys);var Qs=function(e){function i(){e.call(this),this._hotPixel=null,this._parentEdge=null,this._hotPixelVertexIndex=null,this._isNodeAdded=!1;var d=arguments[1],x=arguments[2];this._hotPixel=arguments[0],this._parentEdge=d,this._hotPixelVertexIndex=x}return e&&(i.__proto__=e),(i.prototype=Object.create(e&&e.prototype)).constructor=i,i.prototype.isNodeAdded=function(){return this._isNodeAdded},i.prototype.select=function(){if(2!==arguments.length)return e.prototype.select.apply(this,arguments);var d=arguments[1],x=arguments[0].getContext();if(null!==this._parentEdge&&x===this._parentEdge&&d===this._hotPixelVertexIndex)return null;this._isNodeAdded=this._hotPixel.addSnappedNode(x,d)},i.prototype.interfaces_=function(){return[]},i.prototype.getClass=function(){return i},i}(As),Vs=function(){this._li=null,this._interiorIntersections=null,this._li=arguments[0],this._interiorIntersections=new cr};Vs.prototype.processIntersections=function(e,i,h,d){if(e===h&&i===d)return null;var x=e.getCoordinates()[i],D=e.getCoordinates()[i+1],F=h.getCoordinates()[d],$=h.getCoordinates()[d+1];if(this._li.computeIntersection(x,D,F,$),this._li.hasIntersection()&&this._li.isInteriorIntersection()){for(var Ct=0;Ct<this._li.getIntersectionNum();Ct++)this._interiorIntersections.add(this._li.getIntersection(Ct));e.addIntersections(this._li,i,0),h.addIntersections(this._li,d,1)}},Vs.prototype.isDone=function(){return!1},Vs.prototype.getInteriorIntersections=function(){return this._interiorIntersections},Vs.prototype.interfaces_=function(){return[Au]},Vs.prototype.getClass=function(){return Vs};var vs=function(){this._pm=null,this._li=null,this._scaleFactor=null,this._noder=null,this._pointSnapper=null,this._nodedSegStrings=null;var e=arguments[0];this._pm=e,this._li=new Oe,this._li.setPrecisionModel(e),this._scaleFactor=e.getScale()};vs.prototype.checkCorrectness=function(e){var i=ki.getNodedSubstrings(e),h=new Gi(i);try{h.checkValid()}catch(d){if(!(d instanceof mr))throw d;d.printStackTrace()}},vs.prototype.getNodedSubstrings=function(){return ki.getNodedSubstrings(this._nodedSegStrings)},vs.prototype.snapRound=function(e,i){var h=this.findInteriorIntersections(e,i);this.computeIntersectionSnaps(h),this.computeVertexSnaps(e)},vs.prototype.findInteriorIntersections=function(e,i){var h=new Vs(i);return this._noder.setSegmentIntersector(h),this._noder.computeNodes(e),h.getInteriorIntersections()},vs.prototype.computeVertexSnaps=function(){if(Ce(arguments[0],Gn))for(var e=arguments[0].iterator();e.hasNext();){var i=e.next();this.computeVertexSnaps(i)}else if(arguments[0]instanceof ki)for(var h=arguments[0],d=h.getCoordinates(),x=0;x<d.length;x++){var D=new mi(d[x],this._scaleFactor,this._li);this._pointSnapper.snap(D,h,x)&&h.addIntersection(d[x],x)}},vs.prototype.computeNodes=function(e){this._nodedSegStrings=e,this._noder=new Us,this._pointSnapper=new Qa(this._noder.getIndex()),this.snapRound(e,this._li)},vs.prototype.computeIntersectionSnaps=function(e){for(var i=e.iterator();i.hasNext();){var h=i.next(),d=new mi(h,this._scaleFactor,this._li);this._pointSnapper.snap(d)}},vs.prototype.interfaces_=function(){return[wu]},vs.prototype.getClass=function(){return vs};var Go=function(){if(this._argGeom=null,this._distance=null,this._bufParams=new $n,this._resultGeometry=null,this._saveException=null,1===arguments.length)this._argGeom=arguments[0];else if(2===arguments.length){var h=arguments[1];this._argGeom=arguments[0],this._bufParams=h}},Zs={CAP_ROUND:{configurable:!0},CAP_BUTT:{configurable:!0},CAP_FLAT:{configurable:!0},CAP_SQUARE:{configurable:!0},MAX_PRECISION_DIGITS:{configurable:!0}};Go.prototype.bufferFixedPrecision=function(e){var i=new mo(new vs(new Bn(1)),e.getScale()),h=new Ln(this._bufParams);h.setWorkingPrecisionModel(e),h.setNoder(i),this._resultGeometry=h.buffer(this._argGeom,this._distance)},Go.prototype.bufferReducedPrecision=function(){var e=this;if(0===arguments.length){for(var i=Go.MAX_PRECISION_DIGITS;i>=0;i--){try{e.bufferReducedPrecision(i)}catch(D){if(!(D instanceof ar))throw D;e._saveException=D}if(null!==e._resultGeometry)return null}throw this._saveException}if(1===arguments.length){var d=Go.precisionScaleFactor(this._argGeom,this._distance,arguments[0]),x=new Bn(d);this.bufferFixedPrecision(x)}},Go.prototype.computeGeometry=function(){if(this.bufferOriginalPrecision(),null!==this._resultGeometry)return null;var e=this._argGeom.getFactory().getPrecisionModel();e.getType()===Bn.FIXED?this.bufferFixedPrecision(e):this.bufferReducedPrecision()},Go.prototype.setQuadrantSegments=function(e){this._bufParams.setQuadrantSegments(e)},Go.prototype.bufferOriginalPrecision=function(){try{var e=new Ln(this._bufParams);this._resultGeometry=e.buffer(this._argGeom,this._distance)}catch(i){if(!(i instanceof ut))throw i;this._saveException=i}},Go.prototype.getResultGeometry=function(e){return this._distance=e,this.computeGeometry(),this._resultGeometry},Go.prototype.setEndCapStyle=function(e){this._bufParams.setEndCapStyle(e)},Go.prototype.interfaces_=function(){return[]},Go.prototype.getClass=function(){return Go},Go.bufferOp=function(){if(2===arguments.length){var i=arguments[1];return new Go(arguments[0]).getResultGeometry(i)}if(3===arguments.length){if(Number.isInteger(arguments[2])&&arguments[0]instanceof hr&&"number"==typeof arguments[1]){var d=arguments[1],x=arguments[2],D=new Go(arguments[0]);return D.setQuadrantSegments(x),D.getResultGeometry(d)}if(arguments[2]instanceof $n&&arguments[0]instanceof hr&&"number"==typeof arguments[1]){var $=arguments[1];return new Go(arguments[0],arguments[2]).getResultGeometry($)}}else if(4===arguments.length){var Ne=arguments[1],Ve=arguments[2],gr=arguments[3],Pr=new Go(arguments[0]);return Pr.setQuadrantSegments(Ve),Pr.setEndCapStyle(gr),Pr.getResultGeometry(Ne)}},Go.precisionScaleFactor=function(e,i,h){var d=e.getEnvelopeInternal(),x=Mt.max(Math.abs(d.getMaxX()),Math.abs(d.getMaxY()),Math.abs(d.getMinX()),Math.abs(d.getMinY()))+2*(i>0?i:0),D=h-Math.trunc(Math.log(x)/Math.log(10)+1);return Math.pow(10,D)},Zs.CAP_ROUND.get=function(){return $n.CAP_ROUND},Zs.CAP_BUTT.get=function(){return $n.CAP_FLAT},Zs.CAP_FLAT.get=function(){return $n.CAP_FLAT},Zs.CAP_SQUARE.get=function(){return $n.CAP_SQUARE},Zs.MAX_PRECISION_DIGITS.get=function(){return 12},Object.defineProperties(Go,Zs);var ua=function(){this._pt=[new Z,new Z],this._distance=X.NaN,this._isNull=!0};ua.prototype.getCoordinates=function(){return this._pt},ua.prototype.getCoordinate=function(e){return this._pt[e]},ua.prototype.setMinimum=function(){if(1===arguments.length){var e=arguments[0];this.setMinimum(e._pt[0],e._pt[1])}else if(2===arguments.length){var i=arguments[0],h=arguments[1];if(this._isNull)return this.initialize(i,h),null;var d=i.distance(h);d<this._distance&&this.initialize(i,h,d)}},ua.prototype.initialize=function(){if(0===arguments.length)this._isNull=!0;else if(2===arguments.length){var e=arguments[0],i=arguments[1];this._pt[0].setCoordinate(e),this._pt[1].setCoordinate(i),this._distance=e.distance(i),this._isNull=!1}else if(3===arguments.length){var d=arguments[1],x=arguments[2];this._pt[0].setCoordinate(arguments[0]),this._pt[1].setCoordinate(d),this._distance=x,this._isNull=!1}},ua.prototype.getDistance=function(){return this._distance},ua.prototype.setMaximum=function(){if(1===arguments.length){var e=arguments[0];this.setMaximum(e._pt[0],e._pt[1])}else if(2===arguments.length){var i=arguments[0],h=arguments[1];if(this._isNull)return this.initialize(i,h),null;var d=i.distance(h);d>this._distance&&this.initialize(i,h,d)}},ua.prototype.interfaces_=function(){return[]},ua.prototype.getClass=function(){return ua};var js=function(){};js.prototype.interfaces_=function(){return[]},js.prototype.getClass=function(){return js},js.computeDistance=function(){if(arguments[2]instanceof ua&&arguments[0]instanceof Nr&&arguments[1]instanceof Z)for(var i=arguments[1],h=arguments[2],d=arguments[0].getCoordinates(),x=new Hr,D=0;D<d.length-1;D++){x.setCoordinates(d[D],d[D+1]);var F=x.closestPoint(i);h.setMinimum(F,i)}else if(arguments[2]instanceof ua&&arguments[0]instanceof Tn&&arguments[1]instanceof Z){var $=arguments[0],Ct=arguments[1],te=arguments[2];js.computeDistance($.getExteriorRing(),Ct,te);for(var Ne=0;Ne<$.getNumInteriorRing();Ne++)js.computeDistance($.getInteriorRingN(Ne),Ct,te)}else if(arguments[2]instanceof ua&&arguments[0]instanceof hr&&arguments[1]instanceof Z){var Ve=arguments[0],gr=arguments[1],Pr=arguments[2];if(Ve instanceof Nr)js.computeDistance(Ve,gr,Pr);else if(Ve instanceof Tn)js.computeDistance(Ve,gr,Pr);else if(Ve instanceof Xe)for(var Yr=Ve,an=0;an<Yr.getNumGeometries();an++){var Mi=Yr.getGeometryN(an);js.computeDistance(Mi,gr,Pr)}else Pr.setMinimum(Ve.getCoordinate(),gr)}else if(arguments[2]instanceof ua&&arguments[0]instanceof Hr&&arguments[1]instanceof Z){var f=arguments[1],c=arguments[2],m=arguments[0].closestPoint(f);c.setMinimum(m,f)}};var du=function(e){this._maxPtDist=new ua,this._inputGeom=e||null},Eo={MaxPointDistanceFilter:{configurable:!0},MaxMidpointDistanceFilter:{configurable:!0}};du.prototype.computeMaxMidpointDistance=function(e){var i=new si(this._inputGeom);e.apply(i),this._maxPtDist.setMaximum(i.getMaxPointDistance())},du.prototype.computeMaxVertexDistance=function(e){var i=new bi(this._inputGeom);e.apply(i),this._maxPtDist.setMaximum(i.getMaxPointDistance())},du.prototype.findDistance=function(e){return this.computeMaxVertexDistance(e),this.computeMaxMidpointDistance(e),this._maxPtDist.getDistance()},du.prototype.getDistancePoints=function(){return this._maxPtDist},du.prototype.interfaces_=function(){return[]},du.prototype.getClass=function(){return du},Eo.MaxPointDistanceFilter.get=function(){return bi},Eo.MaxMidpointDistanceFilter.get=function(){return si},Object.defineProperties(du,Eo);var bi=function(e){this._maxPtDist=new ua,this._minPtDist=new ua,this._geom=e||null};bi.prototype.filter=function(e){this._minPtDist.initialize(),js.computeDistance(this._geom,e,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)},bi.prototype.getMaxPointDistance=function(){return this._maxPtDist},bi.prototype.interfaces_=function(){return[Jn]},bi.prototype.getClass=function(){return bi};var si=function(e){this._maxPtDist=new ua,this._minPtDist=new ua,this._geom=e||null};si.prototype.filter=function(e,i){if(0===i)return null;var h=e.getCoordinate(i-1),d=e.getCoordinate(i),x=new Z((h.x+d.x)/2,(h.y+d.y)/2);this._minPtDist.initialize(),js.computeDistance(this._geom,x,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)},si.prototype.isDone=function(){return!1},si.prototype.isGeometryChanged=function(){return!1},si.prototype.getMaxPointDistance=function(){return this._maxPtDist},si.prototype.interfaces_=function(){return[Ar]},si.prototype.getClass=function(){return si};var ba=function(e){this._comps=e||null};ba.prototype.filter=function(e){e instanceof Tn&&this._comps.add(e)},ba.prototype.interfaces_=function(){return[wr]},ba.prototype.getClass=function(){return ba},ba.getPolygons=function(){if(1===arguments.length)return ba.getPolygons(arguments[0],new cr);if(2===arguments.length){var i=arguments[0],h=arguments[1];return i instanceof Tn?h.add(i):i instanceof Xe&&i.apply(new ba(h)),h}};var Po=function(){if(this._lines=null,this._isForcedToLineString=!1,1===arguments.length)this._lines=arguments[0];else if(2===arguments.length){var h=arguments[1];this._lines=arguments[0],this._isForcedToLineString=h}};Po.prototype.filter=function(e){if(this._isForcedToLineString&&e instanceof ni){var i=e.getFactory().createLineString(e.getCoordinateSequence());return this._lines.add(i),null}e instanceof Nr&&this._lines.add(e)},Po.prototype.setForceToLineString=function(e){this._isForcedToLineString=e},Po.prototype.interfaces_=function(){return[en]},Po.prototype.getClass=function(){return Po},Po.getGeometry=function(){if(1===arguments.length){var e=arguments[0];return e.getFactory().buildGeometry(Po.getLines(e))}if(2===arguments.length){var i=arguments[0],h=arguments[1];return i.getFactory().buildGeometry(Po.getLines(i,h))}},Po.getLines=function(){if(1===arguments.length)return Po.getLines(arguments[0],!1);if(2===arguments.length){if(Ce(arguments[0],Gn)&&Ce(arguments[1],Gn)){for(var h=arguments[1],d=arguments[0].iterator();d.hasNext();){var x=d.next();Po.getLines(x,h)}return h}if(arguments[0]instanceof hr&&"boolean"==typeof arguments[1]){var D=arguments[0],F=arguments[1],$=new cr;return D.apply(new Po($,F)),$}if(arguments[0]instanceof hr&&Ce(arguments[1],Gn)){var Ct=arguments[0],te=arguments[1];return Ct instanceof Nr?te.add(Ct):Ct.apply(new Po(te)),te}}else if(3===arguments.length){if("boolean"==typeof arguments[2]&&Ce(arguments[0],Gn)&&Ce(arguments[1],Gn)){for(var Ve=arguments[1],gr=arguments[2],Pr=arguments[0].iterator();Pr.hasNext();){var Yr=Pr.next();Po.getLines(Yr,Ve,gr)}return Ve}if("boolean"==typeof arguments[2]&&arguments[0]instanceof hr&&Ce(arguments[1],Gn)){var Mi=arguments[1];return arguments[0].apply(new Po(Mi,arguments[2])),Mi}}};var po=function(){if(this._boundaryRule=Sn.OGC_SFS_BOUNDARY_RULE,this._isIn=null,this._numBoundaries=null,0!==arguments.length&&1===arguments.length){var e=arguments[0];if(null===e)throw new tt("Rule must be non-null");this._boundaryRule=e}};po.prototype.locateInternal=function(){if(arguments[0]instanceof Z&&arguments[1]instanceof Tn){var e=arguments[0],i=arguments[1];if(i.isEmpty())return dt.EXTERIOR;var h=i.getExteriorRing(),d=this.locateInPolygonRing(e,h);if(d===dt.EXTERIOR)return dt.EXTERIOR;if(d===dt.BOUNDARY)return dt.BOUNDARY;for(var x=0;x<i.getNumInteriorRing();x++){var D=i.getInteriorRingN(x),F=this.locateInPolygonRing(e,D);if(F===dt.INTERIOR)return dt.EXTERIOR;if(F===dt.BOUNDARY)return dt.BOUNDARY}return dt.INTERIOR}if(arguments[0]instanceof Z&&arguments[1]instanceof Nr){var $=arguments[0],Ct=arguments[1];if(!Ct.getEnvelopeInternal().intersects($))return dt.EXTERIOR;var te=Ct.getCoordinates();return Ct.isClosed()||!$.equals(te[0])&&!$.equals(te[te.length-1])?Ge.isOnLine($,te)?dt.INTERIOR:dt.EXTERIOR:dt.BOUNDARY}if(arguments[0]instanceof Z&&arguments[1]instanceof ai){var Ne=arguments[0];return arguments[1].getCoordinate().equals2D(Ne)?dt.INTERIOR:dt.EXTERIOR}},po.prototype.locateInPolygonRing=function(e,i){return i.getEnvelopeInternal().intersects(e)?Ge.locatePointInRing(e,i.getCoordinates()):dt.EXTERIOR},po.prototype.intersects=function(e,i){return this.locate(e,i)!==dt.EXTERIOR},po.prototype.updateLocationInfo=function(e){e===dt.INTERIOR&&(this._isIn=!0),e===dt.BOUNDARY&&this._numBoundaries++},po.prototype.computeLocation=function(e,i){if(i instanceof ai&&this.updateLocationInfo(this.locateInternal(e,i)),i instanceof Nr)this.updateLocationInfo(this.locateInternal(e,i));else if(i instanceof Tn)this.updateLocationInfo(this.locateInternal(e,i));else if(i instanceof vr)for(var h=i,d=0;d<h.getNumGeometries();d++){var x=h.getGeometryN(d);this.updateLocationInfo(this.locateInternal(e,x))}else if(i instanceof Xr)for(var D=i,F=0;F<D.getNumGeometries();F++){var $=D.getGeometryN(F);this.updateLocationInfo(this.locateInternal(e,$))}else if(i instanceof Xe)for(var Ct=new Qn(i);Ct.hasNext();){var te=Ct.next();te!==i&&this.computeLocation(e,te)}},po.prototype.locate=function(e,i){return i.isEmpty()?dt.EXTERIOR:i instanceof Nr||i instanceof Tn?this.locateInternal(e,i):(this._isIn=!1,this._numBoundaries=0,this.computeLocation(e,i),this._boundaryRule.isInBoundary(this._numBoundaries)?dt.BOUNDARY:this._numBoundaries>0||this._isIn?dt.INTERIOR:dt.EXTERIOR)},po.prototype.interfaces_=function(){return[]},po.prototype.getClass=function(){return po};var En=function e(){if(this._component=null,this._segIndex=null,this._pt=null,2===arguments.length)e.call(this,arguments[0],e.INSIDE_AREA,arguments[1]);else if(3===arguments.length){var x=arguments[1],D=arguments[2];this._component=arguments[0],this._segIndex=x,this._pt=D}},jn={INSIDE_AREA:{configurable:!0}};En.prototype.isInsideArea=function(){return this._segIndex===En.INSIDE_AREA},En.prototype.getCoordinate=function(){return this._pt},En.prototype.getGeometryComponent=function(){return this._component},En.prototype.getSegmentIndex=function(){return this._segIndex},En.prototype.interfaces_=function(){return[]},En.prototype.getClass=function(){return En},jn.INSIDE_AREA.get=function(){return-1},Object.defineProperties(En,jn);var Va=function(e){this._pts=e||null};Va.prototype.filter=function(e){e instanceof ai&&this._pts.add(e)},Va.prototype.interfaces_=function(){return[wr]},Va.prototype.getClass=function(){return Va},Va.getPoints=function(){if(1===arguments.length){var e=arguments[0];return e instanceof ai?cs.singletonList(e):Va.getPoints(e,new cr)}if(2===arguments.length){var i=arguments[0],h=arguments[1];return i instanceof ai?h.add(i):i instanceof Xe&&i.apply(new Va(h)),h}};var Za=function(){this._locations=null,this._locations=arguments[0]};Za.prototype.filter=function(e){(e instanceof ai||e instanceof Nr||e instanceof Tn)&&this._locations.add(new En(e,0,e.getCoordinate()))},Za.prototype.interfaces_=function(){return[wr]},Za.prototype.getClass=function(){return Za},Za.getLocations=function(e){var i=new cr;return e.apply(new Za(i)),i};var Ro=function(){if(this._geom=null,this._terminateDistance=0,this._ptLocator=new po,this._minDistanceLocation=null,this._minDistance=X.MAX_VALUE,2===arguments.length)this._geom=[arguments[0],arguments[1]],this._terminateDistance=0;else if(3===arguments.length){var h=arguments[0],d=arguments[1],x=arguments[2];this._geom=new Array(2).fill(null),this._geom[0]=h,this._geom[1]=d,this._terminateDistance=x}};Ro.prototype.computeContainmentDistance=function(){if(0===arguments.length){var e=new Array(2).fill(null);if(this.computeContainmentDistance(0,e),this._minDistance<=this._terminateDistance)return null;this.computeContainmentDistance(1,e)}else if(2===arguments.length){var i=arguments[0],h=arguments[1],d=1-i,x=ba.getPolygons(this._geom[i]);if(x.size()>0){var D=Za.getLocations(this._geom[d]);if(this.computeContainmentDistance(D,x,h),this._minDistance<=this._terminateDistance)return this._minDistanceLocation[d]=h[0],this._minDistanceLocation[i]=h[1],null}}else if(3===arguments.length)if(arguments[2]instanceof Array&&Ce(arguments[0],xn)&&Ce(arguments[1],xn)){for(var F=arguments[0],$=arguments[1],Ct=arguments[2],te=0;te<F.size();te++)for(var Ne=F.get(te),Ve=0;Ve<$.size();Ve++)if(this.computeContainmentDistance(Ne,$.get(Ve),Ct),this._minDistance<=this._terminateDistance)return null}else if(arguments[2]instanceof Array&&arguments[0]instanceof En&&arguments[1]instanceof Tn){var gr=arguments[0],Pr=arguments[1],Yr=arguments[2],an=gr.getCoordinate();if(dt.EXTERIOR!==this._ptLocator.locate(an,Pr))return this._minDistance=0,Yr[0]=gr,Yr[1]=new En(Pr,an),null}},Ro.prototype.computeMinDistanceLinesPoints=function(e,i,h){for(var d=0;d<e.size();d++)for(var x=e.get(d),D=0;D<i.size();D++){var F=i.get(D);if(this.computeMinDistance(x,F,h),this._minDistance<=this._terminateDistance)return null}},Ro.prototype.computeFacetDistance=function(){var e=new Array(2).fill(null),i=Po.getLines(this._geom[0]),h=Po.getLines(this._geom[1]),d=Va.getPoints(this._geom[0]),x=Va.getPoints(this._geom[1]);return this.computeMinDistanceLines(i,h,e),this.updateMinDistance(e,!1),this._minDistance<=this._terminateDistance?null:(e[0]=null,e[1]=null,this.computeMinDistanceLinesPoints(i,x,e),this.updateMinDistance(e,!1),this._minDistance<=this._terminateDistance?null:(e[0]=null,e[1]=null,this.computeMinDistanceLinesPoints(h,d,e),this.updateMinDistance(e,!0),this._minDistance<=this._terminateDistance?null:(e[0]=null,e[1]=null,this.computeMinDistancePoints(d,x,e),void this.updateMinDistance(e,!1))))},Ro.prototype.nearestLocations=function(){return this.computeMinDistance(),this._minDistanceLocation},Ro.prototype.updateMinDistance=function(e,i){if(null===e[0])return null;i?(this._minDistanceLocation[0]=e[1],this._minDistanceLocation[1]=e[0]):(this._minDistanceLocation[0]=e[0],this._minDistanceLocation[1]=e[1])},Ro.prototype.nearestPoints=function(){return this.computeMinDistance(),[this._minDistanceLocation[0].getCoordinate(),this._minDistanceLocation[1].getCoordinate()]},Ro.prototype.computeMinDistance=function(){if(0===arguments.length){if(null!==this._minDistanceLocation||(this._minDistanceLocation=new Array(2).fill(null),this.computeContainmentDistance(),this._minDistance<=this._terminateDistance))return null;this.computeFacetDistance()}else if(3===arguments.length)if(arguments[2]instanceof Array&&arguments[0]instanceof Nr&&arguments[1]instanceof ai){var e=arguments[0],i=arguments[1],h=arguments[2];if(e.getEnvelopeInternal().distance(i.getEnvelopeInternal())>this._minDistance)return null;for(var d=e.getCoordinates(),x=i.getCoordinate(),D=0;D<d.length-1;D++){var F=Ge.distancePointLine(x,d[D],d[D+1]);if(F<this._minDistance){this._minDistance=F;var $=new Hr(d[D],d[D+1]).closestPoint(x);h[0]=new En(e,D,$),h[1]=new En(i,0,x)}if(this._minDistance<=this._terminateDistance)return null}}else if(arguments[2]instanceof Array&&arguments[0]instanceof Nr&&arguments[1]instanceof Nr){var Ct=arguments[0],te=arguments[1],Ne=arguments[2];if(Ct.getEnvelopeInternal().distance(te.getEnvelopeInternal())>this._minDistance)return null;for(var Ve=Ct.getCoordinates(),gr=te.getCoordinates(),Pr=0;Pr<Ve.length-1;Pr++)for(var Yr=0;Yr<gr.length-1;Yr++){var an=Ge.distanceLineLine(Ve[Pr],Ve[Pr+1],gr[Yr],gr[Yr+1]);if(an<this._minDistance){this._minDistance=an;var Mi=new Hr(Ve[Pr],Ve[Pr+1]),l=new Hr(gr[Yr],gr[Yr+1]),f=Mi.closestPoints(l);Ne[0]=new En(Ct,Pr,f[0]),Ne[1]=new En(te,Yr,f[1])}if(this._minDistance<=this._terminateDistance)return null}}},Ro.prototype.computeMinDistancePoints=function(e,i,h){for(var d=0;d<e.size();d++)for(var x=e.get(d),D=0;D<i.size();D++){var F=i.get(D),$=x.getCoordinate().distance(F.getCoordinate());if($<this._minDistance&&(this._minDistance=$,h[0]=new En(x,0,x.getCoordinate()),h[1]=new En(F,0,F.getCoordinate())),this._minDistance<=this._terminateDistance)return null}},Ro.prototype.distance=function(){if(null===this._geom[0]||null===this._geom[1])throw new tt("null geometries are not supported");return this._geom[0].isEmpty()||this._geom[1].isEmpty()?0:(this.computeMinDistance(),this._minDistance)},Ro.prototype.computeMinDistanceLines=function(e,i,h){for(var d=0;d<e.size();d++)for(var x=e.get(d),D=0;D<i.size();D++){var F=i.get(D);if(this.computeMinDistance(x,F,h),this._minDistance<=this._terminateDistance)return null}},Ro.prototype.interfaces_=function(){return[]},Ro.prototype.getClass=function(){return Ro},Ro.distance=function(e,i){return new Ro(e,i).distance()},Ro.isWithinDistance=function(e,i,h){return new Ro(e,i,h).distance()<=h},Ro.nearestPoints=function(e,i){return new Ro(e,i).nearestPoints()};var fo=function(){this._pt=[new Z,new Z],this._distance=X.NaN,this._isNull=!0};fo.prototype.getCoordinates=function(){return this._pt},fo.prototype.getCoordinate=function(e){return this._pt[e]},fo.prototype.setMinimum=function(){if(1===arguments.length){var e=arguments[0];this.setMinimum(e._pt[0],e._pt[1])}else if(2===arguments.length){var i=arguments[0],h=arguments[1];if(this._isNull)return this.initialize(i,h),null;var d=i.distance(h);d<this._distance&&this.initialize(i,h,d)}},fo.prototype.initialize=function(){if(0===arguments.length)this._isNull=!0;else if(2===arguments.length){var e=arguments[0],i=arguments[1];this._pt[0].setCoordinate(e),this._pt[1].setCoordinate(i),this._distance=e.distance(i),this._isNull=!1}else if(3===arguments.length){var d=arguments[1],x=arguments[2];this._pt[0].setCoordinate(arguments[0]),this._pt[1].setCoordinate(d),this._distance=x,this._isNull=!1}},fo.prototype.toString=function(){return Kt.toLineString(this._pt[0],this._pt[1])},fo.prototype.getDistance=function(){return this._distance},fo.prototype.setMaximum=function(){if(1===arguments.length){var e=arguments[0];this.setMaximum(e._pt[0],e._pt[1])}else if(2===arguments.length){var i=arguments[0],h=arguments[1];if(this._isNull)return this.initialize(i,h),null;var d=i.distance(h);d>this._distance&&this.initialize(i,h,d)}},fo.prototype.interfaces_=function(){return[]},fo.prototype.getClass=function(){return fo};var ts=function(){};ts.prototype.interfaces_=function(){return[]},ts.prototype.getClass=function(){return ts},ts.computeDistance=function(){if(arguments[2]instanceof fo&&arguments[0]instanceof Nr&&arguments[1]instanceof Z)for(var e=arguments[0],i=arguments[1],h=arguments[2],d=new Hr,x=e.getCoordinates(),D=0;D<x.length-1;D++){d.setCoordinates(x[D],x[D+1]);var F=d.closestPoint(i);h.setMinimum(F,i)}else if(arguments[2]instanceof fo&&arguments[0]instanceof Tn&&arguments[1]instanceof Z){var $=arguments[0],Ct=arguments[1],te=arguments[2];ts.computeDistance($.getExteriorRing(),Ct,te);for(var Ne=0;Ne<$.getNumInteriorRing();Ne++)ts.computeDistance($.getInteriorRingN(Ne),Ct,te)}else if(arguments[2]instanceof fo&&arguments[0]instanceof hr&&arguments[1]instanceof Z){var Ve=arguments[0],gr=arguments[1],Pr=arguments[2];if(Ve instanceof Nr)ts.computeDistance(Ve,gr,Pr);else if(Ve instanceof Tn)ts.computeDistance(Ve,gr,Pr);else if(Ve instanceof Xe)for(var Yr=Ve,an=0;an<Yr.getNumGeometries();an++){var Mi=Yr.getGeometryN(an);ts.computeDistance(Mi,gr,Pr)}else Pr.setMinimum(Ve.getCoordinate(),gr)}else if(arguments[2]instanceof fo&&arguments[0]instanceof Hr&&arguments[1]instanceof Z){var f=arguments[1],c=arguments[2],m=arguments[0].closestPoint(f);c.setMinimum(m,f)}};var hs=function(){this._g0=null,this._g1=null,this._ptDist=new fo,this._densifyFrac=0;var i=arguments[1];this._g0=arguments[0],this._g1=i},Bu={MaxPointDistanceFilter:{configurable:!0},MaxDensifiedByFractionDistanceFilter:{configurable:!0}};hs.prototype.getCoordinates=function(){return this._ptDist.getCoordinates()},hs.prototype.setDensifyFraction=function(e){if(e>1||e<=0)throw new tt("Fraction is not in range (0.0 - 1.0]");this._densifyFrac=e},hs.prototype.compute=function(e,i){this.computeOrientedDistance(e,i,this._ptDist),this.computeOrientedDistance(i,e,this._ptDist)},hs.prototype.distance=function(){return this.compute(this._g0,this._g1),this._ptDist.getDistance()},hs.prototype.computeOrientedDistance=function(e,i,h){var d=new tu(i);if(e.apply(d),h.setMaximum(d.getMaxPointDistance()),this._densifyFrac>0){var x=new _s(i,this._densifyFrac);e.apply(x),h.setMaximum(x.getMaxPointDistance())}},hs.prototype.orientedDistance=function(){return this.computeOrientedDistance(this._g0,this._g1,this._ptDist),this._ptDist.getDistance()},hs.prototype.interfaces_=function(){return[]},hs.prototype.getClass=function(){return hs},hs.distance=function(){if(2===arguments.length)return new hs(arguments[0],arguments[1]).distance();if(3===arguments.length){var x=arguments[2],D=new hs(arguments[0],arguments[1]);return D.setDensifyFraction(x),D.distance()}},Bu.MaxPointDistanceFilter.get=function(){return tu},Bu.MaxDensifiedByFractionDistanceFilter.get=function(){return _s},Object.defineProperties(hs,Bu);var tu=function(){this._maxPtDist=new fo,this._minPtDist=new fo,this._euclideanDist=new ts,this._geom=null,this._geom=arguments[0]};tu.prototype.filter=function(e){this._minPtDist.initialize(),ts.computeDistance(this._geom,e,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)},tu.prototype.getMaxPointDistance=function(){return this._maxPtDist},tu.prototype.interfaces_=function(){return[Jn]},tu.prototype.getClass=function(){return tu};var _s=function(){this._maxPtDist=new fo,this._minPtDist=new fo,this._geom=null,this._numSubSegs=0;var i=arguments[1];this._geom=arguments[0],this._numSubSegs=Math.trunc(Math.round(1/i))};_s.prototype.filter=function(e,i){if(0===i)return null;for(var h=e.getCoordinate(i-1),d=e.getCoordinate(i),x=(d.x-h.x)/this._numSubSegs,D=(d.y-h.y)/this._numSubSegs,F=0;F<this._numSubSegs;F++){var te=new Z(h.x+F*x,h.y+F*D);this._minPtDist.initialize(),ts.computeDistance(this._geom,te,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)}},_s.prototype.isDone=function(){return!1},_s.prototype.isGeometryChanged=function(){return!1},_s.prototype.getMaxPointDistance=function(){return this._maxPtDist},_s.prototype.interfaces_=function(){return[Ar]},_s.prototype.getClass=function(){return _s};var ao=function(e,i,h){this._minValidDistance=null,this._maxValidDistance=null,this._minDistanceFound=null,this._maxDistanceFound=null,this._isValid=!0,this._errMsg=null,this._errorLocation=null,this._errorIndicator=null,this._input=e||null,this._bufDistance=i||null,this._result=h||null},es={VERBOSE:{configurable:!0},MAX_DISTANCE_DIFF_FRAC:{configurable:!0}};ao.prototype.checkMaximumDistance=function(e,i,h){var d=new hs(i,e);if(d.setDensifyFraction(.25),this._maxDistanceFound=d.orientedDistance(),this._maxDistanceFound>h){this._isValid=!1;var x=d.getCoordinates();this._errorLocation=x[1],this._errorIndicator=e.getFactory().createLineString(x),this._errMsg="Distance between buffer curve and input is too large ("+this._maxDistanceFound+" at "+Kt.toLineString(x[0],x[1])+")"}},ao.prototype.isValid=function(){var e=Math.abs(this._bufDistance),i=ao.MAX_DISTANCE_DIFF_FRAC*e;return this._minValidDistance=e-i,this._maxValidDistance=e+i,!(!this._input.isEmpty()&&!this._result.isEmpty())||(this._bufDistance>0?this.checkPositiveValid():this.checkNegativeValid(),ao.VERBOSE&&jr.out.println("Min Dist= "+this._minDistanceFound+"  err= "+(1-this._minDistanceFound/this._bufDistance)+"  Max Dist= "+this._maxDistanceFound+"  err= "+(this._maxDistanceFound/this._bufDistance-1)),this._isValid)},ao.prototype.checkNegativeValid=function(){if(!(this._input instanceof Tn||this._input instanceof Xr||this._input instanceof Xe))return null;var e=this.getPolygonLines(this._input);if(this.checkMinimumDistance(e,this._result,this._minValidDistance),!this._isValid)return null;this.checkMaximumDistance(e,this._result,this._maxValidDistance)},ao.prototype.getErrorIndicator=function(){return this._errorIndicator},ao.prototype.checkMinimumDistance=function(e,i,h){var d=new Ro(e,i,h);if(this._minDistanceFound=d.distance(),this._minDistanceFound<h){this._isValid=!1;var x=d.nearestPoints();this._errorLocation=d.nearestPoints()[1],this._errorIndicator=e.getFactory().createLineString(x),this._errMsg="Distance between buffer curve and input is too small ("+this._minDistanceFound+" at "+Kt.toLineString(x[0],x[1])+" )"}},ao.prototype.checkPositiveValid=function(){var e=this._result.getBoundary();if(this.checkMinimumDistance(this._input,e,this._minValidDistance),!this._isValid)return null;this.checkMaximumDistance(this._input,e,this._maxValidDistance)},ao.prototype.getErrorLocation=function(){return this._errorLocation},ao.prototype.getPolygonLines=function(e){for(var i=new cr,h=new Po(i),d=ba.getPolygons(e).iterator();d.hasNext();)d.next().apply(h);return e.getFactory().buildGeometry(i)},ao.prototype.getErrorMessage=function(){return this._errMsg},ao.prototype.interfaces_=function(){return[]},ao.prototype.getClass=function(){return ao},es.VERBOSE.get=function(){return!1},es.MAX_DISTANCE_DIFF_FRAC.get=function(){return.012},Object.defineProperties(ao,es);var ea=function(e,i,h){this._isValid=!0,this._errorMsg=null,this._errorLocation=null,this._errorIndicator=null,this._input=e||null,this._distance=i||null,this._result=h||null},wa={VERBOSE:{configurable:!0},MAX_ENV_DIFF_FRAC:{configurable:!0}};ea.prototype.isValid=function(){return this.checkPolygonal(),this._isValid?(this.checkExpectedEmpty(),this._isValid?(this.checkEnvelope(),this._isValid?(this.checkArea(),this._isValid?(this.checkDistance(),this._isValid):this._isValid):this._isValid):this._isValid):this._isValid},ea.prototype.checkEnvelope=function(){if(this._distance<0)return null;var e=this._distance*ea.MAX_ENV_DIFF_FRAC;0===e&&(e=.001);var i=new He(this._input.getEnvelopeInternal());i.expandBy(this._distance);var h=new He(this._result.getEnvelopeInternal());h.expandBy(e),h.contains(i)||(this._isValid=!1,this._errorMsg="Buffer envelope is incorrect",this._errorIndicator=this._input.getFactory().toGeometry(h)),this.report("Envelope")},ea.prototype.checkDistance=function(){var e=new ao(this._input,this._distance,this._result);e.isValid()||(this._isValid=!1,this._errorMsg=e.getErrorMessage(),this._errorLocation=e.getErrorLocation(),this._errorIndicator=e.getErrorIndicator()),this.report("Distance")},ea.prototype.checkArea=function(){var e=this._input.getArea(),i=this._result.getArea();this._distance>0&&e>i&&(this._isValid=!1,this._errorMsg="Area of positive buffer is smaller than input",this._errorIndicator=this._result),this._distance<0&&e<i&&(this._isValid=!1,this._errorMsg="Area of negative buffer is larger than input",this._errorIndicator=this._result),this.report("Area")},ea.prototype.checkPolygonal=function(){this._result instanceof Tn||this._result instanceof Xr||(this._isValid=!1),this._errorMsg="Result is not polygonal",this._errorIndicator=this._result,this.report("Polygonal")},ea.prototype.getErrorIndicator=function(){return this._errorIndicator},ea.prototype.getErrorLocation=function(){return this._errorLocation},ea.prototype.checkExpectedEmpty=function(){return this._input.getDimension()>=2||this._distance>0?null:(this._result.isEmpty()||(this._isValid=!1,this._errorMsg="Result is non-empty",this._errorIndicator=this._result),void this.report("ExpectedEmpty"))},ea.prototype.report=function(e){if(!ea.VERBOSE)return null;jr.out.println("Check "+e+": "+(this._isValid?"passed":"FAILED"))},ea.prototype.getErrorMessage=function(){return this._errorMsg},ea.prototype.interfaces_=function(){return[]},ea.prototype.getClass=function(){return ea},ea.isValidMsg=function(e,i,h){var d=new ea(e,i,h);return d.isValid()?null:d.getErrorMessage()},ea.isValid=function(e,i,h){return!!new ea(e,i,h).isValid()},wa.VERBOSE.get=function(){return!1},wa.MAX_ENV_DIFF_FRAC.get=function(){return.012},Object.defineProperties(ea,wa);var ra=function(){this._pts=null,this._data=null;var i=arguments[1];this._pts=arguments[0],this._data=i};ra.prototype.getCoordinates=function(){return this._pts},ra.prototype.size=function(){return this._pts.length},ra.prototype.getCoordinate=function(e){return this._pts[e]},ra.prototype.isClosed=function(){return this._pts[0].equals(this._pts[this._pts.length-1])},ra.prototype.getSegmentOctant=function(e){return e===this._pts.length-1?-1:pu.octant(this.getCoordinate(e),this.getCoordinate(e+1))},ra.prototype.setData=function(e){this._data=e},ra.prototype.getData=function(){return this._data},ra.prototype.toString=function(){return Kt.toLineString(new Wn(this._pts))},ra.prototype.interfaces_=function(){return[Da]},ra.prototype.getClass=function(){return ra};var _r=function(){this._findAllIntersections=!1,this._isCheckEndSegmentsOnly=!1,this._li=null,this._interiorIntersection=null,this._intSegments=null,this._intersections=new cr,this._intersectionCount=0,this._keepIntersections=!0,this._li=arguments[0],this._interiorIntersection=null};_r.prototype.getInteriorIntersection=function(){return this._interiorIntersection},_r.prototype.setCheckEndSegmentsOnly=function(e){this._isCheckEndSegmentsOnly=e},_r.prototype.getIntersectionSegments=function(){return this._intSegments},_r.prototype.count=function(){return this._intersectionCount},_r.prototype.getIntersections=function(){return this._intersections},_r.prototype.setFindAllIntersections=function(e){this._findAllIntersections=e},_r.prototype.setKeepIntersections=function(e){this._keepIntersections=e},_r.prototype.processIntersections=function(e,i,h,d){if(!this._findAllIntersections&&this.hasIntersection()||e===h&&i===d||this._isCheckEndSegmentsOnly&&!this.isEndSegment(e,i)&&!this.isEndSegment(h,d))return null;var x=e.getCoordinates()[i],D=e.getCoordinates()[i+1],F=h.getCoordinates()[d],$=h.getCoordinates()[d+1];this._li.computeIntersection(x,D,F,$),this._li.hasIntersection()&&this._li.isInteriorIntersection()&&(this._intSegments=new Array(4).fill(null),this._intSegments[0]=x,this._intSegments[1]=D,this._intSegments[2]=F,this._intSegments[3]=$,this._interiorIntersection=this._li.getIntersection(0),this._keepIntersections&&this._intersections.add(this._interiorIntersection),this._intersectionCount++)},_r.prototype.isEndSegment=function(e,i){return 0===i||i>=e.size()-2},_r.prototype.hasIntersection=function(){return null!==this._interiorIntersection},_r.prototype.isDone=function(){return!this._findAllIntersections&&null!==this._interiorIntersection},_r.prototype.interfaces_=function(){return[Au]},_r.prototype.getClass=function(){return _r},_r.createAllIntersectionsFinder=function(e){var i=new _r(e);return i.setFindAllIntersections(!0),i},_r.createAnyIntersectionFinder=function(e){return new _r(e)},_r.createIntersectionCounter=function(e){var i=new _r(e);return i.setFindAllIntersections(!0),i.setKeepIntersections(!1),i};var Ls=function(){this._li=new Oe,this._segStrings=null,this._findAllIntersections=!1,this._segInt=null,this._isValid=!0,this._segStrings=arguments[0]};Ls.prototype.execute=function(){if(null!==this._segInt)return null;this.checkInteriorIntersections()},Ls.prototype.getIntersections=function(){return this._segInt.getIntersections()},Ls.prototype.isValid=function(){return this.execute(),this._isValid},Ls.prototype.setFindAllIntersections=function(e){this._findAllIntersections=e},Ls.prototype.checkInteriorIntersections=function(){this._isValid=!0,this._segInt=new _r(this._li),this._segInt.setFindAllIntersections(this._findAllIntersections);var e=new Us;if(e.setSegmentIntersector(this._segInt),e.computeNodes(this._segStrings),this._segInt.hasIntersection())return this._isValid=!1,null},Ls.prototype.checkValid=function(){if(this.execute(),!this._isValid)throw new ar(this.getErrorMessage(),this._segInt.getInteriorIntersection())},Ls.prototype.getErrorMessage=function(){if(this._isValid)return"no intersections found";var e=this._segInt.getIntersectionSegments();return"found non-noded intersection between "+Kt.toLineString(e[0],e[1])+" and "+Kt.toLineString(e[2],e[3])},Ls.prototype.interfaces_=function(){return[]},Ls.prototype.getClass=function(){return Ls},Ls.computeIntersections=function(e){var i=new Ls(e);return i.setFindAllIntersections(!0),i.isValid(),i.getIntersections()};var Cu=function e(){this._nv=null,this._nv=new Ls(e.toSegmentStrings(arguments[0]))};Cu.prototype.checkValid=function(){this._nv.checkValid()},Cu.prototype.interfaces_=function(){return[]},Cu.prototype.getClass=function(){return Cu},Cu.toSegmentStrings=function(e){for(var i=new cr,h=e.iterator();h.hasNext();){var d=h.next();i.add(new ra(d.getCoordinates(),d))}return i},Cu.checkValid=function(e){new Cu(e).checkValid()};var gu=function(e){this._mapOp=e};gu.prototype.map=function(e){for(var i=new cr,h=0;h<e.getNumGeometries();h++){var d=this._mapOp.map(e.getGeometryN(h));d.isEmpty()||i.add(d)}return e.getFactory().createGeometryCollection(wn.toGeometryArray(i))},gu.prototype.interfaces_=function(){return[]},gu.prototype.getClass=function(){return gu},gu.map=function(e,i){return new gu(i).map(e)};var na=function(){this._op=null,this._geometryFactory=null,this._ptLocator=null,this._lineEdgesList=new cr,this._resultLineList=new cr;var i=arguments[1],h=arguments[2];this._op=arguments[0],this._geometryFactory=i,this._ptLocator=h};na.prototype.collectLines=function(e){for(var i=this._op.getGraph().getEdgeEnds().iterator();i.hasNext();){var h=i.next();this.collectLineEdge(h,e,this._lineEdgesList),this.collectBoundaryTouchEdge(h,e,this._lineEdgesList)}},na.prototype.labelIsolatedLine=function(e,i){var h=this._ptLocator.locate(e.getCoordinate(),this._op.getArgGeometry(i));e.getLabel().setLocation(i,h)},na.prototype.build=function(e){return this.findCoveredLineEdges(),this.collectLines(e),this.buildLines(e),this._resultLineList},na.prototype.collectLineEdge=function(e,i,h){var d=e.getLabel(),x=e.getEdge();e.isLineEdge()&&(e.isVisited()||!hn.isResultOfOp(d,i)||x.isCovered()||(h.add(x),e.setVisitedEdge(!0)))},na.prototype.findCoveredLineEdges=function(){for(var e=this._op.getGraph().getNodes().iterator();e.hasNext();)e.next().getEdges().findCoveredLineEdges();for(var i=this._op.getGraph().getEdgeEnds().iterator();i.hasNext();){var h=i.next(),d=h.getEdge();if(h.isLineEdge()&&!d.isCoveredSet()){var x=this._op.isCoveredByA(h.getCoordinate());d.setCovered(x)}}},na.prototype.labelIsolatedLines=function(e){for(var i=e.iterator();i.hasNext();){var h=i.next(),d=h.getLabel();h.isIsolated()&&(d.isNull(0)?this.labelIsolatedLine(h,0):this.labelIsolatedLine(h,1))}},na.prototype.buildLines=function(e){for(var i=this._lineEdgesList.iterator();i.hasNext();){var h=i.next(),d=this._geometryFactory.createLineString(h.getCoordinates());this._resultLineList.add(d),h.setInResult(!0)}},na.prototype.collectBoundaryTouchEdge=function(e,i,h){var d=e.getLabel();return e.isLineEdge()||e.isVisited()||e.isInteriorAreaEdge()||e.getEdge().isInResult()?null:(ot.isTrue(!(e.isInResult()||e.getSym().isInResult())||!e.getEdge().isInResult()),void(hn.isResultOfOp(d,i)&&i===hn.INTERSECTION&&(h.add(e.getEdge()),e.setVisitedEdge(!0))))},na.prototype.interfaces_=function(){return[]},na.prototype.getClass=function(){return na};var Lu=function(){this._op=null,this._geometryFactory=null,this._resultPointList=new cr;var i=arguments[1];this._op=arguments[0],this._geometryFactory=i};Lu.prototype.filterCoveredNodeToPoint=function(e){var i=e.getCoordinate();if(!this._op.isCoveredByLA(i)){var h=this._geometryFactory.createPoint(i);this._resultPointList.add(h)}},Lu.prototype.extractNonCoveredResultNodes=function(e){for(var i=this._op.getGraph().getNodes().iterator();i.hasNext();){var h=i.next();if(!(h.isInResult()||h.isIncidentEdgeInResult()||0!==h.getEdges().getDegree()&&e!==hn.INTERSECTION)){var d=h.getLabel();hn.isResultOfOp(d,e)&&this.filterCoveredNodeToPoint(h)}}},Lu.prototype.build=function(e){return this.extractNonCoveredResultNodes(e),this._resultPointList},Lu.prototype.interfaces_=function(){return[]},Lu.prototype.getClass=function(){return Lu};var So=function(){this._inputGeom=null,this._factory=null,this._pruneEmptyGeometry=!0,this._preserveGeometryCollectionType=!0,this._preserveCollections=!1,this._preserveType=!1};So.prototype.transformPoint=function(e,i){return this._factory.createPoint(this.transformCoordinates(e.getCoordinateSequence(),e))},So.prototype.transformPolygon=function(e,i){var h=!0,d=this.transformLinearRing(e.getExteriorRing(),e);null!==d&&d instanceof ni&&!d.isEmpty()||(h=!1);for(var x=new cr,D=0;D<e.getNumInteriorRing();D++){var F=this.transformLinearRing(e.getInteriorRingN(D),e);null===F||F.isEmpty()||(F instanceof ni||(h=!1),x.add(F))}if(h)return this._factory.createPolygon(d,x.toArray([]));var $=new cr;return null!==d&&$.add(d),$.addAll(x),this._factory.buildGeometry($)},So.prototype.createCoordinateSequence=function(e){return this._factory.getCoordinateSequenceFactory().create(e)},So.prototype.getInputGeometry=function(){return this._inputGeom},So.prototype.transformMultiLineString=function(e,i){for(var h=new cr,d=0;d<e.getNumGeometries();d++){var x=this.transformLineString(e.getGeometryN(d),e);null!==x&&(x.isEmpty()||h.add(x))}return this._factory.buildGeometry(h)},So.prototype.transformCoordinates=function(e,i){return this.copy(e)},So.prototype.transformLineString=function(e,i){return this._factory.createLineString(this.transformCoordinates(e.getCoordinateSequence(),e))},So.prototype.transformMultiPoint=function(e,i){for(var h=new cr,d=0;d<e.getNumGeometries();d++){var x=this.transformPoint(e.getGeometryN(d),e);null!==x&&(x.isEmpty()||h.add(x))}return this._factory.buildGeometry(h)},So.prototype.transformMultiPolygon=function(e,i){for(var h=new cr,d=0;d<e.getNumGeometries();d++){var x=this.transformPolygon(e.getGeometryN(d),e);null!==x&&(x.isEmpty()||h.add(x))}return this._factory.buildGeometry(h)},So.prototype.copy=function(e){return e.copy()},So.prototype.transformGeometryCollection=function(e,i){for(var h=new cr,d=0;d<e.getNumGeometries();d++){var x=this.transform(e.getGeometryN(d));null!==x&&(this._pruneEmptyGeometry&&x.isEmpty()||h.add(x))}return this._preserveGeometryCollectionType?this._factory.createGeometryCollection(wn.toGeometryArray(h)):this._factory.buildGeometry(h)},So.prototype.transform=function(e){if(this._inputGeom=e,this._factory=e.getFactory(),e instanceof ai)return this.transformPoint(e,null);if(e instanceof co)return this.transformMultiPoint(e,null);if(e instanceof ni)return this.transformLinearRing(e,null);if(e instanceof Nr)return this.transformLineString(e,null);if(e instanceof vr)return this.transformMultiLineString(e,null);if(e instanceof Tn)return this.transformPolygon(e,null);if(e instanceof Xr)return this.transformMultiPolygon(e,null);if(e instanceof Xe)return this.transformGeometryCollection(e,null);throw new tt("Unknown Geometry subtype: "+e.getClass().getName())},So.prototype.transformLinearRing=function(e,i){var h=this.transformCoordinates(e.getCoordinateSequence(),e);if(null===h)return this._factory.createLinearRing(null);var d=h.size();return d>0&&d<4&&!this._preserveType?this._factory.createLineString(h):this._factory.createLinearRing(h)},So.prototype.interfaces_=function(){return[]},So.prototype.getClass=function(){return So};var Ir=function e(){if(this._snapTolerance=0,this._srcPts=null,this._seg=new Hr,this._allowSnappingToSourceVertices=!1,this._isClosed=!1,arguments[0]instanceof Nr&&"number"==typeof arguments[1]){var h=arguments[1];e.call(this,arguments[0].getCoordinates(),h)}else if(arguments[0]instanceof Array&&"number"==typeof arguments[1]){var d=arguments[0],x=arguments[1];this._srcPts=d,this._isClosed=e.isClosed(d),this._snapTolerance=x}};Ir.prototype.snapVertices=function(e,i){for(var h=this._isClosed?e.size()-1:e.size(),d=0;d<h;d++){var x=e.get(d),D=this.findSnapForVertex(x,i);null!==D&&(e.set(d,new Z(D)),0===d&&this._isClosed&&e.set(e.size()-1,new Z(D)))}},Ir.prototype.findSnapForVertex=function(e,i){for(var h=0;h<i.length;h++){if(e.equals2D(i[h]))return null;if(e.distance(i[h])<this._snapTolerance)return i[h]}return null},Ir.prototype.snapTo=function(e){var i=new Y(this._srcPts);return this.snapVertices(i,e),this.snapSegments(i,e),i.toCoordinateArray()},Ir.prototype.snapSegments=function(e,i){if(0===i.length)return null;var h=i.length;i[0].equals2D(i[i.length-1])&&(h=i.length-1);for(var d=0;d<h;d++){var x=i[d],D=this.findSegmentIndexToSnap(x,e);D>=0&&e.add(D+1,new Z(x),!1)}},Ir.prototype.findSegmentIndexToSnap=function(e,i){for(var h=X.MAX_VALUE,d=-1,x=0;x<i.size()-1;x++){if(this._seg.p0=i.get(x),this._seg.p1=i.get(x+1),this._seg.p0.equals2D(e)||this._seg.p1.equals2D(e)){if(this._allowSnappingToSourceVertices)continue;return-1}var D=this._seg.distance(e);D<this._snapTolerance&&D<h&&(h=D,d=x)}return d},Ir.prototype.setAllowSnappingToSourceVertices=function(e){this._allowSnappingToSourceVertices=e},Ir.prototype.interfaces_=function(){return[]},Ir.prototype.getClass=function(){return Ir},Ir.isClosed=function(e){return!(e.length<=1)&&e[0].equals2D(e[e.length-1])};var Vo=function(e){this._srcGeom=e||null},jl={SNAP_PRECISION_FACTOR:{configurable:!0}};Vo.prototype.snapTo=function(e,i){var h=this.extractTargetCoordinates(e);return new eu(i,h).transform(this._srcGeom)},Vo.prototype.snapToSelf=function(e,i){var h=this.extractTargetCoordinates(this._srcGeom),d=new eu(e,h,!0).transform(this._srcGeom),x=d;return i&&Ce(x,kn)&&(x=d.buffer(0)),x},Vo.prototype.computeSnapTolerance=function(e){return this.computeMinimumSegmentLength(e)/10},Vo.prototype.extractTargetCoordinates=function(e){for(var i=new Jt,h=e.getCoordinates(),d=0;d<h.length;d++)i.add(h[d]);return i.toArray(new Array(0).fill(null))},Vo.prototype.computeMinimumSegmentLength=function(e){for(var i=X.MAX_VALUE,h=0;h<e.length-1;h++){var d=e[h].distance(e[h+1]);d<i&&(i=d)}return i},Vo.prototype.interfaces_=function(){return[]},Vo.prototype.getClass=function(){return Vo},Vo.snap=function(e,i,h){var d=new Array(2).fill(null),x=new Vo(e);d[0]=x.snapTo(i,h);var D=new Vo(i);return d[1]=D.snapTo(d[0],h),d},Vo.computeOverlaySnapTolerance=function(){if(1===arguments.length){var e=arguments[0],i=Vo.computeSizeBasedSnapTolerance(e),h=e.getPrecisionModel();if(h.getType()===Bn.FIXED){var d=1/h.getScale()*2/1.415;d>i&&(i=d)}return i}if(2===arguments.length){var D=arguments[1];return Math.min(Vo.computeOverlaySnapTolerance(arguments[0]),Vo.computeOverlaySnapTolerance(D))}},Vo.computeSizeBasedSnapTolerance=function(e){var i=e.getEnvelopeInternal();return Math.min(i.getHeight(),i.getWidth())*Vo.SNAP_PRECISION_FACTOR},Vo.snapToSelf=function(e,i,h){return new Vo(e).snapToSelf(i,h)},jl.SNAP_PRECISION_FACTOR.get=function(){return 1e-9},Object.defineProperties(Vo,jl);var eu=function(e){function i(h,d,x){e.call(this),this._snapTolerance=h||null,this._snapPts=d||null,this._isSelfSnap=void 0!==x&&x}return e&&(i.__proto__=e),(i.prototype=Object.create(e&&e.prototype)).constructor=i,i.prototype.snapLine=function(h,d){var x=new Ir(h,this._snapTolerance);return x.setAllowSnappingToSourceVertices(this._isSelfSnap),x.snapTo(d)},i.prototype.transformCoordinates=function(h,d){var x=h.toCoordinateArray(),D=this.snapLine(x,this._snapPts);return this._factory.getCoordinateSequenceFactory().create(D)},i.prototype.interfaces_=function(){return[]},i.prototype.getClass=function(){return i},i}(So),Co=function(){this._isFirst=!0,this._commonMantissaBitsCount=53,this._commonBits=0,this._commonSignExp=null};Co.prototype.getCommon=function(){return X.longBitsToDouble(this._commonBits)},Co.prototype.add=function(e){var i=X.doubleToLongBits(e);return this._isFirst?(this._commonBits=i,this._commonSignExp=Co.signExpBits(this._commonBits),this._isFirst=!1,null):Co.signExpBits(i)!==this._commonSignExp?(this._commonBits=0,null):(this._commonMantissaBitsCount=Co.numCommonMostSigMantissaBits(this._commonBits,i),void(this._commonBits=Co.zeroLowerBits(this._commonBits,64-(12+this._commonMantissaBitsCount))))},Co.prototype.toString=function(){if(1===arguments.length){var e=arguments[0],i=X.longBitsToDouble(e),h="0000000000000000000000000000000000000000000000000000000000000000"+X.toBinaryString(e),d=h.substring(h.length-64);return d.substring(0,1)+"  "+d.substring(1,12)+"(exp) "+d.substring(12)+" [ "+i+" ]"}},Co.prototype.interfaces_=function(){return[]},Co.prototype.getClass=function(){return Co},Co.getBit=function(e,i){return 0!=(e&1<<i)?1:0},Co.signExpBits=function(e){return e>>52},Co.zeroLowerBits=function(e,i){return e&~((1<<i)-1)},Co.numCommonMostSigMantissaBits=function(e,i){for(var h=0,d=52;d>=0;d--){if(Co.getBit(e,d)!==Co.getBit(i,d))return h;h++}return 52};var Du=function(){this._commonCoord=null,this._ccFilter=new nl},lc={CommonCoordinateFilter:{configurable:!0},Translater:{configurable:!0}};Du.prototype.addCommonBits=function(e){var i=new ga(this._commonCoord);e.apply(i),e.geometryChanged()},Du.prototype.removeCommonBits=function(e){if(0===this._commonCoord.x&&0===this._commonCoord.y)return e;var i=new Z(this._commonCoord);i.x=-i.x,i.y=-i.y;var h=new ga(i);return e.apply(h),e.geometryChanged(),e},Du.prototype.getCommonCoordinate=function(){return this._commonCoord},Du.prototype.add=function(e){e.apply(this._ccFilter),this._commonCoord=this._ccFilter.getCommonCoordinate()},Du.prototype.interfaces_=function(){return[]},Du.prototype.getClass=function(){return Du},lc.CommonCoordinateFilter.get=function(){return nl},lc.Translater.get=function(){return ga},Object.defineProperties(Du,lc);var nl=function(){this._commonBitsX=new Co,this._commonBitsY=new Co};nl.prototype.filter=function(e){this._commonBitsX.add(e.x),this._commonBitsY.add(e.y)},nl.prototype.getCommonCoordinate=function(){return new Z(this._commonBitsX.getCommon(),this._commonBitsY.getCommon())},nl.prototype.interfaces_=function(){return[Jn]},nl.prototype.getClass=function(){return nl};var ga=function(){this.trans=null,this.trans=arguments[0]};ga.prototype.filter=function(e,i){var h=e.getOrdinate(i,0)+this.trans.x,d=e.getOrdinate(i,1)+this.trans.y;e.setOrdinate(i,0,h),e.setOrdinate(i,1,d)},ga.prototype.isDone=function(){return!1},ga.prototype.isGeometryChanged=function(){return!0},ga.prototype.interfaces_=function(){return[Ar]},ga.prototype.getClass=function(){return ga};var Zo=function(e,i){this._geom=new Array(2).fill(null),this._snapTolerance=null,this._cbr=null,this._geom[0]=e,this._geom[1]=i,this.computeSnapTolerance()};Zo.prototype.selfSnap=function(e){return new Vo(e).snapTo(e,this._snapTolerance)},Zo.prototype.removeCommonBits=function(e){this._cbr=new Du,this._cbr.add(e[0]),this._cbr.add(e[1]);var i=new Array(2).fill(null);return i[0]=this._cbr.removeCommonBits(e[0].copy()),i[1]=this._cbr.removeCommonBits(e[1].copy()),i},Zo.prototype.prepareResult=function(e){return this._cbr.addCommonBits(e),e},Zo.prototype.getResultGeometry=function(e){var i=this.snap(this._geom),h=hn.overlayOp(i[0],i[1],e);return this.prepareResult(h)},Zo.prototype.checkValid=function(e){e.isValid()||jr.out.println("Snapped geometry is invalid")},Zo.prototype.computeSnapTolerance=function(){this._snapTolerance=Vo.computeOverlaySnapTolerance(this._geom[0],this._geom[1])},Zo.prototype.snap=function(e){var i=this.removeCommonBits(e);return Vo.snap(i[0],i[1],this._snapTolerance)},Zo.prototype.interfaces_=function(){return[]},Zo.prototype.getClass=function(){return Zo},Zo.overlayOp=function(e,i,h){return new Zo(e,i).getResultGeometry(h)},Zo.union=function(e,i){return Zo.overlayOp(e,i,hn.UNION)},Zo.intersection=function(e,i){return Zo.overlayOp(e,i,hn.INTERSECTION)},Zo.symDifference=function(e,i){return Zo.overlayOp(e,i,hn.SYMDIFFERENCE)},Zo.difference=function(e,i){return Zo.overlayOp(e,i,hn.DIFFERENCE)};var ja=function(e,i){this._geom=new Array(2).fill(null),this._geom[0]=e,this._geom[1]=i};ja.prototype.getResultGeometry=function(e){var i=null,h=!1,d=null;try{i=hn.overlayOp(this._geom[0],this._geom[1],e),h=!0}catch(x){if(!(x instanceof ut))throw x;d=x}if(!h)try{i=Zo.overlayOp(this._geom[0],this._geom[1],e)}catch(x){throw x instanceof ut?d:x}return i},ja.prototype.interfaces_=function(){return[]},ja.prototype.getClass=function(){return ja},ja.overlayOp=function(e,i,h){return new ja(e,i).getResultGeometry(h)},ja.union=function(e,i){return ja.overlayOp(e,i,hn.UNION)},ja.intersection=function(e,i){return ja.overlayOp(e,i,hn.INTERSECTION)},ja.symDifference=function(e,i){return ja.overlayOp(e,i,hn.SYMDIFFERENCE)},ja.difference=function(e,i){return ja.overlayOp(e,i,hn.DIFFERENCE)};var ul=function(){this.mce=null,this.chainIndex=null;var i=arguments[1];this.mce=arguments[0],this.chainIndex=i};ul.prototype.computeIntersections=function(e,i){this.mce.computeIntersectsForChain(this.chainIndex,e.mce,e.chainIndex,i)},ul.prototype.interfaces_=function(){return[]},ul.prototype.getClass=function(){return ul};var rs=function e(){if(this._label=null,this._xValue=null,this._eventType=null,this._insertEvent=null,this._deleteEventIndex=null,this._obj=null,2===arguments.length){var i=arguments[0],h=arguments[1];this._eventType=e.DELETE,this._xValue=i,this._insertEvent=h}else if(3===arguments.length){var d=arguments[0],x=arguments[1],D=arguments[2];this._eventType=e.INSERT,this._label=d,this._xValue=x,this._obj=D}},Xs={INSERT:{configurable:!0},DELETE:{configurable:!0}};rs.prototype.isDelete=function(){return this._eventType===rs.DELETE},rs.prototype.setDeleteEventIndex=function(e){this._deleteEventIndex=e},rs.prototype.getObject=function(){return this._obj},rs.prototype.compareTo=function(e){return this._xValue<e._xValue?-1:this._xValue>e._xValue?1:this._eventType<e._eventType?-1:this._eventType>e._eventType?1:0},rs.prototype.getInsertEvent=function(){return this._insertEvent},rs.prototype.isInsert=function(){return this._eventType===rs.INSERT},rs.prototype.isSameLabel=function(e){return null!==this._label&&this._label===e._label},rs.prototype.getDeleteEventIndex=function(){return this._deleteEventIndex},rs.prototype.interfaces_=function(){return[J]},rs.prototype.getClass=function(){return rs},Xs.INSERT.get=function(){return 1},Xs.DELETE.get=function(){return 2},Object.defineProperties(rs,Xs);var Xl=function(){};Xl.prototype.interfaces_=function(){return[]},Xl.prototype.getClass=function(){return Xl};var ui=function(){this._hasIntersection=!1,this._hasProper=!1,this._hasProperInterior=!1,this._properIntersectionPoint=null,this._li=null,this._includeProper=null,this._recordIsolated=null,this._isSelfIntersection=null,this._numIntersections=0,this.numTests=0,this._bdyNodes=null,this._isDone=!1,this._isDoneWhenProperInt=!1;var i=arguments[1],h=arguments[2];this._li=arguments[0],this._includeProper=i,this._recordIsolated=h};ui.prototype.isTrivialIntersection=function(e,i,h,d){if(e===h&&1===this._li.getIntersectionNum()){if(ui.isAdjacentSegments(i,d))return!0;if(e.isClosed()){var x=e.getNumPoints()-1;if(0===i&&d===x||0===d&&i===x)return!0}}return!1},ui.prototype.getProperIntersectionPoint=function(){return this._properIntersectionPoint},ui.prototype.setIsDoneIfProperInt=function(e){this._isDoneWhenProperInt=e},ui.prototype.hasProperInteriorIntersection=function(){return this._hasProperInterior},ui.prototype.isBoundaryPointInternal=function(e,i){for(var h=i.iterator();h.hasNext();){var d=h.next().getCoordinate();if(e.isIntersection(d))return!0}return!1},ui.prototype.hasProperIntersection=function(){return this._hasProper},ui.prototype.hasIntersection=function(){return this._hasIntersection},ui.prototype.isDone=function(){return this._isDone},ui.prototype.isBoundaryPoint=function(e,i){return!(null===i||!this.isBoundaryPointInternal(e,i[0])&&!this.isBoundaryPointInternal(e,i[1]))},ui.prototype.setBoundaryNodes=function(e,i){this._bdyNodes=new Array(2).fill(null),this._bdyNodes[0]=e,this._bdyNodes[1]=i},ui.prototype.addIntersections=function(e,i,h,d){if(e===h&&i===d)return null;this.numTests++;var x=e.getCoordinates()[i],D=e.getCoordinates()[i+1],F=h.getCoordinates()[d],$=h.getCoordinates()[d+1];this._li.computeIntersection(x,D,F,$),this._li.hasIntersection()&&(this._recordIsolated&&(e.setIsolated(!1),h.setIsolated(!1)),this._numIntersections++,this.isTrivialIntersection(e,i,h,d)||(this._hasIntersection=!0,!this._includeProper&&this._li.isProper()||(e.addIntersections(this._li,i,0),h.addIntersections(this._li,d,1)),this._li.isProper()&&(this._properIntersectionPoint=this._li.getIntersection(0).copy(),this._hasProper=!0,this._isDoneWhenProperInt&&(this._isDone=!0),this.isBoundaryPoint(this._li,this._bdyNodes)||(this._hasProperInterior=!0))))},ui.prototype.interfaces_=function(){return[]},ui.prototype.getClass=function(){return ui},ui.isAdjacentSegments=function(e,i){return 1===Math.abs(e-i)};var so=function(e){function i(){e.call(this),this.events=new cr,this.nOverlaps=null}return e&&(i.__proto__=e),(i.prototype=Object.create(e&&e.prototype)).constructor=i,i.prototype.prepareEvents=function(){cs.sort(this.events);for(var h=0;h<this.events.size();h++){var d=this.events.get(h);d.isDelete()&&d.getInsertEvent().setDeleteEventIndex(h)}},i.prototype.computeIntersections=function(){if(1===arguments.length){var h=arguments[0];this.nOverlaps=0,this.prepareEvents();for(var d=0;d<this.events.size();d++){var x=this.events.get(d);if(x.isInsert()&&this.processOverlaps(d,x.getDeleteEventIndex(),x,h),h.isDone())break}}else if(3===arguments.length)if(arguments[2]instanceof ui&&Ce(arguments[0],xn)&&Ce(arguments[1],xn)){var D=arguments[0],F=arguments[1],$=arguments[2];this.addEdges(D,D),this.addEdges(F,F),this.computeIntersections($)}else if("boolean"==typeof arguments[2]&&Ce(arguments[0],xn)&&arguments[1]instanceof ui){var Ct=arguments[0],te=arguments[1];arguments[2]?this.addEdges(Ct,null):this.addEdges(Ct),this.computeIntersections(te)}},i.prototype.addEdge=function(h,d){for(var x=h.getMonotoneChainEdge(),D=x.getStartIndexes(),F=0;F<D.length-1;F++){var $=new ul(x,F),Ct=new rs(d,x.getMinX(F),$);this.events.add(Ct),this.events.add(new rs(x.getMaxX(F),Ct))}},i.prototype.processOverlaps=function(h,d,x,D){for(var F=x.getObject(),$=h;$<d;$++){var Ct=this.events.get($);if(Ct.isInsert()){var te=Ct.getObject();x.isSameLabel(Ct)||(F.computeIntersections(te,D),this.nOverlaps++)}}},i.prototype.addEdges=function(){if(1===arguments.length)for(var h=arguments[0].iterator();h.hasNext();){var d=h.next();this.addEdge(d,d)}else if(2===arguments.length)for(var D=arguments[1],F=arguments[0].iterator();F.hasNext();){var $=F.next();this.addEdge($,D)}},i.prototype.interfaces_=function(){return[]},i.prototype.getClass=function(){return i},i}(Xl),ka=function(){this._min=X.POSITIVE_INFINITY,this._max=X.NEGATIVE_INFINITY},ru={NodeComparator:{configurable:!0}};ka.prototype.getMin=function(){return this._min},ka.prototype.intersects=function(e,i){return!(this._min>i||this._max<e)},ka.prototype.getMax=function(){return this._max},ka.prototype.toString=function(){return Kt.toLineString(new Z(this._min,0),new Z(this._max,0))},ka.prototype.interfaces_=function(){return[]},ka.prototype.getClass=function(){return ka},ru.NodeComparator.get=function(){return Ds},Object.defineProperties(ka,ru);var Ds=function(){};Ds.prototype.compare=function(e,i){var x=(e._min+e._max)/2,D=(i._min+i._max)/2;return x<D?-1:x>D?1:0},Ds.prototype.interfaces_=function(){return[at]},Ds.prototype.getClass=function(){return Ds};var Il=function(e){function i(){e.call(this),this._item=null;var d=arguments[1],x=arguments[2];this._min=arguments[0],this._max=d,this._item=x}return e&&(i.__proto__=e),(i.prototype=Object.create(e&&e.prototype)).constructor=i,i.prototype.query=function(h,d,x){if(!this.intersects(h,d))return null;x.visitItem(this._item)},i.prototype.interfaces_=function(){return[]},i.prototype.getClass=function(){return i},i}(ka),Uu=function(e){function i(){e.call(this),this._node1=null,this._node2=null;var d=arguments[1];this._node1=arguments[0],this._node2=d,this.buildExtent(this._node1,this._node2)}return e&&(i.__proto__=e),(i.prototype=Object.create(e&&e.prototype)).constructor=i,i.prototype.buildExtent=function(h,d){this._min=Math.min(h._min,d._min),this._max=Math.max(h._max,d._max)},i.prototype.query=function(h,d,x){if(!this.intersects(h,d))return null;null!==this._node1&&this._node1.query(h,d,x),null!==this._node2&&this._node2.query(h,d,x)},i.prototype.interfaces_=function(){return[]},i.prototype.getClass=function(){return i},i}(ka),xs=function(){this._leaves=new cr,this._root=null,this._level=0};xs.prototype.buildTree=function(){cs.sort(this._leaves,new ka.NodeComparator);for(var e=this._leaves,i=null,h=new cr;;){if(this.buildLevel(e,h),1===h.size())return h.get(0);i=e,e=h,h=i}},xs.prototype.insert=function(e,i,h){if(null!==this._root)throw new Error("Index cannot be added to once it has been queried");this._leaves.add(new Il(e,i,h))},xs.prototype.query=function(e,i,h){this.init(),this._root.query(e,i,h)},xs.prototype.buildRoot=function(){if(null!==this._root)return null;this._root=this.buildTree()},xs.prototype.printNode=function(e){jr.out.println(Kt.toLineString(new Z(e._min,this._level),new Z(e._max,this._level)))},xs.prototype.init=function(){if(null!==this._root)return null;this.buildRoot()},xs.prototype.buildLevel=function(e,i){this._level++,i.clear();for(var h=0;h<e.size();h+=2){var d=e.get(h);if(null===(h+1<e.size()?e.get(h):null))i.add(d);else{var x=new Uu(e.get(h),e.get(h+1));i.add(x)}}},xs.prototype.interfaces_=function(){return[]},xs.prototype.getClass=function(){return xs};var ps=function(){this._items=new cr};ps.prototype.visitItem=function(e){this._items.add(e)},ps.prototype.getItems=function(){return this._items},ps.prototype.interfaces_=function(){return[sa]},ps.prototype.getClass=function(){return ps};var mu=function(){this._index=null;var e=arguments[0];if(!Ce(e,kn))throw new tt("Argument must be Polygonal");this._index=new Ea(e)},Dr={SegmentVisitor:{configurable:!0},IntervalIndexedGeometry:{configurable:!0}};mu.prototype.locate=function(e){var i=new ir(e),h=new cn(i);return this._index.query(e.y,e.y,h),i.getLocation()},mu.prototype.interfaces_=function(){return[Eu]},mu.prototype.getClass=function(){return mu},Dr.SegmentVisitor.get=function(){return cn},Dr.IntervalIndexedGeometry.get=function(){return Ea},Object.defineProperties(mu,Dr);var cn=function(){this._counter=null,this._counter=arguments[0]};cn.prototype.visitItem=function(e){var i=e;this._counter.countSegment(i.getCoordinate(0),i.getCoordinate(1))},cn.prototype.interfaces_=function(){return[sa]},cn.prototype.getClass=function(){return cn};var Ea=function(){this._index=new xs,this.init(arguments[0])};Ea.prototype.init=function(e){for(var i=Po.getLines(e).iterator();i.hasNext();){var h=i.next().getCoordinates();this.addLine(h)}},Ea.prototype.addLine=function(e){for(var i=1;i<e.length;i++){var h=new Hr(e[i-1],e[i]),d=Math.min(h.p0.y,h.p1.y),x=Math.max(h.p0.y,h.p1.y);this._index.insert(d,x,h)}},Ea.prototype.query=function(){if(2===arguments.length){var e=arguments[0],i=arguments[1],h=new ps;return this._index.query(e,i,h),h.getItems()}3===arguments.length&&this._index.query(arguments[0],arguments[1],arguments[2])},Ea.prototype.interfaces_=function(){return[]},Ea.prototype.getClass=function(){return Ea};var Os=function(e){function i(){if(e.call(this),this._parentGeom=null,this._lineEdgeMap=new ss,this._boundaryNodeRule=null,this._useBoundaryDeterminationRule=!0,this._argIndex=null,this._boundaryNodes=null,this._hasTooFewPoints=!1,this._invalidPoint=null,this._areaPtLocator=null,this._ptLocator=new po,2===arguments.length){var d=arguments[1],x=Sn.OGC_SFS_BOUNDARY_RULE;this._argIndex=arguments[0],this._parentGeom=d,this._boundaryNodeRule=x,null!==d&&this.add(d)}else if(3===arguments.length){var F=arguments[1],$=arguments[2];this._argIndex=arguments[0],this._parentGeom=F,this._boundaryNodeRule=$,null!==F&&this.add(F)}}return e&&(i.__proto__=e),(i.prototype=Object.create(e&&e.prototype)).constructor=i,i.prototype.insertBoundaryPoint=function(h,d){var x=this._nodes.addNode(d).getLabel(),D=1;x.getLocation(h,Bt.ON)===dt.BOUNDARY&&D++;var F=i.determineBoundary(this._boundaryNodeRule,D);x.setLocation(h,F)},i.prototype.computeSelfNodes=function(){if(2===arguments.length)return this.computeSelfNodes(arguments[0],arguments[1],!1);if(3===arguments.length){var D=arguments[1],F=arguments[2],$=new ui(arguments[0],!0,!1);return $.setIsDoneIfProperInt(F),this.createEdgeSetIntersector().computeIntersections(this._edges,$,D||!(this._parentGeom instanceof ni||this._parentGeom instanceof Tn||this._parentGeom instanceof Xr)),this.addSelfIntersectionNodes(this._argIndex),$}},i.prototype.computeSplitEdges=function(h){for(var d=this._edges.iterator();d.hasNext();)d.next().eiList.addSplitEdges(h)},i.prototype.computeEdgeIntersections=function(h,d,x){var D=new ui(d,x,!0);return D.setBoundaryNodes(this.getBoundaryNodes(),h.getBoundaryNodes()),this.createEdgeSetIntersector().computeIntersections(this._edges,h._edges,D),D},i.prototype.getGeometry=function(){return this._parentGeom},i.prototype.getBoundaryNodeRule=function(){return this._boundaryNodeRule},i.prototype.hasTooFewPoints=function(){return this._hasTooFewPoints},i.prototype.addPoint=function(){if(arguments[0]instanceof ai){var h=arguments[0].getCoordinate();this.insertPoint(this._argIndex,h,dt.INTERIOR)}else arguments[0]instanceof Z&&this.insertPoint(this._argIndex,arguments[0],dt.INTERIOR)},i.prototype.addPolygon=function(h){this.addPolygonRing(h.getExteriorRing(),dt.EXTERIOR,dt.INTERIOR);for(var d=0;d<h.getNumInteriorRing();d++){var x=h.getInteriorRingN(d);this.addPolygonRing(x,dt.INTERIOR,dt.EXTERIOR)}},i.prototype.addEdge=function(h){this.insertEdge(h);var d=h.getCoordinates();this.insertPoint(this._argIndex,d[0],dt.BOUNDARY),this.insertPoint(this._argIndex,d[d.length-1],dt.BOUNDARY)},i.prototype.addLineString=function(h){var d=W.removeRepeatedPoints(h.getCoordinates());if(d.length<2)return this._hasTooFewPoints=!0,this._invalidPoint=d[0],null;var x=new xi(d,new lr(this._argIndex,dt.INTERIOR));this._lineEdgeMap.put(h,x),this.insertEdge(x),ot.isTrue(d.length>=2,"found LineString with single point"),this.insertBoundaryPoint(this._argIndex,d[0]),this.insertBoundaryPoint(this._argIndex,d[d.length-1])},i.prototype.getInvalidPoint=function(){return this._invalidPoint},i.prototype.getBoundaryPoints=function(){for(var h=this.getBoundaryNodes(),d=new Array(h.size()).fill(null),x=0,D=h.iterator();D.hasNext();){var F=D.next();d[x++]=F.getCoordinate().copy()}return d},i.prototype.getBoundaryNodes=function(){return null===this._boundaryNodes&&(this._boundaryNodes=this._nodes.getBoundaryNodes(this._argIndex)),this._boundaryNodes},i.prototype.addSelfIntersectionNode=function(h,d,x){if(this.isBoundaryNode(h,d))return null;x===dt.BOUNDARY&&this._useBoundaryDeterminationRule?this.insertBoundaryPoint(h,d):this.insertPoint(h,d,x)},i.prototype.addPolygonRing=function(h,d,x){if(h.isEmpty())return null;var D=W.removeRepeatedPoints(h.getCoordinates());if(D.length<4)return this._hasTooFewPoints=!0,this._invalidPoint=D[0],null;var F=d,$=x;Ge.isCCW(D)&&(F=x,$=d);var Ct=new xi(D,new lr(this._argIndex,dt.BOUNDARY,F,$));this._lineEdgeMap.put(h,Ct),this.insertEdge(Ct),this.insertPoint(this._argIndex,D[0],dt.BOUNDARY)},i.prototype.insertPoint=function(h,d,x){var D=this._nodes.addNode(d),F=D.getLabel();null===F?D._label=new lr(h,x):F.setLocation(h,x)},i.prototype.createEdgeSetIntersector=function(){return new so},i.prototype.addSelfIntersectionNodes=function(h){for(var d=this._edges.iterator();d.hasNext();)for(var x=d.next(),D=x.getLabel().getLocation(h),F=x.eiList.iterator();F.hasNext();){var $=F.next();this.addSelfIntersectionNode(h,$.coord,D)}},i.prototype.add=function(){if(1!==arguments.length)return e.prototype.add.apply(this,arguments);var h=arguments[0];if(h.isEmpty())return null;if(h instanceof Xr&&(this._useBoundaryDeterminationRule=!1),h instanceof Tn)this.addPolygon(h);else if(h instanceof Nr)this.addLineString(h);else if(h instanceof ai)this.addPoint(h);else if(h instanceof co)this.addCollection(h);else if(h instanceof vr)this.addCollection(h);else if(h instanceof Xr)this.addCollection(h);else{if(!(h instanceof Xe))throw new Error(h.getClass().getName());this.addCollection(h)}},i.prototype.addCollection=function(h){for(var d=0;d<h.getNumGeometries();d++){var x=h.getGeometryN(d);this.add(x)}},i.prototype.locate=function(h){return Ce(this._parentGeom,kn)&&this._parentGeom.getNumGeometries()>50?(null===this._areaPtLocator&&(this._areaPtLocator=new mu(this._parentGeom)),this._areaPtLocator.locate(h)):this._ptLocator.locate(h,this._parentGeom)},i.prototype.findEdge=function(){return 1===arguments.length?this._lineEdgeMap.get(arguments[0]):e.prototype.findEdge.apply(this,arguments)},i.prototype.interfaces_=function(){return[]},i.prototype.getClass=function(){return i},i.determineBoundary=function(h,d){return h.isInBoundary(d)?dt.BOUNDARY:dt.INTERIOR},i}(qr),Ys=function(){if(this._li=new Oe,this._resultPrecisionModel=null,this._arg=null,1===arguments.length){var e=arguments[0];this.setComputationPrecision(e.getPrecisionModel()),this._arg=new Array(1).fill(null),this._arg[0]=new Os(0,e)}else if(2===arguments.length){var i=arguments[0],h=arguments[1],d=Sn.OGC_SFS_BOUNDARY_RULE;i.getPrecisionModel().compareTo(h.getPrecisionModel())>=0?this.setComputationPrecision(i.getPrecisionModel()):this.setComputationPrecision(h.getPrecisionModel()),this._arg=new Array(2).fill(null),this._arg[0]=new Os(0,i,d),this._arg[1]=new Os(1,h,d)}else if(3===arguments.length){var x=arguments[0],D=arguments[1],F=arguments[2];x.getPrecisionModel().compareTo(D.getPrecisionModel())>=0?this.setComputationPrecision(x.getPrecisionModel()):this.setComputationPrecision(D.getPrecisionModel()),this._arg=new Array(2).fill(null),this._arg[0]=new Os(0,x,F),this._arg[1]=new Os(1,D,F)}};Ys.prototype.getArgGeometry=function(e){return this._arg[e].getGeometry()},Ys.prototype.setComputationPrecision=function(e){this._resultPrecisionModel=e,this._li.setPrecisionModel(this._resultPrecisionModel)},Ys.prototype.interfaces_=function(){return[]},Ys.prototype.getClass=function(){return Ys};var Sa=function(){};Sa.prototype.interfaces_=function(){return[]},Sa.prototype.getClass=function(){return Sa},Sa.map=function(){if(arguments[0]instanceof hr&&Ce(arguments[1],Sa.MapOp)){for(var e=arguments[0],i=arguments[1],h=new cr,d=0;d<e.getNumGeometries();d++){var x=i.map(e.getGeometryN(d));null!==x&&h.add(x)}return e.getFactory().buildGeometry(h)}if(Ce(arguments[0],Gn)&&Ce(arguments[1],Sa.MapOp)){for(var D=arguments[0],F=arguments[1],$=new cr,Ct=D.iterator();Ct.hasNext();){var te=Ct.next(),Ne=F.map(te);null!==Ne&&$.add(Ne)}return $}},Sa.MapOp=function(){};var hn=function(e){function i(){var h=arguments[0];e.call(this,h,arguments[1]),this._ptLocator=new po,this._geomFact=null,this._resultGeom=null,this._graph=null,this._edgeList=new $a,this._resultPolyList=new cr,this._resultLineList=new cr,this._resultPointList=new cr,this._graph=new qr(new Cl),this._geomFact=h.getFactory()}return e&&(i.__proto__=e),(i.prototype=Object.create(e&&e.prototype)).constructor=i,i.prototype.insertUniqueEdge=function(h){var d=this._edgeList.findEqualEdge(h);if(null!==d){var x=d.getLabel(),D=h.getLabel();d.isPointwiseEqual(h)||(D=new lr(h.getLabel())).flip();var F=d.getDepth();F.isNull()&&F.add(x),F.add(D),x.merge(D)}else this._edgeList.add(h)},i.prototype.getGraph=function(){return this._graph},i.prototype.cancelDuplicateResultEdges=function(){for(var h=this._graph.getEdgeEnds().iterator();h.hasNext();){var d=h.next(),x=d.getSym();d.isInResult()&&x.isInResult()&&(d.setInResult(!1),x.setInResult(!1))}},i.prototype.isCoveredByLA=function(h){return!!this.isCovered(h,this._resultLineList)||!!this.isCovered(h,this._resultPolyList)},i.prototype.computeGeometry=function(h,d,x,D){var F=new cr;return F.addAll(h),F.addAll(d),F.addAll(x),F.isEmpty()?i.createEmptyResult(D,this._arg[0].getGeometry(),this._arg[1].getGeometry(),this._geomFact):this._geomFact.buildGeometry(F)},i.prototype.mergeSymLabels=function(){for(var h=this._graph.getNodes().iterator();h.hasNext();)h.next().getEdges().mergeSymLabels()},i.prototype.isCovered=function(h,d){for(var x=d.iterator();x.hasNext();){var D=x.next();if(this._ptLocator.locate(h,D)!==dt.EXTERIOR)return!0}return!1},i.prototype.replaceCollapsedEdges=function(){for(var h=new cr,d=this._edgeList.iterator();d.hasNext();){var x=d.next();x.isCollapsed()&&(d.remove(),h.add(x.getCollapsedEdge()))}this._edgeList.addAll(h)},i.prototype.updateNodeLabelling=function(){for(var h=this._graph.getNodes().iterator();h.hasNext();){var d=h.next(),x=d.getEdges().getLabel();d.getLabel().merge(x)}},i.prototype.getResultGeometry=function(h){return this.computeOverlay(h),this._resultGeom},i.prototype.insertUniqueEdges=function(h){for(var d=h.iterator();d.hasNext();){var x=d.next();this.insertUniqueEdge(x)}},i.prototype.computeOverlay=function(h){this.copyPoints(0),this.copyPoints(1),this._arg[0].computeSelfNodes(this._li,!1),this._arg[1].computeSelfNodes(this._li,!1),this._arg[0].computeEdgeIntersections(this._arg[1],this._li,!0);var d=new cr;this._arg[0].computeSplitEdges(d),this._arg[1].computeSplitEdges(d),this.insertUniqueEdges(d),this.computeLabelsFromDepths(),this.replaceCollapsedEdges(),Cu.checkValid(this._edgeList.getEdges()),this._graph.addEdges(this._edgeList.getEdges()),this.computeLabelling(),this.labelIncompleteNodes(),this.findResultAreaEdges(h),this.cancelDuplicateResultEdges();var x=new Bi(this._geomFact);x.add(this._graph),this._resultPolyList=x.getPolygons();var D=new na(this,this._geomFact,this._ptLocator);this._resultLineList=D.build(h);var F=new Lu(this,this._geomFact,this._ptLocator);this._resultPointList=F.build(h),this._resultGeom=this.computeGeometry(this._resultPointList,this._resultLineList,this._resultPolyList,h)},i.prototype.labelIncompleteNode=function(h,d){var x=this._ptLocator.locate(h.getCoordinate(),this._arg[d].getGeometry());h.getLabel().setLocation(d,x)},i.prototype.copyPoints=function(h){for(var d=this._arg[h].getNodeIterator();d.hasNext();){var x=d.next();this._graph.addNode(x.getCoordinate()).setLabel(h,x.getLabel().getLocation(h))}},i.prototype.findResultAreaEdges=function(h){for(var d=this._graph.getEdgeEnds().iterator();d.hasNext();){var x=d.next(),D=x.getLabel();D.isArea()&&!x.isInteriorAreaEdge()&&i.isResultOfOp(D.getLocation(0,Bt.RIGHT),D.getLocation(1,Bt.RIGHT),h)&&x.setInResult(!0)}},i.prototype.computeLabelsFromDepths=function(){for(var h=this._edgeList.iterator();h.hasNext();){var d=h.next(),x=d.getLabel(),D=d.getDepth();if(!D.isNull()){D.normalize();for(var F=0;F<2;F++)x.isNull(F)||!x.isArea()||D.isNull(F)||(0===D.getDelta(F)?x.toLine(F):(ot.isTrue(!D.isNull(F,Bt.LEFT),"depth of LEFT side has not been initialized"),x.setLocation(F,Bt.LEFT,D.getLocation(F,Bt.LEFT)),ot.isTrue(!D.isNull(F,Bt.RIGHT),"depth of RIGHT side has not been initialized"),x.setLocation(F,Bt.RIGHT,D.getLocation(F,Bt.RIGHT))))}}},i.prototype.computeLabelling=function(){for(var h=this._graph.getNodes().iterator();h.hasNext();)h.next().getEdges().computeLabelling(this._arg);this.mergeSymLabels(),this.updateNodeLabelling()},i.prototype.labelIncompleteNodes=function(){for(var h=this._graph.getNodes().iterator();h.hasNext();){var d=h.next(),x=d.getLabel();d.isIsolated()&&(x.isNull(0)?this.labelIncompleteNode(d,0):this.labelIncompleteNode(d,1)),d.getEdges().updateLabelling(x)}},i.prototype.isCoveredByA=function(h){return!!this.isCovered(h,this._resultPolyList)},i.prototype.interfaces_=function(){return[]},i.prototype.getClass=function(){return i},i}(Ys);hn.overlayOp=function(e,i,h){return new hn(e,i).getResultGeometry(h)},hn.intersection=function(e,i){if(e.isEmpty()||i.isEmpty())return hn.createEmptyResult(hn.INTERSECTION,e,i,e.getFactory());if(e.isGeometryCollection()){var h=i;return gu.map(e,{interfaces_:function(){return[Sa.MapOp]},map:function(d){return d.intersection(h)}})}return e.checkNotGeometryCollection(e),e.checkNotGeometryCollection(i),ja.overlayOp(e,i,hn.INTERSECTION)},hn.symDifference=function(e,i){if(e.isEmpty()||i.isEmpty()){if(e.isEmpty()&&i.isEmpty())return hn.createEmptyResult(hn.SYMDIFFERENCE,e,i,e.getFactory());if(e.isEmpty())return i.copy();if(i.isEmpty())return e.copy()}return e.checkNotGeometryCollection(e),e.checkNotGeometryCollection(i),ja.overlayOp(e,i,hn.SYMDIFFERENCE)},hn.resultDimension=function(e,i,h){var d=i.getDimension(),x=h.getDimension(),D=-1;switch(e){case hn.INTERSECTION:D=Math.min(d,x);break;case hn.UNION:D=Math.max(d,x);break;case hn.DIFFERENCE:D=d;break;case hn.SYMDIFFERENCE:D=Math.max(d,x)}return D},hn.createEmptyResult=function(e,i,h,d){var x=null;switch(hn.resultDimension(e,i,h)){case-1:x=d.createGeometryCollection(new Array(0).fill(null));break;case 0:x=d.createPoint();break;case 1:x=d.createLineString();break;case 2:x=d.createPolygon()}return x},hn.difference=function(e,i){return e.isEmpty()?hn.createEmptyResult(hn.DIFFERENCE,e,i,e.getFactory()):i.isEmpty()?e.copy():(e.checkNotGeometryCollection(e),e.checkNotGeometryCollection(i),ja.overlayOp(e,i,hn.DIFFERENCE))},hn.isResultOfOp=function(){if(2===arguments.length){var e=arguments[0],i=arguments[1],h=e.getLocation(0),d=e.getLocation(1);return hn.isResultOfOp(h,d,i)}if(3===arguments.length){var x=arguments[0],D=arguments[1];switch(x===dt.BOUNDARY&&(x=dt.INTERIOR),D===dt.BOUNDARY&&(D=dt.INTERIOR),arguments[2]){case hn.INTERSECTION:return x===dt.INTERIOR&&D===dt.INTERIOR;case hn.UNION:return x===dt.INTERIOR||D===dt.INTERIOR;case hn.DIFFERENCE:return x===dt.INTERIOR&&D!==dt.INTERIOR;case hn.SYMDIFFERENCE:return x===dt.INTERIOR&&D!==dt.INTERIOR||x!==dt.INTERIOR&&D===dt.INTERIOR}return!1}},hn.INTERSECTION=1,hn.UNION=2,hn.DIFFERENCE=3,hn.SYMDIFFERENCE=4;var il=function(){this._g=null,this._boundaryDistanceTolerance=null,this._linework=null,this._ptLocator=new po,this._seg=new Hr;var e=arguments[0],i=arguments[1];this._g=e,this._boundaryDistanceTolerance=i,this._linework=this.extractLinework(e)};il.prototype.isWithinToleranceOfBoundary=function(e){for(var i=0;i<this._linework.getNumGeometries();i++)for(var h=this._linework.getGeometryN(i).getCoordinateSequence(),d=0;d<h.size()-1;d++)if(h.getCoordinate(d,this._seg.p0),h.getCoordinate(d+1,this._seg.p1),this._seg.distance(e)<=this._boundaryDistanceTolerance)return!0;return!1},il.prototype.getLocation=function(e){return this.isWithinToleranceOfBoundary(e)?dt.BOUNDARY:this._ptLocator.locate(e,this._g)},il.prototype.extractLinework=function(e){var i=new bs;e.apply(i);var h=i.getLinework(),d=wn.toLineStringArray(h);return e.getFactory().createMultiLineString(d)},il.prototype.interfaces_=function(){return[]},il.prototype.getClass=function(){return il};var bs=function(){this._linework=null,this._linework=new cr};bs.prototype.getLinework=function(){return this._linework},bs.prototype.filter=function(e){if(e instanceof Tn){var i=e;this._linework.add(i.getExteriorRing());for(var h=0;h<i.getNumInteriorRing();h++)this._linework.add(i.getInteriorRingN(h))}},bs.prototype.interfaces_=function(){return[wr]},bs.prototype.getClass=function(){return bs};var Vi=function(){this._g=null,this._doLeft=!0,this._doRight=!0,this._g=arguments[0]};Vi.prototype.extractPoints=function(e,i,h){for(var d=e.getCoordinates(),x=0;x<d.length-1;x++)this.computeOffsetPoints(d[x],d[x+1],i,h)},Vi.prototype.setSidesToGenerate=function(e,i){this._doLeft=e,this._doRight=i},Vi.prototype.getPoints=function(e){for(var i=new cr,h=Po.getLines(this._g).iterator();h.hasNext();){var d=h.next();this.extractPoints(d,e,i)}return i},Vi.prototype.computeOffsetPoints=function(e,i,h,d){var x=i.x-e.x,D=i.y-e.y,F=Math.sqrt(x*x+D*D),$=h*x/F,Ct=h*D/F,te=(i.x+e.x)/2,Ne=(i.y+e.y)/2;if(this._doLeft){var Ve=new Z(te-Ct,Ne+$);d.add(Ve)}if(this._doRight){var gr=new Z(te+Ct,Ne-$);d.add(gr)}},Vi.prototype.interfaces_=function(){return[]},Vi.prototype.getClass=function(){return Vi};var yo=function e(){this._geom=null,this._locFinder=null,this._location=new Array(3).fill(null),this._invalidLocation=null,this._boundaryDistanceTolerance=e.TOLERANCE,this._testCoords=new cr;var i=arguments[0],h=arguments[1],d=arguments[2];this._boundaryDistanceTolerance=e.computeBoundaryDistanceTolerance(i,h),this._geom=[i,h,d],this._locFinder=[new il(this._geom[0],this._boundaryDistanceTolerance),new il(this._geom[1],this._boundaryDistanceTolerance),new il(this._geom[2],this._boundaryDistanceTolerance)]},cc={TOLERANCE:{configurable:!0}};yo.prototype.reportResult=function(e,i,h){jr.out.println("Overlay result invalid - A:"+dt.toLocationSymbol(i[0])+" B:"+dt.toLocationSymbol(i[1])+" expected:"+(h?"i":"e")+" actual:"+dt.toLocationSymbol(i[2]))},yo.prototype.isValid=function(e){return this.addTestPts(this._geom[0]),this.addTestPts(this._geom[1]),this.checkValid(e)},yo.prototype.checkValid=function(){if(1===arguments.length){for(var e=arguments[0],i=0;i<this._testCoords.size();i++){var h=this._testCoords.get(i);if(!this.checkValid(e,h))return this._invalidLocation=h,!1}return!0}if(2===arguments.length){var d=arguments[0],x=arguments[1];return this._location[0]=this._locFinder[0].getLocation(x),this._location[1]=this._locFinder[1].getLocation(x),this._location[2]=this._locFinder[2].getLocation(x),!!yo.hasLocation(this._location,dt.BOUNDARY)||this.isValidResult(d,this._location)}},yo.prototype.addTestPts=function(e){var i=new Vi(e);this._testCoords.addAll(i.getPoints(5*this._boundaryDistanceTolerance))},yo.prototype.isValidResult=function(e,i){var h=hn.isResultOfOp(i[0],i[1],e),d=!(h^i[2]===dt.INTERIOR);return d||this.reportResult(e,i,h),d},yo.prototype.getInvalidLocation=function(){return this._invalidLocation},yo.prototype.interfaces_=function(){return[]},yo.prototype.getClass=function(){return yo},yo.hasLocation=function(e,i){for(var h=0;h<3;h++)if(e[h]===i)return!0;return!1},yo.computeBoundaryDistanceTolerance=function(e,i){return Math.min(Vo.computeSizeBasedSnapTolerance(e),Vo.computeSizeBasedSnapTolerance(i))},yo.isValid=function(e,i,h,d){return new yo(e,i,d).isValid(h)},cc.TOLERANCE.get=function(){return 1e-6},Object.defineProperties(yo,cc);var fs=function e(i){this._geomFactory=null,this._skipEmpty=!1,this._inputGeoms=null,this._geomFactory=e.extractFactory(i),this._inputGeoms=i};fs.prototype.extractElements=function(e,i){if(null===e)return null;for(var h=0;h<e.getNumGeometries();h++){var d=e.getGeometryN(h);this._skipEmpty&&d.isEmpty()||i.add(d)}},fs.prototype.combine=function(){for(var e=new cr,i=this._inputGeoms.iterator();i.hasNext();){var h=i.next();this.extractElements(h,e)}return 0===e.size()?null!==this._geomFactory?this._geomFactory.createGeometryCollection(null):null:this._geomFactory.buildGeometry(e)},fs.prototype.interfaces_=function(){return[]},fs.prototype.getClass=function(){return fs},fs.combine=function(){return 1===arguments.length?new fs(arguments[0]).combine():2===arguments.length?new fs(fs.createList(arguments[0],arguments[1])).combine():3===arguments.length?new fs(fs.createList(arguments[0],arguments[1],arguments[2])).combine():void 0},fs.extractFactory=function(e){return e.isEmpty()?null:e.iterator().next().getFactory()},fs.createList=function(){if(2===arguments.length){var e=arguments[0],i=arguments[1],h=new cr;return h.add(e),h.add(i),h}if(3===arguments.length){var d=arguments[0],x=arguments[1],D=arguments[2],F=new cr;return F.add(d),F.add(x),F.add(D),F}};var Io=function(){this._inputPolys=null,this._geomFactory=null,this._inputPolys=arguments[0],null===this._inputPolys&&(this._inputPolys=new cr)},Js={STRTREE_NODE_CAPACITY:{configurable:!0}};Io.prototype.reduceToGeometries=function(e){for(var i=new cr,h=e.iterator();h.hasNext();){var d=h.next(),x=null;Ce(d,xn)?x=this.unionTree(d):d instanceof hr&&(x=d),i.add(x)}return i},Io.prototype.extractByEnvelope=function(e,i,h){for(var d=new cr,x=0;x<i.getNumGeometries();x++){var D=i.getGeometryN(x);D.getEnvelopeInternal().intersects(e)?d.add(D):h.add(D)}return this._geomFactory.buildGeometry(d)},Io.prototype.unionOptimized=function(e,i){var h=e.getEnvelopeInternal(),d=i.getEnvelopeInternal();if(!h.intersects(d))return fs.combine(e,i);if(e.getNumGeometries()<=1&&i.getNumGeometries()<=1)return this.unionActual(e,i);var x=h.intersection(d);return this.unionUsingEnvelopeIntersection(e,i,x)},Io.prototype.union=function(){if(null===this._inputPolys)throw new Error("union() method cannot be called twice");if(this._inputPolys.isEmpty())return null;this._geomFactory=this._inputPolys.iterator().next().getFactory();for(var e=new Ol(Io.STRTREE_NODE_CAPACITY),i=this._inputPolys.iterator();i.hasNext();){var h=i.next();e.insert(h.getEnvelopeInternal(),h)}this._inputPolys=null;var d=e.itemsTree();return this.unionTree(d)},Io.prototype.binaryUnion=function(){if(1===arguments.length){var e=arguments[0];return this.binaryUnion(e,0,e.size())}if(3===arguments.length){var i=arguments[0],h=arguments[1],d=arguments[2];if(d-h<=1){var x=Io.getGeometry(i,h);return this.unionSafe(x,null)}if(d-h==2)return this.unionSafe(Io.getGeometry(i,h),Io.getGeometry(i,h+1));var D=Math.trunc((d+h)/2),F=this.binaryUnion(i,h,D),$=this.binaryUnion(i,D,d);return this.unionSafe(F,$)}},Io.prototype.repeatedUnion=function(e){for(var i=null,h=e.iterator();h.hasNext();){var d=h.next();i=null===i?d.copy():i.union(d)}return i},Io.prototype.unionSafe=function(e,i){return null===e&&null===i?null:null===e?i.copy():null===i?e.copy():this.unionOptimized(e,i)},Io.prototype.unionActual=function(e,i){return Io.restrictToPolygons(e.union(i))},Io.prototype.unionTree=function(e){var i=this.reduceToGeometries(e);return this.binaryUnion(i)},Io.prototype.unionUsingEnvelopeIntersection=function(e,i,h){var d=new cr,x=this.extractByEnvelope(h,e,d),D=this.extractByEnvelope(h,i,d),F=this.unionActual(x,D);return d.add(F),fs.combine(d)},Io.prototype.bufferUnion=function(){if(1===arguments.length){var e=arguments[0];return e.get(0).getFactory().buildGeometry(e).buffer(0)}if(2===arguments.length){var i=arguments[0],h=arguments[1];return i.getFactory().createGeometryCollection([i,h]).buffer(0)}},Io.prototype.interfaces_=function(){return[]},Io.prototype.getClass=function(){return Io},Io.restrictToPolygons=function(e){if(Ce(e,kn))return e;var i=ba.getPolygons(e);return 1===i.size()?i.get(0):e.getFactory().createMultiPolygon(wn.toPolygonArray(i))},Io.getGeometry=function(e,i){return i>=e.size()?null:e.get(i)},Io.union=function(e){return new Io(e).union()},Js.STRTREE_NODE_CAPACITY.get=function(){return 4},Object.defineProperties(Io,Js);var ll=function(){};ll.prototype.interfaces_=function(){return[]},ll.prototype.getClass=function(){return ll},ll.union=function(e,i){if(e.isEmpty()||i.isEmpty()){if(e.isEmpty()&&i.isEmpty())return hn.createEmptyResult(hn.UNION,e,i,e.getFactory());if(e.isEmpty())return i.copy();if(i.isEmpty())return e.copy()}return e.checkNotGeometryCollection(e),e.checkNotGeometryCollection(i),ja.overlayOp(e,i,hn.UNION)},It.GeoJSONReader=oe,It.GeoJSONWriter=Se,It.OverlayOp=hn,It.UnionOp=ll,It.BufferOp=Go,Object.defineProperty(It,"__esModule",{value:!0})}(ce)}}]);